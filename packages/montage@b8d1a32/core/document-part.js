var Montage=require("montage").Montage,logger=require("core/logger").logger("document-part"),Promise=require("core/promise").Promise,defaultEventManager=require("core/event/event-manager").defaultEventManager,DocumentPart=Montage.specialize({template:{value:null},fragment:{value:null},objects:{value:null},childComponents:{value:null},parameters:{value:null},initWithTemplateAndFragment:{value:function(n,s){this.template=n,this.fragment=s,this.objects=null,this.childComponents=[],this.parameters=null}},startActingAsTopComponent:{value:function(){this.fragment&&defaultEventManager.registerEventHandlerForElement(this,this.fragment)}},stopActingAsTopComponent:{value:function(){this.fragment&&defaultEventManager.unregisterEventHandlerForElement(this.fragment)}},addChildComponent:{value:function(n){-1==this.childComponents.indexOf(n)&&this.childComponents.push(n)}},removeChildComponent:{value:function(n){var s=this.childComponents,e=s.indexOf(n);e>-1&&(s.splice(e,1),n._parentComponent=null,n._alternateParentComponent=null)}},_addToDrawList:{value:function(){}},_componentTreeLoadedDeferred:{value:null},loadComponentTree:{value:function(){var n,s=this._componentTreeLoadedDeferred;return s||(s=Promise.defer(),this._componentTreeLoadedDeferred=s,n=[],this.childComponents.forEach(function(s){n.push(s.loadComponentTree())}),Promise.all(n).then(function(){s.resolve()},s.reject).done()),s.promise}}});exports.DocumentPart=DocumentPart;