montageDefine("196fc31","test/simple/test-stream2-unpipe-leak",{dependencies:["../common.js","assert","../../readable","util"],factory:function(e){function t(){s.Writable.call(this)}function n(){s.Readable.call(this,{highWaterMark:65536})}e("../common.js");var a=e("assert"),s=e("../../readable"),i=new Buffer("hallo"),r=e("util");r.inherits(t,s.Writable),t.prototype._write=function(e,t,n){n(null)};var o=new t;r.inherits(n,s.Readable),n.prototype._read=function(){this.push(i)};for(var l=new n,c=0;10>c;c++)l.pipe(o),l.unpipe(o);a.equal(l.listeners("end").length,0),a.equal(l.listeners("readable").length,0),a.equal(o.listeners("unpipe").length,0),a.equal(o.listeners("drain").length,0),a.equal(o.listeners("error").length,0),a.equal(o.listeners("close").length,0),a.equal(o.listeners("finish").length,0),console.error(l._readableState),process.on("exit",function(){a(l._readableState.length>=l._readableState.highWaterMark),l._readableState.buffer.length=0,console.error(l._readableState)})}});