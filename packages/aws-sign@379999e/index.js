function authorization(e){return"AWS "+e.key+":"+sign(e)}function hmacSha1(e){return crypto.createHmac("sha1",e.secret).update(e.message).digest("base64")}function sign(e){return e.message=stringToSign(e),hmacSha1(e)}function signQuery(e){return e.message=queryStringToSign(e),hmacSha1(e)}function stringToSign(e){var t=e.amazonHeaders||"";t&&(t+="\n");var n=[e.verb,e.md5,e.contentType,e.date.toUTCString(),t+e.resource];return n.join("\n")}function queryStringToSign(e){return"GET\n\n\n"+e.date+"\n"+e.resource}function canonicalizeHeaders(e){var t=[],n=Object.keys(e);for(var r=0,i=n.length;r<i;++r){var s=n[r],o=e[s],s=s.toLowerCase();if(0!==s.indexOf("x-amz"))continue;t.push(s+":"+o)}return t.sort().join("\n")}function canonicalizeResource(e){var t=parse(e,!0),n=t.pathname,r=[];return Object.keys(t.query).forEach(function(e){if(!~keys.indexOf(e))return;var n=""==t.query[e]?"":"="+encodeURIComponent(t.query[e]);r.push(e+n)}),n+(r.length?"?"+r.sort().join("&"):"")}var crypto=require("crypto"),parse=require("url").parse,keys=["acl","location","logging","notification","partNumber","policy","requestPayment","torrent","uploadId","uploads","versionId","versioning","versions","website"];module.exports=authorization,module.exports.authorization=authorization,module.exports.hmacSha1=hmacSha1,module.exports.sign=sign,module.exports.signQuery=signQuery,module.exports.queryStringToSign=stringToSign,module.exports.queryStringToSign=queryStringToSign,module.exports.canonicalizeHeaders=canonicalizeHeaders,module.exports.canonicalizeResource=canonicalizeResource