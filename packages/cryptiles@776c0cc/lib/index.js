var Crypto=require("crypto"),Boom=require("boom"),internals={};exports.randomString=function(e){var t=exports.randomBits((e+1)*6);if(t instanceof Error)return t;var n=t.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return n.slice(0,e)},exports.randomBits=function(e){if(!e||e<0)return Boom.internal("Invalid random bits count");var t=Math.ceil(e/8);try{return Crypto.randomBytes(t)}catch(n){return Boom.internal("Failed generating random bits: "+n.message)}},exports.fixedTimeComparison=function(e,t){var n=e.length===t.length?0:1;n&&(t=e);for(var r=0,i=e.length;r<i;++r){var s=e.charCodeAt(r),o=t.charCodeAt(r);n+=s===o?0:1}return n===0}