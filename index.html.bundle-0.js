BUNDLE=[],!function(e,t){"function"==typeof define&&define.amd?define("montage",[],t):"object"==typeof module&&module.exports?module.exports=t(require,exports,module):e.Montage=t({},{},{})}(this,function(e,t,n){"use strict";var r=eval,i=r("this");i.global=i,t.initMontage=function(){var e=t.getPlatform();e.bootstrap(function(n,r,a){var s=e.getParams(),l={location:n.getLocation()};t.Require=n;var u=a.resolve(l.location,s.montageLocation),c=a.resolve(l.location,s["package"]||"."),h=s.applicationHash;if("object"==typeof i.BUNDLE){var p={},d=function(e){if(!p[e]){var t=p[e]={},n=new r(function(e,n){t.resolve=e,t.reject=n});return t.promise=n,t}return p[e]};i.bundleLoaded=function(e){d(e).resolve()};var f={},v=new r(function(e,t){f.resolve=e,f.reject=t});f.promise=v,l.preloaded=f.promise;var m=r.resolve();i.BUNDLE.forEach(function(e){m=m.then(function(){return r.all(e.map(function(e){return o.load(e),d(e).promise}))})}),f.resolve(m.then(function(){delete i.BUNDLE,delete i.bundleLoaded}))}var g;if("remoteTrigger"in s){window.postMessage({type:"montageReady"},"*");var _=new r(function(e){var t=function(n){if(s.remoteTrigger===n.origin&&(n.source===window||n.source===window.parent))switch(n.data.type){case"montageInit":window.removeEventListener("message",t),e([n.data.location,n.data.injections]);break;case"isMontageReady":window.postMessage({type:"montageReady"},"*")}};window.addEventListener("message",t)});g=_.spread(function(e,t){var r=n.loadPackage({location:e,hash:h},l);return t&&(r=r.then(function(n){e=a.resolve(e,".");var r,i,o=t.packageDescriptions,s=t.packageDescriptionLocations,l=t.mappings,u=t.dependencies;if(o)for(i=o.length,r=0;r<i;r++)n.injectPackageDescription(o[r].location,o[r].description);if(s)for(i=s.length,r=0;r<i;r++)n.injectPackageDescriptionLocation(s[r].location,s[r].descriptionLocation);if(l)for(i=l.length,r=0;r<i;r++)n.injectMapping(l[r].dependency,l[r].name);if(u)for(i=u.length,r=0;r<i;r++)n.injectDependency(u[r].name,u[r].version);return n})),r})}else{if("autoPackage"in s)n.injectPackageDescription(c,{dependencies:{montage:"*"}},l);else if(".json"===c.slice(c.length-5)){var b=c;c=a.resolve(c,"."),n.injectPackageDescriptionLocation(c,b,l)}g=n.loadPackage({location:c,hash:h},l)}g.then(function(t){return t.loadPackage({location:u,hash:s.montageHash}).then(function(e){var t;t=s.promiseLocation?a.resolve(n.getLocation(),s.promiseLocation):a.resolve(u,"node_modules/bluebird");var r=[e,e.loadPackage({location:t,hash:s.promiseHash})];return r}).spread(function(n,o){return n.inject("core/mini-url",a),n.inject("core/promise",{Promise:r}),o.inject("bluebird",r),o.inject("js/browser/bluebird",r),l.lint=function(e){n.async("jslint/lib/jslint").then(function(t){t.JSHINT(e.text)||(console.warn("JSHint Error: "+e.location),t.JSHINT.errors.forEach(function(e){e&&(console.warn("Problem at line "+e.line+" character "+e.character+": "+e.reason),e.evidence&&console.warn("    "+e.evidence))}))})},i.require=i.mr=t,e.initMontage(n,t,s)})})})},t.getPlatform=function(){if("undefined"!=typeof window&&window&&window.document)return o;if("undefined"!=typeof process)return e("./node.js");throw new Error("Platform not supported.")};var o={makeResolve:function(){try{var e="http://example.org",t="/test.html",n=new URL(t,e).href;if(!n||n!==e+t)throw new Error("NotSupported");return function(e,t){return new URL(t,e).href}}catch(r){var i=/^[\w\-]+:/,o=document.querySelector("head"),a=o.querySelector("base"),s=document.createElement("base"),l=document.createElement("a"),u=!1;return a?u=!0:a=document.createElement("base"),s.href="",function(e,t){var n;if(u||o.appendChild(a),e=String(e),i.test(e)===!1)throw new Error("Can't resolve from a relative location: "+JSON.stringify(e)+" "+JSON.stringify(t));u&&(n=a.href),a.href=e,l.href=t;var r=l.href;return u?a.href=n:o.removeChild(a),r}}},load:function(e,t){var n=document.createElement("script");n.src=e,n.onload=function(){t&&t(n),n.parentNode.removeChild(n)},document.getElementsByTagName("head")[0].appendChild(n)},getParams:function(){var e,t,n,r,i,o,a;if(!this._params){this._params={};var s=document.getElementsByTagName("script");for(e=0;e<s.length;e++)if(r=s[e],i=!1,r.src&&(n=r.src.match(/^(.*)montage.js(?:[\?\.]|$)/i))&&(this._params.montageLocation=n[1],i=!0),r.hasAttribute("data-montage-location")&&(this._params.montageLocation=r.getAttribute("data-montage-location"),i=!0),i){if(r.dataset)for(a in r.dataset)this._params[a]=r.dataset[a];else if(r.attributes){var l=/^data-(.*)$/,u=/-([a-z])/g,c=function(e,t){return t.toUpperCase()};for(t=0;t<r.attributes.length;t++)o=r.attributes[t],n=o.name.match(l),n&&(this._params[n[1].replace(u,c)]=o.value)}r.parentNode.removeChild(r);break}}return this._params},bootstrap:function(e){function t(){document.removeEventListener("DOMContentLoaded",t,!0),l=!0;var e=document.documentElement;e.classList?e.classList.add("montage-app-bootstrapping"):e.className=e.className+" montage-app-bootstrapping",document._montageTiming=document._montageTiming||{},document._montageTiming.bootstrappingStartTime=Date.now(),a()}function n(e){if(!m[e]&&f[e]){var t=m[e]={};m[e]=f[e](n,t)||t}return m[e]}function r(){c=n("mini-url"),u=n("promise"),s=n("require"),delete i.bootstrap,a()}function a(){l&&s&&e(s,u,c)}var s,l,u,c,h=this.getParams(),p=this.makeResolve();/interactive|complete/.test(document.readyState)?t():document.addEventListener("DOMContentLoaded",t,!0);var d={require:"node_modules/mr/require.js","require/browser":"node_modules/mr/browser.js",promise:"node_modules/bluebird/js/browser/bluebird.min.js"},f={};if(i.bootstrap=function(e,t){f[e]=t,delete d[e];for(var n in d)return;r()},"undefined"==typeof i.BUNDLE){var v=p(i.location,h.montageLocation);o.load(p(v,d.promise),function(){delete d.promise,i.bootstrap("bluebird",function(e,t){return i.Promise}),i.bootstrap("promise",function(e,t){return i.Promise});for(var e in d)o.load(p(v,d[e]))})}else i.nativePromise=i.Promise,Object.defineProperty(i,"Promise",{configurable:!0,set:function(e){Object.defineProperty(i,"Promise",{value:e}),i.bootstrap("bluebird",function(e,t){return i.Promise}),i.bootstrap("promise",function(e,t){return i.Promise})}});i.bootstrap("mini-url",function(e,t){t.resolve=p});var m={}},initMontage:function(e,t,n){for(var r,o=["core/core","core/event/event-manager","core/serialization/deserializer/montage-reviver","core/logger"],a=e("core/promise").Promise,s=[],l=0;r=o[l];l++)s.push(e.deepLoad(r));return a.all(s).then(function(){for(var r,a=0;r=o[a];a++)e(r);var s,l,u=(e("core/core").Montage,e("core/event/event-manager").EventManager),c=e("core/serialization/deserializer/montage-reviver").MontageReviver;e("core/logger").logger,s=(new u).initWithWindow(window),"function"==typeof i.montageWillLoad&&i.montageWillLoad();var h,p,d=t.packageDescription.applicationPrototype;return d?(h=c.parseObjectLocationId(d),p=t.async(h.moduleId)):p=e.async("core/application"),p.then(function(e){var r=e[h?h.objectName:"Application"];return l=new r,s.application=l,l.eventManager=s,l._load(t,function(){n.module&&t.async(n.module),"function"==typeof i.montageDidLoad&&i.montageDidLoad()})})})}};return"undefined"!=typeof window?i.__MONTAGE_LOADED__?console.warn("Montage already loaded!"):(i.__MONTAGE_LOADED__=!0,t.initMontage()):t.getPlatform(),t}),!function(e){if("undefined"!=typeof bootstrap)"undefined"!=typeof window?bootstrap("require",function(t,n){var r=t("promise"),i=t("mini-url");e(n,r,i),t("require/browser")}):bootstrap("require",function(t,n){var r=t("promise").Promise,i=t("mini-url");e(n,r,i)});else{if("undefined"==typeof process)throw new Error("Can't support require on this platform");var t=require("bluebird"),n=require("url");e(exports,t,n),require("./node")}}(function(e,t,n){"use strict";function r(e){var t;return g.has(e)?t=g.get(e):(t=m.exec(e),t=t?t[1]:e,g.set(e,t)),t}function i(e,t){function n(n,r){var i;return t.has(n)?i=t.get(n):(i=e(n,r),t.set(n,i)),i}return n}function o(e,t,n){var r=e.length,i=String(t),o=i.length,a=r;void 0!==n&&(a=n?Number(n):0,a!==a&&(a=0));var s=Math.min(Math.max(a,0),r),l=s-o;if(l<0)return!1;for(var u=-1;++u<o;)if(e.charCodeAt(l+u)!==i.charCodeAt(u))return!1;return!0}function a(e,t,n){""===t||"."===t||(".."===t?n.length&&n.pop():n.push(t))}function s(e,t){if(""===e&&""===t)return"";var n,r,i=_.get(e)||_.set(e,i=new p)&&i||i;if(!(i.has(t)&&e in i.get(t))){e=String(e);var o=b.get(e)||b.set(e,o=e.split("/"))&&o||o,s=b.get(t)||b.set(t,s=t.split("/"))&&s||s,l=a;if(o.length&&"."===o[0]||".."===o[0])for(n=0,r=s.length-1;n<r;n++)l(s,s[n],y);for(n=0,r=o.length;n<r;n++)l(o,o[n],y);i.get(t)||i.set(t,new p),i.get(t).set(e,y.join("/")),y.length=0}return i.get(t).get(e)}function l(t,r,i){if(r=r||{},"string"==typeof t&&(t={location:t}),t.main&&(t.location=r.mainPackageLocation),t.name&&r.registry&&r.registry.has(t.name)&&(t.location=r.registry.get(t.name)),!t.location&&r.packagesDirectory&&t.name)t.location=n.resolve(r.packagesDirectory,t.name+"/");else if(!t.location)return t;if(w.test(t.location)||(t.location+="/"),!e.isAbsolute(t.location)){if(!r.location)throw new Error("Dependency locations must be fully qualified: "+JSON.stringify(t));t.location=n.resolve(r.location,t.location)}return t.name&&r.registry.set(t.name,t.location),t}function u(e,t){if(e)for(var n,r=0,i=Object.keys(e);n=i[r];r++)t[n]||(t[n]={name:n,version:e[n]})}function c(e){return e._args||e._requested?"flat":"nested"}function h(t,i,o){w.test(t)||(t+="/");var a=Object.create(o);a.name=i.name,a.location=t||e.getLocation(),a.packageDescription=i,a.useScriptInjection=i.useScriptInjection,a.strategy=o.strategy||c(i),void 0!==i.production&&(a.production=i.production);var h=a.modules=a.modules||{},p=a.registry;void 0===a.name||p.has(a.name)||p.set(a.name,a.location);var d,f=i.overlay||{};if("string"==typeof i.browser)f.browser={redirects:{"":i.browser}};else if("object"==typeof i.browser){var v,m,g=i.browser,_=Object.keys(g);for(f.browser={redirects:{}},d=f.browser.redirects,m=0;v=_[m];m++)g[v]!==!1&&(d[v]=g[v])}var b,y,E,C;y=a.overlays=a.overlays||e.overlays;for(var O=0,j=y.length;O<j;O++)if(b=f[E=y[O]])for(C in b)b.hasOwnProperty(C)&&(i[C]=b[C]);if(delete i.overlay,"flat"===a.strategy?a.packagesDirectory=n.resolve(a.mainPackageLocation,"node_modules/"):a.packagesDirectory=n.resolve(t,"node_modules/"),i.main=i.main||"index",h[""]={id:"",redirect:r(s(i.main,"")),location:a.location},d=i.redirects,void 0!==d)for(C in d)d.hasOwnProperty(C)&&(h[C]={id:C,redirect:r(s(d[C],C)),location:n.resolve(t,C)});var P=i.mappings||{};u(i.dependencies,P),a.production||u(i.devDependencies,P);for(var T=0,k=Object.keys(P);C=k[T];T++)P[C]=l(P[C],a,C);return a.mappings=P,a}var p,d=eval,f=d("this");f.Map?p=f.Map:(p=function(){this._content=Object.create(null)},p.prototype.constructor=p,p.prototype.set=function(e,t){return this._content[e]=t,this},p.prototype.get=function(e){return this.hasOwnProperty.call(this._content,e)?this._content[e]:null},p.prototype.has=function(e){return e in this._content});var v=function(){};v.prototype.id=null,v.prototype.display=null,v.prototype.require=null,v.prototype.factory=void 0,v.prototype.exports=void 0,v.prototype.redirect=void 0,v.prototype.location=null,v.prototype.directory=null,v.prototype.injected=!1,v.prototype.mappingRedirect=void 0,v.prototype.type=null,v.prototype.text=void 0,v.prototype.dependees=null,v.prototype.extraDependencies=void 0,v.prototype.uuid=null;var m=/^(.*)\.js$/,g=new p,_=new p,b=new p,y=[],w=/\/$/,E=/^[a-z]+$/;e.makeRequire=function(o){function a(e){var t=E.test(e)?e:e.toLowerCase();if(!(t in _)){var n=new v;_[t]=n,n.id=e,n.display=o.name||o.location,n.display+="#",n.display+=e,n.require=g}return _[t]}function u(e,t){var r,i,s=a(e),l=c(e);l?(r=o.mappings[l],e.length>l.length?(i=e.slice(l.length+1),s.location=n.resolve(r.location,i),"undefined"==typeof r.mappingRequire?o.loadPackage(r,o).then(function(e){r.mappingRequire=e,e.inject(i,t)}):r.mappingRequire.inject(i,t)):s.location=r.location):s.location=n.resolve(o.location,e),s.exports=t,s.directory=n.resolve(s.location,"./"),s.injected=!0,s.redirect=void 0,s.mappingRedirect=void 0,s.error=void 0}function c(e){var t,n,r=o.mappings,i=Object.keys(r),a=i.length;for(t=0;t<a;t++)if(n=i[t],e===n||0===e.indexOf(n)&&"/"===e.charAt(n.length))return n}function h(e,n,i){return i=i||Object.create(null),e in i?null:(i[e]=!0,b(e,n).then(function(){var n,o,l,u=a(e),c=u.dependencies;if(c&&c.length>0)for(var p=0;o=c[p];p++)(l=h(r(s(o,e)),e,i))&&(n?n.push?n.push(l):n=[n,l]:n=l);return n?void 0===n.push?n:t.all(n):null},function(t){a(e).error=t}))}function d(e,t){var r=a(e);if(r.id!==e)throw new Error("Can't require module "+JSON.stringify(r.id)+" by alternate spelling "+JSON.stringify(e));if(r.error){var i=new Error("Can't require module "+JSON.stringify(r.id)+" via "+JSON.stringify(t)+" because "+r.error.message);throw i.cause=r.error,i}if(void 0!==r.redirect)return d(r.redirect,t);if(void 0!==r.mappingRedirect)return r.mappingRequire(r.mappingRedirect,t);if(void 0!==r.exports)return r.exports;if(void 0===r.factory)throw new Error("Can't require module "+JSON.stringify(e)+" via "+JSON.stringify(t));r.directory=n.resolve(r.location,"./"),r.exports={};var o;try{o=r.factory(m(e),r.exports,r)}catch(s){throw r.exports=void 0,s}return void 0!==o&&(r.exports=o),r.exports}function f(e,t,n){var r=o.location;if(t.location===r)return e;var i=!!n;if(n=n||new p,n.has(r))return null;n.set(r,!0);for(var a in o.mappings){var s=o.mappings[a];if(r=s.location,o.hasPackage(r)){var l=o.getPackage(r),u=l.identify(e,t,n);if(null!==u)return""===u?a:(a+="/",a+=u)}}if(i)return null;throw new Error("Can't identify "+e+" from "+t.location)}function m(t){var n=function(e){var n=r(s(e,t));return d(n,t)};n.viaId=t,n.async=function(e){var i=r(s(e,t));return h(i,t).then(function(){return n(i)})},n.resolve=function(e){return r(s(e,t))},n.getModule=a,n.getModuleDescriptor=a,n.load=b,n.deepLoad=h,n.loadPackage=function(t,n){return n?e.loadPackage(t,n):o.loadPackage(t,o)},n.hasPackage=function(e){return o.hasPackage(e)},n.getPackage=function(e){return o.getPackage(e)},n.isMainPackage=function(){return n.location===o.mainPackageLocation},n.injectPackageDescription=function(t,n){e.injectPackageDescription(t,n,o)},n.injectPackageDescriptionLocation=function(t,n){e.injectPackageDescriptionLocation(t,n,o)},n.injectMapping=function(e,t){e=l(e,o,t),t=t||e.name,o.mappings[t]=e},n.injectDependency=function(e){n.injectMapping({name:e},e)},n.identify=f,n.inject=u;for(var i=o.exposedConfigs,c=0,p=i.length;c<p;c++)n[i[c]]=o[i[c]];return n.config=o,n.read=o.read,n}var g;o=o||{},o.cache=o.cache||new p,o.rootLocation=n.resolve(o.rootLocation||e.getLocation(),"./"),o.location=n.resolve(o.location||o.rootLocation,"./"),o.paths=o.paths||[o.location],o.mappings=o.mappings||{},o.exposedConfigs=o.exposedConfigs||e.exposedConfigs,o.moduleTypes=o.moduleTypes||["html","meta","mjson"],o.makeLoader=o.makeLoader||e.makeLoader,o.load=o.load||o.makeLoader(o),o.makeCompiler=o.makeCompiler||e.makeCompiler,o.compile=o.compile||o.makeCompiler(o),o.parseDependencies=o.parseDependencies||e.parseDependencies,o.read=o.read||e.read,o.strategy=o.strategy||"nested";var _=o.modules=o.modules||Object.create(null),b=i(function(e,n){var r=a(e);return t["try"](function(){if(void 0===r.factory&&void 0===r.exports&&void 0===r.redirect)return o.load(e,r)}).then(function(){return o.compile(r).then(function(){void 0!==r.redirect&&(r.dependencies=r.dependencies||[],r.dependencies.push(r.redirect)),void 0!==r.extraDependencies&&(r.dependencies=r.dependencies||[],Array.prototype.push.apply(r.dependencies,r.extraDependencies))})})},o.cache);return g=m("")},e.injectPackageDescription=function(e,n,r){var i=r.descriptions=r.descriptions||{};i[e]=t.resolve(n)},e.injectLoadedPackageDescription=function(t,n,r,i){var o,a=h(t,n,r);return"function"==typeof i?o=i:(e.delegate&&e.delegate.willCreatePackage&&(o=e.delegate.willCreatePackage(t,n,a)),o||(o=e.makeRequire(a),e.delegate&&e.delegate.didCreatePackage&&e.delegate.didCreatePackage(a))),r.packages[t]=o,o},e.injectPackageDescriptionLocation=function(e,t,n){var r=n.descriptionLocations=n.descriptionLocations||{};r[e]=t},e.loadPackageDescription=function(t,r){var i=t.location,o=r.descriptions=r.descriptions||{};if(void 0===o[i]){var a,s=r.descriptionLocations=r.descriptionLocations||{};a=s[i]?s[i]:n.resolve(i,"package.json");var l;e.delegate&&"function"==typeof e.delegate.requireWillLoadPackageDescriptionAtLocation&&(l=e.delegate.requireWillLoadPackageDescriptionAtLocation(a,t,r)),l||(l=(r.read||e.read)(a)),o[i]=l.then(function(e){try{return JSON.parse(e)}catch(t){throw t.message=t.message+" in "+JSON.stringify(a),t}})}return o[i]},e.loadPackage=function(t,n,r){if(t=l(t,n),!t.location)throw new Error("Can't find dependency: "+JSON.stringify(t));var i=t.location;n=Object.create(n||null);var o=n.loadingPackages=n.loadingPackages||{},a=n.packages={},s=n.registry=n.registry||new p;n.mainPackageLocation=n.mainPackageLocation||i,n.hasPackage=function(e){if(e=l(e,n),!e.location)return!1;var t=e.location;return!!a[t]},n.getPackage=function(e){if(e=l(e,n),!e.location)throw new Error("Can't find dependency: "+JSON.stringify(e)+" from "+n.location);var t=e.location;if(!a[t])throw o[t]?new Error("Dependency has not finished loading: "+JSON.stringify(e)):new Error("Dependency was not loaded: "+JSON.stringify(e));return a[t]},n.loadPackage=function(t,r){if(t=l(t,r),!t.location)throw new Error("Can't find dependency: "+JSON.stringify(t)+" from "+n.location);var i=t.location;return o[i]||(o[i]=e.loadPackageDescription(t,n).then(function(t){return e.injectLoadedPackageDescription(i,t,n)})),o[i]};var u;return u="object"==typeof r?e.injectLoadedPackageDescription(i,r,n):n.loadPackage(t),"function"==typeof u.then?u=u.then(function(e){return e.registry=s,e}):u.registry=s,u.location=i,u.async=function(e,t){return u.then(function(n){return n.async(e,t)})},u},e.resolve=s;var C=/\.([^\/\.]+)$/;e.extension=function(e){var t=C.exec(e);if(t)return t[1]};var O=/^[\w\-]+:/;e.isAbsolute=function(e){return O.test(e)};var j=/(?:^|[^\w\$_.])require\s*\(\s*["']([^"']*)["']\s*\)/g,P=/^\/\/.*/gm,T=/^\/\*[\S\s]*?\*\//gm;e.parseDependencies=function(e){e=e.replace(P,"").replace(T,"");for(var t,n=[];null!==(t=j.exec(e));)n.push(t[1]);return n},e.DependenciesCompiler=function(t,n){return function(r){return r.dependencies||void 0===r.text||(r.dependencies=t.parseDependencies(r.text)),n(r),r&&!r.dependencies&&(r.text||r.factory?r.dependencies=e.parseDependencies(r.text||r.factory):r.dependencies=[]),r}};var k=/^#!/,x="//#!";e.ShebangCompiler=function(e,t){return function(e){e.text&&(e.text=e.text.replace(k,x)),t(e)}},e.LintCompiler=function(e,n){return function(r){try{n(r)}catch(i){throw i.message=i.message+" in "+r.location,console.log(i),e.lint&&t.resolve().then(function(){e.lint(r)}),i}}},e.exposedConfigs=["paths","mappings","location","packageDescription","packages","modules"];var A;A="undefined"!=typeof window?function(t){return e.SerializationCompiler(t,e.TemplateCompiler(t,e.JsonCompiler(t,e.DependenciesCompiler(t,e.LintCompiler(t,e.Compiler(t))))))}:function(t){return e.SerializationCompiler(t,e.TemplateCompiler(t,e.JsonCompiler(t,e.ShebangCompiler(t,e.DependenciesCompiler(t,e.LintCompiler(t,e.Compiler(t)))))))},e.makeCompiler=function(n){return function(r){return new t(function(t,i){return e.MetaCompiler(r).then(function(){t("object"==typeof r.exports?r:A(n)(r))})})}},e.JsonCompiler=function(e,t){var n=/\.json$/;return function(e){var r=(e.location||"").match(n);if(r)return"object"!=typeof e.exports&&"string"==typeof e.text&&(e.exports=JSON.parse(e.text)),e;var i=t(e);return i}},e.MetaCompiler=function(n){if(n.location&&(o(n.location,".meta")||o(n.location,".mjson"))&&"object"!=typeof n.exports&&"string"==typeof n.text){if(e.delegate&&"function"==typeof e.delegate.requireWillCompileMJSONFile)return e.delegate.requireWillCompileMJSONFile(n.text,n.require,n.id).then(function(e){return n.exports=e||JSON.parse(n.text),n});n.exports=JSON.parse(n.text)}return t.resolve(n)};var D=/(.*\/)?(?=[^\/]+)/,S=".html",L=".html.load.js";e.TemplateCompiler=function(e,t){return function(e){var n=e.location;if(n){if(o(n,S)||o(n,L)){var r=n.match(D);if(r)return e.dependencies=e.dependencies||[],e.exports={directory:r[1],content:e.text},e}t(e)}}};var M=function(e,t,n){return this.require=e,this.module=t,this.property=n,this};M.prototype={get moduleId(){return this.module},get objectName(){return this.property},get aliases(){return this._aliases||(this._aliases=[this.property])},_aliases:null,isInstance:!1};var R="_montage_metadata",F=/((.*)\.reel)\/\2$/,z=function(e,t){return t};e.SerializationCompiler=function(e,t){return function(n){if(t(n),n.factory){var r=n.factory;return n.factory=function(t,n,i){var o;try{o=r.call(this,t,n,i,f)}catch(a){if(!(a instanceof SyntaxError))throw a;e.lint(i)}if(o)return o;var s,l,u,c=Object.keys(n);for(s=0,u;u=c[s];s++)(l=n[u])instanceof Object&&(l.hasOwnProperty(R)&&!l[R].isInstance?l[R].aliases.push(u):Object.isSealed(l)||(l[R]=new M(t,i.id.replace(F,z),u)))},n}}},e.MappingsLoader=function(t,n){return t.mappings=t.mappings||{},t.name=t.name,function(r,i){function o(e){var n=r.slice(c.length+1);return t.mappings[c].mappingRequire=e,i.mappingRedirect=n,i.mappingRequire=e,e.deepLoad(n,t.location)}if(e.isAbsolute(r))return n(r,i);var a=t.mappings,s=Object.keys(a),l=s.length;void 0!==t.name&&0===r.indexOf(t.name)&&"/"===r.charAt(t.name.length)&&console.warn("Package reflexive module ignored:",r);var u,c;for(u=0;u<l;u++)if(c=s[u],r===c||0===r.indexOf(c)&&"/"===r.charAt(c.length))return t.loadPackage(a[c],t).then(o);return n(r,i)}},e.LocationLoader=function(t,r){function i(t,o){var a,s,l=t,u=i.config,c=e.extension(t);return(!c||"js"!==c&&"json"!==c&&u.moduleTypes.indexOf(c)===-1)&&(l+=".js"),a=o.location=n.resolve(u.location,l),u.delegate&&u.delegate.packageWillLoadModuleAtLocation&&(s=u.delegate.packageWillLoadModuleAtLocation(o,a)),s?s:r(a,o)}return i.config=t,i},e.MemoizedLoader=function(e,t){return i(t,e.cache)};var I=/([^\/]+)\.reel$/,N=".reel",B="/";e.ReelLoader=function(e,t){return function(e,n){return o(e,N)?(n.redirect=e,n.redirect+=B,n.redirect+=I.exec(e)[1],n):t(e,n)}}}),bootstrap("require/browser",function(e){function t(e){var n=e.target,r=n.module;200===n.status||0===n.status&&n.responseText?(r&&(r.type=c,r.text=n.responseText,r.location=n.url),n.resolve(n.responseText),t.xhrPool.push(n)):n.onerror(e),n.abort(),n.url=null,n.module=null}function n(e){var t=e.target,r=t.url;t.reject(new Error("Can't XHR "+JSON.stringify(r))),n.xhrPool.push(t),t.abort(),t.url=null,t.module=null}function r(e,t){var n=r.xhrPool.pop();n||(n=new r.XMLHttpRequest,n.overrideMimeType&&n.overrideMimeType(u),n.onload=r.onload,n.onerror=r.onerror,n.promiseHandler=function(e,t){n.resolve=e,n.reject=t}),n.url=e,n.module=t,n.open(l,e,!0);var i=new a(n.promiseHandler);return n.send(null),i}var i,o=e("require"),a=e("promise"),s=e("mini-url"),l="GET",u="application/javascript",c="javascript",h=eval;h("this"),o.getLocation=function(){if(!i){var e=document.querySelector("head > base");i=e?e.href:window.location,i=s.resolve(i,".")}return i},o.overlays=["window","browser","montage"];var p=[];t.xhrPool=p,n.xhrPool=p,o.read=r,r.xhrPool=p,r.XMLHttpRequest=XMLHttpRequest,r.onload=t,r.onerror=n;var d="__",f="_",v="(function ",m="(require, exports, module, global) {",g="//*/\n})\n//# sourceURL=",_=[v,void 0,m,void 0,g,void 0],b=/[^\w\d]/g;o.Compiler=function(e){return function(t){if(t.factory||void 0===t.text)return t;if(e.useScriptInjection)throw new Error("Can't use eval.");var n=[d,t.require.config.name,f,t.id].join("").replace(b,f);_[1]=n,_[3]=t.text,_[5]=t.location,t.factory=h(_.join("")),t.factory.displayName=n,t.text=null,_[1]=_[3]=_[5]=null}},o.XhrLoader=function(e){return function(t,n){return e.read(t,n).then(function(e){n.type=c,n.text=e,n.location=t})}};var y={},w=function(e,t){var n=y[e]=y[e]||{};if(!n[t]){var r;n[t]=new a(function(e,t){r=e}),n[t].resolve=r}return n[t]},E=function(e,t,n){n&&n.isPending()?n.then(function(){t.isPending()&&o.loadScript(e)}):t.isPending()&&o.loadScript(e)};montageDefine=function(e,t,n){w(e,t).resolve(n)},o.loadScript=function(e){var t=document.createElement("script");t.onload=function(){t.parentNode.removeChild(t)},t.onerror=function(e){t.parentNode.removeChild(t)},t.src=e,t.defer=!0,document.getElementsByTagName("head")[0].appendChild(t)},o.ScriptLoader=function(e){var t=e.packageDescription.hash;return function(n,r){return a["try"](function(){if(y[t]&&y[t][r.id])return y[t][r.id];/\.js$/.test(n)?n=n.replace(/\.js$/,".load.js"):n+=".load.js";var i=w(t,r.id);return E(n,i,e.preloaded),i}).then(function(e){delete y[t][r.id];for(var i in e)r[i]=e[i];r.location=n,r.directory=s.resolve(n,".")})}};var C=o.loadPackageDescription;o.loadPackageDescription=function(e,t){if(e.hash){var n=w(e.hash,"package.json"),r=s.resolve(e.location,"package.json.load.js");return E(r,n,t.preloaded),n.get("exports")}return C(e,t)},o.makeLoader=function(e){var t;return t=e.useScriptInjection?o.ScriptLoader:o.XhrLoader,o.ReelLoader(e,o.MappingsLoader(e,o.LocationLoader(e,o.MemoizedLoader(e,t(e)))))}}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Promise=e()}}(function(){return function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof _dereq_&&_dereq_;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return i(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof _dereq_&&_dereq_,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";t.exports=function(e){function t(e){var t=new n(e),r=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),r}var n=e._SomePromiseArray;e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}},{}],2:[function(e,t,n){"use strict";function r(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new c(16),this._normalQueue=new c(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=u}function i(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function o(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function a(e){this._normalQueue._pushOne(e),this._queueTick()}var s;try{throw new Error}catch(l){s=l}var u=e("./schedule"),c=e("./queue"),h=e("./util");r.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},r.prototype.hasCustomScheduler=function(){return this._customScheduler},r.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},r.prototype.disableTrampolineIfNecessary=function(){h.hasDevTools&&(this._trampolineEnabled=!1)},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},r.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},h.hasDevTools?(r.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?i.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},r.prototype.invoke=function(e,t,n){this._trampolineEnabled?o.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},r.prototype.settlePromises=function(e){this._trampolineEnabled?a.call(this,e):this._schedule(function(){e._settlePromises()})}):(r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=a),r.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),r=e.shift();t.call(n,r)}else t._settlePromises()}},r.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},t.exports=r,t.exports.firstLineError=s},{"./queue":26,"./schedule":29,"./util":36}],3:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var i=!1,o=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(o,o,null,this,e)},s=function(e,t){0===(50397184&this._bitField)&&this._resolveCallback(t.target)},l=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(o){i||(i=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var u=n(o),c=new e(t);c._propagateFrom(this,1);var h=this._target();if(c._setBoundTo(u),u instanceof e){var p={promiseRejectionQueued:!1,promise:c,target:h,bindingPromise:u};h._then(t,a,void 0,c,p),u._then(s,l,void 0,c,p),c._setOnCancel(u)}else c._resolveCallback(h);return c},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}},{}],4:[function(e,t,n){"use strict";function r(){try{Promise===o&&(Promise=i)}catch(e){}return o}var i;"undefined"!=typeof Promise&&(i=Promise);var o=e("./promise")();o.noConflict=r,t.exports=o},{"./promise":22}],5:[function(e,t,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}t.exports=function(t){function n(e,n){var r;if(null!=e&&(r=e[n]),"function"!=typeof r){var i="Object "+s.classString(e)+" has no method '"+s.toString(n)+"'";throw new t.TypeError(i)}return r}function r(e){var t=this.pop(),r=n(e,t);return r.apply(e,this)}function i(e){return e[this]}function o(e){var t=+this;return 0>t&&(t=Math.max(0,t+e.length)),e[t]}var a,s=e("./util"),l=s.canEvaluate;s.isIdentifier,t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(r,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t,n="number"==typeof e;if(n)t=o;else if(l){var r=a(e);t=null!==r?r:i}else t=i;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){var o=e("./util"),a=o.tryCatch,s=o.errorObj,l=t._async;t.prototype["break"]=t.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){
return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(o.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var r=a(e).call(this._boundValue());r===s&&(this._attachExtraTrace(r.e),l.throwLater(r.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,n){"use strict";t.exports=function(t){function n(e,n,s){return function(l){var u=s._boundValue();e:for(var c=0;c<e.length;++c){var h=e[c];if(h===Error||null!=h&&h.prototype instanceof Error){if(l instanceof h)return o(n).call(u,l)}else if("function"==typeof h){var p=o(h).call(u,l);if(p===a)return p;if(p)return o(n).call(u,l)}else if(r.isObject(l)){for(var d=i(h),f=0;f<d.length;++f){var v=d[f];if(h[v]!=l[v])continue e}return o(n).call(u,l)}}return t}}var r=e("./util"),i=e("./es5").keys,o=r.tryCatch,a=r.errorObj;return n}},{"./es5":13,"./util":36}],8:[function(e,t,n){"use strict";t.exports=function(e){function t(){this._trace=new t.CapturedTrace(r())}function n(){return i?new t:void 0}function r(){var e=o.length-1;return e>=0?o[e]:void 0}var i=!1,o=[];return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var e=o.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=n,t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var n=e.prototype._pushContext,o=e.prototype._popContext,a=e._peekContext,s=e.prototype._peekContext,l=e.prototype._promiseCreated;t.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=o,e._peekContext=a,e.prototype._peekContext=s,e.prototype._promiseCreated=l,i=!1},i=!0,e.prototype._pushContext=t.prototype._pushContext,e.prototype._popContext=t.prototype._popContext,e._peekContext=e.prototype._peekContext=r,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},t}},{}],9:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e,t){return{promise:t}}function i(){return!1}function o(e,t,n){var r=this;try{e(t,n,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+I.toString(e));r._attachCancellationCallback(e)})}catch(i){return i}}function a(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?I.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function s(){return this._onCancelField}function l(e){this._onCancelField=e}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function c(e,t){if(0!==(1&t)){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function h(e,t){0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function p(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e}function d(){this._trace=new D(this._peekContext())}function f(e,t){if(N(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=C(e);I.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),I.notEnumerableProp(e,"__stackCleaned__",!0)}}}function v(e,t,n,r,i){if(void 0===e&&null!==t&&$){if(void 0!==i&&i._returnedNonUndefined())return;if(0===(65535&r._bitField))return;n&&(n+=" ");var o="",a="";if(t._trace){for(var s=t._trace.stack.split("\n"),l=w(s),u=l.length-1;u>=0;--u){var c=l[u];if(!U.test(c)){var h=c.match(q);h&&(o="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(l.length>0)for(var p=l[0],u=0;u<s.length;++u)if(s[u]===p){u>0&&(a="\n"+s[u-1]);break}}var d="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+a;r._warn(d,!0,t)}}function m(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),g(n)}function g(e,n,r){if(oe.warnings){var i,o=new z(e);if(n)r._attachExtraTrace(o);else if(oe.longStackTraces&&(i=t._peekContext()))i.attachExtraTrace(o);else{var a=C(o);o.stack=a.message+"\n"+a.stack.join("\n")}ee("warning",o)||O(o,"",!0)}}function _(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function b(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function y(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],i=t.length-1,o=t[i],a=-1,s=r.length-1;s>=0;--s)if(r[s]===o){a=s;break}for(var s=a;s>=0;--s){var l=r[s];if(t[i]!==l)break;t.pop(),i--}t=r}}function w(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],i="    (No stack trace)"===r||V.test(r),o=i&&ne(r);i&&!o&&(H&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function E(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||V.test(r))break}return n>0&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}function C(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?E(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:w(t)}}function O(e,t,n){if("undefined"!=typeof console){var r;if(I.isObject(e)){var i=e.stack;r=t+W(i,e)}else r=t+String(e);"function"==typeof M?M(r,n):("function"==typeof console.log||"object"==typeof console.log)&&console.log(r)}}function j(e,t,n,r){var i=!1;try{"function"==typeof t&&(i=!0,"rejectionHandled"===e?t(r):t(n,r))}catch(o){F.throwLater(o)}"unhandledRejection"===e?ee(e,n,r)||i||O(n,"Unhandled rejection "):ee(e,r)}function P(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():I.toString(e);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(t))try{var r=JSON.stringify(e);t=r}catch(i){}0===t.length&&(t="(empty array)")}return"(<"+T(t)+">, no stack trace)"}function T(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function k(){return"function"==typeof ie}function x(e){var t=e.match(re);return t?{fileName:t[1],line:parseInt(t[2],10)}:void 0}function A(e,t){if(k()){for(var n,r,i=e.stack.split("\n"),o=t.stack.split("\n"),a=-1,s=-1,l=0;l<i.length;++l){var u=x(i[l]);if(u){n=u.fileName,a=u.line;break}}for(var l=0;l<o.length;++l){var u=x(o[l]);if(u){r=u.fileName,s=u.line;break}}0>a||0>s||!n||!r||n!==r||a>=s||(ne=function(e){if(B.test(e))return!0;var t=x(e);return!!(t&&t.fileName===n&&a<=t.line&&t.line<=s)})}}function D(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);ie(this,D),t>32&&this.uncycle()}var S,L,M,R=t._getDomain,F=t._async,z=e("./errors").Warning,I=e("./util"),N=I.canAttachTrace,B=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,U=/\((?:timers\.js):\d+:\d+\)/,q=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,V=null,W=null,H=!1,X=!(0==I.env("BLUEBIRD_DEBUG")||!I.env("BLUEBIRD_DEBUG")&&"development"!==I.env("NODE_ENV")),G=!(0==I.env("BLUEBIRD_WARNINGS")||!X&&!I.env("BLUEBIRD_WARNINGS")),Y=!(0==I.env("BLUEBIRD_LONG_STACK_TRACES")||!X&&!I.env("BLUEBIRD_LONG_STACK_TRACES")),$=0!=I.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(G||!!I.env("BLUEBIRD_W_FORGOTTEN_RETURN"));t.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},t.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),F.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){j("rejectionHandled",S,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},t.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),j("unhandledRejection",L,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},t.prototype._warn=function(e,t,n){return g(e,t,n||this)},t.onPossiblyUnhandledRejection=function(e){var t=R();L="function"==typeof e?null===t?e:I.domainBind(t,e):void 0},t.onUnhandledRejectionHandled=function(e){var t=R();S="function"==typeof e?null===t?e:I.domainBind(t,e):void 0};var K=function(){};t.longStackTraces=function(){if(F.haveItemsQueued()&&!oe.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!oe.longStackTraces&&k()){var e=t.prototype._captureStackTrace,r=t.prototype._attachExtraTrace;oe.longStackTraces=!0,K=function(){if(F.haveItemsQueued()&&!oe.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=r,n.deactivateLongStackTraces(),F.enableTrampoline(),oe.longStackTraces=!1},t.prototype._captureStackTrace=d,t.prototype._attachExtraTrace=f,n.activateLongStackTraces(),F.disableTrampolineIfNecessary()}},t.hasLongStackTraces=function(){return oe.longStackTraces&&k()};var J=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return I.global.dispatchEvent(e),function(e,t){var n=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!I.global.dispatchEvent(n)}}if("function"==typeof Event){var e=new Event("CustomEvent");return I.global.dispatchEvent(e),function(e,t){var n=new Event(e.toLowerCase(),{cancelable:!0});return n.detail=t,!I.global.dispatchEvent(n)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),I.global.dispatchEvent(e),function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e.toLowerCase(),!1,!0,t),!I.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),Q=function(){return I.isNode?function(){return process.emit.apply(process,arguments)}:I.global?function(e){var t="on"+e.toLowerCase(),n=I.global[t];return!!n&&(n.apply(I.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),Z={promiseCreated:r,promiseFulfilled:r,promiseRejected:r,promiseResolved:r,promiseCancelled:r,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:r},ee=function(e){var t=!1;try{t=Q.apply(null,arguments)}catch(n){F.throwLater(n),t=!0}var r=!1;try{r=J(e,Z[e].apply(null,arguments))}catch(n){F.throwLater(n),r=!0}return r||t};t.config=function(e){if(e=Object(e),"longStackTraces"in e&&(e.longStackTraces?t.longStackTraces():!e.longStackTraces&&t.hasLongStackTraces()&&K()),"warnings"in e){var n=e.warnings;oe.warnings=!!n,$=oe.warnings,I.isObject(n)&&"wForgottenReturn"in n&&($=!!n.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!oe.cancellation){if(F.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=u,t.prototype._propagateFrom=c,t.prototype._onCancel=s,t.prototype._setOnCancel=l,t.prototype._attachCancellationCallback=a,t.prototype._execute=o,te=c,oe.cancellation=!0}return"monitoring"in e&&(e.monitoring&&!oe.monitoring?(oe.monitoring=!0,t.prototype._fireEvent=ee):!e.monitoring&&oe.monitoring&&(oe.monitoring=!1,t.prototype._fireEvent=i)),t},t.prototype._fireEvent=i,t.prototype._execute=function(e,t,n){try{e(t,n)}catch(r){return r}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(e){},t.prototype._attachCancellationCallback=function(e){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(e,t){};var te=h,ne=function(){return!1},re=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;I.inherits(D,Error),n.CapturedTrace=D,D.prototype.uncycle=function(){var e=this._length;if(!(2>e)){for(var t=[],n={},r=0,i=this;void 0!==i;++r)t.push(i),i=i._parent;e=this._length=r;for(var r=e-1;r>=0;--r){var o=t[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;e>r;++r){var a=t[r].stack,s=n[a];if(void 0!==s&&s!==r){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var l=r>0?t[r-1]:this;e-1>s?(l._parent=t[s+1],l._parent.uncycle(),l._length=l._parent._length+1):(l._parent=void 0,l._length=1);for(var u=l._length+1,c=r-2;c>=0;--c)t[c]._length=u,u++;return}}}},D.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=C(e),n=t.message,r=[t.stack],i=this;void 0!==i;)r.push(w(i.stack.split("\n"))),i=i._parent;y(r),b(r),I.notEnumerableProp(e,"stack",_(n,r)),I.notEnumerableProp(e,"__stackCleaned__",!0)}};var ie=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():P(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,V=e,W=t;var n=Error.captureStackTrace;return ne=function(e){return B.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return V=/@/,W=t,H=!0,function(e){e.stack=(new Error).stack};var i;try{throw new Error}catch(o){i="stack"in o}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(W=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?P(t):t.toString()},null):(V=e,W=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(M=function(e){console.warn(e)},I.isNode&&process.stderr.isTTY?M=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:I.isNode||"string"!=typeof(new Error).stack||(M=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var oe={warnings:G,longStackTraces:!1,cancellation:!1,monitoring:!1};return Y&&t.longStackTraces(),{longStackTraces:function(){return oe.longStackTraces},warnings:function(){return oe.warnings},cancellation:function(){return oe.cancellation},monitoring:function(){return oe.monitoring},propagateFromFunction:function(){return te},boundValueFunction:function(){return p},checkForgottenReturns:v,setBounds:A,warn:g,deprecated:m,CapturedTrace:D,fireDomEvent:J,fireGlobalEvent:Q}}},{"./errors":12,"./util":36}],10:[function(e,t,n){"use strict";t.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype["return"]=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype["throw"]=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1],r=function(){throw t};return this.caught(e,r)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var r=arguments[1];r instanceof e&&r.suppressUnhandledRejections();var i=function(){return r};return this.caught(n,i)}}},{}],11:[function(e,t,n){"use strict";t.exports=function(e,t){function n(){return o(this)}function r(e,n){return i(e,n,t,t)}var i=e.reduce,o=e.all;e.prototype.each=function(e){return i(this,e,t,0)._then(n,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return i(this,e,t,t)},e.each=function(e,r){return i(e,r,t,0)._then(n,void 0,void 0,e,void 0)},e.mapSeries=r}},{}],12:[function(e,t,n){"use strict";function r(e,t){function n(r){return this instanceof n?(h(this,"message","string"==typeof r?r:t),h(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return c(n,Error),n}function i(e){return this instanceof i?(h(this,"name","OperationalError"),h(this,"message",e),this.cause=e,this.isOperational=!0,void(e instanceof Error?(h(this,"message",e.message),h(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(e)}var o,a,s=e("./es5"),l=s.freeze,u=e("./util"),c=u.inherits,h=u.notEnumerableProp,p=r("Warning","warning"),d=r("CancellationError","cancellation error"),f=r("TimeoutError","timeout error"),v=r("AggregateError","aggregate error");try{o=TypeError,a=RangeError}catch(m){o=r("TypeError","type error"),a=r("RangeError","range error")}for(var g="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),_=0;_<g.length;++_)"function"==typeof Array.prototype[g[_]]&&(v.prototype[g[_]]=Array.prototype[g[_]]);s.defineProperty(v.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),v.prototype.isOperational=!0;var b=0;v.prototype.toString=function(){var e=Array(4*b+1).join(" "),t="\n"+e+"AggregateError of:\n";b++,e=Array(4*b+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=e+i[o];r=i.join("\n"),t+=r+"\n"}return b--,t},c(i,Error);var y=Error.__BluebirdErrorTypes__;y||(y=l({CancellationError:d,TimeoutError:f,OperationalError:i,RejectionError:i,AggregateError:v}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:y,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:o,RangeError:a,CancellationError:y.CancellationError,OperationalError:y.OperationalError,TimeoutError:y.TimeoutError,AggregateError:y.AggregateError,Warning:p}},{"./es5":13,"./util":36}],13:[function(e,t,n){var r=function(){"use strict";return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},l=function(e,t){return{value:e[t]}},u=function(e,t,n){return e[t]=n.value,e},c=function(e){return e},h=function(e){try{return Object(e).constructor.prototype}catch(t){return a}},p=function(e){try{return"[object Array]"===o.call(e)}catch(t){return!1}};t.exports={isArray:p,keys:s,names:s,defineProperty:u,getDescriptor:l,freeze:c,getPrototypeOf:h,isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,r){return n(this,e,r,t)},e.filter=function(e,r,i){return n(e,r,i,t)}}},{}],15:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function i(e){this.finallyHandler=e}function o(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function a(){return l.call(this,this.promise._target()._settledValue())}function s(e){return o(this,e)?void 0:(h.e=e,h)}function l(e){var r=this.promise,l=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?l.call(r._boundValue()):l.call(r._boundValue(),e);if(void 0!==u){r._setReturnedNonUndefined();var p=n(u,r);if(p instanceof t){if(null!=this.cancelPromise){if(p._isCancelled()){var d=new c("late cancellation observer");return r._attachExtraTrace(d),h.e=d,h}p.isPending()&&p._attachCancellationCallback(new i(this))}return p._then(a,s,void 0,this,void 0)}}}return r.isRejected()?(o(this),h.e=e,h):(o(this),e)}var u=e("./util"),c=t.CancellationError,h=u.errorObj;return r.prototype.isFinallyHandler=function(){return 0===this.type},i.prototype._resultCancelled=function(){o(this.finallyHandler)},t.prototype._passThrough=function(e,t,n,i){return"function"!=typeof e?this.then():this._then(n,i,void 0,new r(this,t,e),void 0)},t.prototype.lastly=t.prototype["finally"]=function(e){return this._passThrough(e,0,l,l)},t.prototype.tap=function(e){return this._passThrough(e,1,l)},r}},{"./util":36}],16:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o,a){function s(e,n,r){for(var o=0;o<n.length;++o){r._pushContext();var a=d(n[o])(e);if(r._popContext(),a===p){r._pushContext();var s=t.reject(p.e);return r._popContext(),s}var l=i(a,r);if(l instanceof t)return l}return null}function l(e,n,i,o){if(a.cancellation()){var s=new t(r),l=this._finallyPromise=new t(r);this._promise=s.lastly(function(){return l}),s._captureStackTrace(),s._setOnCancel(this)}else{var u=this._promise=new t(r);u._captureStackTrace()}this._stack=o,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}var u=e("./errors"),c=u.TypeError,h=e("./util"),p=h.errorObj,d=h.tryCatch,f=[];h.inherits(l,o),l.prototype._isResolved=function(){return null===this._promise},l.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},l.prototype._promiseCancelled=function(){if(!this._isResolved()){var e,n="undefined"!=typeof this._generator["return"];if(n)this._promise._pushContext(),e=d(this._generator["return"]).call(this._generator,void 0),this._promise._popContext();else{var r=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),e=d(this._generator["throw"]).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},l.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=d(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},l.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=d(this._generator["throw"]).call(this._generator,e);this._promise._popContext(),this._continue(t)},l.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},l.prototype.promise=function(){return this._promise},l.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},l.prototype._continue=function(e){var n=this._promise;if(e===p)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(e.e,!1);var r=e.value;if(e.done===!0)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var o=i(r,this._promise);if(!(o instanceof t)&&(o=s(o,this._yieldHandlers,this._promise),null===o))return void this._promiseRejected(new c("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",r)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));o=o._target();var a=o._bitField;0===(50397184&a)?(this._yieldedPromise=o,o._proxy(this,null)):0!==(33554432&a)?t._async.invoke(this._promiseFulfilled,this,o._value()):0!==(16777216&a)?t._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()},t.coroutine=function(e,t){if("function"!=typeof e)throw new c("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,r=l,i=(new Error).stack;return function(){var t=e.apply(this,arguments),o=new r((void 0),(void 0),n,i),a=o.promise();return o._generator=t,o._promiseFulfilled(void 0),a}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new c("expecting a function but got "+h.classString(e));f.push(e)},t.spawn=function(e){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new l(e,this),i=r.promise();return r._run(t.spawn),i}}},{"./errors":12,"./util":36}],17:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o,a){var s=e("./util");s.canEvaluate,s.tryCatch,s.errorObj,t.join=function(){var e,t=arguments.length-1;if(t>0&&"function"==typeof arguments[t]){e=arguments[t];var r}var i=[].slice.call(arguments);e&&i.pop();var r=new n(i).promise();return void 0!==e?r.spread(e):r}}},{"./util":36}],18:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o,a){function s(e,t,n,r){this.constructor$(e),this._promise._captureStackTrace();var i=u();this._callback=null===i?t:c.domainBind(i,t),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}function l(e,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+c.classString(n));var a=0;if(void 0!==i){if("object"!=typeof i||null===i)return t.reject(new TypeError("options argument must be an object but it is "+c.classString(i)));if("number"!=typeof i.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(i.concurrency)));a=i.concurrency}return a="number"==typeof a&&isFinite(a)&&a>=1?a:0,new s(e,n,a,o).promise()}var u=t._getDomain,c=e("./util"),h=c.tryCatch,p=c.errorObj,d=t._async;c.inherits(s,n),s.prototype._asyncInit=function(){this._init$(void 0,-2)},s.prototype._init=function(){},s.prototype._promiseFulfilled=function(e,n){var r=this._values,o=this.length(),s=this._preservedValues,l=this._limit;if(0>n){if(n=-1*n-1,r[n]=e,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return r[n]=e,this._queue.push(n),!1;null!==s&&(s[n]=e);var u=this._promise,c=this._callback,d=u._boundValue();u._pushContext();var f=h(c).call(d,e,n,o),v=u._popContext();if(a.checkForgottenReturns(f,v,null!==s?"Promise.filter":"Promise.map",u),f===p)return this._reject(f.e),!0;var m=i(f,this._promise);if(m instanceof t){m=m._target();var g=m._bitField;if(0===(50397184&g))return l>=1&&this._inFlight++,r[n]=m,m._proxy(this,-1*(n+1)),!1;if(0===(33554432&g))return 0!==(16777216&g)?(this._reject(m._reason()),!0):(this._cancel(),!0);f=m._value()}r[n]=f}var _=++this._totalResolved;return _>=o&&(null!==s?this._filter(r,s):this._resolve(r),!0)},s.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(n[r],r)}},s.prototype._filter=function(e,t){for(var n=t.length,r=new Array(n),i=0,o=0;n>o;++o)e[o]&&(r[i++]=t[o]);r.length=i,this._resolve(r)},s.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return l(this,e,t,null)},t.map=function(e,t,n,r){return l(e,t,n,r)}}},{"./util":36}],19:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o){var a=e("./util"),s=a.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+a.classString(e));return function(){var r=new t(n);r._captureStackTrace(),r._pushContext();var i=s(e).apply(this,arguments),a=r._popContext();return o.checkForgottenReturns(i,a,"Promise.method",r),r._resolveFromSyncValue(i),r}},t.attempt=t["try"]=function(e){if("function"!=typeof e)return i("expecting a function but got "+a.classString(e));var r=new t(n);r._captureStackTrace(),r._pushContext();var l;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],c=arguments[2];l=a.isArray(u)?s(e).apply(c,u):s(e).call(c,u)}else l=s(e)();var h=r._popContext();return o.checkForgottenReturns(l,h,"Promise.try",r),r._resolveFromSyncValue(l),r},t.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,n){"use strict";function r(e){return e instanceof Error&&c.getPrototypeOf(e)===Error.prototype}function i(e){var t;if(r(e)){t=new u(e),t.name=e.name,t.message=e.message,t.stack=e.stack;for(var n=c.keys(e),i=0;i<n.length;++i){var o=n[i];h.test(o)||(t[o]=e[o])}return t}return a.markAsOriginatingFromRejection(e),e}function o(e,t){return function(n,r){if(null!==e){if(n){var o=i(s(n));e._attachExtraTrace(o),e._reject(o)}else if(t){var a=[].slice.call(arguments,1);e._fulfill(a)}else e._fulfill(r);e=null}}}var a=e("./util"),s=a.maybeWrapAsError,l=e("./errors"),u=l.OperationalError,c=e("./es5"),h=/^(?:name|message|stack|cause)$/;t.exports=o},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,n){"use strict";t.exports=function(t){function n(e,t){var n=this;if(!o.isArray(e))return r.call(n,e,t);var i=s(t).apply(n._boundValue(),[null].concat(e));i===l&&a.throwLater(i.e)}function r(e,t){var n=this,r=n._boundValue(),i=void 0===e?s(t).call(r,null):s(t).call(r,null,e);i===l&&a.throwLater(i.e)}function i(e,t){var n=this;if(!e){var r=new Error(e+"");r.cause=e,e=r}var i=s(t).call(n._boundValue(),e);i===l&&a.throwLater(i.e)}var o=e("./util"),a=t._async,s=o.tryCatch,l=o.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var o=r;void 0!==t&&Object(t).spread&&(o=n),this._then(o,i,void 0,this,e)}return this}}},{"./util":36}],22:[function(e,t,n){"use strict";t.exports=function(){function n(){}function r(e,t){if("function"!=typeof t)throw new _("expecting a function but got "+d.classString(t));if(e.constructor!==i)throw new _("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}function i(e){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,e!==y&&(r(this,e),this._resolveFromExecutor(e)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(e){this.promise._resolveCallback(e)}function a(e){this.promise._rejectCallback(e,!1)}function s(e){var t=new i(y);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}var l,u=function(){return new _("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},c=function(){return new i.PromiseInspection(this._target())},h=function(e){return i.reject(new _(e))},p={},d=e("./util");l=d.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},d.notEnumerableProp(i,"_getDomain",l);var f=e("./es5"),v=e("./async"),m=new v;f.defineProperty(i,"_async",{value:m});var g=e("./errors"),_=i.TypeError=g.TypeError;i.RangeError=g.RangeError;var b=i.CancellationError=g.CancellationError;i.TimeoutError=g.TimeoutError,
i.OperationalError=g.OperationalError,i.RejectionError=g.OperationalError,i.AggregateError=g.AggregateError;var y=function(){},w={},E={},C=e("./thenables")(i,y),O=e("./promise_array")(i,y,C,h,n),j=e("./context")(i),P=j.create,T=e("./debuggability")(i,j),k=(T.CapturedTrace,e("./finally")(i,C)),x=e("./catch_filter")(E),A=e("./nodeback"),D=d.errorObj,S=d.tryCatch;return i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype["catch"]=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),i=0;for(n=0;t-1>n;++n){var o=arguments[n];if(!d.isObject(o))return h("expecting an object but got A catch statement predicate "+d.classString(o));r[i++]=o}return r.length=i,e=arguments[n],this.then(void 0,x(r,e,this))}return this.then(void 0,e)},i.prototype.reflect=function(){return this._then(c,c,void 0,this,void 0)},i.prototype.then=function(e,t){if(T.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+d.classString(e);arguments.length>1&&(n+=", "+d.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},i.prototype.done=function(e,t){var n=this._then(e,t,void 0,void 0,void 0);n._setIsFinal()},i.prototype.spread=function(e){return"function"!=typeof e?h("expecting a function but got "+d.classString(e)):this.all()._then(e,void 0,void 0,w,void 0)},i.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},i.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new O(this).promise()},i.prototype.error=function(e){return this.caught(d.originatesFromRejection,e)},i.getNewLibraryCopy=t.exports,i.is=function(e){return e instanceof i},i.fromNode=i.fromCallback=function(e){var t=new i(y);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=S(e)(A(t,n));return r===D&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},i.all=function(e){return new O(e).promise()},i.cast=function(e){var t=C(e);return t instanceof i||(t=new i(y),t._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},i.resolve=i.fulfilled=i.cast,i.reject=i.rejected=function(e){var t=new i(y);return t._captureStackTrace(),t._rejectCallback(e,!0),t},i.setScheduler=function(e){if("function"!=typeof e)throw new _("expecting a function but got "+d.classString(e));return m.setScheduler(e)},i.prototype._then=function(e,t,n,r,o){var a=void 0!==o,s=a?o:new i(y),u=this._target(),c=u._bitField;a||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===r&&0!==(2097152&this._bitField)&&(r=0!==(50397184&c)?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var h=l();if(0!==(50397184&c)){var p,f,v=u._settlePromiseCtx;0!==(33554432&c)?(f=u._rejectionHandler0,p=e):0!==(16777216&c)?(f=u._fulfillmentHandler0,p=t,u._unsetRejectionIsUnhandled()):(v=u._settlePromiseLateCancellationObserver,f=new b("late cancellation observer"),u._attachExtraTrace(f),p=t),m.invoke(v,u,{handler:null===h?p:"function"==typeof p&&d.domainBind(h,p),promise:s,receiver:r,value:f})}else u._addCallbacks(e,t,s,r,h);return s},i.prototype._length=function(){return 65535&this._bitField},i.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},i.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},i.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},i.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},i.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},i.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},i.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},i.prototype._isFinal=function(){return(4194304&this._bitField)>0},i.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},i.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},i.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},i.prototype._setAsyncGuaranteed=function(){m.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},i.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];return t===p?void 0:void 0===t&&this._isBound()?this._boundValue():t},i.prototype._promiseAt=function(e){return this[4*e-4+2]},i.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},i.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},i.prototype._boundValue=function(){},i.prototype._migrateCallback0=function(e){var t=(e._bitField,e._fulfillmentHandler0),n=e._rejectionHandler0,r=e._promise0,i=e._receiverAt(0);void 0===i&&(i=p),this._addCallbacks(t,n,r,i,null)},i.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),i=e._promiseAt(t),o=e._receiverAt(t);void 0===o&&(o=p),this._addCallbacks(n,r,i,o,null)},i.prototype._addCallbacks=function(e,t,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=null===i?e:d.domainBind(i,e)),"function"==typeof t&&(this._rejectionHandler0=null===i?t:d.domainBind(i,t));else{var a=4*o-4;this[a+2]=n,this[a+3]=r,"function"==typeof e&&(this[a+0]=null===i?e:d.domainBind(i,e)),"function"==typeof t&&(this[a+1]=null===i?t:d.domainBind(i,t))}return this._setLength(o+1),o},i.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},i.prototype._resolveCallback=function(e,t){if(0===(117506048&this._bitField)){if(e===this)return this._rejectCallback(u(),!1);var n=C(e,this);if(!(n instanceof i))return this._fulfill(e);t&&this._propagateFrom(n,2);var r=n._target();if(r===this)return void this._reject(u());var o=r._bitField;if(0===(50397184&o)){var a=this._length();a>0&&r._migrateCallback0(this);for(var s=1;a>s;++s)r._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!==(33554432&o))this._fulfill(r._value());else if(0!==(16777216&o))this._reject(r._reason());else{var l=new b("late cancellation observer");r._attachExtraTrace(l),this._reject(l)}}},i.prototype._rejectCallback=function(e,t,n){var r=d.ensureErrorObject(e),i=r===e;if(!i&&!n&&T.warnings()){var o="a promise was rejected with a non-error: "+d.classString(e);this._warn(o,!0)}this._attachExtraTrace(r,!!t&&i),this._reject(e)},i.prototype._resolveFromExecutor=function(e){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,n)});n=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)},i.prototype._settlePromiseFromHandler=function(e,t,n,r){var i=r._bitField;if(0===(65536&i)){r._pushContext();var o;t===w?n&&"number"==typeof n.length?o=S(e).apply(this._boundValue(),n):(o=D,o.e=new _("cannot .spread() a non-array: "+d.classString(n))):o=S(e).call(t,n);var a=r._popContext();i=r._bitField,0===(65536&i)&&(o===E?r._reject(n):o===D?r._rejectCallback(o.e,!1):(T.checkForgottenReturns(o,a,"",r,this),r._resolveCallback(o)))}},i.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},i.prototype._followee=function(){return this._rejectionHandler0},i.prototype._setFollowee=function(e){this._rejectionHandler0=e},i.prototype._settlePromise=function(e,t,r,o){var a=e instanceof i,s=this._bitField,l=0!==(134217728&s);0!==(65536&s)?(a&&e._invokeInternalOnCancel(),r instanceof k&&r.isFinallyHandler()?(r.cancelPromise=e,S(t).call(r,o)===D&&e._reject(D.e)):t===c?e._fulfill(c.call(r)):r instanceof n?r._promiseCancelled(e):a||e instanceof O?e._cancel():r.cancel()):"function"==typeof t?a?(l&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,o,e)):t.call(r,o,e):r instanceof n?r._isResolved()||(0!==(33554432&s)?r._promiseFulfilled(o,e):r._promiseRejected(o,e)):a&&(l&&e._setAsyncGuaranteed(),0!==(33554432&s)?e._fulfill(o):e._reject(o))},i.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,r=e.receiver,o=e.value;"function"==typeof t?n instanceof i?this._settlePromiseFromHandler(t,r,o,n):t.call(r,o,n):n instanceof i&&n._reject(o)},i.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},i.prototype._settlePromise0=function(e,t,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,i,t)},i.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},i.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var n=u();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!==(134217728&t)?this._settlePromises():m.settlePromises(this))}},i.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16))return this._setRejected(),this._fulfillmentHandler0=e,this._isFinal()?m.fatalError(e,d.isNode):void((65535&t)>0?m.settlePromises(this):this._ensurePossibleRejectionHandled())},i.prototype._fulfillPromises=function(e,t){for(var n=1;e>n;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,t)}},i.prototype._rejectPromises=function(e,t){for(var n=1;e>n;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,t)}},i.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!==(16842752&e)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},i.prototype._settledValue=function(){var e=this._bitField;return 0!==(33554432&e)?this._rejectionHandler0:0!==(16777216&e)?this._fulfillmentHandler0:void 0},i.defer=i.pending=function(){T.deprecated("Promise.defer","new Promise");var e=new i(y);return{promise:e,resolve:o,reject:a}},d.notEnumerableProp(i,"_makeSelfResolutionError",u),e("./method")(i,y,C,h,T),e("./bind")(i,y,C,T),e("./cancel")(i,O,h,T),e("./direct_resolve")(i),e("./synchronous_inspection")(i),e("./join")(i,O,C,y,m,l),i.Promise=i,i.version="3.4.7",e("./map.js")(i,O,h,C,y,T),e("./call_get.js")(i),e("./using.js")(i,h,C,P,y,T),e("./timers.js")(i,y,T),e("./generators.js")(i,h,y,C,n,T),e("./nodeify.js")(i),e("./promisify.js")(i,y),e("./props.js")(i,O,C,h),e("./race.js")(i,y,C,h),e("./reduce.js")(i,O,h,C,y,T),e("./settle.js")(i,O,T),e("./some.js")(i,O,h),e("./filter.js")(i,y),e("./each.js")(i,y),e("./any.js")(i),d.toFastProperties(i),d.toFastProperties(i.prototype),s({a:1}),s({b:2}),s({c:3}),s(1),s(function(){}),s(void 0),s(!1),s(new i(y)),T.setBounds(v.firstLineError,d.lastLineError),i}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o){function a(e){switch(e){case-2:return[];case-3:return{}}}function s(e){var r=this._promise=new t(n);e instanceof t&&r._propagateFrom(e,3),r._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var l=e("./util");return l.isArray,l.inherits(s,o),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function u(e,n){var o=r(this._values,this._promise);if(o instanceof t){o=o._target();var s=o._bitField;if(this._values=o,0===(50397184&s))return this._promise._setAsyncGuaranteed(),o._then(u,this._reject,void 0,this,n);if(0===(33554432&s))return 0!==(16777216&s)?this._reject(o._reason()):this._cancel();o=o._value()}if(o=l.asArray(o),null===o){var c=i("expecting an array or an iterable object but got "+l.classString(o)).reason();return void this._promise._rejectCallback(c,!1)}return 0===o.length?void(-5===n?this._resolveEmptyArray():this._resolve(a(n))):void this._iterate(o)},s.prototype._iterate=function(e){var n=this.getActualLength(e.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,a=null,s=0;n>s;++s){var l=r(e[s],i);l instanceof t?(l=l._target(),a=l._bitField):a=null,o?null!==a&&l.suppressUnhandledRejections():null!==a?0===(50397184&a)?(l._proxy(this,s),this._values[s]=l):o=0!==(33554432&a)?this._promiseFulfilled(l._value(),s):0!==(16777216&a)?this._promiseRejected(l._reason(),s):this._promiseCancelled(s):o=this._promiseFulfilled(l,s)}o||i._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var n=0;n<e.length;++n)e[n]instanceof t&&e[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}},{"./util":36}],24:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e){return!E.test(e)}function i(e){try{return e.__isPromisified__===!0}catch(t){return!1}}function o(e,t,n){var r=d.getDataPropertyOrDefault(e,t+n,y);return!!r&&i(r)}function a(e,t,n){for(var r=0;r<e.length;r+=2){var i=e[r];if(n.test(i))for(var o=i.replace(n,""),a=0;a<e.length;a+=2)if(e[a]===o)throw new _("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}function s(e,t,n,r){for(var s=d.inheritedDataKeys(e),l=[],u=0;u<s.length;++u){var c=s[u],h=e[c],p=r===C||C(c,h,e);"function"!=typeof h||i(h)||o(e,c,t)||!r(c,h,e,p)||l.push(c,h)}return a(l,t,n),l}function l(e,r,i,o,a,s){function l(){var i=r;r===p&&(i=this);var o=new t(n);o._captureStackTrace();var a="string"==typeof c&&this!==u?this[c]:e,l=f(o,s);try{a.apply(i,v(arguments,l))}catch(h){o._rejectCallback(m(h),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var u=function(){return this}(),c=e;return"string"==typeof c&&(e=o),d.notEnumerableProp(l,"__isPromisified__",!0),l}function u(e,t,n,r,i){for(var o=new RegExp(O(t)+"$"),a=s(e,t,o,n),l=0,u=a.length;u>l;l+=2){var c=a[l],h=a[l+1],f=c+t;if(r===j)e[f]=j(c,p,c,h,t,i);else{var v=r(h,function(){return j(c,p,c,h,t,i)});d.notEnumerableProp(v,"__isPromisified__",!0),e[f]=v}}return d.toFastProperties(e),e}function c(e,t,n){return j(e,t,void 0,e,null,n)}var h,p={},d=e("./util"),f=e("./nodeback"),v=d.withAppended,m=d.maybeWrapAsError,g=d.canEvaluate,_=e("./errors").TypeError,b="Async",y={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],E=new RegExp("^(?:"+w.join("|")+")$"),C=function(e){return d.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e},O=function(e){return e.replace(/([$])/,"\\$")},j=g?h:l;t.promisify=function(e,t){if("function"!=typeof e)throw new _("expecting a function but got "+d.classString(e));if(i(e))return e;t=Object(t);var n=void 0===t.context?p:t.context,o=!!t.multiArgs,a=c(e,n,o);return d.copyDescriptors(e,a,r),a},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new _("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");t=Object(t);var n=!!t.multiArgs,r=t.suffix;"string"!=typeof r&&(r=b);var i=t.filter;"function"!=typeof i&&(i=C);var o=t.promisifier;if("function"!=typeof o&&(o=j),!d.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=d.inheritedDataKeys(e),s=0;s<a.length;++s){var l=e[a[s]];"constructor"!==a[s]&&d.isClass(l)&&(u(l.prototype,r,i,o,n),u(l,r,i,o,n))}return u(e,r,i,o,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function o(e){var t,n=!1;if(void 0!==s&&e instanceof s)t=h(e),n=!0;else{var r=c.keys(e),i=r.length;t=new Array(2*i);for(var o=0;i>o;++o){var a=r[o];t[o]=e[a],t[o+i]=a}}this.constructor$(t),this._isMap=n,this._init$(void 0,-3)}function a(e){var n,a=r(e);return u(a)?(n=a instanceof t?a._then(t.props,void 0,void 0,void 0,void 0):new o(a).promise(),a instanceof t&&n._propagateFrom(a,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,l=e("./util"),u=l.isObject,c=e("./es5");"function"==typeof Map&&(s=Map);var h=function(){function e(e,r){this[t]=e,this[t+n]=r,t++}var t=0,n=0;return function(r){n=r.size,t=0;var i=new Array(2*r.size);return r.forEach(e,i),i}}(),p=function(e){for(var t=new s,n=e.length/2|0,r=0;n>r;++r){var i=e[n+r],o=e[r];t.set(i,o)}return t};l.inherits(o,n),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;if(n>=this._length){var r;if(this._isMap)r=p(this._values);else{r={};for(var i=this.length(),o=0,a=this.length();a>o;++o)r[this._values[o+i]]=this._values[o]}return this._resolve(r),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return a(this)},t.props=function(e){return a(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,n){"use strict";function r(e,t,n,r,i){for(var o=0;i>o;++o)n[o+r]=e[o+t],e[o+t]=void 0}function i(e){this._capacity=e,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(e){return this._capacity<e},i.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var n=this._front+t&this._capacity-1;this[n]=e,this._length=t+1},i.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=e,this[i+1&o]=t,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,i=this._length,o=n+i&t-1;r(this,0,this,t,o)},t.exports=i},{}],27:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function o(e,o){var l=r(e);if(l instanceof t)return s(l);if(e=a.asArray(e),null===e)return i("expecting an array or an iterable object but got "+a.classString(e));var u=new t(n);void 0!==o&&u._propagateFrom(o,3);for(var c=u._fulfill,h=u._reject,p=0,d=e.length;d>p;++p){var f=e[p];(void 0!==f||p in e)&&t.cast(f)._then(c,h,void 0,u,null)}return u}var a=e("./util"),s=function(e){return e.then(function(t){return o(t,e)})};t.race=function(e){return o(e,void 0)},t.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o,a){function s(e,n,r,i){this.constructor$(e);var a=p();this._fn=null===a?n:d.domainBind(a,n),void 0!==r&&(r=t.resolve(r),r._attachCancellationCallback(this)),this._initialValue=r,this._currentCancellable=null,i===o?this._eachValues=Array(this._length):0===i?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function u(e,t,n,i){if("function"!=typeof t)return r("expecting a function but got "+d.classString(t));var o=new s(e,t,n,i);return o.promise()}function c(e){this.accum=e,this.array._gotAccum(e);var n=i(this.value,this.array._promise);return n instanceof t?(this.array._currentCancellable=n,n._then(h,void 0,void 0,this,void 0)):h.call(this,n)}function h(e){var n=this.array,r=n._promise,i=f(n._fn);r._pushContext();var o;o=void 0!==n._eachValues?i.call(r._boundValue(),e,this.index,this.length):i.call(r._boundValue(),this.accum,e,this.index,this.length),o instanceof t&&(n._currentCancellable=o);var s=r._popContext();return a.checkForgottenReturns(o,s,void 0!==n._eachValues?"Promise.each":"Promise.reduce",r),o}var p=t._getDomain,d=e("./util"),f=d.tryCatch;d.inherits(s,n),s.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==o&&this._eachValues.push(e)},s.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},s.prototype.shouldCopyValues=function(){return!1},s.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},s.prototype._resultCancelled=function(e){return e===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel()))},s.prototype._iterate=function(e){this._values=e;var n,r,i=e.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=t.resolve(e[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;i>r;++r){var o={accum:null,value:e[r],index:r,length:i,array:this};n=n._then(c,void 0,void 0,o,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(l,l,void 0,n,this)},t.prototype.reduce=function(e,t){return u(this,e,t,null)},t.reduce=function(e,t,n,r){return u(e,t,n,r)}}},{"./util":36}],29:[function(e,t,n){"use strict";var r,i=e("./util"),o=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},a=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var s=global.setImmediate,l=process.nextTick;r=i.isRecentNode?function(e){s.call(global,e)}:function(e){l.call(process,e)}}else if("function"==typeof a&&"function"==typeof a.resolve){var u=a.resolve();r=function(e){u.then(e)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:o:function(){var e=document.createElement("div"),t={attributes:!0},n=!1,r=document.createElement("div"),i=new MutationObserver(function(){e.classList.toggle("foo"),n=!1});i.observe(r,t);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(e,t),o()}}();t.exports=r},{"./util":36}],30:[function(e,t,n){"use strict";t.exports=function(t,n,r){function i(e){this.constructor$(e)}var o=t.PromiseInspection,a=e("./util");a.inherits(i,n),i.prototype._promiseResolved=function(e,t){this._values[e]=t;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var n=new o;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},i.prototype._promiseRejected=function(e,t){var n=new o;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},t.settle=function(e){return r.deprecated(".settle()",".reflect()"),new i(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,n){"use strict";t.exports=function(t,n,r){function i(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(e,t){if((0|t)!==t||0>t)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new i(e),o=n.promise();return n.setHowMany(t),n.init(),o}var a=e("./util"),s=e("./errors").RangeError,l=e("./errors").AggregateError,u=a.isArray,c={};a.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var e=u(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(e){this._howMany=e},i.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},i.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new l,t=this.length();t<this._values.length;++t)this._values[t]!==c&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(e){this._values.push(e)},i.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return o(e,t)},t.prototype.some=function(e){return o(this,e)},t._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(e,t,n){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},o=t.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0===(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return o.call(this._target())},e.prototype.isFulfilled=function(){return i.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e,r){if(c(e)){if(e instanceof t)return e;var i=o(e);if(i===u){r&&r._pushContext();var l=t.reject(i.e);return r&&r._popContext(),l}if("function"==typeof i){if(a(e)){var l=new t(n);return e._then(l._fulfill,l._reject,void 0,l,null),l}return s(e,i,r)}}return e}function i(e){return e.then}function o(e){try{return i(e)}catch(t){return u.e=t,u}}function a(e){try{return h.call(e,"_promise0")}catch(t){return!1}}function s(e,r,i){function o(e){s&&(s._resolveCallback(e),s=null)}function a(e){s&&(s._rejectCallback(e,h,!0),s=null)}var s=new t(n),c=s;i&&i._pushContext(),s._captureStackTrace(),i&&i._popContext();var h=!0,p=l.tryCatch(r).call(e,o,a);return h=!1,s&&p===u&&(s._rejectCallback(p.e,!0,!0),s=null),c}var l=e("./util"),u=l.errorObj,c=l.isObject,h={}.hasOwnProperty;return r}},{"./util":36}],34:[function(e,t,n){"use strict";t.exports=function(t,n,r){function i(e){this.handle=e}function o(e){return clearTimeout(this.handle),e}function a(e){throw clearTimeout(this.handle),e}var s=e("./util"),l=t.TimeoutError;i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var u=function(e){return c(+this).thenReturn(e)},c=t.delay=function(e,o){var a,s;return void 0!==o?(a=t.resolve(o)._then(u,null,null,e,void 0),r.cancellation()&&o instanceof t&&a._setOnCancel(o)):(a=new t(n),s=setTimeout(function(){a._fulfill()},+e),r.cancellation()&&a._setOnCancel(new i(s)),a._captureStackTrace()),a._setAsyncGuaranteed(),a};t.prototype.delay=function(e){return c(e,this)};var h=function(e,t,n){var r;r="string"!=typeof t?t instanceof Error?t:new l("operation timed out"):new l(t),s.markAsOriginatingFromRejection(r),e._attachExtraTrace(r),e._reject(r),null!=n&&n.cancel()};t.prototype.timeout=function(e,t){e=+e;var n,s,l=new i(setTimeout(function(){n.isPending()&&h(n,t,s)},e));return r.cancellation()?(s=this.then(),n=s._then(o,a,void 0,l,void 0),n._setOnCancel(l)):n=this._then(o,a,void 0,l,void 0),n}}},{"./util":36}],35:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o,a){function s(e){setTimeout(function(){throw e},0)}function l(e){var t=r(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function u(e,n){function i(){if(a>=u)return c._fulfill();var o=l(e[a++]);if(o instanceof t&&o._isDisposable()){try{o=r(o._getDisposer().tryDispose(n),e.promise)}catch(h){return s(h)}if(o instanceof t)return o._then(i,s,null,null,null)}i()}var a=0,u=e.length,c=new t(o);return i(),c}function c(e,t,n){this._data=e,this._promise=t,this._context=n}function h(e,t,n){this.constructor$(e,t,n)}function p(e){return c.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function d(e){this.length=e,this.promise=null,this[e-1]=null}var f=e("./util"),v=e("./errors").TypeError,m=e("./util").inherits,g=f.errorObj,_=f.tryCatch,b={};c.prototype.data=function(){return this._data},c.prototype.promise=function(){return this._promise},c.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():b;
},c.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=t!==b?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},c.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},m(h,c),h.prototype.doDispose=function(e,t){var n=this.data();return n.call(e,e,t)},d.prototype._resultCancelled=function(){for(var e=this.length,n=0;e>n;++n){var r=this[n];r instanceof t&&r.cancel()}},t.using=function(){var e=arguments.length;if(2>e)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[e-1];if("function"!=typeof i)return n("expecting a function but got "+f.classString(i));var o,s=!0;2===e&&Array.isArray(arguments[0])?(o=arguments[0],e=o.length,s=!1):(o=arguments,e--);for(var l=new d(e),h=0;e>h;++h){var v=o[h];if(c.isDisposer(v)){var m=v;v=v.promise(),v._setDisposable(m)}else{var b=r(v);b instanceof t&&(v=b._then(p,null,null,{resources:l,index:h},void 0))}l[h]=v}for(var y=new Array(l.length),h=0;h<y.length;++h)y[h]=t.resolve(l[h]).reflect();var w=t.all(y).then(function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return g.e=n.error(),g;if(!n.isFulfilled())return void w.cancel();e[t]=n.value()}E._pushContext(),i=_(i);var r=s?i.apply(void 0,e):i(e),o=E._popContext();return a.checkForgottenReturns(r,o,"Promise.using",E),r}),E=w.lastly(function(){var e=new t.PromiseInspection(w);return u(l,e)});return l.promise=E,E._setOnCancel(l),E},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new h(e,this,i());throw new v}}},{"./errors":12,"./util":36}],36:[function(e,t,n){"use strict";function r(){try{var e=P;return P=null,e.apply(this,arguments)}catch(t){return x.e=t,x}}function i(e){return P=e,r}function o(e){return null==e||e===!0||e===!1||"string"==typeof e||"number"==typeof e}function a(e){return"function"==typeof e||"object"==typeof e&&null!==e}function s(e){return o(e)?new Error(m(e)):e}function l(e,t){var n,r=e.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=e[n];return i[n]=t,i}function u(e,t,n){if(!T.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function c(e,t,n){if(o(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return T.defineProperty(e,t,r),e}function h(e){throw e}function p(e){try{if("function"==typeof e){var t=T.names(e.prototype),n=T.isES5&&t.length>1,r=t.length>0&&!(1===t.length&&"constructor"===t[0]),i=L.test(e+"")&&T.names(e).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}}function d(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e}function f(e){return M.test(e)}function v(e,t,n){for(var r=new Array(e),i=0;e>i;++i)r[i]=t+i+n;return r}function m(e){try{return e+""}catch(t){return"[no string representation]"}}function g(e){return null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function _(e){try{c(e,"isOperational",!0)}catch(t){}}function b(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||e.isOperational===!0)}function y(e){return g(e)&&T.propertyIsWritable(e,"stack")}function w(e){return{}.toString.call(e)}function E(e,t,n){for(var r=T.names(e),i=0;i<r.length;++i){var o=r[i];if(n(o))try{T.defineProperty(t,o,T.getDescriptor(e,o))}catch(a){}}}function C(e){return N?process.env[e]:void 0}function O(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"==={}.toString.call(e))return Promise}catch(t){}}function j(e,t){return e.bind(t)}var P,T=e("./es5"),k="undefined"==typeof navigator,x={e:{}},A="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,D=function(e,t){function n(){this.constructor=e,this.constructor$=t;for(var n in t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}var r={}.hasOwnProperty;return n.prototype=t.prototype,e.prototype=new n,e.prototype},S=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(T.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var r=[],i=Object.create(null);null!=e&&!t(e);){var o;try{o=n(e)}catch(a){return r}for(var s=0;s<o.length;++s){var l=o[s];if(!i[l]){i[l]=!0;var u=Object.getOwnPropertyDescriptor(e,l);null!=u&&null==u.get&&null==u.set&&r.push(l)}}e=T.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var i=[];e:for(var o in n)if(r.call(n,o))i.push(o);else{for(var a=0;a<e.length;++a)if(r.call(e[a],o))continue e;i.push(o)}return i}}(),L=/this\s*\.\s*\S+\s*=/,M=/^[a-z$_][a-z$_0-9]*$/i,R=function(){return"stack"in new Error?function(e){return y(e)?e:new Error(m(e))}:function(e){if(y(e))return e;try{throw new Error(m(e))}catch(t){return t}}}(),F=function(e){return T.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var z="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],r=e[Symbol.iterator]();!(t=r.next()).done;)n.push(t.value);return n};F=function(e){return T.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?z(e):null}}var I="undefined"!=typeof process&&"[object process]"===w(process).toLowerCase(),N="undefined"!=typeof process&&"undefined"!=typeof process.env,B={isClass:p,isIdentifier:f,inheritedDataKeys:S,getDataPropertyOrDefault:u,thrower:h,isArray:T.isArray,asArray:F,notEnumerableProp:c,isPrimitive:o,isObject:a,isError:g,canEvaluate:k,errorObj:x,tryCatch:i,inherits:D,withAppended:l,maybeWrapAsError:s,toFastProperties:d,filledRange:v,toString:m,canAttachTrace:y,ensureErrorObject:R,originatesFromRejection:b,markAsOriginatingFromRejection:_,classString:w,copyDescriptors:E,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:I,hasEnvVariables:N,env:C,global:A,getNativePromise:O,domainBind:j};B.isRecentNode=B.isNode&&function(){var e=process.versions.node.split(".").map(Number);return 0===e[0]&&e[1]>10||e[0]>0}(),B.isNode&&B.toFastProperties(process);try{throw new Error}catch(U){B.lastLineError=U}t.exports=B},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),montageDefine("6a7e87c","package.json",{exports:{name:"montagejs.org",version:"0.0.0","private":!0,dependencies:{digit:"^3.0.0",montage:"^17.0.11"},devDependencies:{mop:"^16.1.3"},main:"index",hash:"6a7e87c",mappings:{digit:{name:"digit",hash:"c3eaa99",location:"packages/digit@c3eaa99/"},montage:{name:"montage",hash:"ad36237",location:"packages/montage@ad36237/"}},production:!0,useScriptInjection:!0}}),montageDefine("ad36237","package.json",{exports:{name:"montage",version:"17.0.11",description:"Build your next application with a browser based platform that really gets the web.",license:"BSD-3-Clause",repository:{type:"git",url:"git+https://github.com/montagejs/montage.git"},main:"core/core",engines:{node:"4.8.0",npm:"2.15.11"},production:!0,dependencies:{bluebird:"~3.4.7",collections:"~5.0.x",frb:"~4.0.x",htmlparser2:"~3.0.5",jslint:"^0.10.3",mr:"^17.0.4","q-io":"^1.13.3"},devDependencies:{concurrently:"^3.4.0","jasmine-console-reporter":"^1.2.7","jasmine-core":"^2.5.2",karma:"^1.5.0","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.0.1","karma-ie-launcher":"^1.0.0","karma-jasmine":"^1.1.0","karma-phantomjs-launcher":"^1.0.2","karma-safari-launcher":"^1.0.0","montage-testing":"git://github.com/montagejs/montage-testing.git#master","mop-integration":"git://github.com/montagejs/mop-integration.git#master",open:"0.0.5"},scripts:{test:"node test/run-node.js",integration:"MONTAGE_VERSION=${MONTAGE_VERSION:=./} MOP_VERSION=${MOP_VERSION:=#master} node node_modules/mop-integration/integration",jsdoc:"node ../montagejs.org/build/jsdoc/jsdoc.js -out $PWD/builds/jsdoc/ montage@npm-link","test:karma":"karma start --no-auto-watch --single-run","test:karma-debug":"karma start --no-auto-watch --single-run --browsers=PhantomJS_debug","test:karma-firefox":"karma start --no-auto-watch --single-run --browsers=Firefox","test:karma-chrome":"karma start --no-auto-watch --single-run --browsers=Chrome","test:karma-dev":"karma start --auto-watch --no-single-run --capture","test:jasmine":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/test/run.html"'},exclude:["report","test","tools"],gitHead:"3463add25b8eaec92fe89fa58f4831417e80ac0b",bugs:{url:"https://github.com/montagejs/montage/issues"},homepage:"https://github.com/montagejs/montage#readme",_id:"montage@17.0.11",_shasum:"b494d3d7838f85761f262a58d944a9df72fda14f",_from:"montage@latest",_npmVersion:"2.15.11",_nodeVersion:"4.8.0",_npmUser:{name:"hthetiot",email:"hthetiot@gmail.com"},dist:{shasum:"b494d3d7838f85761f262a58d944a9df72fda14f",tarball:"https://registry.npmjs.org/montage/-/montage-17.0.11.tgz"},maintainers:[{name:"hthetiot",email:"hthetiot@gmail.com"}],_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/montage-17.0.11.tgz_1500484628508_0.4269174460787326"},directories:{},_resolved:"https://registry.npmjs.org/montage/-/montage-17.0.11.tgz",redirects:{montage:"core/core"},mappings:{mr:{name:"mr",hash:"0f0a8ea",location:"../mr@0f0a8ea/"},bluebird:{name:"bluebird",hash:"489b8c2",location:"../bluebird@489b8c2/"},collections:{name:"collections",hash:"449c0c3",location:"../collections@449c0c3/"},frb:{name:"frb",hash:"afa97d9",location:"../frb@afa97d9/"},htmlparser2:{name:"htmlparser2",hash:"d27b149",location:"../htmlparser2@d27b149/"},jslint:{name:"jslint",hash:"ca674de",location:"../jslint@ca674de/"},"q-io":{name:"q-io",hash:"b67ee0e",location:"../q-io@b67ee0e/"}},hash:"ad36237",useScriptInjection:!0}}),montageDefine("489b8c2","package.json",{exports:{name:"bluebird",description:"Full featured Promises/A+ implementation with exceptionally good performance",version:"3.4.7",keywords:["promise","performance","promises","promises-a","promises-aplus","async","await","deferred","deferreds","future","flow control","dsl","fluent interface"],scripts:{lint:"node scripts/jshint.js",test:"node tools/test.js",istanbul:"istanbul",prepublish:"npm run generate-browser-core && npm run generate-browser-full","generate-browser-full":"node tools/build.js --no-clean --no-debug --release --browser --minify","generate-browser-core":"node tools/build.js --features=core --no-debug --release --zalgo --browser --minify && mv js/browser/bluebird.js js/browser/bluebird.core.js && mv js/browser/bluebird.min.js js/browser/bluebird.core.min.js"},homepage:"https://github.com/petkaantonov/bluebird",repository:{type:"git",url:"git://github.com/petkaantonov/bluebird.git"},bugs:{url:"http://github.com/petkaantonov/bluebird/issues"},license:"MIT",author:{name:"Petka Antonov",email:"petka_antonov@hotmail.com",url:"http://github.com/petkaantonov/"},devDependencies:{acorn:"~0.6.0",baconjs:"^0.7.43",bluebird:"^2.9.2","body-parser":"^1.10.2",browserify:"^8.1.1","cli-table":"~0.3.1",co:"^4.2.0","cross-spawn":"^0.2.3",glob:"^4.3.2","grunt-saucelabs":"~8.4.1",highland:"^2.3.0",istanbul:"^0.3.5",jshint:"^2.6.0","jshint-stylish":"~0.2.0",mkdirp:"~0.5.0",mocha:"~2.1",open:"~0.0.5",optimist:"~0.6.1",rimraf:"~2.2.6",rx:"^2.3.25","serve-static":"^1.7.1",sinon:"~1.7.3","uglify-js":"~2.4.16",kefir:"^2.4.1"},main:"./js/release/bluebird.js",browser:"./js/browser/bluebird.js",files:["js/browser","js/release","LICENSE"],gitHead:"dc267aa1be9d1f08c25a5b98bb836f6504ba03a5",_id:"bluebird@3.4.7",_shasum:"f72d760be09b7f76d08ed8fae98b289a8d05fab3",_from:"bluebird@>=3.4.7 <3.5.0",_npmVersion:"3.6.0",_nodeVersion:"5.6.0",_npmUser:{name:"esailija",email:"petka_antonov@hotmail.com"},dist:{shasum:"f72d760be09b7f76d08ed8fae98b289a8d05fab3",tarball:"https://registry.npmjs.org/bluebird/-/bluebird-3.4.7.tgz"},maintainers:[{name:"esailija",email:"petka_antonov@hotmail.com"}],_npmOperationalInternal:{host:"packages-12-west.internal.npmjs.com",tmp:"tmp/bluebird-3.4.7.tgz_1482427669507_0.09324374701827765"},directories:{},_resolved:"https://registry.npmjs.org/bluebird/-/bluebird-3.4.7.tgz",hash:"489b8c2",mappings:{},production:!0,useScriptInjection:!0}}),montageDefine("449c0c3","package.json",{exports:{name:"collections",version:"5.0.7",description:"data structures with idiomatic JavaScript collection interfaces",homepage:"http://www.collectionsjs.com",author:{name:"Kris Kowal",email:"kris@cixar.com",url:"http://github.com/kriskowal"},contributors:[{name:"Benoit Marchant"}],keywords:["collections","data structures","observable","list","set","map","splay"],bugs:{url:"http://github.com/montagejs/collections/issues"},license:"BSD-3-Clause",licenses:[{type:"MIT",url:"https://raw.github.com/montagejs/collections/master/LICENSE.md"}],repository:{type:"git",url:"git+ssh://git@github.com/montagejs/collections.git"},dependencies:{"weak-map":"~1.0.x"},devDependencies:{"montage-testing":"git://github.com/montagejs/montage-testing.git#master","jasmine-console-reporter":"^1.2.7","jasmine-core":"^2.5.2",karma:"^1.5.0","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.0.1","karma-jasmine":"^1.1.0","karma-phantomjs-launcher":"^1.0.2","mop-integration":"git://github.com/montagejs/mop-integration.git#master",concurrently:"^3.4.0","http-server":"^0.9.0",open:"0.0.5"},scripts:{test:"node test/run-node.js",integration:"mop-integration","test:karma":"karma start --no-auto-watch --single-run","test:karma-firefox":"karma start --no-auto-watch --single-run --browsers=Firefox","test:karma-chrome":"karma start --no-auto-watch --single-run --browsers=Chrome","test:karma-debug":"karma start --auto-watch --no-single-run --browsers=PhantomJS_debug","test:karma-dev":"karma start --auto-watch --no-single-run --capture","test:jasmine":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/test/run.html"'},gitHead:"8ac0a4b8ba73292a74e8023bc5606b64c1afb3c3",_id:"collections@5.0.7",_shasum:"347e78bfe99d3e5a3864b6dfdc7bce4e401cbe54",_from:"collections@>=5.0.0 <5.1.0",_npmVersion:"2.15.11",_nodeVersion:"4.8.0",_npmUser:{name:"hthetiot",email:"hthetiot@gmail.com"},dist:{shasum:"347e78bfe99d3e5a3864b6dfdc7bce4e401cbe54",tarball:"https://registry.npmjs.org/collections/-/collections-5.0.7.tgz"},maintainers:[{name:"aadsm",email:"antonio.afonso@gmail.com"},{name:"francoisfrisch",email:"francoisfrisch@gmail.com"},{name:"hthetiot",email:"hthetiot@gmail.com"},{name:"kriskowal",email:"kris.kowal@cixar.com"},{name:"marchant",email:"benoit@montagestudio.com"},{name:"stuk",email:"stuart@stuartk.com"}],_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/collections-5.0.7.tgz_1501202471492_0.36544556310400367"},directories:{},_resolved:"https://registry.npmjs.org/collections/-/collections-5.0.7.tgz",main:"index",hash:"449c0c3",mappings:{"weak-map":{name:"weak-map",hash:"8919b53",location:"../weak-map@8919b53/"}},production:!0,useScriptInjection:!0}}),montageDefine("afa97d9","package.json",{exports:{name:"frb",version:"4.0.1",description:"Functional reactive bindings",keywords:["functional","reactive","bindings","observe","change"],author:{name:"Kris Kowal",email:"kris@cixar.com",url:"http://github.com/kriskowal/"},contributors:[{name:"Kris Kowal",email:"kris@cixar.com",url:"http://github.com/kriskowal/"},{name:"Benoit Marchant",email:"benoit@montagestudio.com",url:"http://github.com/marchant/"}],bugs:{url:"http://github.com/montagejs/frb/issues"},licenses:[{type:"MIT",url:"http://github.com/montagejs/frb/raw/master/LICENSE.md"}],repository:{type:"git",url:"git+ssh://git@github.com/montagejs/frb.git"},main:"bindings",dependencies:{collections:"~5.0.x"},devDependencies:{"jasmine-node":"github:montagestudio/jasmine-node#master",pegjs:"git://github.com/dmajda/pegjs.git","memwatch-next":"*"},scripts:{test:"jasmine-node spec","build-parser":"pegjs --allowed-start-rules expression,sheet grammar.pegjs"},gitHead:"f308b188528debcc1eb36c040de7dac338b220df",homepage:"https://github.com/montagejs/frb#readme",_id:"frb@4.0.1",_shasum:"cf463759615169e7b33ae2f66f6f52ada8aa01c7",_from:"frb@>=4.0.0 <4.1.0",_npmVersion:"2.15.11",_nodeVersion:"4.7.0",_npmUser:{name:"marchant",email:"benoit@montagestudio.com"},maintainers:[{name:"kriskowal",email:"kris.kowal@cixar.com"},{name:"marchant",email:"benoit@montagestudio.com"}],dist:{shasum:"cf463759615169e7b33ae2f66f6f52ada8aa01c7",tarball:"https://registry.npmjs.org/frb/-/frb-4.0.1.tgz"},_npmOperationalInternal:{host:"packages-18-east.internal.npmjs.com",tmp:"tmp/frb-4.0.1.tgz_1490060215062_0.2427865113131702"},directories:{},_resolved:"https://registry.npmjs.org/frb/-/frb-4.0.1.tgz",hash:"afa97d9",mappings:{collections:{name:"collections",hash:"449c0c3",location:"../collections@449c0c3/"}},production:!0,useScriptInjection:!0}}),montageDefine("8919b53","package.json",{exports:{name:"weak-map",version:"1.0.5",description:"A WeakMap shim for Node.js and browsers",main:"weak-map.js",repository:{type:"git",url:"git://github.com/drses/weak-map.git"},keywords:["weakmap","weak-map","weak","map","collections","es6"],author:{name:"Mark Miller",email:"erights@gmail.com"},maintainer:"Kris Kowal <kris@cixar.com>",license:"Apache 2.0",bugs:{url:"https://github.com/drses/weak-map/issues"},files:["weak-map.js"],scripts:{test:"npm run test:native; npm run test:shim","test:phantom":"","test:shim":"node test/index.js","test:native":"node --harmony_collections test/index.js"},devDependencies:{jasminum:"^2.0.1"},homepage:"https://github.com/drses/weak-map",_id:"weak-map@1.0.5",dist:{shasum:"79691584d98607f5070bd3b70a40e6bb22e401eb",tarball:"https://registry.npmjs.org/weak-map/-/weak-map-1.0.5.tgz"},_from:"weak-map@>=1.0.0 <1.1.0",_npmVersion:"1.4.3",_npmUser:{name:"kriskowal",email:"kris.kowal@cixar.com"},maintainers:[{name:"kriskowal",email:"kris.kowal@cixar.com"}],directories:{},_shasum:"79691584d98607f5070bd3b70a40e6bb22e401eb",_resolved:"https://registry.npmjs.org/weak-map/-/weak-map-1.0.5.tgz",hash:"8919b53",mappings:{},production:!0,useScriptInjection:!0}}),montageDefine("c3eaa99","package.json",{exports:{name:"digit",description:"Touch-optimized MontageJS components for tablets and phones.",version:"3.0.0",license:"BSD-3-Clause",repository:{type:"git",url:"git+https://github.com/montagejs/digit.git"},dependencies:{montage:"^17.0.7"},devDependencies:{concurrently:"^3.4.0","http-server":"^0.9.0","jasmine-console-reporter":"^1.2.7","jasmine-core":"^2.5.2",karma:"^1.5.0","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.0.1","karma-jasmine":"^1.1.0","karma-phantomjs-launcher":"^1.0.2","montage-testing":"git://github.com/montagejs/montage-testing.git#master",open:"0.0.5"},scripts:{test:"node test/run-node.js","test:karma":"karma start --no-auto-watch --single-run","test:karma-dev":"karma start --auto-watch --no-single-run","test:jasmine":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/test/run.html"',"start:demo":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/demo/sizing/index.html"',"start:overview":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/overview/index.html"'},exclude:["overview","test"],gitHead:"a46d7aa68cbf985e6f4b322096a1e2a022c14035",bugs:{url:"https://github.com/montagejs/digit/issues"},homepage:"https://github.com/montagejs/digit#readme",_id:"digit@3.0.0",_shasum:"1d2be43a34f5aa1684c22934a4b2b6b5f80638f0",_from:"digit@latest",_npmVersion:"2.15.11",_nodeVersion:"4.8.0",_npmUser:{name:"hthetiot",email:"hthetiot@gmail.com"},dist:{shasum:"1d2be43a34f5aa1684c22934a4b2b6b5f80638f0",tarball:"https://registry.npmjs.org/digit/-/digit-3.0.0.tgz"},maintainers:[{name:"francoisfrisch",email:"francoisfrisch@gmail.com"},{name:"hthetiot",email:"hthetiot@gmail.com"},{name:"marchant",email:"benoit@montagestudio.com"},{name:"montage-bot",email:"francoisfrisch@gmail.com"}],_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/digit-3.0.0.tgz_1495575626923_0.7017284843605012"},directories:{},_resolved:"https://registry.npmjs.org/digit/-/digit-3.0.0.tgz",main:"index",hash:"c3eaa99",mappings:{montage:{name:"montage",hash:"ad36237",location:"../montage@ad36237/"}},production:!0,useScriptInjection:!0}}),montageDefine("6a7e87c","index.html",{text:'<html><head></head><body><div data-montage-id=features></div><script src=packages/montage@ad36237/montage.js></script><script type=text/montage-serialization>{"features":{"prototype":"ui/features.reel","properties":{"element":{"#":"features"}}}}</script></body></html>'}),montageDefine("6a7e87c","ui/features.reel/features",{dependencies:["montage","montage/ui/component"],factory:function(e,t,n){var r=e("montage").Montage,i=e("montage/ui/component").Component;t.Features=r.create(i,{hasTemplate:{value:!0},convert:{value:function(e){return Number(Math.round(e)).toString()}},revert:{value:function(e){return Number(Math.round(e)).toString()}}})}}),montageDefine("6a7e87c","ui/features.reel/features.html",{text:'<!DOCTYPE html><html><head><title></title><style>.features ul{list-style:none;margin:0;padding:0}.features li{padding:10px 0;text-align:center}.features .digit-Slider{width:200px}.features .arrow{padding:10px 0 5px;font-size:30px;color:hsl(0,0%,70%)}.features pre{box-sizing:border-box;font-size:15px;line-height:1.2em;text-shadow:none;color:hsl(0,0%,50%)}.features .hl-number{color:#00f}.features .hl-range{color:red}.features .hl-bindings,.features .hl-value{color:#000}.features .block{display:inline-block;position:relative;margin:20px 0 20px 30px;padding:0 20px;border-left:1px solid hsl(0,0%,80%)}.features .block::before{position:absolute;left:-30px;font-family:\'Open Sans\',sans-serif;color:hsl(0,0%,70%);-webkit-transform-origin:left top;-moz-transform-origin:left top;-ms-transform-origin:left top;-o-transform-origin:left top;transform-origin:left top;-webkit-transform:rotate(-90deg) translateX(-100%);-moz-transform:rotate(-90deg) translateX(-100%);-ms-transform:rotate(-90deg) translateX(-100%);-o-transform:rotate(-90deg) translateX(-100%);transform:rotate(-90deg) translateX(-100%)}.features .block.serialization{margin-bottom:60px}@media all and (min-width:800px){.features .block::before{text-shadow:-1px 0 0 hsla(0,0%,100%,.8)}}.features .markup::before{content:"HTML";top:15px}.features .serialization::before{content:"JSON Serialization";top:32px}.features ::-webkit-scrollbar{-webkit-appearance:none;width:4px;height:4px;border-radius:2px;background-color:hsl(0,0%,90%)}.features ::-webkit-scrollbar-thumb{border-radius:2px;background-clip:padding-box;background-color:hsl(0,0%,80%)}@media all and (max-width:800px){.features .block{display:block;position:relative;margin:20px 0;padding:0;border:none;overflow:auto}.features .block pre{font-size:12px;padding-bottom:10px;white-space:pre;overflow:auto}.features .block::before{display:block;position:relative;top:8px;left:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;-o-transform:none;transform:none}.features .block.serialization{margin-bottom:20px}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/features.reel","properties":{"element":{"#":"component"}}},"number":{"prototype":"digit/ui/number-field.reel","properties":{"element":{"#":"number"},"min":0,"max":100,"step":1},"bindings":{"value":{"<->":"@slider.value"}}},"slider":{"prototype":"digit/ui/slider.reel","properties":{"element":{"#":"slider"},"min":0,"max":100,"step":1,"value":50}},"numberValue":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"numberValue"}},"bindings":{"value":{"<-":"@number.value","converter":{"@":"owner"}}}},"rangeValue":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"rangeValue"}},"bindings":{"value":{"<-":"@number.value","converter":{"@":"owner"}}}}}</script></head><body><div data-montage-id=component class=features data-montage-skin=light><ul><li><input data-montage-id=number type=number value=50></li><li class=arrow>↕</li><li><input data-montage-id=slider type=range value=50></li></ul><div class="block markup"><pre>&lt;input data-montage-id="<span class=hl-number>number</span>" type="number" value="<span data-montage-id=numberValue class=hl-value>0</span>"&gt;\n&lt;input data-montage-id="<span class=hl-range>slider</span>" type="range" value="<span data-montage-id=rangeValue class=hl-value>0</span>"&gt;\n</pre></div><div class="block serialization"><pre>"number": {\n    "prototype": "digit/ui/number-field.reel",\n    "properties": { "element": {"#": "<span class=hl-number>number</span>"} }\n},\n"slider": {\n    "prototype": "digit/ui/slider.reel",\n    "properties": { "element": {"#": "<span class=hl-range>slider</span>"} },\n    <span class=hl-bindings>"bindings": { "value": {"&lt;-&gt;": "@number.value"} }</span>\n}\n</pre></div></div></body></html>'}),montageDefine("ad36237","core/core",{dependencies:["collections/shim","./shim/object","./shim/array","./extras/object","./extras/date","./extras/element","./extras/function","./extras/regexp","./extras/string","collections/map","collections/weak-map","collections/set","collections/listen/property-changes","frb","frb/parse","frb/evaluate","frb/assign","frb/bind","frb/compile-observer","frb/scope","frb/observers","./serialization/bindings","./promise"],factory:function(e,t,n){function r(){var e="";return this===Function||this===Function.prototype.constructor?e="Function":this!==Function.prototype&&(e=(""+this).replace(A,"").replace(D,"")),e}function i(e,t,n){var r=n||(t===y?N:v+t+f);return e!==Object.prototype?e.hasOwnProperty(r)?e[r]:Object.defineProperty(e,r,{enumerable:!1,configurable:!1,writable:!0,value:Object.create(i(Object.getPrototypeOf(e),t,r))})[r]:(B.has(t)||B.set(t,{}),B.get(t))}function o(e){var t=o&&o.caller?o.caller:arguments.callee.caller,n=h.call(this,t,e,!0,!1,!1),r=this;return n?function(){return n.apply(r,arguments)}:Function.noop}function a(e){var t=a&&a.caller?a.caller:arguments.callee.caller,n=h.call(this,t,e,!1,!0,!1),r=this;return n?function(){return n.apply(r,arguments)}:Function.noop}function s(e){var t=s&&s.caller?s.caller:arguments.callee.caller,n=h.call(this,t,e,!1,!1,!0),r=this;return n?function(){return n.apply(r,arguments)}:Function.noop}function l(){var e=l&&l.caller?l.caller:arguments.callee.caller,t=h.call(this,e);return t?t.apply(this,arguments):void 0}function u(e){var t=_superDependenciesWeakMap.get(e);return t||_superDependenciesWeakMap.set(e,t=new k),t}function c(e){var t=U.get(e);return t||U.set(e,t=new k),t}function h(e,t,n,r,i){if(e||t){var o=x.get(e);if(!o){var a=typeof this===w;o=d(e,a?this:this.constructor,a,t,n,r,i),o&&(x.set(e,o),c(o).add(e))}return o}}function p(e,t,n){var r,i,o,a=x,s=Object.getOwnPropertyDescriptor(e,t);if(s)if(typeof s.value===w&&typeof n.value===w)for(a["delete"](s.value),r=c(s.value),i=r.values();o=i.next().value;)a["delete"](o);else{if(typeof s.get===w&&typeof n.get===w)for(a["delete"](s.get),r=c(s.get),i=r.values();o=i.next().value;)a["delete"](o);if(typeof s.set===w&&typeof n.set===w)for(a["delete"](s.set),r=c(s.set),i=r.values();o=i.next().value;)a["delete"](o)}if(r=_superDependenciesWeakMap.get(e))for(i=r.values();o=i.next().value;)p(o,t,n)}function d(e,t,n,r,i,o,a){var s,l,c,h,p,d,f,v,m,g,_=global.Object,b=i,y=o,E=a;for(f=m=n?t:t.prototype;!g&&null!==m;){if(d){if(h=_.getOwnPropertyDescriptor(m,d)){if(h.hasOwnProperty("value")){p=h.value,g=!0;break}if(y&&h.hasOwnProperty("get")){p=h.get,g=!0;break}if(E&&h.hasOwnProperty("set")){p=h.set,g=!0;break}}}else for(s=r?(q[0]=r)&&q:_.getOwnPropertyNames(m),l=0;c=s[l];l++)if(h=_.getOwnPropertyDescriptor(m,c))if(null!=(p=h.value)){if(p===e||p.deprecatedFunction===e){d=c,b=!0;break}}else{if(null!=(p=h.get)&&(p===e||p.deprecatedFunction===e)){d=c,y=!0;break}if(null!=(p=h.set)&&(p===e||p.deprecatedFunction===e)){d=c,E=!0;break}}v=m,(m=_.getPrototypeOf(m))&&u(m).add(v)}return g&&typeof p===w?p:Function.noop}e("collections/shim"),e("./shim/object"),e("./shim/array"),e("./extras/object"),e("./extras/date"),e("./extras/element"),e("./extras/function"),e("./extras/regexp"),e("./extras/string");var f="AttributeProperties",v="_",m="__proto__",g="value",_="enumerable",b="distinct",y="serializable",w="function",E=95,C=Array.prototype,O=(Object.prototype,{get:void 0,set:void 0,configurable:!1,enumerable:!1}),j={value:void 0,configurable:!1,enumerable:!1,writable:!1},P=e("collections/map"),T=e("collections/weak-map"),k=e("collections/set"),x=new T;if(_superDependenciesWeakMap=new T,!Object.create.name){var A=/^[\S\s]*?function\s*/,D=/[\s\(\/][\S\s]+$/;Object.defineProperty(Function.prototype,"name",{get:r})}var S=t.Montage=function(){},L={}.__proto__===Object.prototype,M={_montage_metadata:1,__state__:1,_hasUserDefinedConstructor:1};if(S.defineValueProperty=function oe(e,t,n,r,i,o){oe.template.value=n,oe.template.configurable=r,oe.template.enumerable=i,oe.template.writable=o,this.defineProperty(e,t,oe.template)},S.defineValueProperty.template=j,S.defineAccessorProperty=function ae(e,t,n,r,i,o){ae.template.get=n,ae.template.set=r,ae.template.configurable=i,ae.template.enumerable=o,this.defineProperty(e,t,Montage_defineValueProperty.template)},S.defineAccessorProperty.template=O,j.value=!1,Object.defineProperty(S,"_hasUserDefinedConstructor",j),j.value=function(e,t){var n,r,i,o,a,s,l,u=this,c="undefined"==typeof this.specialize;if(e=e||Object.empty,t=t||Object.empty,e.constructor&&e.constructor.value?(n=e.constructor.value,n._hasUserDefinedConstructor=!0):this._hasUserDefinedConstructor?n=function(){return this["super"]()||this}:(n=function(){return this},n.name=this.name+"Specialized"),L)n.__proto__=u;else{for(i=Object.getOwnPropertyNames(u),s=0,l=i.length;s<l;s++)o=i[s],M.hasOwnProperty(o)||(a=Object.getOwnPropertyDescriptor(n,o),a&&!a.configurable||S.defineProperty(n,o,Object.getOwnPropertyDescriptor(u,o)));n.__constructorProto__=u,S.defineProperty(n,"isPrototypeOf",{value:function(e){for(var t;null!==e;){if(t=Object.getPrototypeOf(e),t===this)return!0;e=t}return!1},enumerable:!1})}if(r=Object.create(this.prototype),c){for(i=Object.getOwnPropertyNames(S),s=0,l=i.length;s<l;s++)o=i[s],a=Object.getOwnPropertyDescriptor(n,o),a&&!a.configurable||S.defineProperty(n,o,Object.getOwnPropertyDescriptor(S,o));for(i=Object.getOwnPropertyNames(S.prototype),s=0,l=i.length;s<l;s++)o=i[s],a=Object.getOwnPropertyDescriptor(n,o),a&&!a.configurable||S.defineProperty(r,o,Object.getOwnPropertyDescriptor(S.prototype,o))}return"objectDescriptor"in e&&S.defineProperty(n,"objectDescriptor",e.objectDescriptor),"blueprint"in e&&S.defineProperty(n,"blueprint",e.blueprint),"objectDescriptorModuleId"in e&&S.defineProperty(n,"objectDescriptorModuleId",e.objectDescriptorModuleId),"blueprintModuleId"in e&&S.defineProperty(n,"blueprintModuleId",e.blueprintModuleId),S.defineProperties(r,e,!0),S.defineProperties(n,t,!0),S.defineProperty(n,"__isConstructor__",{value:!0,enumerable:!1}),n.prototype=r,S.defineValueProperty(r,"constructor",n,!0,!1,!0),S.defineValueProperty(n,"constructor",n,!0,!1,!0),n},j.writable=!1,j.configurable=!0,j.enumerable=!1,Object.defineProperty(S,"specialize",j),!L){var R=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return typeof e===w&&e.__constructorProto__?e.__constructorProto__:R.apply(Object,arguments)}}j.writable=j.configurable=j.enumerable=!1,j.value=function(e,t,n,r){if("object"!=typeof e&&typeof e!==w||null===e)throw new TypeError("Object must be an object, not '"+e+"'");var o=g in n;if(b in n&&!o)throw new TypeError("Cannot use distinct attribute on non-value property '"+t+"'");if(m in n)n.__proto__=o?typeof n.value===w?I:z:F;else{
var a;a=o?typeof n.value===w?I:z:F;for(var s in a)s in n||(n[s]=a[s])}return n.hasOwnProperty(_)||t.charCodeAt(0)!==E||(n.enumerable=!1),n.hasOwnProperty(y)||(n.enumerable?n.get&&!n.set?n.serializable=!1:n.writable===!1&&(n.serializable=!1):n.serializable=!1),y in n&&(i(e,y)[t]=n.serializable),r||p(e,t,n),Object.defineProperty(e,t,n)},Object.defineProperty(S,"defineProperty",j),Object.defineProperty(S,"defineProperties",{value:function(e,t,n){if("object"!=typeof t||null===t)throw new TypeError("Properties must be an object, not '"+t+"'");for(var r=Object.getOwnPropertyNames(t),i=0;property=r[i];i++)"_bindingDescriptors"!==property&&this.defineProperty(e,property,t[property],n);return e}});var F={enumerable:!0,configurable:!0,serializable:!0},z={writable:!0,enumerable:!0,configurable:!0,serializable:"reference"},I={writable:!0,enumerable:!1,configurable:!0},N="_serializableAttributeProperties";Object.defineProperty(S.prototype,N,{enumerable:!1,configurable:!1,writable:!0,value:{}});var B=new P;S.defineProperty(S,"didCreate",{value:Function.noop});var U=new P,q=[];S.defineProperty(S,"super",{value:l,enumerable:!1}),S.defineProperty(S.prototype,"super",{value:l,enumerable:!1}),S.defineProperty(S,"superForValue",{value:o,enumerable:!1}),S.defineProperty(S.prototype,"superForValue",{value:o,enumerable:!1}),S.defineProperty(S,"superForGet",{value:a,enumerable:!1}),S.defineProperty(S.prototype,"superForGet",{value:a,enumerable:!1}),S.defineProperty(S,"superForSet",{value:s,enumerable:!1}),S.defineProperty(S.prototype,"superForSet",{value:s,enumerable:!1}),S.defineProperty(S,"getSerializablePropertyNames",{value:function(e){var t,n=i(e,y);if(n){t=[];for(var r in n)n[r]&&t.push(r);return t}return Array.empty}}),S.defineProperty(S,"getPropertyAttribute",{value:function(e,t,n){var r=i(e,n);if(r)return r[t]}}),S.defineProperty(S,"getPropertyAttributes",{value:function(e,t){var n,r=i(e,t);if(r){n={};for(var o in r)n[o]=r[o];return n}}});var V={isInstance:{value:!0}},W={objectName:{value:"Function"},isInstance:{value:!0}};Object.defineProperty(S.prototype,"_montage_metadata",{enumerable:!1,writable:!0,value:void 0}),S.defineProperty(S,"getInfoForObject",{value:function(e){var t,n;if(H.call(e,"_montage_metadata")&&e._montage_metadata)return e._montage_metadata;if(t=e._montage_metadata||e.constructor&&e.constructor._montage_metadata||null,n=e.constructor===Function?W:V,e===Object.prototype)return Object.create(t,n);try{return e.constructor===Object?Object.defineProperty(e,"_montage_metadata",{enumerable:!1,writable:!0,value:Object.create(t,n)})._montage_metadata:("_montage_metadata"in e.constructor.prototype||Object.defineProperty(e.constructor.prototype,"_montage_metadata",{enumerable:!1,writable:!0,value:void 0}),(e._montage_metadata=Object.create(t,n))||e._montage_metadata)}catch(r){return e._montage_metadata=Object.create(t,n)}}});var H=Object.prototype.hasOwnProperty;S.defineProperty(S,"identifier",{value:null,serializable:!0}),S.defineProperty(S.prototype,"identifier",{value:null,serializable:!0}),S.defineProperty(S.prototype,"equals",{value:function(e){return!!e&&(this===e||this.uuid&&this.uuid===e.uuid)}}),S.defineProperty(S,"equals",{value:S.prototype.equals}),S.defineProperty(S.prototype,"callDelegateMethod",{value:function(e){var t,n=this.delegate;if(n&&("string"==typeof this.identifier&&typeof(t=n[this.identifier+e.toCapitalized()])===w||typeof(t=n[e])===w,t))return 2===arguments.length?t.call(n,arguments[1]):3===arguments.length?t.call(n,arguments[1],arguments[2]):4===arguments.length?t.call(n,arguments[1],arguments[2],arguments[3]):5===arguments.length?t.call(n,arguments[1],arguments[2],arguments[3],arguments[4]):(C.shift.call(arguments),t.apply(n,arguments))}});var X=e("collections/listen/property-changes");Object.addEach(S,X.prototype),Object.addEach(S.prototype,X.prototype);var G=t.Bindings=e("frb"),Y={defineBinding:{value:function(e,t,n){return G.defineBinding(this,e,t,n)}},defineBindings:{value:function(e,t){return G.defineBindings(this,e,t)}},cancelBinding:{value:function(e){return G.cancelBinding(this,e)}},cancelBindings:{value:function(){return G.cancelBindings(this)}},getBinding:{value:function(e){return G.getBinding(this,e)}},getBindings:{value:function(){return G.getBindings(this)}}};S.defineProperties(S,Y),S.defineProperties(S.prototype,Y);var $=e("frb/parse"),K=e("frb/evaluate"),J=e("frb/assign"),Q=(e("frb/bind"),e("frb/compile-observer")),Z=e("frb/scope"),ee=e("frb/observers"),te=ee.autoCancelPrevious,ne=function(){return this._willChangeListeners=null,this._changeListeners=null,this};Object.defineProperties(ne.prototype,{_willChangeListeners:{value:null,writable:!0},willChangeListeners:{get:function(){return this._willChangeListeners||(this._willChangeListeners=new P)}},_changeListeners:{value:null,writable:!0},changeListeners:{get:function(){return this._changeListeners||(this._changeListeners=new P)}}});var re=new T,ie={getPath:{value:function(e,t,n,r){return K(e,this,t||this,n,r)}},setPath:{value:function(e,t,n,r,i){return J(this,e,t,n||this,r,i)}},observePath:{value:function(e,t){var n=$(e),r=Q(n);return r(te(t),new Z(this))}},addRangeAtPathChangeListener:{value:function(e,t,n,r,i,o){function a(e,r,i){if(t[n])t[n](e,r,i);else{if(!t.call)throw new Error("Can't dispatch range change to "+t);t.call(null,e,r,i)}}n=n||"handleRangeChange";var s=[];return this.addPathChangeListener(e,function(e){return e&&e.toArray&&e.addRangeChangeListener?(a(e.toArray(),s.toArray(),0),s=e,e.addRangeChangeListener(a)):(e=[],a(e,s,0),void(s=e))},void 0,void 0,r,i,o)}},getPathChangeDescriptors:{value:function(){return re.has(this)||re.set(this,new P),re.get(this)}},getPathChangeDescriptor:{value:function(e,t,n){var r=S.getPathChangeDescriptors.call(this);return r.has(e)||r.set(e,new ne),r=r.get(e),r=n?r.willChangeListeners:r.changeListeners,r.has(t)||r.set(t,{path:e,handler:t,beforeChange:n,cancel:Function.noop}),r.get(t)}},addPathChangeListener:{value:function(e,t,n,r,i,o,a){var s=this;t=t||Function.noop;var l=S.getPathChangeDescriptor.call(this,e,t,r);l.cancel();var u,c,h,p=$(e);if(t===Function.noop)h=function(t){if(c)throw new Error("Path change handler needs a handler because it emits new values when the source changes: "+JSON.stringify(e));c=!0,u=t};else if(n)h=function(r){return t[n].call(t,r,e,s)};else if(t.handlePathChange)h=function(n){return t.handlePathChange.call(t,n,e,s)};else{if(typeof t!==w)throw new Error("Can't recognize handler type: "+t+". Must be function or delegate implementing handlePathChange.");h=function(n){return t.call(s,n,e,s)}}var d=Q(p),f=new Z(this);f.beforeChange=r,f.parameters=i,f.document=o,f.components=a;var v=d(te(h),f);return l.cancel=v,c?u:v}},removePathChangeListener:{value:function(e,t,n){t=t||Function.noop;var r=S.getPathChangeDescriptors.call(this),i=n?"willChangeListeners":"changeListeners",o=r.get(e);if(!o)throw new Error("Can't find "+i+" for "+JSON.stringify(e));var a=o[i];if(!a.has(t))throw new Error("Can't find "+i+" for "+JSON.stringify(e));var s=a.get(t);s.cancel(),a["delete"](t),0===o.willChangeListeners.size&&0===o.changeListeners.size&&r["delete"](e),r.size<1&&re["delete"](this)}},addBeforePathChangeListener:{value:function(e,t,n,r,i,o){return S.addPathChangeListener.call(this,e,t,n,!0,r,i,o)}},removeBeforePathChangeListener:{value:function(e,t,n){return S.removePathChangeListener.call(this,e,t,!0)}}};S.defineProperties(S,ie),S.defineProperties(S.prototype,ie),e("./serialization/bindings"),t._objectDescriptorModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var e=S.getInfoForObject(this),t=e&&!e.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(t,"_objectDescriptorModuleId")||!t._objectDescriptorModuleId){e=S.getInfoForObject(t);var n=e.moduleId,r=n.lastIndexOf("/"),i=n.lastIndexOf(".");r=r===-1?0:r+1,i=i===-1?n.length:i,i=i<r?n.length:i,S.defineProperty(t,"_objectDescriptorModuleId",{enumerable:!1,value:n.slice(0,i)+".mjson"})}return t._objectDescriptorModuleId}},t._blueprintModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var e=S.getInfoForObject(this),t=e&&!e.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(t,"_objectDescriptorModuleId")||!t._objectDescriptorModuleId){e=S.getInfoForObject(t);var n=e.moduleId,r=n.lastIndexOf("/"),i=n.lastIndexOf(".");r=r===-1?0:r+1,i=i===-1?n.length:i,i=i<r?n.length:i,S.defineProperty(t,"_objectDescriptorModuleId",{enumerable:!1,value:n.slice(0,i)+".meta"})}return t._objectDescriptorModuleId}},t._objectDescriptorDescriptor={serializable:!1,enumerable:!1,get:function(){var n=S.getInfoForObject(this),r=n&&!n.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(r,"_objectDescriptor")||!r._objectDescriptor){var i=r.objectDescriptorModuleId||r.blueprintModuleId;if(!i)throw new TypeError("ObjectDescriptor moduleId undefined for the module '"+JSON.stringify(r)+"'");t._objectDescriptorDescriptor.ObjectDescriptorModulePromise||(t._objectDescriptorDescriptor.ObjectDescriptorModulePromise=e.async("core/meta/module-object-descriptor").get("ModuleObjectDescriptor")),S.defineProperty(r,"_objectDescriptor",{enumerable:!1,value:t._objectDescriptorDescriptor.ObjectDescriptorModulePromise.then(function(e){var t=S.getInfoForObject(r);return e.getObjectDescriptorWithModuleId(i,t.require)["catch"](function(t){if(t.message.indexOf("Can't XHR")!==-1)return e.createDefaultObjectDescriptorForObject(r).then(function(e){return e});throw t})})})}return r._objectDescriptor},set:function(t){var n,r=S.getInfoForObject(this),i=r&&!r.isInstance?this:this.constructor;if(null===t)n=null;else{if(typeof t.then===w)throw new TypeError("Object descriptor should not be a promise");t.objectDescriptorInstanceModule=i.objectDescriptorModule,n=e("./promise").Promise.resolve(t)}S.defineProperty(i,"_objectDescriptor",{enumerable:!1,value:n})}},t._blueprintDescriptor=t._objectDescriptorDescriptor}}),montageDefine("ad36237","core/event/event-manager",{dependencies:["../core","./mutable-event","../serialization/serializer/montage-serializer","../serialization/deserializer/montage-deserializer","collections/map","collections/weak-map","../environment"],factory:function(e,t,n){function r(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}function i(e,t,n,r,i){var o,a,s,l;for(l=n.keys();o=l.next().value;)a=n.get(o),s=a&&a.get(t),Array.isArray(s)&&s.length>0?s.forEach(function(t){r.push({type:o,listener:e.addObjectReference(t),capture:i})}):s&&r.push({type:o,listener:e.addObjectReference(s),capture:i})}var o,a=e("../core").Montage,s=e("./mutable-event").MutableEvent,l=e("../serialization/serializer/montage-serializer").MontageSerializer,u=e("../serialization/deserializer/montage-deserializer").MontageDeserializer,c=e("collections/map"),h=e("collections/weak-map"),p=e("../environment").currentEnvironment;if("undefined"!=typeof window){"function"!=typeof window.CustomEvent&&(r.prototype=window.Event.prototype,window.CustomEvent=r),"undefined"==typeof window.Touch&&"ontouchstart"in window&&(window.Touch=function(){},function(){var e;document.addEventListener("touchstart",e=function t(e){window.Touch=e.touches[0].constructor,document.nativeRemoveEventListener?document.nativeRemoveEventListener("touchstart",t,!0):document.removeEventListener("touchstart",t,!0),o&&o.isStoringPointerEvents&&(o.isStoringPointerEvents=!1,o.isStoringPointerEvents=!0)},!0)}());var d=(a.specialize({constructor:{value:function(e){return this.data=new Array(32),this.velocity={velocity:(new d).initWithIdentifier(e)},this}},data:{enumerable:!1,writable:!0,value:null},size:{enumerable:!1,writable:!0,value:0},pos:{enumerable:!1,writable:!0,value:0},velocity:{enumerable:!1,writable:!0,value:0}}),a.specialize({constructor:{value:function(e,t,n){return this.clientX=e,this.clientY=t,this.timeStamp=n,this}},clientX:{enumerable:!1,writable:!0,value:null},clientY:{enumerable:!1,writable:!0,value:0},timeStamp:{enumerable:!1,writable:!0,value:0}}),a.specialize({_identifier:{enumerable:!1,writable:!0,value:null},initWithIdentifier:{value:function(e){return this._identifier=e,this}},clearCache:{value:function(){return this._data=this._x=this._y=this._speed=this._angle=null,this}},_data:{enumerable:!1,writable:!0,value:null},_x:{enumerable:!1,writable:!0,value:null},_y:{enumerable:!1,writable:!0,value:null},_speed:{enumerable:!1,writable:!0,value:null},_angle:{enumerable:!1,writable:!0,value:null},x:{get:function(){return null===this._x&&(null===this._data&&(this._data=o._getPointerVelocityData(this._identifier)),this._x=o._calculatePointerVelocity(this._data.time,this._data.x)),this._x},set:function(){}},y:{get:function(){return null===this._y&&(null===this._data&&(this._data=o._getPointerVelocityData(this._identifier)),this._y=o._calculatePointerVelocity(this._data.time,this._data.y)),this._y},set:function(){}},speed:{get:function(){return null===this._speed&&(this._speed=Math.sqrt(this.x*this.x+this.y*this.y)),this._speed},set:function(){}},angle:{get:function(){return null===this._angle&&(this._angle=Math.atan2(this.y,this.x)),this._angle},set:function(){}}}));l.defineSerializationUnit("listeners",function(e,t){var n=o,r=[];if(i(e,t,n._registeredCaptureEventListeners,r,!0),i(e,t,n._registeredBubbleEventListeners,r,!1),r.length>0)return r}),u.defineDeserializationUnit("listeners",function(e,t,n){for(var r,i=0;r=n[i];i++)t.addEventListener(r.type,r.listener,r.capture)});var f=Event.NONE,v=Event.CAPTURING_PHASE,m=Event.AT_TARGET,g=Event.BUBBLING_PHASE,_="function";t.EventManager=a.specialize({constructor:{value:function(){return this._trackingTouchStartList=new c,this._trackingTouchEndList=new c,this._claimedPointers=new c,this._registeredCaptureEventListeners=new c,this._registeredBubbleEventListeners=new c,this._observedTarget_byEventType_=Object.create(null),this._currentDispatchedTargetListeners=new c,this._elementEventHandlerByElement=new h,this.environment=p,this._trackingTouchTimeoutIDs=new c,this}},spliceOne:{value:function(e,t){var n=e.length;if(n){for(;t<n;)e[t]=e[t+1],t++;e.length--}}},eventDefinitions:{value:{abort:{bubbles:!1,cancelable:!1},beforeunload:{bubbles:!1},blur:{bubbles:!1,cancelable:!1},change:{bubbles:!0,cancelable:!1},click:{bubbles:!0,cancelable:!0},close:{bubbles:!1,cancelable:!1},compositionend:{bubbles:!0,cancelable:!1},compositionstart:{bubbles:!0,cancelable:!0},compositionupdate:{bubbles:!0,cancelable:!1},contextmenu:{bubbles:!0,cancelable:!0},copy:{bubbles:!0,cancelable:!0},cut:{bubbles:!0,cancelable:!0},dblclick:{bubbles:!0,cancelable:!1},DOMActivate:{bubbles:!0,cancelable:!0,deprecated:!0},DOMMouseScroll:{bubbles:!0},drag:{bubbles:!0,cancelable:!0},dragend:{bubbles:!0,cancelable:!1},dragenter:{bubbles:!0,cancelable:!0},dragleave:{bubbles:!0,cancelable:!1},dragover:{bubbles:!0,cancelable:!0},dragstart:{bubbles:!0,cancelable:!0},drop:{bubbles:!0,cancelable:!0},error:{bubbles:function(e){return!(XMLHttpRequest.prototype.isPrototypeOf(e)||e.tagName&&"VIDEO"===e.tagName.toUpperCase()||e.tagName&&"AUDIO"===e.tagName.toUpperCase())},cancelable:!1},focus:{bubbles:!1,cancelable:!1},focusin:{bubbles:!0,cancelable:!1},focusout:{bubbles:!0,cancelable:!1},input:{bubbles:!0,cancelable:!1},keydown:{bubbles:!0,cancelable:!1},keypress:{bubbles:!0,cancelable:!1},keyup:{bubbles:!0,cancelable:!1},load:{bubbles:!1,cancelable:!1},loadend:{bubbles:!1,cancelable:!1},loadstart:{bubbles:!1,cancelable:!1},message:{bubbles:!1,cancelable:!1},mousedown:{bubbles:!0,cancelable:!0},mouseenter:{bubbles:!1,cancelable:!1},mouseleave:{bubbles:!1,cancelable:!1},mousemove:{bubbles:!0,cancelable:!0},mouseout:{bubbles:!0,cancelable:!0},mouseover:{bubbles:!0,cancelable:!0},mouseup:{bubbles:!0,cancelable:!0},mousewheel:{bubbles:!0},orientationchange:{bubbles:!1},paste:{bubbles:!0,cancelable:!0},progress:{bubbles:!1,cancelable:!1},reset:{bubbles:!0,cancelable:!1},resize:{bubbles:!1,cancelable:!1},scroll:{bubbles:function(e){return!!e.defaultView},cancelable:!1},select:{bubbles:!0,cancelable:!1},submit:{bubbles:!0,cancelable:!0},touchcancel:{bubbles:!0,cancelable:!1},touchend:{bubbles:!0,cancelable:!0},touchmove:{bubbles:!0,cancelable:!0},touchstart:{bubbles:!0,cancelable:!0},unload:{bubbles:!1,cancelable:!1},wheel:{bubbles:!0,cancelable:!0},pointerdown:{bubbles:!0,cancelable:!0},pointerup:{bubbles:!0,cancelable:!0},pointerenter:{bubbles:!1,cancelable:!0},pointercancel:{bubbles:!0,cancelable:!0},pointerout:{bubbles:!0,cancelable:!0},pointerover:{bubbles:!0,cancelable:!0},pointerleave:{bubbles:!1,cancelable:!0},pointermove:{bubbles:!0,cancelable:!0},MSPointerDown:{bubbles:!0,cancelable:!0},MSPointerMove:{bubbles:!0,cancelable:!0},MSPointerUp:{bubbles:!0,cancelable:!0},MSPointerOver:{bubbles:!0,cancelable:!0},MSPointerOut:{bubbles:!0,cancelable:!0},MSPointerHover:{bubbles:!0,cancelable:!0}}},_DOMPasteboardElement:{value:null,enumerable:!1},_delegate:{value:null,enumerable:!1},delegate:{enumerable:!1,get:function(){return this._delegate},set:function(e){this._delegate=e}},_application:{value:null,enumerable:!1},application:{enumerable:!1,get:function(){return this._application},set:function(e){this._application=e}},_registeredWindows:{value:null,enumerable:!1},_windowsAwaitingFinalRegistration:{value:new h,enumerable:!1},initWithWindow:{enumerable:!1,value:function(e){if(this._registeredWindows)throw"EventManager has already been initialized";return this.registerWindow(e),this}},registerWindow:{enumerable:!1,value:function(e){if(e.defaultEventManager&&e.defaultEventManager!==this)throw"EventManager cannot register a window already registered to another EventManager";if(this._registeredWindows&&this._registeredWindows.indexOf(e)>=0)throw"EventManager cannot register a window more than once";if(this._registeredWindows||(this._registeredWindows=[]),!this._windowsAwaitingFinalRegistration.has(e)){if(e.Element.prototype.nativeAddEventListener=e.Element.prototype.addEventListener,Object.defineProperty(e,"nativeAddEventListener",{configurable:!0,value:e.addEventListener}),e.document.nativeAddEventListener=e.document.addEventListener,e.XMLHttpRequest.prototype.nativeAddEventListener=e.XMLHttpRequest.prototype.addEventListener,e.Worker&&(e.Worker.prototype.nativeAddEventListener=e.Worker.prototype.addEventListener),e.MediaController&&(e.MediaController.prototype.nativeAddEventListener=e.MediaController.prototype.addEventListener),e.Element.prototype.nativeRemoveEventListener=e.Element.prototype.removeEventListener,Object.defineProperty(e,"nativeRemoveEventListener",{configurable:!0,value:e.removeEventListener}),e.document.nativeRemoveEventListener=e.document.removeEventListener,e.XMLHttpRequest.prototype.nativeRemoveEventListener=e.XMLHttpRequest.prototype.removeEventListener,e.Worker&&(e.Worker.prototype.nativeRemoveEventListener=e.Worker.prototype.removeEventListener),e.MediaController&&(e.MediaController.prototype.nativeRemoveEventListener=e.MediaController.prototype.removeEventListener),Object.defineProperty(e,"addEventListener",{configurable:!0,value:e.XMLHttpRequest.prototype.addEventListener=e.Element.prototype.addEventListener=e.document.addEventListener=function(t,n,r){return e.defaultEventManager.registerEventListener(this,t,n,!!r)}}),e.Worker&&(e.Worker.prototype.addEventListener=e.addEventListener),e.MediaController&&(e.MediaController.prototype.addEventListener=e.addEventListener),Object.defineProperty(e,"removeEventListener",{configurable:!0,value:e.XMLHttpRequest.prototype.removeEventListener=e.Element.prototype.removeEventListener=e.document.removeEventListener=function(t,n,r){return e.defaultEventManager.unregisterEventListener(this,t,n,!!r)}}),e.Worker&&(e.Worker.prototype.removeEventListener=e.removeEventListener),e.MediaController&&(e.MediaController.prototype.removeEventListener=e.removeEventListener),e.HTMLDivElement.prototype.addEventListener!==e.Element.prototype.nativeAddEventListener&&e.HTMLElement&&"addEventListener"in e.HTMLElement.prototype){var n,r,i=Object.getOwnPropertyNames(e),s=0,l=i.length;for(s;s<l;s++)n=i[s],n.match(/^HTML\w*Element$/)&&"function"==typeof n&&(r=n.prototype,r.nativeAddEventListener=r.addEventListener,r.addEventListener=e.Element.prototype.addEventListener,r.nativeRemoveEventListener=r.removeEventListener,r.removeEventListener=e.Element.prototype.removeEventListener)}a.defineProperty(e.Element.prototype,"component",{get:function(){return o._elementEventHandlerByElement.get(this)},enumerable:!1}),o=e.defaultEventManager=t.defaultEventManager=this,this._registeredWindows.push(e),this._windowsAwaitingFinalRegistration.set(e,e),/loaded|complete|interactive/.test(e.document.readyState)?this._finalizeWindowRegistration(e):e.document.addEventListener("DOMContentLoaded",this,!0),this._evaluateShouldDispatchEventCondition()}}},_finalizeWindowRegistration:{enumerable:!1,value:function(e){if(!this._windowsAwaitingFinalRegistration.has(e))throw"EventManager wasn't expecting to register this window";this._windowsAwaitingFinalRegistration["delete"](e),this._listenToWindow(e)}},unregisterWindow:{enumerable:!1,value:function(e){if(this._registeredWindows.indexOf(e)<0)throw"EventManager cannot unregister an unregistered window";if(this._registeredWindows=this._registeredWindows.filter(function(t){return e!==t}),delete e.defaultEventManager,e.Element.prototype.addEventListener=e.Element.prototype.nativeAddEventListener,Object.defineProperty(e,"addEventListener",{configurable:!0,value:e.nativeAddEventListener}),e.document.addEventListener=e.document.nativeAddEventListener,e.XMLHttpRequest.prototype.addEventListener=e.XMLHttpRequest.prototype.nativeAddEventListener,e.Worker&&(e.Worker.prototype.addEventListener=e.Worker.prototype.nativeAddEventListener),e.Element.prototype.removeEventListener=e.Element.prototype.nativeRemoveEventListener,Object.defineProperty(e,"removeEventListener",{configurable:!0,value:e.nativeRemoveEventListener}),e.document.removeEventListener=e.document.nativeRemoveEventListener,e.XMLHttpRequest.prototype.removeEventListener=e.XMLHttpRequest.prototype.nativeRemoveEventListener,e.Worker&&(e.Worker.prototype.removeEventListener=e.Worker.prototype.nativeRemoveEventListener),e.HTMLDivElement.prototype.nativeAddEventListener!==e.Element.prototype.addEventListener&&e.HTMLElement&&"addEventListener"in e.HTMLElement.prototype&&e.Components&&e.Components.interfaces){var t,n;for(t in Components.interfaces)t.match(/^nsIDOMHTML\w*Element$/)&&(t=t.replace(/^nsIDOM/,""),(t=window[t])&&(n=t.prototype,n.addEventListener=n.nativeAddEventListener,delete n.nativeAddEventListener,n.removeEventListener=n.nativeRemoveEventListener,delete n.nativeRemoveEventListener))}delete e.Element.prototype.nativeAddEventListener,delete e.nativeAddEventListener,delete e.document.nativeAddEventListener,delete e.XMLHttpRequest.prototype.nativeAddEventListener,e.Worker&&delete e.Worker.prototype.nativeAddEventListener,delete e.Element.prototype.nativeRemoveEventListener,delete e.nativeRemoveEventListener,delete e.document.nativeRemoveEventListener,delete e.XMLHttpRequest.prototype.nativeRemoveEventListener,e.Worker&&delete e.Worker.prototype.nativeRemoveEventListener,delete e.Element.prototype.component,this._stopListeningToWindow(e)}},unregisterWindows:{enumerable:!1,value:function(){this._registeredWindows.forEach(this.unregisterWindow)}},registeredEventListeners:{enumerable:!1,value:{}},registeredEventListenersForEventType_:{value:function(e){var t=this._registeredCaptureEventListeners.get(e),n=this._registeredBubbleEventListeners.get(e),r=null;return t&&t.forEach(function(e,t,n){e&&e.length>0&&(r||(r=[]),e.forEach(function(e){r.push(e)}))}),n&&n.forEach(function(e,t,n){e&&e.length>0&&(r||(r=[]),e.forEach(function(e){r.push(e)}))}),r}},registeredEventListenersForEventType_onTarget_:{enumerable:!1,value:function(e,t){var n,r=this._registeredCaptureEventListeners.get(e),i=this._registeredBubbleEventListeners.get(e),o=null;return e&&t&&(r||i)?(n=r?r.get(t):null,n&&(o||(o=n)),n=i?i.get(t):null,n&&(o=o?o.union(n):n),o):null}},registeredEventListenersForEventType_onTarget_phase_:{enumerable:!1,value:function(e,t,n){return t?this._registeredEventListenersForEventType_onTarget_registeredEventListeners_(e,t,n?this._registeredCaptureEventListeners:this._registeredBubbleEventListeners):null}},_registeredEventListenersForEventType_onTarget_registeredEventListeners_:{value:function(e,t,n){var r=n.get(e);return r?r.get(t):null},enumerable:!1},registeredEventListenersOnTarget_:{value:function(e){var t,n,r,i=this._registeredCaptureEventListeners,o=this._registeredBubbleEventListeners,a=[];for(r=i.keys();t=r.next().value;)n=i.get(t),n.has(e)&&a.push(t);for(r=o.keys();t=r.next().value;)n=_registeredBubbleEventListenersget(t),n.has(e)&&a.push(t);return a}},_registeredCaptureEventListeners:{value:null},_registeredBubbleEventListeners:{value:null},registerEventListener:{enumerable:!1,value:function(e,t,n,r){var i;return i=this._registerEventListener(e,t,n,r?this._registeredCaptureEventListeners:this._registeredBubbleEventListeners)}},_registerEventListener:{enumerable:!1,value:function(e,t,n,r){var i,o=r.get(t),a=!1,s=!1;return o?o.has(e)?(i=o.get(e),Array.isArray(i)?i.indexOf(n)!==-1?s=!0:(i.push(n),s=!0):(i!==n&&(i=[i,n],o.set(e,i)),s=!0)):(o.set(e,n),a=!0):(r.set(t,o=new c),o.set(e,n),a=!0,s=!0),a&&"function"==typeof e.nativeAddEventListener&&this._observeTarget_forEventType_(e,t),s}},unregisterEventListener:{enumerable:!1,value:function(e,t,n,r){return r?this._unregisterEventListener(e,t,n,this._registeredCaptureEventListeners,this._registeredBubbleEventListeners):this._unregisterEventListener(e,t,n,this._registeredBubbleEventListeners,this._registeredCaptureEventListeners)}},_unregisterEventListener:{enumerable:!1,value:function(e,t,n,r,i){var o,a,s=r.get(t);if(s&&(o=s.get(e)))return o===n?(s.set(e,null),void this._unregisterTargetForEventTypeIfNeeded(e,t,o,r,i)):void(Array.isArray(o)&&o.indexOf(n)!==-1&&(this._currentDispatchedTargetListeners.has(o)?(a=this._currentDispatchedTargetListeners.get(o),a||this._currentDispatchedTargetListeners.set(o,a=new c),a.set(n,!0)):(this.spliceOne(o,o.indexOf(n)),this._unregisterTargetForEventTypeIfNeeded(e,t,o,r,i))))}},_unregisterTargetForEventTypeIfNeeded:{value:function(e,t,n,r,i){if(!Array.isArray(n)||0===n.length){var o=r.get(t),a=i.get(t);o["delete"](e),0===o.size&&(!a||a&&0===a.size)&&this._stopObservingTarget_forEventType_(e,t)}}},actualDOMTargetForEventTypeOnTarget:{value:function(e,t){if(t.nativeAddEventListener){if(t.defaultView)return t;var n,r=this.eventDefinitions[e];return r?(n=typeof r.bubbles===_?r.bubbles(t):r.bubbles,n?t.screen?t.document:t.ownerDocument:t):t}return null}},_observedTarget_byEventType_:{value:null},_observeTarget_forEventType_:{enumerable:!1,value:function(e,t){var n;!(n=this.actualDOMTargetForEventTypeOnTarget(t,e))||this._observedTarget_byEventType_[t]&&this._observedTarget_byEventType_[t].has(n)||(this._observedTarget_byEventType_[t]||(this._observedTarget_byEventType_[t]=new c),this._observedTarget_byEventType_[t].set(n,this),n.nativeAddEventListener(t,this,!0))}},_stopObservingTarget_forEventType_:{enumerable:!1,value:function(e,t){var n;n=this.actualDOMTargetForEventTypeOnTarget(t,e),n&&(this._observedTarget_byEventType_[t]["delete"](n),n.nativeRemoveEventListener(t,this,!0))}},_activationHandler:{enumerable:!0,value:null},_listenToWindow:{enumerable:!1,value:function(e){if(!this._activationHandler){var t=this;this._activationHandler=function(e){var n,r=e.type,i="mouseenter"!==r&&"pointerenter"!==r;if(e.changedTouches){n=e.changedTouches.length;for(var o=0;o<n;o++)t._prepareComponentsForActivation(e.changedTouches[o].target,i)}else t._prepareComponentsForActivation(e.target,i)}}if(window.PointerEvent?(e.nativeAddEventListener("pointerdown",this._activationHandler,!0),e.document.nativeAddEventListener("pointerenter",this._activationHandler,!0)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(e.nativeAddEventListener("MSPointerDown",this._activationHandler,!0),e.document.nativeAddEventListener("mouseenter",this._activationHandler,!0)):(e.nativeAddEventListener("touchstart",this._activationHandler,!0),e.nativeAddEventListener("mousedown",this._activationHandler,!0),e.document.nativeAddEventListener("mouseenter",this._activationHandler,!0)),e.nativeAddEventListener("focus",this._activationHandler,!0),this.application){var n,r=this.registeredEventListenersOnTarget_(this.application);for(n in r)this._observeTarget_forEventType_(e,n)}}},_stopListeningToWindow:{enumerable:!1,value:function(e){var t,n,r=this.registeredEventListenersOnTarget_(this.application),i=this.registeredEventListenersOnTarget_(e);for(t in r)this._stopObservingTarget_forEventType_(e,t);for(t in i)this._stopObservingTarget_forEventType_(e,t);(n=this._listeningWindowOnTouchCancel.indexOf(e))>-1&&this.spliceOne(this._listeningWindowOnTouchCancel,n)}},_resetRegisteredEventListeners:{enumerable:!1,value:function(e){var t,n,r=this;for(t in e)n=e.get(t),n&&n.forEach(function(e,n,i){r._stopObservingTarget_forEventType_(n,t)})}},reset:{enumerable:!1,value:function(){this._resetRegisteredEventListeners(this._registeredCaptureEventListeners),this._resetRegisteredEventListeners(this._registeredBubbleEventListeners),this._claimedPointers=new c,this._registeredCaptureEventListeners=new c,this._registeredBubbleEventListeners=new c}},unload:{enumerable:!1,value:function(){this._stopListening()}},_bubbleMethodNameByEventType_:{value:new c},_bubbleMethodNameByEventTypeIdentifier_:{value:new c},methodNameForBubblePhaseOfEventType:{enumerable:!1,value:function(e,t,n,r){var i;return t?(i=this._bubbleMethodNameByEventTypeIdentifier_.get(e)||this._bubbleMethodNameByEventTypeIdentifier_.set(e,new c).get(e),i.get(t)||i.set(t,"handle"+(r||t.toCapitalized())+(n||e.toCapitalized())).get(t)):this._bubbleMethodNameByEventType_.get(e)||this._bubbleMethodNameByEventType_.set(e,"handle"+(n||e.toCapitalized())).get(e)}},_captureMethodNameByEventType_:{value:new c},_catptureMethodNameByEventTypeIdentifier_:{value:new c},methodNameForCapturePhaseOfEventType:{enumerable:!1,value:function(e,t,n,r){var i;return t?(i=this._catptureMethodNameByEventTypeIdentifier_.get(e)||this._catptureMethodNameByEventTypeIdentifier_.set(e,new c).get(e),i.get(t)||i.set(t,"capture"+(r||t.toCapitalized())+(n||e.toCapitalized())).get(t)):this._captureMethodNameByEventType_.get(e)||this._captureMethodNameByEventType_.set(e,"capture"+(n||e.toCapitalized())).get(e)}},_claimedPointers:{enumerable:!1,value:null},componentClaimingPointer:{value:function(e){return this._claimedPointers.get(e)}},isPointerClaimedByComponent:{value:function(e,t){if(!t)throw"Must specify a valid component to see if it claims the specified pointer, '"+t+"' is not valid.";return this._claimedPointers.get(e)===t}},claimPointer:{value:function(e,t){if(!e&&0!==e)throw"Must specify a valid pointer to claim, '"+e+"' is not valid.";if(!t)throw"Must specify a valid component to claim a pointer, '"+t+"' is not valid.";var n=this._claimedPointers.get(e);return n===t||(n?!!n.surrenderPointer(e,t)&&(this._claimedPointers.set(e,t),!0):(this._claimedPointers.set(e,t),!0))}},forfeitPointer:{value:function(e,t){if(t!==this._claimedPointers.get(e))throw"Not allowed to forfeit pointer '"+e+"' claimed by another component";this._claimedPointers["delete"](e)}},forfeitAllPointers:{value:function(e){for(var t,n,r=this._claimedPointers.keys();t=r.next().value;)n=this._claimedPointers.get(t),e===n&&this._claimedPointers["delete"](t)}},_isStoringPointerEvents:{enumerable:!1,value:!1},isStoringPointerEvents:{enumerable:!0,get:function(){return this._isStoringPointerEvents},set:function(e){e===!0?this._isStoringPointerEvents||(this._isStoringPointerEvents=!0,window.PointerEvent||window.MSPointerEvent&&window.navigator.msPointerEnabled?Object.defineProperty(s.prototype,"velocity",{get:function(){return o.pointerMotion(this.pointerId).velocity}}):window.Touch&&Object.defineProperty(Touch.prototype,"velocity",{
get:function(){return o.pointerMotion(this.identifier).velocity}})):(this._isStoringPointerEvents=!1,this._pointerStorage.memory={},this._isMouseDragging=!1)}},_isStoringMouseEventsWhileDraggingOnly:{enumerable:!1,value:!0},isStoringMouseEventsWhileDraggingOnly:{enumerable:!0,get:function(){return this._isStoringMouseEventsWhileDraggingOnly},set:function(e){this._isStoringMouseEventsWhileDraggingOnly=e===!0}},_isMouseDragging:{enumerable:!1,value:!1},_pointerStorage:{enumerable:!1,value:{memory:{},velocity:{},add:function(e,t){this.memory[e]||(this.memory[e]={data:new Array(32),size:0,pos:0}),this.memory[e].data[this.memory[e].pos]=t,this.memory[e].size<this.memory[e].data.length&&this.memory[e].size++,this.memory[e].pos=(this.memory[e].pos+1)%this.memory[e].data.length},remove:function(e){delete this.memory[e]},clear:function(e){this.memory[e]&&(this.memory[e].size=0)},getMemory:function(e){return this.memory[e]},isStored:function(e){return this.memory[e]&&this.memory[e].size>0},storeEvent:function(e){var t=p.isBrowserSupportPointerEvents,n=e instanceof s?e._event:e,r=n.pointerType;if(t&&("mouse"===r||window.MSPointerEvent&&r===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)||!t&&n instanceof MouseEvent)switch(e.type){case"pointerdown":case"MSPointerDown":case"mousedown":o._isMouseDragging=!0;case"pointermove":case"MSPointerMove":case"mousemove":o._isStoringMouseEventsWhileDraggingOnly?o._isMouseDragging&&this._storeMouse(e):this._storeMouse(e);break;case"pointerup":case"MSPointerUp":case"mouseup":this._storeMouse(e)}else if(t&&("touch"===r||window.MSPointerEvent&&r===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)||void 0!==window.TouchEvent&&!t&&n instanceof TouchEvent)switch(n.type){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":this._storeTouch(n.pointerId,n.clientX,n.clientY,n.timeStamp);break;case"touchstart":case"touchmove":this._storeTouches(n.touches,n.timeStamp);break;case"touchend":this._storeTouches(n.changedTouches,n.timeStamp)}},removeEvent:function(e){var t=p.isBrowserSupportPointerEvents,n=e instanceof s?e._event:e;if(t&&("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)||!t&&n instanceof MouseEvent)"mouseup"!==e.type&&"pointerup"!==e.type&&"MSPointerUp"!==e.type||(o._isMouseDragging=!1,o._isStoringMouseEventsWhileDraggingOnly&&this.clear("mouse"));else if((t&&("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)||void 0!==window.TouchEvent&&!t&&n instanceof TouchEvent)&&("touchend"===e.type||"pointerup"===e.type||"MSPointerUp"===e.type))if(e.changedTouches)for(var r,i=0,a=e.changedTouches;r=a[i];i++)this.remove(r.identifier);else this.remove(e.pointerId)},_storeMouse:function(e){this.add("mouse",{clientX:e.clientX,clientY:e.clientY,timeStamp:e.timeStamp}),Object.defineProperty(e,"velocity",{get:function(){return o.pointerMotion("mouse").velocity}})},_storeTouches:function(e,t){for(var n,r=0;n=e[r];r++)this._storeTouch(n.identifier,n.clientX,n.clientY,t)},_storeTouch:function(e,t,n,r){this.add(e,{clientX:t,clientY:n,timeStamp:r})}}},_getPointerVelocityData:{enumerable:!1,value:function(e){var t,n,r,i,a,s,l,u,c,h=0,p=!0,d={x:[],y:[],time:[]};for(t=o._pointerStorage.getMemory(e),n=t.data.length,r=t.data[(t.pos-1+n)%n],i=a=s=r.timeStamp,l=r.clientX,u=r.clientY;p&&a>i-350&&h<t.size;)r=t.data[(t.pos-h-1+n)%n],a=r.timeStamp,c=l*l+u*u,c>2&&s-a<=50?(d.x.push(r.clientX),d.y.push(r.clientY),d.time.push(a),s=a,l=r.clientX,u=r.clientY,h++):p=!1;return d}},_fitPointerCurve:{enumerable:!1,value:function(e,t){var n,r,i,o,a,s,l,u,c,h,p,d,f,v,m,g,_,b,y,w,E,C,O,j,P,T,k,x,A,D,S,L,M,R,F,z,I,N,B=1e-4,U=t.length;do{for(p=d=f=v=m=g=b=y=w=E=C=O=P=T=k=x=A=D=L=M=R=F=z=I=0,h=0;h<U;h++)a=t[h],s=a.t,u=s*s,c=u*s,l=a.v,_=B*(6*(u-s)-c+2),j=6*B*(c-2*u+s),S=6*B*(u-c),N=2*B*c,g+=_*_,O+=j*j,D+=S*S,I+=N*N,p+=l*_,b+=l*j,P+=l*S,L+=l*N,f-=_,w-=j,k-=S,R-=N,d-=_*s,y-=j*s,T-=S*s,M-=N*s,v-=_*u,E-=j*u,x-=S*u,F-=N*u,m-=_*c,C-=j*c,A-=S*c,z-=N*c;B*=2}while(0===g||0===O||0===D||0===I);for(s=B/g,p*=s,d*=3*s,f*=s,v*=3*s,m*=s,s=B/O,b*=s,y*=3*s,w*=s,E*=3*s,C*=s,s=B/D,P*=s,T*=3*s,k*=s,x*=3*s,A*=s,s=B/I,L*=s,M*=3*s,R*=s,F*=3*s,z*=s,g=e[0],O=e[1],D=e[2],I=e[3],n=3*(O-D)+I-g,r=g+D-2*O,i=O-g,o=g,h=0;h<20;h++)s=p+o*f+i*d+r*v+n*m,g+=s,o+=s,n-=s,r+=s,i-=s,s=b+o*w+i*y+r*E+n*C,O+=s,n+=3*s,r-=s+s,i+=s,s=P+o*k+i*T+r*x+n*A,D+=s,n-=3*s,r+=s,s=L+o*R+i*M+r*F+n*z,I+=s,n+=s;e[0]=g,e[1]=O,e[2]=D,e[3]=I}},_pointerBezierValue:{enumerable:!1,value:function(e,t){var n=1-e;return n*n*n*t[0]+3*n*n*e*t[1]+3*n*e*e*t[2]+e*e*e*t[3]}},_calculatePointerVelocity:{enumerable:!1,value:function(e,t){var n,r,i=e.length,o=e[0],a=e[0],s=0;for(r=1;r<i;r++)e[r]<o&&(o=e[r],s=r);if(n=a-o){if(i>5){var l,u,c,h=[];for(r=0;r<i;r++)h[r]={v:t[r],t:(e[r]-o)/n};return l=h[s].v,u=h[0].v,c=[l,(2*l+u)/3,(l+2*u)/3,u],this._fitPointerCurve(c,h),5e3*(this._pointerBezierValue(.8,c)-this._pointerBezierValue(.6,c))/n}return i>1?1e3*(t[0]-t[s])/n:0}return 0}},pointerMotion:{value:function(e){return o._pointerStorage.isStored(e)?{velocity:(new d).initWithIdentifier(e)}:void 0}},monitorDOMModificationInEventHandling:{value:!1},domModificationEventHandler:{value:a.specialize({handleEvent:{value:function(e){throw"DOM Modified"}},captureDOMSubtreeModified:{value:function(e){throw"DOMSubtreeModified"}},captureDOMAttrModified:{value:function(e){throw"DOMAttrModified"}},captureDOMCharacterDataModified:{value:function(e){throw"DOMCharacterDataModified"}}})},_trackingTouchStartList:{value:null},_trackingTouchEndList:{value:null},_trackingTouchTimeoutIDs:{value:null},_wouldTouchTriggerSimulatedEvent:{value:function(e){switch(e.type){case"touchstart":case"touchend":return!0;default:return!1}}},_couldEventBeSimulated:{value:function(e){switch(e.type){case"mousedown":case"mouseup":case"click":return!0;default:return!1}}},_listeningWindowOnTouchCancel:{value:[]},_findWindowFromEvent:{value:function(e){var t,n=e.target;return n&&(t=n instanceof Window?n:n.defaultView instanceof Window?n.defaultView:n.ownerDocument&&n.ownerDocument.defaultView?n.ownerDocument.defaultView:null),t}},_isWindowListeningOnTouchCancel:{value:function(e){return this._registeredWindows.indexOf(e)>-1&&this._listeningWindowOnTouchCancel.indexOf(e)>-1}},_listenToTouchCancelIfNeeded:{value:function(e){var t=this._findWindowFromEvent(e);if(t&&!this._isWindowListeningOnTouchCancel(t)){var n=this;t.addEventListener("touchcancel",function(e){for(var t,r=e.changedTouches,i=n._trackingTouchStartList,o=0,a=r.length;o<a;o++)t=r[o].identifier,i.has(t)&&i["delete"](t)},!0),this._listeningWindowOnTouchCancel.push(t)}}},_blocksEmulatedEvents:{value:!0},blocksEmulatedEvents:{get:function(){return this._blocksEmulatedEvents},set:function(e){e!==this._blocksEmulatedEvents&&(this._blocksEmulatedEvents=e,this._evaluateShouldDispatchEventCondition())}},_shouldDispatchEventCondition:{value:void 0},_evaluateShouldDispatchEventCondition:{value:function(){this._shouldDispatchEventCondition=this.blocksEmulatedEvents&&!window.PointerEvent&&!(window.MSPointerEvent&&window.navigator.msPointerEnabled)}},_shouldDispatchEvent:{value:function(e){if(this._shouldDispatchEventCondition){if(this.environment.isIOSDevice&&this.environment.isWKWebView){if(0===e.timeStamp)return!1;if(this._couldEventBeSimulated(e)&&!e.hasOwnProperty("movementX"))return!1}if(this.environment.isAndroidDevice&&this._couldEventBeSimulated(e))return!1;if(this._wouldTouchTriggerSimulatedEvent(e)){var t=e.changedTouches;this._listenToTouchCancelIfNeeded(e);for(var n=0,r=t.length;n<r;n++)this._trackTouch(e,t[n])}else if(this._couldEventBeSimulated(e))return!this._isEmulatedEvent(e)}return!0}},_trackTouch:{value:function(e,t){var n=this._trackingTouchTimeoutIDs,r=this._trackingTouchStartList,i=this._trackingTouchEndList,o=t.identifier;if(t.timeStamp=e.timeStamp,"touchstart"===e.type){var a=n.get(o);a&&(clearTimeout(a),n["delete"](o)),r.set(o,t)}else n.set(o,setTimeout(function(){i["delete"](o),delete n[o]},400)),r["delete"](o),i.set(o,t)}},_isEmulatedEvent:{value:function(e){var t=this._findEmulatedEventIdentifierWithEventAndTrackingTouchList(e,this._trackingTouchStartList)>-1;if(!t){var n=this._trackingTouchEndList,r=this._findEmulatedEventIdentifierWithEventAndTrackingTouchList(e,n);if((t=r>-1)&&"click"===e.type){var i=this._trackingTouchTimeoutIDs,o=i.get(r);o&&(clearTimeout(o),n["delete"](r),i["delete"](r))}}return t}},_emulatedEventTimestampThreshold:{value:20},_emulatedEventRadiusThreshold:{value:20},_findEmulatedEventIdentifierWithEventAndTrackingTouchList:{value:function(e,t){var n,r,i,o=e.target,a=-1;for(i=t.keys();n=i.next().value;)if(r=t.get(n),r.target===o||this._couldEmulatedEventHaveWrongTarget(r,e,this._emulatedEventRadiusThreshold,this._emulatedEventTimestampThreshold)){a=n;break}return a}},_couldEmulatedEventHaveWrongTarget:{value:function(e,t,n,r){if(t.timeStamp-e.timeStamp<=r){var i=e.clientX-t.clientX,o=e.clientY-t.clientY;return i*i+o*o<=n*n}return!1}},_currentDispatchedTargetListeners:{value:null},_processCurrentDispatchedTargetListenersToRemove:{value:function(e,t,n,r){var i,o,a=this._currentDispatchedTargetListeners.get(r);a&&a.size>0&&(r.removeObjects(a),i=n?this._registeredCaptureEventListeners:this._registeredBubbleEventListeners,o=n?this._registeredBubbleEventListeners:this._registeredCaptureEventListeners,this._unregisterTargetForEventTypeIfNeeded(e,t,r,i,o))}},handleEvent:{enumerable:!1,value:function(e){if(!(e instanceof UIEvent)||this._shouldDispatchEvent(e)){this.monitorDOMModificationInEventHandling&&(document.body.addEventListener("DOMSubtreeModified",this.domModificationEventHandler,!0),document.body.addEventListener("DOMAttrModified",this.domModificationEventHandler,!0),document.body.addEventListener("DOMCharacterDataModified",this.domModificationEventHandler,!0));var t,n,r,i,o,a,l,u,c,h,p,d,b,y,w=e.type,E=w.toCapitalized(),C=e.bubbles,O=this._currentDispatchedTargetListeners,j=this._registeredCaptureEventListeners,P=this._registeredBubbleEventListeners;for("DOMContentLoaded"===w&&(t=e.target.defaultView,t&&this._windowsAwaitingFinalRegistration.has(t)&&(this._finalizeWindowRegistration(t),e.target.removeEventListener("DOMContentLoaded",this,!0))),b="boolean"!=typeof e.propagationStopped?s.fromEvent(e):e,y=b.target,l=Element.isElement(y)||y instanceof Document||y===window?this._eventPathForDomTarget(y):this._eventPathForTarget(y),y.identifier?(d=y.identifier.toCapitalized(),h=this.methodNameForCapturePhaseOfEventType(w,y.identifier,E,d),p=this.methodNameForBubblePhaseOfEventType(w,y.identifier,E,d)):(h=null,p=null),u=this.methodNameForCapturePhaseOfEventType(w,null,E),c=this.methodNameForBubblePhaseOfEventType(w,null,E),this.delegate&&typeof this.delegate.willDistributeEvent===_&&this.delegate.willDistributeEvent(b),this._isStoringPointerEvents&&this._pointerStorage.storeEvent(b),b.eventPhase=v,n=l.length-1;!b.propagationStopped&&(i=l[n]);n--)if(b.currentTarget=i,o=this._registeredEventListenersForEventType_onTarget_registeredEventListeners_(w,i,j))if(Array.isArray(o)){for(r=0,O.set(o,null);(a=o[r++])&&!b.immediatePropagationStopped;)this._invokeTargetListenerForEvent(i,a,b,h,u);this._processCurrentDispatchedTargetListenersToRemove(i,w,!0,o),O["delete"](o)}else this._invokeTargetListenerForEvent(i,o,b,h,u);if(!b.propagationStopped){if(b.eventPhase=m,b.currentTarget=i=y,o=this._registeredEventListenersForEventType_onTarget_registeredEventListeners_(w,i,j))if(Array.isArray(o)){for(r=0,O.set(o,null);(a=o[r++])&&!b.immediatePropagationStopped;)this._invokeTargetListenerForEvent(i,a,b,h,u);this._processCurrentDispatchedTargetListenersToRemove(i,w,!0,o),O["delete"](o)}else this._invokeTargetListenerForEvent(i,o,b,h,u);if(o=this._registeredEventListenersForEventType_onTarget_registeredEventListeners_(w,i,P))if(Array.isArray(o)){for(r=0,O.set(o,null);(a=o[r++])&&!b.immediatePropagationStopped;)this._invokeTargetListenerForEvent(i,a,b,p,c);this._processCurrentDispatchedTargetListenersToRemove(i,w,!1,o),O["delete"](o)}else this._invokeTargetListenerForEvent(i,o,b,p,c)}for(b.eventPhase=g,n=0;C&&!b.propagationStopped&&(i=l[n]);n++)if(b.currentTarget=i,o=this._registeredEventListenersForEventType_onTarget_registeredEventListeners_(w,i,P))if(Array.isArray(o)){for(r=0,O.set(o,null);(a=o[r++])&&!b.immediatePropagationStopped;)this._invokeTargetListenerForEvent(i,a,b,p,c);this._processCurrentDispatchedTargetListenersToRemove(i,w,!1,o),O["delete"](o)}else this._invokeTargetListenerForEvent(i,o,b,p,c);b.eventPhase=f,b.currentTarget=null,this._isStoringPointerEvents&&this._pointerStorage.removeEvent(e),this.monitorDOMModificationInEventHandling&&(document.body.removeEventListener("DOMSubtreeModified",this.domModificationEventHandler,!0),document.body.removeEventListener("DOMAttrModified",this.domModificationEventHandler,!0),document.body.removeEventListener("DOMCharacterDataModified",this.domModificationEventHandler,!0))}}},_invokeTargetListenerForEvent:{value:function(e,t,n,r,i){var o=_;typeof t===o?t.call(e,n):r&&typeof t[r]===o?t[r](n):typeof t[i]===o?t[i](n):typeof t.handleEvent===o&&t.handleEvent(n)}},_prepareComponentsForActivation:{value:function(e,t){var n,r,i=e,o=i&&i.defaultView?i.defaultView:window,a=o.document?o.document:document,s=!1,l=null;do switch(i&&(r=this.eventHandlerForElement(i),r&&(s||(s=!0,l=this._findActiveTarget(r)),r.preparedForActivationEvents||r._prepareForActivationEvents())),n=i,i){case o:i=null;break;case a:i=o;break;case a.documentElement:i=a;break;default:i=i.parentNode}while(i&&n!==i);t&&(this.activeTarget=l)}},_findActiveTarget:{value:function(e){for(var t=null,n=new h;!t&&e&&!n.has(e);)n.set(e,!0),e.acceptsActiveTarget?t=e:e=e.nextTarget;return t}},_eventPathForTarget:{enumerable:!1,value:function(e){if(!e)return[];var t=e,n=this.application,r=[],i=new h;i.set(e,!0);do i.has(t)||(r.push(t),i.set(t,!0)),t=t.nextTarget,t&&!i.has(t)||(t=n),t&&i.has(t)&&(t=null);while(t);return r}},_eventPathForDomTarget:{enumerable:!1,value:function(e){if(!e)return[];var t,n=e,r=n&&n.defaultView?n.defaultView:window,i=r.document?r.document:document,o=this.application,a=[];do switch(n!==e&&a.push(n),t=n,n){case o:n=n.parentApplication,n&&(o=n);break;case r:n=o;break;case i:n=r;break;case i.documentElement:n=i;break;default:n=n.parentNode,n||(n=o)}while(n&&t!==n);return a}},_elementEventHandlerByElement:{enumerable:!1,value:null},registerEventHandlerForElement:{enumerable:!1,value:function(e,t){var n=this.eventHandlerForElement(t);n&&this.unregisterEventHandlerForElement(t),this._elementEventHandlerByElement.set(t,e)}},unregisterEventHandlerForElement:{enumerable:!1,value:function(e){this._elementEventHandlerByElement["delete"](e)}},eventHandlerForElement:{enumerable:!1,value:function(e){return this._elementEventHandlerByElement.get(e)}},_activeTarget:{value:null},activeTarget:{get:function(){return this._activeTarget||this.application},set:function(e){e||(e=this.application),e===this._activeTarget||this.activeTarget&&!this.activeTarget.surrendersActiveTarget(e)||e&&(e.willBecomeActiveTarget(this.activeTarget),this._activeTarget=e,e.didBecomeActiveTarget())}}})}}}),montageDefine("ad36237","core/serialization/deserializer/montage-reviver",{dependencies:["../../core","./properties-deserializer","./self-deserializer","./unit-deserializer","../../module-reference","../alias","../../promise"],factory:function(e,t,n){var r=e("../../core").Montage,i=e("./properties-deserializer").PropertiesDeserializer,o=e("./self-deserializer").SelfDeserializer,a=e("./unit-deserializer").UnitDeserializer,s=e("../../module-reference").ModuleReference,l=e("../alias").Alias,u=e("../../promise").Promise,c=r.specialize({_require:{value:null},_objectRequires:{value:null},init:{value:function(e,t){if("function"!=typeof e)throw new Error("Function 'require' missing.");if("string"!=typeof e.location)throw new Error("Function 'require' location is missing");if("object"!=typeof t&&"undefined"!=typeof t)throw new Error("Parameter 'objectRequires' should be an object.");return this._require=e,this._objectRequires=t,this}},getExports:{value:function(e,t){var n;for(t=e.resolve(t),n=e.getModuleDescriptor(t);void 0!==n.redirect;)n=e.getModuleDescriptor(n.redirect);return void 0!==n.mappingRedirect?this.getExports(n.mappingRequire,n.mappingRedirect):n.exports}},getModule:{value:function(e,t){var n,r,i=this._objectRequires;return n=i&&t in i?i[t]:this._require,r=this.getExports(n,e),r||(r=n.async(e)),r}}}),h=t.MontageReviver=r.specialize({moduleLoader:{value:null},init:{value:function(e,t){return this.moduleLoader=(new c).init(e,t),this._require=e,this}},getTypeOf:{value:function(e){var t=typeof e;if(null===e)return"null";if(Array.isArray(e))return"array";if("object"===t&&1===Object.keys(e).length){if("@"in e)return"reference";if("/"in e)return"regexp";if("#"in e)return"Element";if("%"in e)return"Module"}return t}},_checkLabel:{value:function(e,t){return t&&":"!==e[0]?new Error('Aliases can only be defined in template properties (start with a colon (:)), "'+e+'".'):t||":"!==e[0]?void 0:new Error('Only aliases are allowed as template properties (start with a colon (:), "'+e+'".')}},reviveRootObject:{value:function(e,t,n){var r,i="alias"in e;if(r=this._checkLabel(n,i))return u.reject(r);var o;if(e["debugger"]&&console.log("enable debugger statement here"),"value"in e){if(t.hasUserObject(n))return o=t.getUserObject(n),t.setObjectLabel(o,n),o;var a;if("Element"===this.getTypeOf(e.value)){if(a=this.reviveElement(e.value,t,n),!u.is(a)){var s=this.reviveObjectLiteral(e,t);t.setUnitsToDeserialize(a,s,h._unitNames)}}else a=this.reviveValue(e.value,t,n);return a}return 0===Object.keys(e).length?t.hasUserObject(n)?(o=t.getUserObject(n),t.setObjectLabel(o,n),o):this.reviveExternalObject(e,t,n):this.reviveCustomObject(e,t,n)}},reviveElement:{value:function(e,t,n){var r=e["#"],i=t.getElementById(r);return i?(n&&t.setObjectLabel(i,n),i):u.reject(new Error("Element with id '"+r+"' was not found."))}},reviveModule:{value:function(e,t,n){var r=e["%"],i=t.getRequire();r=i.resolve(r);var o=i.getModuleDescriptor(r);return(new s).initWithIdAndRequire(o.id,o.require)}},reviveCustomObject:{value:function(e,t,n){return"alias"in e?this.reviveAlias(e,t,n):this.reviveMontageObject(e,t,n)}},reviveMontageObject:{value:function(e,t,n){var r,i,o,a=this,s=e.prototype||e.object;return s&&(i=h.parseObjectLocationId(s),r=this.moduleLoader.getModule(i.moduleId,n),o=i.objectName),u.is(r)?r.then(function(r){return"object"in e&&e.object.endsWith(".mjson")?a.instantiateMjsonObject(r,i.moduleId):a.instantiateMontageObject(e,r,o,t,n)},function(t){throw t.stack&&console.error(t.stack),new Error('Error deserializing "'+n+'" when loading module "'+i.moduleId+"' from '"+e.prototype+"' cause: "+t.message)}):"object"in e&&e.object.endsWith(".mjson")?a.instantiateMjsonObject(r,i.moduleId):this.instantiateMontageObject(e,r,o,t,n)}},instantiateMjsonObject:{value:function(t,n){var r=this,i=function(e,t){for(var n=e.resolve(t),r=e.getModuleDescriptor(n);r.redirect||r.mappingRedirect;)r.redirect?n=r.redirect:(e=r.mappingRequire,n=r.mappingRedirect),r=e.getModuleDescriptor(n);return r.require};return e.async("core/serialization/deserializer/montage-deserializer").then(function(e){return(new e.MontageDeserializer).init(JSON.stringify(t),i(r._require,n)).deserializeObject()})}},instantiateMontageObject:{value:function(e,t,n,r,i){var o,a,s=this;return o=this.getMontageObject(e,t,n,r,i),r.setObjectLabel(o,i),null!==o&&void 0!==o&&(o.isDeserializing=!0),a=this.reviveObjectLiteral(e,r),u.is(a)?a.then(function(e){return s.deserializeMontageObject(e,o,r,i)}):this.deserializeMontageObject(a,o,r,i)}},deserializeMontageObject:{value:function(e,t,n,r){var i;return"function"==typeof t.deserializeSelf?this.deserializeCustomMontageObject(t,e,n,r):(n.setUnitsToDeserialize(t,e,h._unitNames),i=this.deserializeMontageObjectProperties(t,e.properties,n),u.is(i)?i.then(function(){return t}):t)}},deserializeMontageObjectProperties:{value:function(e,t,n){var r;if("function"==typeof e.deserializeProperties){var o=(new i).initWithReviverAndObjects(this,n);r=e.deserializeProperties(o)}else for(var a in t)e[a]=t[a];return r}},deserializeCustomMontageObject:{value:function(e,t,n,r){var i,a=(new o).initWithObjectAndObjectDescriptorAndContextAndUnitNames(e,t,n,h._unitNames);return i=e.deserializeSelf(a),u.is(i)?i.then(function(e){return n.setObjectLabel(e,r),e}):"undefined"!=typeof i?(n.setObjectLabel(i,r),i):e}},getMontageObject:{value:function(e,t,n,r,i){var o;if(r.hasUserObject(i))return r.getUserObject(i);if("prototype"in e){if(!(n in t))throw new Error('Error deserializing "'+i+'": object named "'+n+'" was not found in "'+e.prototype+'". Available objects are: '+Object.keys(t)+".");return o=Object.create(t[n].prototype),o.isDeserializing=!0,"function"==typeof o.didCreate?o.didCreate():"function"==typeof o.constructor&&o.constructor(),o}if("object"in e){if(e.object.endsWith(".json"))return t;if(!(n in t))throw new Error('Error deserializing "'+i+'": object named "'+o+"' was not found given '"+e.object+"'");return t[n]}throw new Error("Error deserializing "+JSON.stringify(e)+', might need "prototype" or "object" on label '+JSON.stringify(i))}},reviveAlias:{value:function(e,t,n){var r=new l;return r.value=e.alias,t.setObjectLabel(r,n),r}},didReviveObjects:{value:function(e,t){var n,r=this;return n=this._deserializeUnits(t),u.is(n)?n.then(function(){r._invokeDeserializedFromSerialization(e,t)}):void this._invokeDeserializedFromSerialization(e,t)}},_invokeDeserializedFromSerialization:{value:function(e,t){var n;for(var r in e)n=e[r],null!==n&&void 0!==n&&delete n.isDeserializing,t.hasUserObject(r)||n&&"function"==typeof n.deserializedFromSerialization&&n.deserializedFromSerialization(r)}},_deserializeUnits:{value:function(e){var t,n,r=e.getUnitsToDeserialize(),i=h._unitRevivers;try{for(var o,s=0;o=r[s];s++){t=o.unitNames;for(var l,c=0;l=t[c];c++)l in o.objectDesc&&(n=(new a).initWithContext(e),i[l](n,o.object,o.objectDesc[l]))}}catch(p){return u.reject(p)}}},_createAssignValueFunction:{value:function(e,t){return function(n){e[t]=n}}},getCustomObjectTypeOf:{writable:!0,value:function(){}},reviveValue:{value:function(e,t,n){var r=this.getTypeOf(e);return"string"===r||"number"===r||"boolean"===r||"null"===r||"undefined"===r?this.reviveNativeValue(e,t,n):"regexp"===r?this.reviveRegExp(e,t,n):"reference"===r?this.reviveObjectReference(e,t,n):"array"===r?this.reviveArray(e,t,n):"object"===r?this.reviveObjectLiteral(e,t,n):"Element"===r?this.reviveElement(e,t,n):this._callReviveMethod("revive"+r,e,t,n)}},reviveNativeValue:{value:function(e,t,n){return n&&t.setObjectLabel(e,n),e}},reviveObjectLiteral:{value:function(e,t,n){var r,i=[];n&&t.setObjectLabel(e,n);for(var o in e)r=this.reviveValue(e[o],t),u.is(r)?i.push(r.then(this._createAssignValueFunction(e,o))):e[o]=r;return 0===i.length?e:u.all(i).then(function(){return e})}},reviveRegExp:{value:function(e,t,n){var e=e["/"],r=new RegExp(e.source,e.flags);return n&&t.setObjectLabel(r,n),r}},reviveObjectReference:{value:function(e,t,n){var e=e["@"],r=t.getObject(e);return r}},reviveArray:{value:function(e,t,n){var r,i=[];n&&t.setObjectLabel(e,n);for(var o=0,a=e.length;o<a;o++)r=this.reviveValue(e[o],t),u.is(r)?i.push(r.then(this._createAssignValueFunction(e,o))):e[o]=r;return 0===i.length?e:u.all(i).then(function(){return e})}},reviveExternalObject:{value:function(e,t,n){return u.reject(new Error("External object '"+n+"' not found in user objects."))}},_callReviveMethod:{value:function(e,t,n,r){return this[e](t,n,r)}}},{_unitRevivers:{value:Object.create(null)},_unitNames:{value:[]},_findObjectNameRegExp:{value:/([^\/]+?)(\.reel)?$/},_toCamelCaseRegExp:{value:/(?:^|-)([^-])/g},_replaceToCamelCase:{value:function(e,t){return t.toUpperCase()}},_locationDescCache:{value:Object.create(null)},customObjectRevivers:{value:Object.create(null)},parseObjectLocationId:{value:function(e){var t,n,r,i,o=this._locationDescCache;return e in o?t=o[e]:(n=e.indexOf("["),n>0?(r=e.substr(0,n),i=e.slice(n+1,-1)):(r=e,this._findObjectNameRegExp.test(e),i=RegExp.$1.replace(this._toCamelCaseRegExp,this._replaceToCamelCase)),t={moduleId:r,objectName:i},o[e]=t),t}},defineUnitReviver:{value:function(e,t){this._unitRevivers[e]=t,this._unitNames.push(e)}},getTypeOf:{value:function(e){return this.prototype.getTypeOf.call(this,e)}},addCustomObjectReviver:{value:function(e){var t=this.customObjectRevivers;for(var n in e)if("getTypeOf"!==n&&"function"==typeof e[n]&&/^revive/.test(n)){if("undefined"!=typeof t[n])return new Error("Reviver '"+n+"' is already registered.");t[n]=e[n].bind(e)}this.prototype.getCustomObjectTypeOf=this.makeGetCustomObjectTypeOf(e.getTypeOf)}},resetCustomObjectRevivers:{value:function(){this.customObjectRevivers=Object.create(null),this.prototype.getCustomObjectTypeOf=function(){}}},makeGetCustomObjectTypeOf:{value:function(e){var t=this.prototype.getCustomObjectTypeOf;return function(n){return e(n)||t(n)}}}});"undefined"!=typeof t&&(t.MontageReviver=h)}}),montageDefine("ad36237","core/logger",{dependencies:["./extras/console","./core"],factory:function(e,t,n){function r(e){var t=function(e){return this._color=e,this};for(var n in d)t[n]=function(t){return function(){return e.color(d[t])}}(n);e.color=t}var i,o,a,s,l,u,c,h=e("./extras/console").console,p=e("./core").Montage;o=t.loggers={},s=function(e){var t,n=s.caller.caller;return t=n.name,""===t&&(t="anonymous"),t},l=function(e){if(e.getHours){var t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return(1===t.length?"0"+t:t)+":"+(1===n.length?"0"+n:n)+":"+(1===r.length?"0"+r:r)+"."+e.getMilliseconds()}},a=function(){h.log(arguments)},i=t.Logger=p.specialize({constructor:{value:function(){this.debug=Function.noop,this.error=Function.noop,r(this)}},init:{value:function(e,t,n){if(this.name=e,this._onStateChange=t,this._storeState=!n,this._storeState&&c){var r=c.getItem("_montage_logger_"+e);r&&(this.isDebug="true"===r)}return t&&this._onStateChange("true"===r),this.isError=!0,this}},name:{value:null},_buffer:{value:null},buffer:{get:function(){return this._buffer||(this._buffer=[])}},buffered:{value:!1},flush:{value:function(){var e,t,n=this.buffer;for(t=0;e=n[t];t++)this._formattedLog(e);this.buffer.length=0}},isDebug:{get:function(){return this.debug!==Function.noop},set:function(e){e?this.debug=this._consoleLogMontage:this.debug=Function.noop}},isError:{get:function(){return this.error!==Function.noop},set:function(e){e?this.error=this._consoleLogMontage:this.error=Function.noop}},_consoleLogMontage:{value:function(){var e=arguments[0],t=e._montage_metadata;new Date,t?(Array.prototype.shift.call(arguments),Array.prototype.unshift.call(arguments,t.objectName+"."+s(e)+"()"),this.buffered?this.buffer.push(arguments):this._formattedLog(arguments)):this.buffered?this.buffer.push(arguments):this._formattedLog(arguments)}},_formattedLog:{value:function(e){var t=e[0];m.isDebug&&"string"==typeof t&&Array.prototype.splice.call(e,0,1,"%c"+t,this._logCss),h.log.apply(h,e)}},__logCss:{value:null},_logCss:{get:function(){return null===this.__logCss&&(this.__logCss="",this._color?this.__logCss+="color:"+this._color+";":this.__logCss+="color:black;"),this.__logCss}},debug:{value:null},error:{value:null},toTimeString:{value:l},_storeState:{value:null},_onStateChange:{value:null}});var d={base03:"#002b36",base02:"#073642",base01:"#586e75",base00:"#657b83",base0:"#839496",base1:"#93a1a1",base2:"#eee8d5",base3:"#fdf6e3",yellow:"#b58900",orange:"#cb4b16",red:"#dc322f",magenta:"#d33682",violet:"#6c71c4",blue:"#268bd2",cyan:"#2aa198",green:"#859900"};t.logger=function(e,t,n){var r;return null==(r=o[e])&&(r=(new i).init(e,t,n),p.defineProperty(o,e,{value:r})),r},u=p.specialize({init:{value:function(){return document.nativeAddEventListener?(document.nativeAddEventListener("keyup",this,!1),document.nativeAddEventListener("keydown",this,!1)):(document.addEventListener("keyup",this,!1),document.addEventListener("keydown",this,!1)),this}},inspectorElement:{value:null},m_dontRemove:{value:null},titleHeader:{value:null},shown:{value:!1},isCtrl:{value:!1},isAlt:{value:!1},keyup:{value:function(e){17==e.which&&(this.isCtrl=!1),18==e.which&&(this.isAlt=!1)}},keydown:{value:function(e){if(17==e.which&&(this.isCtrl=!0),18==e.which&&(this.isAlt=!0),76==e.which&&this.isCtrl===!0&&this.isAlt===!0)return this.shown?this.hideInspector():this.showInspector(),!1}},change:{value:function(e){var t=e.target.checked,n=e.target.value,r=o[n];r.isDebug=t,r._onStateChange&&r._onStateChange(t),r._storeState&&c&&c.setItem("_montage_logger_"+n,t)}},mouseup:{value:function(e){this.hideInspector()}},showInspector:{value:function(){if(!this.inspectorElement){var e,t,n,r,i,a,s,l,u,h,p,d=0;for(this.m_dontRemove=document.getElementsByTagName("body")[0],this.inspectorElement=document.createElement("div"),this.inspectorElement.id="_montage_logger_inspector",t=document.createElement("div"),this.inspectorElement.appendChild(t),r=document.createElement("div"),t.appendChild(r),n=document.createElement("h1"),n.className="_montage_logger_inspector-title",n.textContent="Logger Inspector",this.titleHeader=n,r.appendChild(n),u=Object.keys(o),d=0;e=o[u[d]];d++)i=document.createElement("label"),a=document.createElement("input"),p=document.createElement("span"),i.className="_montage_logger_inspector-content",p.textContent=e.name,i.appendChild(a),i.appendChild(p),a.value=e.name,a.type="checkbox",a.checked=!!e.isDebug,l="_montage_logger_"+e.name,e._storeState&&c&&(s=c.getItem(l),null==s&&c.setItem(l,e.isDebug)),r.appendChild(i);h=document.createElement("style");var f="#_montage_logger_inspector {";f+="    border: 1px solid rgba(15,15,15,0.4);",f+="    position: fixed;",f+="    right: 25px;",f+="    top: 25px;",f+="    -webkit-border-radius: 5px;",f+="    color: #dddddd;",f+='    font: 10px "Lucida Grande","Lucida Sans", sans;',f+="    background:-webkit-gradient(linear, left top, left bottom, from(rgba(15,15,15,0.75)), to(rgba(15,15,15,0.95)) );",f+="    -webkit-box-shadow: 0 0 15px rgba(0,0,0,.3);",f+="    width: 250px;",f+="}",f+="#_montage_logger_inspector div {",f+="    -webkit-border-radius: 5px;",f+="    background: -webkit-gradient(radial, 100 -60, 0, 125 -50, 125, from(rgba(255,255,255,0.00)), to(rgba(0,0,0,.2)), color-stop(1, rgba(0,0,0,.2)));",f+="}",f+="#_montage_logger_inspector div div {",f+="    background: -webkit-gradient(linear, left top, left bottom, from(rgba(255,255,255,0.2)), to(rgba(0,0,0,.1)), color-stop(0.33, rgba(255,255,255,.01)), color-stop(0.33, rgba(50,50,50,1)) );",f+="    padding: 7px 10px;",f+="    -webkit-border-radius: 3px;",f+="    overflow-x: hidden;",f+="}",f+="._montage_logger_inspector-title {",f+="    color: rgba(255,255,255,0.9);",f+="    font-size: 13px;",f+="    margin: 0 0 11px 0;",f+="    padding: 0 0 0 5px;",f+="}",f+="._montage_logger_inspector-content {",f+="    padding: 0 0 0 20px;",f+="    margin: 0;",f+="    display: block;",f+="}",h.textContent=f,document.head.appendChild(h)}this.shown=!0,this.m_dontRemove.appendChild(this.inspectorElement),this.titleHeader.nativeAddEventListener("mouseup",this,!1),this.inspectorElement.nativeAddEventListener("change",this,!1)}},hideInspector:{value:function(){document.getElementById("_montage_logger_inspector")&&(this.shown=!1,this.m_dontRemove.removeChild(this.inspectorElement),this.titleHeader.nativeRemoveEventListener("mouseup",this,!1),this.inspectorElement.nativeRemoveEventListener("change",this,!1))}},handleEvent:{enumerable:!1,value:function(e){this[e.type]&&this[e.type](e)}}});var f=function(){(new u).init()};if("undefined"!=typeof window){try{c=window.localStorage}catch(v){h.log("Error accessing localStorage",v)}window.loggers=o,c&&f()}var m=t.logger("colors")}}),montageDefine("ad36237","core/serialization/deserializer/properties-deserializer",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage,i=r.specialize({_object:{value:null},_objectDescriptor:{value:null},_context:{value:null
},initWithObjectAndObjectDescriptorAndContext:{value:function(e,t,n){return this._object=e,this._objectDescriptor=t,this._context=n,this}},get:{value:function(e){if(this._objectDescriptor.properties)return this._objectDescriptor.properties[e]}},deserializeProperties:{value:function(e){var t,n=this._object,i=this._objectDescriptor.properties;if(i){e||(e=r.getSerializablePropertyNames(n));for(var o=0,a=e.length;o<a;o++)t=e[o],n[t]=i[t]}}},getObjectByLabel:{value:function(e){this._context.getObject(e)}}});t.PropertiesDeserializer=i}}),montageDefine("ad36237","core/serialization/deserializer/self-deserializer",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage,i=r.specialize({_object:{value:null},_objectDescriptor:{value:null},_context:{value:null},_unitNames:{value:null},_objectUnitNames:{value:null},create:{value:function(){return new this}},initWithObjectAndObjectDescriptorAndContextAndUnitNames:{value:function(e,t,n,r){return this._object=e,this._objectDescriptor=t,this._context=n,this._unitNames=r,this}},getProperty:{value:function(e){if(this._objectDescriptor.properties)return this._objectDescriptor.properties[e]}},getType:{value:function(){return"prototype"in this._objectDescriptor?"prototype":"object"in this._objectDescriptor?"object":void 0}},getTypeValue:{value:function(){return this._objectDescriptor.prototype||this._objectDescriptor.object}},getObjectByLabel:{value:function(e){this._context.getObject(e)}},deserializeProperties:{value:function(e){var t,n=this._object,i=this._objectDescriptor.properties;if(i){e||(e=r.getSerializablePropertyNames(n));for(var o=0,a=e.length;o<a;o++)t=e[o],n[t]=i[t]}}},deserializeUnit:{value:function(e){var t=this._objectUnitNames;t?t.indexOf(e)===-1&&t.push(e):(t=this._objectUnitNames=[e],this._context.setUnitsToDeserialize(this._object,this._objectDescriptor,t))}},deserializeUnits:{value:function(){var e=this._objectUnitNames;if(e)for(var t,n=0;t=e[n];n++)e.indexOf(t)===-1&&e.push(t);else e=this._objectUnitNames=this._unitNames,this._context.setUnitsToDeserialize(this._object,this._objectDescriptor,e)}}});t.SelfDeserializer=i}}),montageDefine("ad36237","core/serialization/deserializer/unit-deserializer",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage,i=r.specialize({_context:{value:null},create:{value:function(){return new this}},initWithContext:{value:function(e){return this._context=e,this}},_templatePropertyRegExp:{value:/^([^:]+)(:.*)$/},isValidTemplatePropertyReference:{value:function(e){var t=this._templatePropertyRegExp.exec(e);if(t){var n=t[1];return!!this._context.hasObject(n)}return!1}},getObjectByLabel:{value:function(e){if(this._context.hasObject(e))return this._context.getObject(e);if(this.isValidTemplatePropertyReference(e))return null;throw new Error("Object with label '"+e+"' was not found.")}}});t.UnitDeserializer=i}}),montageDefine("ad36237","core/module-reference",{dependencies:["./core"],factory:function(e,t,n){var r=e("./core").Montage;t.ModuleReference=r.specialize({initWithIdAndRequire:{value:function(e,t){if(!e||!t)throw new Error("Module ID and require required");return this.id=e,this.require=t,this}},id:{value:null},require:{value:null},_exports:{value:null},exports:{get:function(){return this._exports?this._exports:this._exports=this.require.async(this.id)}},resolve:{value:function(e){return e.identify(this.id,this.require)}},isModuleReference:{writable:!1,configurable:!1,value:!0}})}}),montageDefine("ad36237","core/serialization/alias",{dependencies:["../core"],factory:function(e,t,n){var r=e("../core").Montage;t.Alias=r.specialize({_value:{value:null},_aliasRegExp:{value:/@([_a-zA-Z$][0-9_a-zA-Z$]*):([_a-zA-Z$][0-9_a-zA-Z$]*)$/},value:{get:function(){return this._value},set:function(e){var t=this._aliasRegExp.exec(e);if(!t)throw new Error("Invalid alias syntax: "+e);this._value=e,this._componentLabel=t[1],this._propertyName=t[2]}},_componentLabel:{value:null},componentLabel:{get:function(){return this._componentLabel}},_propertyName:{value:null},propertyName:{get:function(){return this._propertyName}},init:{value:function(e){return this.value=e,this}}})}}),montageDefine("ad36237","core/extras/console",{dependencies:[],factory:function(e,t,n){"undefined"!=typeof window&&(document._montageTiming=document._montageTiming||{},document._montageTiming.loadStartTime=Date.now(),console._groupTime=Object.create(null),console.groupTime=function(e){var t=this._groupTime[e];t||(t={count:0,start:0,sum:0},this._groupTime[e]=t),t.start=performance.now()},console.groupTimeEnd=function(e){var t=performance.now(),n=this._groupTime[e],r=t-n.start;n.count=n.count+1,n.sum=n.sum+r},console.groupTimeAverage=function(e){var t=this._groupTime[e];return t.sum/t.count},console.groupTimeTotal=function(e){var t=this._groupTime[e];return t.sum},console.groupTimeCount=function(e){var t=this._groupTime[e];return t.count}),n.exports.console=global.console}}),montageDefine("ad36237","core/shim/object",{dependencies:[],factory:function(e,t,n){Object.create||(Object._creator=function r(){this.__proto__=r.prototype},Object.create=function(e,t){return this._creator.prototype=e||Object.prototype,new this._creator},Object.getPrototypeOf=function(e){return e.__proto__}),Object.isSealed||Object.defineProperty(Object,"isSealed",{value:function(){return!1},writable:!0,configurable:!0}),Object.seal||Object.defineProperty(Object,"seal",{value:function(e){return e},writable:!0,configurable:!0})}}),montageDefine("ad36237","core/shim/array",{dependencies:[],factory:function(e,t,n){Array.isArray||Object.defineProperty(Array,"isArray",{value:function(e){return"[object Array]"===Object.prototype.toString.call(e)},writable:!0,configurable:!0}),Object.defineProperty(Array.prototype,"compact",{value:function(){for(var e,t=-1,n=-1,r=this.length;++n<r;)this[n]!==e&&(this[++t]=this[n]);this.length=++t},writable:!0,configurable:!0}),Object.defineProperty(Array.prototype,"removeObjects",{value:function(e,t){var n,r,i=-1,o=-1,a=this.length,s=0;if(t=2!==arguments.length||t,"function"==typeof e.has)for(;++o<a;)e.has(this[o])?t&&e["delete"](this[o]):this[++i]=this[o];else if("function"==typeof e.hasOwnProperty)for(;++o<a;)e.hasOwnProperty(this[o])?t&&delete e[this[o]]:this[++i]=this[o];else if("function"==typeof e.indexOf){for(;++o<a;)(r=e.indexOf(this[o]))===-1?this[++i]=this[o]:(e[r]=n,s++);e.length===s?e.length=0:e.compact()}this.length=++i},writable:!0,configurable:!0})}}),montageDefine("ad36237","core/extras/object",{dependencies:["frb","frb"],factory:function(e,t,n){Object.defineProperty(Object,"getPropertyDescriptor",{value:function(e,t){var n,r=e;do n=Object.getOwnPropertyDescriptor(r,t);while(!n&&(r=r.__proto__||Object.getPrototypeOf(r)));return n},writable:!0,configurable:!0}),Object.defineProperty(Object,"getPrototypeAndDescriptorDefiningProperty",{value:function(e,t){var n,r=e;if(t){do n=Object.getOwnPropertyDescriptor(r,t);while(!n&&(r=r.__proto__||Object.getPrototypeOf(r)));return{prototype:r,propertyDescriptor:n}}},writable:!0,configurable:!0}),Object.defineProperty(Object.prototype,"clear",{value:function(){for(var e=Object.keys(this),t=e.length;t;)t--,delete this[e[t]];return this},writable:!0,configurable:!0}),Object.hasOwnProperty("defineBinding")===!1&&Object.defineProperty(Object,"defineBinding",{value:function(t,n,r){var i=Error.stackTraceLimit,o=["Object.defineBinding deprecated, replace Object.defineBinding with: ",'Import Bindings from "montage/core/core"',"Bindings.defineBinding(target, targetPath, descriptor);",'- Use "<-", "<->", and "source" in place of "boundObjectPropertyPath", "oneway", and "boundObject".','- Use "convert" or "converter.convert" in place of "boundValueMutator".'].join("\r\n");Error.stackTraceLimit=2,console.warn(o+new Error("deprecated").stack),Error.stackTraceLimit=i;var a=e("frb");r.source=r.boundObject,r.oneway?r["<-"]=r.boundObjectPropertyPath:r["<->"]=r.boundObjectPropertyPath,r.boundValueMutator&&(r.convert=r.boundValueMutator),a.defineBinding(t,n,r)},writable:!0,configurable:!0}),Object.hasOwnProperty("deleteBinding")===!1&&Object.defineProperty(Object,"deleteBinding",{value:function(t,n){var r=e("frb");r.cancelBinding(t,n)},writable:!0,configurable:!0})}}),montageDefine("ad36237","core/extras/date",{dependencies:[],factory:function(e,t,n){Object.defineProperty(Date.prototype,"clone",{value:function(){return new Date(this)},writable:!0,configurable:!0})}}),montageDefine("ad36237","core/extras/element",{dependencies:[],factory:function(e,t,n){"undefined"==typeof Element||Element.isElement||Object.defineProperty(Element,"isElement",{value:function(e){return!(!e||1!==e.nodeType)},writable:!0,configurable:!0})}}),montageDefine("ad36237","core/extras/function",{dependencies:["./object"],factory:function(e,t,n){e("./object"),Object.defineProperty(Function,"identity",{value:function(e){return e},writable:!0,configurable:!0}),Object.defineProperty(Function,"noop",{value:function(){},writable:!0,configurable:!0}),Object.defineProperty(Function,"by",{value:function(e,t){t=t||Object.compare,e=e||Function.identity;var n=function(n,r){return t(e(n),e(r))};return n.compare=t,n.by=e,n},writable:!0,configurable:!0})}}),montageDefine("ad36237","core/extras/regexp",{dependencies:[],factory:function(e,t,n){if(!RegExp.isRegExp){var r=Object.prototype.toString;Object.defineProperty(RegExp,"isRegExp",{value:function(e){return"[object RegExp]"===r.call(e)},writable:!0,configurable:!0})}}}),montageDefine("ad36237","core/extras/string",{dependencies:["collections/map"],factory:function(e,t,n){var r=e("collections/map");Object.defineProperty(String.prototype,"equals",{value:function(e){return this.valueOf()===Object.getValueOf(e)},writable:!0,configurable:!0}),Object.defineProperty(String.prototype,"contains",{value:function(e){return this.indexOf(e)!==-1},writable:!0,configurable:!0}),Object.defineProperty(String.prototype,"toCapitalized",{value:function i(){var e;return i.cache.get(String(this))||(i.cache.set(String(this),e=this[0].toUpperCase()+this.slice(1))?e:null)},writable:!0,configurable:!0}),String.prototype.toCapitalized.cache=new r}}),montageDefine("ad36237","core/serialization/bindings",{dependencies:["frb","frb/stringify","frb/expand","frb/scope","../serialization/serializer/montage-serializer","../serialization/deserializer/montage-deserializer"],factory:function(e,t,n){var r=e("frb"),i=e("frb/stringify"),o=e("frb/expand"),a=e("frb/scope"),s=e("../serialization/serializer/montage-serializer").MontageSerializer,l=e("../serialization/deserializer/montage-deserializer").MontageDeserializer,u="boundObject",c="<-",h="<->";s.defineSerializationUnit("bindings",function(e,t){for(var n,s,l=r.getBindings(t),u={},p=l.keys();s=p.next().value;){var d=l.get(s),f={};if((!("serializable"in d)||d.serializable)&&d.sourceSyntax){var v=d.sourcePath,m=d.sourceSyntax;if(d.source&&d.source!==t){var g=e.getObjectLabel(d.source),_=new a({type:"component",label:g});_.components=e,m=o(m,_)}var _=new a;_.components=e,v=i(m,_),d.twoWay?f[h]=v:f[c]=v,d.converter?f.converter=d.converter:(f.convert=d.convert,f.revert=d.revert),d.trace&&(f.trace=!0),u[s]=f,n=!0}}return n?u:void 0}),l.defineDeserializationUnit("bindings",function(e,t,n){var i,o,a={components:e};for(i in n){if(o=n[i],"object"!=typeof o)throw new Error("Binding descriptor must be an object, not "+typeof o);u in o&&(o.source=e.getObjectByLabel(o.boundObject),o.oneway?o[c]=o.boundPropertyPath:o[h]=o.boundPropertyPath,delete o.boundObject,delete o.boundObjectPropertyPath,delete o.oneway),r.defineBinding(t,i,o,a)}})}}),montageDefine("ad36237","core/event/mutable-event",{dependencies:["../core"],factory:function(e,t,n){var r=e("../core").Montage,i=function(e,t){return function(){return this.hasOwnProperty(t)?this[t]:this._event[e]}},o=function(e){return function(t){this[e]=t}};if("undefined"!=typeof window){var a={},s=function(e,t){var n="_"+t;r.defineProperty(e,n,{value:void 0}),r.defineProperty(e,t,{get:i(t,n),set:o(n)})};t.MutableEvent=r.specialize({_initPrototypeWithEvent:{value:function(e){var t,n=this.__proto__||Object.getPrototypeOf(this);for(t in e)t in this||Object.getOwnPropertyDescriptor(n,t)||s(this,t);return s(this,"replayed"),this}},_initWithEvent:{value:function(e){return this._event=e,this}},preventDefault:{value:function(){this._event.preventDefault()}},getPreventDefault:{value:function(){return this._event.getPreventDefault?this._event.getPreventDefault():this._event.defaultPrevented}},stopImmediatePropagation:{value:function(){this._event.stopImmediatePropagation(),this.propagationStopped=!0,this.immediatePropagationStopped=!0}},propagationStopped:{value:!1},immediatePropagationStopped:{value:!1},mutable:{value:!0},stopPropagation:{value:function(){this._event.stopPropagation(),this.propagationStopped=!0}},stop:{value:function(){this.preventDefault(),this.stopPropagation()}},_eventPhase:{value:void 0},eventPhase:{get:function(){return void 0!==this._eventPhase?this._eventPhase:this._event.eventPhase},set:function(e){this._eventPhase=e}},_target:{value:void 0},target:{get:function(){return void 0!==this._target?this._target:this._event.target},set:function(e){this._target=e}},_currentTarget:{value:void 0},currentTarget:{get:function(){return void 0!==this._currentTarget?this._currentTarget:this._event.currentTarget},set:function(e){this._currentTarget=e}},_type:{value:void 0},type:{get:function(){return void 0!==this._type?this._type:this._event.type},set:function(e){this._type=e}},_bubbles:{value:void 0},bubbles:{get:function(){return void 0!==this._bubbles?this._bubbles:this._event.bubbles},set:function(e){this._bubbles=e}},touches:{get:function(){return this._event.touches}},changedTouches:{get:function(){return this._event.changedTouches}},targetTouches:{get:function(){return this._event.targetTouches}},_defaultPrevented:{value:void 0},defaultPrevented:{get:function(){return void 0!==this._defaultPrevented?this._defaultPrevented:this._event.defaultPrevented},set:function(e){this._defaultPrevented=e}},_timeStamp:{value:void 0},timeStamp:{get:function(){return void 0!==this._timeStamp?this._timeStamp:this._event.timeStamp},set:function(e){this._timeStamp=e}}},{fromEvent:{value:function(e){var n,r=e.type,i=a[r];return i||(i=function(){},i.prototype=(new t.MutableEvent)._initPrototypeWithEvent(e),a[r]=i),n=new i,n._initWithEvent(e),n}},fromType:{value:function(e,t,n,r){return this.fromEvent(new CustomEvent(e,{bubbles:t,cancelable:n,detail:r}))}}})}}}),montageDefine("ad36237","core/serialization/serializer/montage-serializer",{dependencies:["../../core","./montage-malker","./montage-builder","./montage-labeler","./montage-visitor","../../logger"],factory:function(e,t,n){var r=e("../../core").Montage,i=e("./montage-malker").MontageWalker,o=e("./montage-builder").MontageBuilder,a=e("./montage-labeler").MontageLabeler,s=e("./montage-visitor").MontageVisitor,l=(e("../../logger").logger("montage-serializer"),r.specialize({_require:{value:null},_visitor:{value:null},_labeler:{value:null},_builder:{value:null},_serializationIndentation:{value:2},_malker:{value:null},initWithRequire:{value:function(e){return this._require=e,this._builder=new o,this._labeler=new a,this._visitor=(new s).initWithBuilderAndLabelerAndRequireAndUnits(this._builder,this._labeler,this._require,this.constructor._units),this._malker=new i(this._visitor),this}},getExternalObjects:{value:function(){return this._visitor.getExternalObjects()}},getExternalElements:{value:function(){return this._visitor.getExternalElements()}},setSerializationIndentation:{value:function(e){this._serializationIndentation=e}},serialize:{value:function(e){var t;this._labeler.initWithObjects(e);for(var n in e)this._malker.visit(e[n]);return t=this._formatSerialization(this._builder.getSerialization(this._serializationIndentation))}},serializeObject:{value:function(e){return this.serialize({root:e})}},_formatSerializationBindingsRegExp:{value:/\{\s*("(?:<->?)")\s*:\s*("[^"]+"\s*(?:,\s*"converter"\s*:\s*\{\s*"@"\s*:\s*"[^"]+"\s*\}\s*|,\s*"deferred"\s*:\s*(true|false)\s*)*)\}/gi},_formatSerializationBindingsReplacer:{value:function(e,t,n){return"{"+t+": "+n.replace(/\n\s*/g,"").replace(/,\s*/g,", ")+"}"}},_formatSerializationBindings:{value:function(e){return e.replace(this._formatSerializationBindingsRegExp,this._formatSerializationBindingsReplacer)}},_formatSerializationReferencesRegExp:{value:/\{\s*("[#@]")\s*:\s*("[^"]+")\s*\}/gi},_formatSerializationReferences:{value:function(e){return e.replace(this._formatSerializationReferencesRegExp,"{$1: $2}")}},_formatSerialization:{value:function(e){return this._formatSerializationBindings(this._formatSerializationReferences(e))}}},{_units:{value:Object.create(null)},defineSerializationUnit:{value:function(e,t){this._units[e]=t}},_toCamelCaseRegExp:{value:/(?:^|-)([^-])/g},_replaceToCamelCase:{value:function(e,t){return t.toUpperCase()}},_findObjectNameRegExp:{value:/([^\/]+?)(\.reel)?$/},getDefaultObjectNameForModuleId:{value:function(e){return this._findObjectNameRegExp.test(e),RegExp.$1.replace(this._toCamelCaseRegExp,this._replaceToCamelCase)}}}));t.MontageSerializer=l,t.serialize=function(e,t){return(new l).initWithRequire(t).serializeObject(e)}}}),montageDefine("ad36237","core/serialization/deserializer/montage-deserializer",{dependencies:["../../core","./montage-interpreter","./montage-reviver","../../deprecate"],factory:function(e,t,n){var r=e("../../core").Montage,i=e("./montage-interpreter").MontageInterpreter,o=e("./montage-reviver").MontageReviver,a=e("../../deprecate"),s=t.MontageDeserializer=r.specialize({_interpreter:{value:null},_serializationString:{value:null},_serialization:{value:null},serialization:{value:{get:function(){return this._serialization}}},init:{value:function(e,t,n){return this._serializationString=e,this._interpreter=(new i).init(t,n),this}},initWithObject:{value:function(e,t,n){return this._serializationString=JSON.stringify(e),this._interpreter=(new i).init(t,n),this}},initWithObjectAndRequire:{value:a.deprecateMethod(void 0,function(e,t,n){return this.initWithObject(e,t,n)},"initWithObjectAndRequire","initWithObject")},deserialize:{value:function(e,t){try{var n=JSON.parse(this._serializationString)}catch(r){return this._formatSerializationSyntaxError(this._serializationString)}return this._interpreter.instantiate(n,e,t)}},deserializeObject:{value:function(e){return this.deserialize(e).then(function(e){return e.root})}},preloadModules:{value:function(){var e=JSON.parse(this._serializationString);return this._interpreter.preloadModules(e)}},getExternalObjectLabels:{value:function(){var e=this._serialization,t=[];for(var n in e)0===Object.keys(e[n]).length&&t.push(n);return t}},_formatSerializationSyntaxError:{value:function(t){var n,r,i,o,a,s="   ",l=this._origin;return e.async("jslint/lib/jslint").then(function(e){if(e.JSHINT(t))n="Syntax error in the serialization but not able to find it!\n"+t;else{r=e.JSHINT.errors[0],i=t.split("\n"),o=(s+i.length).length,a=r.line-1;for(var u=0,c=i.length;u<c;u++)i[u]=new Array(o-(u+1+"").length+1).join(u===a?">":" ")+(u+1)+" "+i[u];n="Syntax error at line "+r.line+(l?" from "+l:"")+":\n"+r.evidence+"\n"+r.reason+"\n"+i.join("\n")}throw new Error(n)})}}});s.defineDeserializationUnit=function(e,t){o.defineUnitReviver(e,t)},t.deserialize=function(e,t){return(new s).init(e,t).deserializeObject()}}}),montageDefine("ad36237","core/environment",{dependencies:["./core"],factory:function(e,t,n){var r=e("./core").Montage,i="trident",o="msie",a="unknown",s="crios",l="fxios",u="cros",c="opr",h=t.Environment=r.specialize({constructor:{value:function(e){this.userAgent=e?e:global.navigator?global.navigator.userAgent:""}},_userAgent:{value:null},userAgent:{set:function(e){e=e.toLowerCase(),e!==this._userAgent&&(this._userAgent=e)},get:function(){return this._userAgent}},_device:{value:null},device:{get:function(){if(!this._device){var e=this.userAgent.match(/iphone|ipod|ipad/i);e&&e.length?this._device=e[0]:this._device=a}return this._device}},_supportsPointerEvents:{value:null},supportsPointerEvents:{get:function(){return"boolean"!=typeof this._supportsPointerEvents?this._supportsPointerEvents=!!(global.PointerEvent||global.MSPointerEvent&&global.navigator.msPointerEnabled):this._supportsPointerEvents}},_isIOSDevice:{value:null},isIOSDevice:{get:function(){return"boolean"!=typeof this._isIOSDevice?this._isIOSDevice=/iphone|ipad|ipod/.test(this.device):this._isIOSDevice}},_isAndroidDevice:{value:null},isAndroidDevice:{get:function(){return"boolean"!=typeof this._isAndroidDevice?this._isAndroidDevice=this.platformName===h.Platform.ANDROID:this._isAndroidDevice}},isCordova:{value:!!global.cordova},_isMobileDevice:{value:null},isMobileDevice:{get:function(){return"boolean"!=typeof this._isMobileDevice?this._isMobileDevice=/mobile/gi.test(this.userAgent):this._isMobileDevice}},isAndroidTablet:{get:function(){return this.isAndroidDevice&&!this.isMobileDevice}},_isStandalone:{value:null},isStandalone:{get:function(){return"boolean"!=typeof this._isStandalone?this._isStandalone=!!("standalone"in navigator&&navigator.standalone):this._isStandalone}},_platformName:{value:null},platformName:{get:function(){if("string"!=typeof this._platformName){var e=this.userAgent.match(/android|windows\sphone|windows|macintosh|linux|cros/gi);if(e&&e.length){var t=e[0];t===h.Platform.LINUX&&e[1]===h.Platform.ANDROID?t=h.Platform.ANDROID:t===u&&(t=h.Platform.CHROME_OS),this._platformName=t}else this.isIOSDevice?this._platformName=h.Platform.IOS:this._platformName=a}return this._platformName}},_browserVersion:{value:null},browserVersion:{get:function(){return"string"!=typeof this._browserVersion&&this._analyzeBrowser(),this._browserVersion}},_browserName:{value:null},browserName:{get:function(){return"string"!=typeof this._browserName&&this._analyzeBrowser(),this._browserName}},_isWKWebView:{value:null},isWKWebView:{get:function(){return"boolean"!=typeof this._isWKWebView?this._isWKWebView=this.isIOSDevice&&!!global.indexedDB:this._isWKWebView}},_isUIWebView:{value:null},isUIWebView:{get:function(){return"boolean"!=typeof this._isUIWebView?this._isUIWebView=!this.isWKWebView:this._isUIWebView}},_analyzeBrowser:{value:function(){var e,t=this.userAgent,n="",r="";e=t.indexOf(c)>-1?t.match(/(opr(?=\/))\/?\s*([\d+\.?]+)/i):t.indexOf(h.Browser.EDGE)>-1?t.match(/(edge(?=\/))\/?\s*([\d+\.?]+)/i):t.match(/(opera|chrome|safari|firefox|msie|trident|crios|fxios(?=\/))\/?\s*([\d+\.?]+)/i),e&&e.length>1&&(n=e[1],n===h.Browser.SAFARI?r=t.match(/version\/([\d+\.?]+)/i)[1]:n===h.Browser.CHROME||n===h.Browser.FIREFOX||n===l||n===o||n===h.Browser.OPERA||n===s||n===h.Browser.EDGE?r=e[2]:n===i&&(e=/\brv[ :]+(\d+)/g.exec(t),r=e&&e.length>1?e[1]:""),n===i||n===o?n=h.Browser.IE:n===c?n=h.Browser.OPERA:n===s?n=h.Browser.CHROME:n===l&&(n=h.Browser.FIREFOX)),this._browserName=n,this._browserVersion=r}}},{Device:{value:{IPHONE:"iphone",IPAD:"ipad",IPOD:"ipod"}},Platform:{value:{IOS:"ios",ANDROID:"android",WINDOWS_PHONE:"windows phone",MACINTOSH:"macintosh",WINDOWS:"windows",LINUX:"linux",CHROME_OS:"chrome os"}},Browser:{value:{SAFARI:"safari",FIREFOX:"firefox",CHROME:"chrome",OPERA:"opera",IE:"ie",EDGE:"edge"}}});t.currentEnvironment=new h}}),montageDefine("ad36237","core/serialization/serializer/montage-malker",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage,i=t.MontageWalker=r.specialize({_visitHandler:{value:null},_enteredObjects:{value:null},constructor:{value:function(e){this._visitHandler=e,this._enteredObjects={}}},_isObjectEntered:{value:function(e){return Object.hash(e)in this._enteredObjects}},_markObjectAsEntered:{value:function(e){this._enteredObjects[Object.hash(e)]=!0}},visit:{value:function(e,t){this._visitValue(e,t)},enumerable:!0},_getTypeOf:{value:function(e){return Array.isArray(e)?"array":RegExp.isRegExp(e)?"regexp":null===e?"null":"object"==typeof e||"function"==typeof e?this._getObjectType(e):typeof e}},_getObjectType:{value:function(e){var t,n=this._visitHandler;return"function"==typeof n.getTypeOf&&(t=n.getTypeOf(e)),"undefined"==typeof t?typeof e:t}},_visitValue:{value:function(e,t){var n=this._getTypeOf(e);"object"===n?this._visitObject(e,t):"array"===n?this._visitArray(e,t):"regexp"===n?this._visitRegExp(e,t):"number"===n?this._visitNumber(e,t):"string"===n?this._visitString(e,t):"boolean"===n?this._visitBoolean(e,t):"null"===n?this._visitNull(t):"undefined"===n?this._visitUndefined(t):this._visitCustomType(n,e,t)}},_visitCustomType:{value:function(e,t,n){this._callVisitorMethod("visit"+e,t,n)}},_enterCustomObject:{value:function(e,t,n){this._callVisitorMethod("enter"+e,t,n),this._callVisitorMethod("exit"+e,t,n)}},_visitObject:{value:function(e,t){var n;this._isObjectEntered(e)?this._callVisitorMethod("visitObject",e,t):(n=this._callVisitorMethod("willEnterObject",e,t),n!==!1&&(this._markObjectAsEntered(e),this._enterObject(e,t)))}},_enterObject:{value:function(e,t){var n,r=Object.keys(e);this._callVisitorMethod("enterObject",e,t);for(var i=0,o=r.length;i<o;i++)n=r[i],this._visitValue(e[n],n);this._callVisitorMethod("exitObject",e,t)}},_visitArray:{value:function(e,t){var n;this._isObjectEntered(e)?this._callVisitorMethod("visitArray",e,t):(n=this._callVisitorMethod("willEnterArray",e,t),n!==!1&&(this._markObjectAsEntered(e),this._enterArray(e,t)))}},_enterArray:{value:function(e,t){this._callVisitorMethod("enterArray",e,t);for(var n=0,r=e.length;n<r;n++)this._visitValue(e[n],""+n);this._callVisitorMethod("exitArray",e,t)}},_visitRegExp:{value:function(e,t){this._callVisitorMethod("visitRegExp",e,t)}},_visitString:{value:function(e,t){this._callVisitorMethod("visitString",e,t)}},_visitNumber:{value:function(e,t){this._callVisitorMethod("visitNumber",e,t)}},_visitBoolean:{value:function(e,t){this._callVisitorMethod("visitBoolean",e,t)}},_visitNull:{value:function(e){this._callVisitorMethod("visitNull",e)}},_visitUndefined:{value:function(e){this._callVisitorMethod("visitUndefined",e)}},_callVisitorMethod:{value:function(e){var t,n=this._visitHandler;if("function"==typeof n[e])return t=Array.prototype.slice.call(arguments,1),t.unshift(this),n[e].apply(n,t)}}});t.visit=function(e,t){var n=new i(t);n.visit(e)}}}),montageDefine("ad36237","core/serialization/serializer/montage-builder",{dependencies:["../../core","./montage-ast"],factory:function(e,t,n){var r=e("../../core").Montage,i=e("./montage-ast"),o=r.specialize({_root:{value:null},_stack:{value:null},_references:{value:null},_placeholderProperty:{value:Object.create(null)},constructor:{value:function(){this.init()}},createElementReference:{value:function(e){return(new i.ElementReference).initWithRootAndId(this._root,e)}},createModuleReference:{value:function(e){return(new i.ModuleReference).initWithRootAndModuleId(this._root,e)}},init:{value:function(){return this._references=Object.create(null),this._root=new i.Root,this._stack=[this._root],this}},cleanup:{value:function(){this._references=null,this._root=null,this._stack=null}},getExternalReferences:{value:function(e,t){var n=this._references,r=this._root,i=[];for(var o in n)r.hasProperty(o)&&r.getProperty(o)!==this._placeholderProperty||i.push(o);return i}},relabelReferences:{value:function(e,t){var n=this._references[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;r++)n[r].value=t}}},_registerReference:{value:function(e){var t=this._references,n=e.value;t[n]?t[n].push(e):t[n]=[e]}},_unregisterReference:{value:function(e){var t,n=e.label,r=this._references[n];1===r.length?delete this._references[n]:(t=r.indexOf(e),t===-1?console.log("BUG: reference '"+n+"' not found in registry."):r.splice(t,1))}},_createPlaceholdersForReferences:{value:function(){var e=this._references,t=this._root;for(var n in e)t.hasProperty(n)||t.setProperty(n,this._placeholderProperty)}},getSerialization:{value:function(e){return this._createPlaceholdersForReferences(),this._root.serialize(e)}},root:{get:function(){return this._root}},top:{get:function(){return this._stack[0]}},push:{value:function(e){return this._stack.unshift(e)}},pop:{value:function(){return this._stack.shift()}},createObjectLiteral:{value:function(){return new i.ObjectLiteral(this._root,Object.create(null))}},createArray:{value:function(){return new i.ObjectLiteral(this._root,[])}},createObjectReference:{value:function(e){var t=new i.ObjectReference(this._root,e);return this._registerReference(t),t}},createRegExp:{value:function(e){return new i.RegExpObject(this._root,e)}},createString:{value:function(e){return new i.Value(this._root,e)}},createNumber:{value:function(e){return new i.Value(this._root,e)}},createBoolean:{value:function(e){return new i.Value(this._root,e)}},createNull:{value:function(e){return new i.Value(this._root,null)}},createCustomObject:{value:function(){return new i.CustomObject(this._root)}}});t.MontageBuilder=o}}),montageDefine("ad36237","core/serialization/serializer/montage-labeler",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage;t.MontageLabeler=r.specialize({_labelRegexp:{value:/^[a-zA-Z_$][0-9a-zA-Z_$]*$/},_labels:{value:null},_objectsLabels:{value:null},_objects:{value:null},_INITIAL_LABEL_NUMBER:{value:2},_baseNamesIndex:{value:null},_userDefinedLabels:{value:null},constructor:{value:function(){this._labels=Object.create(null),this._objectsLabels=Object.create(null),this._objects=Object.create(null),this._baseNamesIndex=Object.create(null),this._userDefinedLabels=Object.create(null)}},getTemplatePropertyLabel:{value:function(e){var t=this._getObjectLabel(e);if(":"!==t[0])throw new Error("Template property's labels need to start with a colon (:), (\""+t+'").');return t}},_getObjectLabel:{value:function(e){var t,n=Object.hash(e);return n in this._objectsLabels?t=this._objectsLabels[n]:(t=this.generateObjectLabel(e),this.setObjectLabel(e,t)),t}},getObjectLabel:{value:function(e){var t=this._getObjectLabel(e);if(":"===t[0])throw new Error('Labels starting with colon (:) can only be used for template properties, ("'+t+'").');return t}},getObjectName:{value:function(e){var t,n=e.identifier;return n&&this._labelRegexp.test(n)?t=e.identifier:e&&"object"==typeof e&&"getInfoForObject"in e||"getInfoForObject"in e.constructor?(t=r.getInfoForObject(e).objectName,t=t.toLowerCase()):t=Array.isArray(e)?"array":RegExp.isRegExp(e)?"regexp":typeof e,t}},initWithObjects:{value:function(e){for(var t in e)this.setObjectLabel(e[t],t),this._userDefinedLabels[t]=!0}},cleanup:{value:function(){this._labels=null,this._objectsLabels=null,this._objects=null,this._baseNamesIndex=null,this._userDefinedLabels=null}},generateLabel:{value:function(e){var t,n=this._baseNamesIndex[e];do n?(t=e+n,this._baseNamesIndex[e]=n+=1):(t=e,this._baseNamesIndex[e]=n=this._INITIAL_LABEL_NUMBER);while(t in this._labels);return t}},getLabelBaseName:{value:function(e){return e.replace(/\d*$/,"")}},addLabel:{value:function(e){this._labels[e]=!0}},addLabels:{value:function(e){for(var t=0,n=e.length;t<n;t++)this.addLabel(e[t])}},isLabelDefined:{value:function(e){return e in this._labels}},isUserDefinedLabel:{value:function(e){return e in this._userDefinedLabels}},generateObjectLabel:{value:function(e){var t=this.getObjectName(e);return this.generateLabel(t)}},setObjectLabel:{value:function(e,t){if("undefined"!=typeof e){var n=Object.hash(e);this.addLabel(t),this._objectsLabels[n]=t,this._objects[t]=e}}},getObjectByLabel:{value:function(e){return this._objects[e]}}})}}),montageDefine("ad36237","core/serialization/serializer/montage-visitor",{dependencies:["../../core","./montage-serializer","./properties-serializer","./self-serializer","./unit-serializer","../alias"],factory:function(e,t,n){var r=e("../../core").Montage,i=e("./montage-serializer"),o=e("./properties-serializer").PropertiesSerializer,a=e("./self-serializer").SelfSerializer,s=e("./unit-serializer").UnitSerializer,l=e("../alias").Alias,u=r.specialize({_MONTAGE_ID_ATTRIBUTE:{value:"data-montage-id"},_require:{value:null},_units:{value:null},_elements:{value:null
},builder:{value:null},labeler:{value:null},_objectsSerialization:{value:null},initWithBuilderAndLabelerAndRequireAndUnits:{value:function(e,t,n,r){return this.builder=e,this.labeler=t,this._objectsSerialization=Object.create(null),this._require=n,this._units=r,this._elements=[],this}},getTypeOf:{value:function(e){return e.isModuleReference?"Module":e instanceof l?"Alias":"getInfoForObject"in e||"getInfoForObject"in e.constructor?"MontageObject":e.thisIsAReferenceCreatedByMontageSerializer?"MontageReference":"undefined"!=typeof Element&&Element.isElement(e)?"Element":void 0}},visitMontageReference:{value:function(e,t,n){this.builder.top.setProperty(n,t.reference)}},visitElement:{value:function(e,t,n){var r,i;if(i=t.getAttribute(this._MONTAGE_ID_ATTRIBUTE),!i)throw new Error("Not possible to serialize a DOM element with no "+this._MONTAGE_ID_ATTRIBUTE+" assigned: "+t.outerHTML);r=this.builder.createElementReference(i),this.storeValue(r,t,n),this._elements.push(t)}},visitModule:{value:function(e,t,n){var r,i;try{i=t.resolve(this._require)}catch(o){throw new Error("Not possible to serialize module reference "+t.id+" from package "+t.require.location+" inside package "+this._require.location)}r=this.builder.createModuleReference(i),this.storeValue(r,t,n)}},visitAlias:{value:function(e,t){var n=this.labeler.getTemplatePropertyLabel(t),r=this.builder.createCustomObject();r.setProperty("alias",t.value),this.builder.top.setProperty(n,r)}},visitMontageObject:{value:function(e,t,n){this.isObjectSerialized(t)?this.serializeReferenceToMontageObject(e,t,n):this.handleMontageObject(e,t,n)}},handleMontageObject:{value:function(e,t,n){var r,i=this.builder.createCustomObject();this.setObjectSerialization(t,i),r=this.serializeMontageObject(e,t,i),r?this.serializeSubstituteObject(e,t,n,i,r):(i.setLabel(this.labeler.getObjectLabel(t)),this.builder.top.setProperty(n,i))}},serializeReferenceToMontageObject:{value:function(e,t,n){var r=this.labeler.getObjectLabel(t),i=this.builder.createObjectReference(r);this.builder.top.setProperty(n,i)}},serializeSubstituteObject:{value:function(e,t,n,r,i){var o,a,s,l;o=this.labeler.getObjectLabel(t),this.labeler.isUserDefinedLabel(o)?(a=this.labeler.getObjectLabel(i),this.labeler.setObjectLabel(i,o),this.builder.relabelReferences(a,o),l=this.getObjectSerialization(i),l&&(l.setLabel(o),this.labeler.isUserDefinedLabel(a)&&this.builder.createObjectReference(o).setLabel(a)),e.visit(i,n)):(e.visit(i,n),s=this.labeler.getObjectLabel(i),this.labeler.setObjectLabel(t,s),this.builder.relabelReferences(o,s))}},serializeMontageObject:{value:function(e,t,n){var r,i,o=this.builder.createObjectLiteral();return this.setObjectType(t,n),n.setProperty("properties",o),this.builder.push(n),"function"==typeof t.serializeSelf?(r=(new a).initWithMalkerAndVisitorAndObject(e,this,t,n),i=t.serializeSelf(r)):(this.setObjectProperties(e,t),this.setObjectCustomUnits(e,t)),this.builder.pop(),0===o.getPropertyNames().length&&n.clearProperty("properties"),i}},setObjectType:{value:function(e,t){var n=r.getInfoForObject(e).isInstance,i=this.getObjectLocationId(e),o=this.builder.createString(i);n?t.setProperty("prototype",o):t.setProperty("object",o)}},getObjectModuleId:{value:function(e){var t=r.getInfoForObject(e);return this._require.identify(t.moduleId,t.require)}},getObjectLocationId:{value:function(e){var t,n=this.getObjectModuleId(e),o=r.getInfoForObject(e),a=o.objectName;return t=i.MontageSerializer.getDefaultObjectNameForModuleId(n),t===a?n:n+"["+a+"]"}},setObjectProperties:{value:function(e,t){var n,r;r=this.builder.top.getProperty("properties"),this.builder.push(r),"function"==typeof t.serializeProperties?(n=(new o).initWithMalkerAndVisitorAndObject(e,this,t),t.serializeProperties(n)):this.setSerializableObjectProperties(e,t),this.builder.pop()}},setSerializableObjectProperties:{value:function(e,t){for(var n,i,o=r.getSerializablePropertyNames(t),a=o.length,s=0;s<a;s++)i=o[s],n=r.getPropertyAttribute(t,i,"serializable"),this.setProperty(e,i,t[i],n)}},hackIsReferenceAllowedForValue:{value:function(e){return"object"==typeof e&&null!=e&&!("undefined"!=typeof Element&&Element.isElement(e))}},setProperty:{value:function(e,t,n,r){var i;if("reference"===r&&this.hackIsReferenceAllowedForValue(n)){i=this.labeler.getObjectLabel(n);var o=this.builder.createObjectReference(i);this.builder.top.setProperty(t,o)}else e.visit(n,t)}},setObjectCustomUnits:{value:function(e,t){for(var n in this._units)this.setObjectCustomUnit(e,t,n)}},setObjectCustomUnit:{value:function(e,t,n){var r,i,o=this._units[n];o&&(i=(new s).initWithMalkerAndVisitorAndObject(e,this,t),r=o(i,t),null!=r&&e.visit(r,n))}},getExternalObjects:{value:function(){for(var e,t={},n=this.builder.getExternalReferences(),r=0;e=n[r];r++)t[e]=this.labeler.getObjectByLabel(e);return t}},getExternalElements:{value:function(){return this._elements}},getCustomObjectTypeOf:{value:function(){},writable:!0},isCustomObject:{value:function(e){var t=this.getCustomObjectTypeOf(e);return"string"==typeof t}},setObjectSerialization:{value:function(e,t){this._objectsSerialization[Object.hash(e)]=t}},getObjectSerialization:{value:function(e){return this._objectsSerialization[Object.hash(e)]}},isObjectSerialized:{value:function(e){return Object.hash(e)in this._objectsSerialization}},enterObject:{value:function(e,t,n){var r=this.builder.createObjectLiteral();this.setObjectSerialization(t,r),this.builder.push(r)}},exitObject:{value:function(e,t,n){this.storeValue(this.builder.pop(),t,n)}},visitObject:{value:function(e,t,n){var r=this.labeler.getObjectLabel(t),i=this.builder.createObjectReference(r);this.getObjectSerialization(t).setLabel(r),this.builder.top.setProperty(n,i)}},enterArray:{value:function(e,t,n){var r=this.builder.createArray();this.setObjectSerialization(t,r),this.builder.push(r)}},exitArray:{value:function(e,t,n){this.storeValue(this.builder.pop(),t,n)}},visitArray:{value:function(e,t,n){var r=this.labeler.getObjectLabel(t),i=this.builder.createObjectReference(r);this.getObjectSerialization(t).setLabel(r),this.builder.top.setProperty(n,i)}},visitRegExp:{value:function(e,t,n){this.storeValue(this.builder.createRegExp(t),t,n)}},visitString:{value:function(e,t,n){this.storeValue(this.builder.createString(t),t,n)}},visitNumber:{value:function(e,t,n){this.storeValue(this.builder.createNumber(t),t,n)}},visitBoolean:{value:function(e,t,n){this.storeValue(this.builder.createBoolean(t),t,n)}},visitNull:{value:function(e,t){this.storeValue(this.builder.createNull(),null,t)}},visitCustomObject:{value:function(e,t,n){var r=this.getCustomObjectTypeOf(t),i=u.customObjectVisitors["visit"+r];if(r)return i.call(global,e,this,t,n);throw new Error("Object's type is unknown: "+t)}},storeValue:{value:function(e,t,n){"undefined"==typeof n?e.setLabel(this.labeler.getObjectLabel(t)):this.builder.top.setProperty(n,e)}}},{customObjectVisitors:{value:Object.create(null)},makeGetCustomObjectTypeOf:{value:function(e){var t=this.prototype.getCustomObjectTypeOf;return function(n){return e(n)||t(n)}}},addCustomObjectVisitor:{value:function(e){var t=this.customObjectVisitors;for(var n in e)if("getTypeOf"!==n&&"function"==typeof e[n]&&/^visit/.test(n)){if("undefined"!=typeof t[n])return new Error("Visitor '"+n+"' is already registered.");t[n]=e[n].bind(e)}this.prototype.getCustomObjectTypeOf=this.makeGetCustomObjectTypeOf(e.getTypeOf)}},resetCustomObjectVisitors:{value:function(){this.customObjectVisitors=Object.create(null),this.prototype.getCustomObjectTypeOf=function(){}}}});t.MontageVisitor=u}}),montageDefine("ad36237","core/serialization/deserializer/montage-interpreter",{dependencies:["../../core","./montage-reviver","../../promise"],factory:function(e,t,n){var r=e("../../core").Montage,i=e("./montage-reviver").MontageReviver,o=e("../../promise").Promise,a=r.specialize({_require:{value:null},_reviver:{value:null},init:{value:function(e,t){if("function"!=typeof e)throw new Error("Function 'require' missing.");return this._reviver=(new i).init(e,t),this._require=e,this}},instantiate:{value:function(e,t,n){var r;return r=(new s).init(e,this._reviver,t,n,this._require),r.getObjects()}},preloadModules:{value:function(e){var t,n,r,a,s=this._reviver,l=s.moduleLoader,u=[];for(var c in e)t=e[c],n=t.prototype||t.object,n&&(r=i.parseObjectLocationId(n),a=l.getModule(r.moduleId,c),o.is(a)&&u.push(a));if(u.length>0)return o.all(u)}}}),s=r.specialize({_ELEMENT_ID_ATTRIBUTE:{value:"data-montage-id"},_unitsToDeserialize:{value:null},_element:{value:null},_require:{value:null},_objects:{value:null},_userObjects:{value:null},_serialization:{value:null},_reviver:{value:null},constructor:{value:function(){this._unitsToDeserialize=[]}},init:{value:function(e,t,n,r,i){if(this._reviver=t,this._serialization=e,this._objects=Object.create(null),n){this._userObjects=Object.create(null);for(var o in n)this._userObjects[o]=n[o]}return this._element=r,this._require=i,this}},setObjectLabel:{value:function(e,t){this._objects[t]=e}},getObject:{value:function(e){var t,n=this._serialization,r=this._reviver,i=this._objects;return e in i?i[e]:e in n?(t=r.reviveRootObject(n[e],this,e),e in i||(i[e]=t),t):o.reject(new Error("Object with label '"+e+"' was not found."))}},getObjects:{value:function(){var e,t=this,n=this._serialization,r=[];for(var i in n)e=this.getObject(i),o.is(e)&&r.push(e);return 0===r.length?o.resolve(this._invokeDidReviveObjects()):o.all(r).then(function(){return t._invokeDidReviveObjects()})}},hasUserObject:{value:function(e){var t=this._userObjects;return!!t&&e in t}},getUserObject:{value:function(e){var t=this._userObjects;if(t)return t[e]}},_invokeDidReviveObjects:{value:function(){var e,t=this,n=this._reviver;return"function"==typeof n.didReviveObjects&&(e=n.didReviveObjects(this._objects,this),o.is(e))?e.then(function(){return t._objects}):this._objects}},hasObject:{value:function(e){return e in this._serialization}},getRequire:{value:function(){return this._require}},getElement:{value:function(){return this._element}},getElementById:{value:function(e){var t="*["+this._ELEMENT_ID_ATTRIBUTE+'="'+e+'"]';return this._element.querySelector(t)}},setUnitsToDeserialize:{value:function(e,t,n){this._unitsToDeserialize.push({object:e,objectDesc:t,unitNames:n})}},getUnitsToDeserialize:{value:function(){return this._unitsToDeserialize}}});t.MontageInterpreter=a,t.MontageContext=s}}),montageDefine("ad36237","core/deprecate",{dependencies:["./core"],factory:function(e,t,n){var r=e("./core").Montage,i=t.deprecationWarning=function(e,t,n){if(n=n===!0?2:n){var r=Error.stackTraceLimit;Error.stackTraceLimit=n}if("undefined"!=typeof console&&"function"==typeof console.warn){var i=n?new Error("").stack:"";t?console.warn(e+" is deprecated, use "+t+" instead.",i):console.warn(e,i)}n&&(Error.stackTraceLimit=r)};t.deprecateMethod=function(e,t,n,r){var o=function(){return i(n,r,3),t.apply(e?e:this,arguments)};return o.deprecatedFunction=t,o},t.callDeprecatedFunction=function(e,t,n,i){var o,a,s=Error.stackTraceLimit;return Error.stackTraceLimit=2,"undefined"!=typeof console&&"function"==typeof console.warn&&(o=r.getInfoForObject(e).objectName,i?console.warn(n+" is deprecated, use "+i+" instead.",o):console.warn(n,o)),Error.stackTraceLimit=s,a=Array.prototype.slice.call(arguments,4),t.apply(e?e:this,a)}}}),montageDefine("ad36237","core/serialization/serializer/montage-ast",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage,i=(t.Root=r.specialize({constructor:{value:function(){this.object=Object.create(null)}},object:{value:null},setProperty:{value:function(e,t){null!=e&&(this.object[e]=t)}},getProperty:{value:function(e){return this.object[e]}},clearProperty:{value:function(e){delete this.object[e]}},hasProperty:{value:function(e){return e in this.object}},serialize:{value:function(e){return JSON.stringify(this,null,e)}},toJSON:{value:function(){var e,t=Object.create(null);for(var n in this.object)e=this.object[n],e.toJSON?t[n]=e.toJSON(n,1):t[n]=e;return t}}}),t.Value=r.specialize({root:{value:null},label:{value:null},value:{value:null},constructor:{value:function(e,t){this.root=e,this.value=t}},setLabel:{value:function(e){this.label&&this.root.clearProperty(this.label),this.label=e,this.root.setProperty(e,this)}},getLabel:{value:function(){return this.label}},clearLabel:{value:function(){this.root.clearProperty(this.label),this.label=null}},_getSerializationValue:{value:function(){return this.value}},toJSON:{value:function(e,t){var n=this._getSerializationValue();return 1===t?{value:n}:n}}})),o=(t.ElementReference=i.specialize({initWithRootAndId:{value:function(e,t){return i.call(this,e,t),this}},_getSerializationValue:{value:function(){return{"#":this.value}}}}),t.ModuleReference=i.specialize({initWithRootAndModuleId:{value:function(e,t){return i.call(this,e,t),this}},_getSerializationValue:{value:function(){return{"%":this.value}}}}),t.ObjectReference=i.specialize({constructor:{value:function(e,t){i.call(this,e,t)}},_getSerializationValue:{value:function(){return{"@":this.value}}}})),a=(t.CustomObject=i.specialize({constructor:{value:function(e){i.call(this,e,Object.create(null))}},setProperty:{value:function(e,t){null!=e&&(this.value[e]=t)}},getProperty:{value:function(e){return this.value[e]}},clearProperty:{value:function(e){delete this.value[e]}},toJSON:{value:function(e,t){var n,r=this._getSerializationValue();return 1===t?r:(n=new o(this.root,this.label),n.toJSON())}}}),t.ReferenceableValue=i.specialize({constructor:{value:function(e,t){i.call(this,e,t)}},toJSON:{value:function(e,t){var n,r=this._getSerializationValue();return 1===t?{value:r}:this.label?(n=new o(this.root,this.label),n.toJSON()):r}}}));t.ObjectLiteral=a.specialize({constructor:{value:function(e,t){i.call(this,e,t)}},setProperty:{value:function(e,t){null!=e&&(this.value[e]=t)}},getProperty:{value:function(e){return this.value[e]}},clearProperty:{value:function(e){delete this.value[e]}},getPropertyNames:{value:function(){return Object.keys(this.value)}}}),t.RegExpObject=a.specialize({constructor:{value:function(e,t){i.call(this,e,t)}},_getSerializationValue:{value:function(){var e=this.value;return{"/":{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")}}}}})}}),montageDefine("ad36237","core/serialization/serializer/properties-serializer",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage,i=r.specialize.call(Object,{_malker:{value:null},_visitor:{value:null},_object:{value:null},initWithMalkerAndVisitorAndObject:{value:function(e,t,n){return this._malker=e,this._visitor=t,this._object=n,this}},addObject:{value:function(e){if("object"==typeof e)return this._malker.visit(e),e}},addObjectReference:{value:function(e){var t=this._visitor.builder,n=this._visitor.labeler,r=n.getObjectLabel(e),i=Object.create(o);return i.reference=t.createReference(r),i}},set:{value:function(e,t,n){this._visitor.setProperty(this._malker,e,t,n)}},setAll:{value:function(){this._visitor.setSerializableObjectProperties(this._malker,this._object)}}}),o={thisIsAReferenceCreatedByMontageSerializer:!0,reference:null};t.PropertiesSerializer=i}}),montageDefine("ad36237","core/serialization/serializer/self-serializer",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage,i=r.specialize.call(Object,{_malker:{value:null},_visitor:{value:null},_object:{value:null},initWithMalkerAndVisitorAndObject:{value:function(e,t,n){return this._malker=e,this._visitor=t,this._object=n,this}},getObjectLabel:{value:function(e){return this._visitor.labeler.getObjectLabel(e)}},addObject:{value:function(e){if("object"==typeof e)return this._malker.visit(e),e}},addObjectReference:{value:function(e){var t=this._visitor.builder,n=this._visitor.labeler,r=n.getObjectLabel(e);return{thisIsAReferenceCreatedByMontageSerializer:!0,reference:t.createObjectReference(r)}}},setProperty:{value:function(e,t,n){var r,i=this._visitor.builder;r=i.top.getProperty("properties"),i.push(r),this._visitor.setProperty(this._malker,e,t,n),i.pop()}},setAllProperties:{value:function(){var e,t=this._visitor.builder;e=t.top.getProperty("properties"),t.push(e),this._visitor.setSerializableObjectProperties(this._malker,this._object),t.pop()}},setUnit:{value:function(e){this._visitor.setObjectCustomUnit(this._malker,this._object,e)}},setAllUnits:{value:function(e){this._visitor.setObjectCustomUnits(this._malker,this._object)}}});t.SelfSerializer=i}}),montageDefine("ad36237","core/serialization/serializer/unit-serializer",{dependencies:["../../core"],factory:function(e,t,n){var r=e("../../core").Montage,i=r.specialize.call(Object,{_malker:{value:null},_visitor:{value:null},_object:{value:null},initWithMalkerAndVisitorAndObject:{value:function(e,t,n){return this._malker=e,this._visitor=t,this._object=n,this}},getObjectLabel:{value:function(e){return this.addObjectReference(e),this._visitor.labeler.getObjectLabel(e)}},addObject:{value:function(e){if("object"==typeof e)return this._malker.visit(e),e}},addObjectReference:{value:function(e){var t=this._visitor.builder,n=this._visitor.labeler,r=n.getObjectLabel(e);return{thisIsAReferenceCreatedByMontageSerializer:!0,reference:t.createObjectReference(r)}}}});t.UnitSerializer=i}}),montageDefine("ad36237","ui/component",{dependencies:["../core/core","../core/target","../core/template","../core/document-resources","../core/gate","../core/promise","../core/event/event-manager","../core/serialization/alias","../core/logger","../core/logger","../core/logger","../core/logger","../core/logger","collections/weak-map","collections/map","collections/set","../core/application","../core/core","../core/core"],factory:function(e,t,n){function r(e){return e?e._montage_metadata.objectName+":"+Object.hash(e)+" id: "+e.identifier:"NIL"}var i=e("../core/core").Montage,o=e("../core/target").Target,a=e("../core/template").Template,s=e("../core/document-resources").DocumentResources,l=e("../core/gate").Gate,u=e("../core/promise").Promise,c=e("../core/event/event-manager").defaultEventManager,h=e("../core/serialization/alias").Alias,p=e("../core/logger").logger("component"),d=e("../core/logger").logger("Drawing performance").color.green(),f=e("../core/logger").logger("drawing list").color.blue(),v=e("../core/logger").logger("drawing needsDraw").color.violet(),m=e("../core/logger").logger("drawing").color.blue(),g=e("collections/weak-map"),_=e("collections/map"),b=e("collections/set"),y="data-montage-le-component",w="data-montage-le-arg",E="data-montage-le-arg-begin",C="data-montage-le-arg-end",O=i.specialize({component:{value:null},fromCssClass:{value:null},cssClass:{value:null},toCssClass:{value:null},hasOneFrameDelay:{value:!1},_animationAndTransitionProperties:{value:["-webkit-animation","-moz-animation","-ms-animation","animation","-webkit-transition","-moz-transition","-ms-transition","transition"]},_emptyArray:{value:[]},_parseComputedStyleTimeValue:{value:function(e){var t,n;if("string"!=typeof e||""===e)return this._emptyArray;for(t=e.replace(/s| /g,"").split(","),n=0;n<t.length;n++)t[n]=+t[n];return t}},_getMaxAnimationTime:{value:function(){var e,t,n,r,i,o,a,s=0;if(this.component&&this.component.element){for(e=global.getComputedStyle(this.component.element),o=0;o<this._animationAndTransitionProperties.length;o++)for(t=this._parseComputedStyleTimeValue(e.getPropertyValue(this._animationAndTransitionProperties[o]+"-duration")),n=this._parseComputedStyleTimeValue(e.getPropertyValue(this._animationAndTransitionProperties[o]+"-delay")),i=Math.max(t.length,n.length),a=0;a<i;a++)r="undefined"==typeof t[a]?t[0]||0:t[a],r+="undefined"==typeof n[a]?n[0]||0:n[a],r>s&&(s=r);s>0&&(s+=.3)}return s}},_onAnimationsCompletedTimeout:{value:null},_cancelOnAnimationsCompletedEvent:{value:function(){clearTimeout(this._onAnimationsCompletedTimeout)}},_onAnimationsCompleted:{value:function(e){var t,n=this._getMaxAnimationTime();return n?(t=this,this._cancelOnAnimationsCompletedEvent(),void(this._onAnimationsCompletedTimeout=setTimeout(function(){e.call(t)},1e3*n))):void e.call(this)}},_needsToMeasureAnimationTimeOnNextDraw:{value:!1},_needsToMeasureAnimationTime:{value:!1},handleDidDraw:{value:function(e){this._needsToMeasureAnimationTimeOnNextDraw?(this.fromCssClass&&this.component.classList.remove(this.fromCssClass),this.cssClass&&this.component.classList.add(this.cssClass),this.toCssClass&&this.component.classList.add(this.toCssClass),this._needsToMeasureAnimationTimeOnNextDraw=!1,this._needsToMeasureAnimationTime=!0,this.component.needsDraw=!0):this._needsToMeasureAnimationTime&&(this._onAnimationsCompleted(function(){this._finishedDeferred&&(this._finishedDeferred.resolve(),this._finishedDeferred=null)}),this.component.removeEventListener("didDraw",this,!1),this._needsToMeasureAnimationTime=!1)}},_finishedDeferred:{value:null},finished:{get:function(){return this._finishedDeferred||(this._finishedDeferred=u.pending()),this._finishedDeferred.promise}},play:{value:function(){this.component&&(this._finishedDeferred&&!this._cancelled||(this._cancelled=!1,this._finishedDeferred=u.pending()),this.component.needsDraw=!0,this.fromCssClass?(this.fromCssClass&&this.component.classList.add(this.fromCssClass),this.cssClass&&this.component.classList.remove(this.cssClass),this.toCssClass&&this.component.classList.remove(this.toCssClass),this._needsToMeasureAnimationTime=!1,this._needsToMeasureAnimationTimeOnNextDraw=!0):this.hasOneFrameDelay?(this._needsToMeasureAnimationTime=!1,this._needsToMeasureAnimationTimeOnNextDraw=!0):(this.cssClass&&this.component.classList.add(this.cssClass),this.toCssClass&&this.component.classList.add(this.toCssClass),this._needsToMeasureAnimationTime=!0,this._needsToMeasureAnimationTimeOnNextDraw=!1),this.component.addEventListener("didDraw",this,!1))}},_cancelled:{value:!1},cancel:{value:function(){this._cancelled=!0,this.fromCssClass&&this.component.classList.remove(this.fromCssClass),this.cssClass&&this.component.classList.remove(this.cssClass),this.toCssClass&&this.component.classList.remove(this.toCssClass),this.component.removeEventListener("didDraw",this,!1),this._finishedDeferred&&this._finishedDeferred.reject()}}}),j=t.Component=o.specialize({DOM_ARG_ATTRIBUTE:{value:"data-arg"},drawListLogger:{value:f},delegate:{value:null},_templateObjects:{serializable:!1,value:null},templateObjects:{serializable:!1,get:function(){return this._templateObjects||(this._templateObjects=Object.create(null)),!this._setupTemplateObjectsCompleted&&this._templateDocumentPart&&this._setupTemplateObjects(this._templateDocumentPart.objects),this._templateObjects},set:function(e){this._templateObjects=e}},_nextTarget:{value:null},nextTarget:{get:function(){return this._nextTarget||this.parentComponent},set:function(e){this._nextTarget=e}},_ownerDocumentPart:{value:null},_templateDocumentPart:{value:null},_domArguments:{value:void 0},_domArgumentNames:{value:void 0},_dispatchActionEvent:{value:function(){this.dispatchEvent(this.createActionEvent())},enumerable:!1},createActionEvent:{value:function(){var e=document.createEvent("CustomEvent");return e.initCustomEvent("action",!0,!0,null),e}},canDrawGate:{get:function(){return this._canDrawGate||(this._canDrawGate=(new l).initWithDelegate(this),this._canDrawGate.setField("componentTreeLoaded",!1)),this._canDrawGate},enumerable:!1},_blockDrawGate:{value:null},blockDrawGate:{enumerable:!1,get:function(){return this._blockDrawGate||(this._blockDrawGate=(new l).initWithDelegate(this),this._blockDrawGate.setField("element",!1),this._blockDrawGate.setField("drawRequested",!1)),this._blockDrawGate}},_firstDraw:{enumerable:!1,value:!0},_completedFirstDraw:{enumerable:!1,value:!1},originalElement:{value:null},_element:{enumerable:!1,value:null},element:{get:function(){return this._element},set:function(e){if(null==e)return void console.warn("Tried to set element of ",this," to ",e);if(e.component&&e.component!==this)throw new Error("Element "+e+" is already assigned to another component: "+e.component);if(global._montage_le_flag&&e.setAttribute(y,i.getInfoForObject(this).moduleId),this.isDeserializing)this.eventManager.registerEventHandlerForElement(this,e),this._isTemplateInstantiated?this._templateElement||(this._templateElement=e):(this._element=e,!this.blockDrawGate.value&&this._element&&this.blockDrawGate.setField("element",!0));else{if(!this._firstDraw)return void console.error("Cannot change element of ",this," after it has been set");this.eventManager.registerEventHandlerForElement(this,e),this._element=e,!this.blockDrawGate.value&&this._element&&this.blockDrawGate.setField("element",!0)}this._initializeClassListFromElement(e)}},getElementId:{value:function(){var e=this._element;if(e)return e.getAttribute("data-montage-id")}},_initDomArguments:{value:function(){var e,t,n,r,i=this.element;e=i.querySelectorAll("*["+this.DOM_ARG_ATTRIBUTE+"]"),e.length&&(t={});e:for(var o,a=0;o=e[a];a++){for(r=o;(r=r.parentNode)!==i;)if(r.component)continue e;this._findAndDetachComponents(o),o.parentNode.removeChild(o),n=o.getAttribute(this.DOM_ARG_ATTRIBUTE),o.removeAttribute(this.DOM_ARG_ATTRIBUTE),t[n]=o}this._domArguments=t}},_sharedEmptyArray:{value:[]},getDomArgumentNames:{value:function(){return void 0===this._domArgumentNames&&(this._domArgumentNames=this._domArguments?Object.keys(this._domArguments):this._sharedEmptyArray),this._domArgumentNames}},extractDomArgument:{value:function(e){if(this._domArguments){var t;return t=this._domArguments[e],this._domArguments[e]=null,t}return null}},_getTemplateDomArgument:{value:function(e){var t,n,r,i,o,a,s=this._ownerDocumentPart.template;r=s.getElementById(this.getElementId()),t=r.querySelectorAll("*["+this.DOM_ARG_ATTRIBUTE+"='"+e+"']");e:for(var l,u=0;l=t[u];u++){for(n=l;(n=n.parentNode)!==r;)if(i=s.getElementId(n),i&&(o=s.getSerialization(),a=o.getSerializationLabelsWithElements(i),a.length>0))continue e;return l}}},getTemplateArgumentElement:{value:function(e){var t,n,r,i=this._ownerDocumentPart.template;if(global._montage_le_flag)var o=this.ownerComponent._montage_metadata.moduleId,a=this._montage_metadata.label;return"*"===e?(t=i.getElementById(this.getElementId()),n=i.document.createRange(),n.selectNodeContents(t),r=n.cloneContents(),global._montage_le_flag&&t.children.length>0&&this._leTagStarArgument(o,a,r)):(r=this._getTemplateDomArgument(e).cloneNode(!0),r.removeAttribute(this.DOM_ARG_ATTRIBUTE),global._montage_le_flag&&this._leTagNamedArgument(o,a,r,e)),r}},getTemplateArgumentSerialization:{value:function(e){var t=this._ownerDocumentPart.template;return t._createSerializationWithElementIds(e)}},resolveTemplateArgumentTemplateProperty:{value:function(e){var t,n,r,o,a=e.indexOf(":"),s=e.slice(0,a),l=e.slice(a),u=this._templateDocumentPart;if(i.getInfoForObject(this).label===s)return u&&(r=u.objects[l]),r instanceof h&&(n=u.objects[r.componentLabel],t=r.value.slice(1),o=n.resolveTemplateArgumentTemplateProperty(t),o||(o=t)),o}},setElementWithParentComponent:{value:function(e,t){this._alternateParentComponent=t,this.element!==e&&(this.element=e)}},_application:{value:null},application:{enumerable:!1,get:function(){return this._application||(j.prototype._application=e("../core/application").application)}},eventManager:{enumerable:!1,get:function(){return c}},rootComponent:{enumerable:!1,get:function(){return T}},elementControllerFromEvent:{enumerable:!1,value:function(e,t){return t}},_alternateParentComponent:{value:null},__parentComponent:{value:null},_parentComponent:{set:function(e){this.__parentComponent=e,this.dispatchOwnPropertyChange("parentComponent",e)},get:function(){return this.__parentComponent}},parentComponent:{enumerable:!1,get:function(){return this._parentComponent}},findParentComponent:{value:function(){var e,t=this.element,n=this.eventManager;if(t){for(;null!=(e=t.parentNode)&&null==n.eventHandlerForElement(e);)t=e;return e?n.eventHandlerForElement(e):this._alternateParentComponent}}},querySelectorComponent:{value:function(e){if("string"!=typeof e)throw"querySelectorComponent: Selector needs to be a string.";var t=e.match(/^\s*(?:@([^>\s]+))?(?:\s*(>)?\s*@([^>\s]+)(.*))?$/);if(!t)throw'querySelectorComponent: Syntax error "'+e+'"';var n,r,o,a=this.childComponents,s=t[1],l=(t[2]||" ",t[3]),u=t[4];if(s)for(u=l?"@"+l+u:"",r=0,o;o=a[r];r++){if(s===i.getInfoForObject(o).label)return u?o.querySelectorComponent(u):o;if(n=o.querySelectorComponent(e))return n}else for(r=0,o;o=a[r];r++)if(l===i.getInfoForObject(o).label)return u?o.querySelectorComponent(u):o;return null}},querySelectorAllComponent:{value:function(e,t){if("string"!=typeof e)throw"querySelectorComponent: Selector needs to be a string.";var n=e.match(/^\s*(?:@([^>\s]+))?(?:\s*(>)?\s*@([^>\s]+)(.*))?$/);if(!n)throw'querySelectorComponent: Syntax error "'+e+'"';var r,o,a=this.childComponents,s=n[1],l=(n[2]||" ",n[3]),u=n[4],c=[];if(s)for(u=l?"@"+l+u:"",r=0,o;o=a[r];r++)s!==i.getInfoForObject(o).label||t&&t!==o.ownerComponent?c=c.concat(o.querySelectorAllComponent(e,t)):u?c=c.concat(o.querySelectorAllComponent(u)):c.push(o);else for(r=0,o;o=a[r];r++)l!==i.getInfoForObject(o).label||t&&t!==o.ownerComponent||(u?c=c.concat(o.querySelectorAllComponent(u,t)):c.push(o));return c}},template:{enumerable:!1,value:null},hasTemplate:{enumerable:!1,value:!0},_templateModuleId:{serializable:!1,value:null},_template:{value:null},_treeLevel:{value:0},_addChildComponent:{value:function(e){return this.addChildComponent(e)}},addChildComponent:{value:function(e){this.childComponents.indexOf(e)===-1&&(this.childComponents.push(e),e._parentComponent=this,e._prepareForEnterDocument(),e.needsDraw&&!this.rootComponent.isComponentWaitingNeedsDraw(e)&&e._addToParentsDrawList()),e._shouldBuildIn=!0}},attachToParentComponent:{value:function(){this.detachFromParentComponent(),this._parentComponent=null;var e,t,n=this.findParentComponent();if(n){e=n.childComponents;for(var r=0;t=e[r];r++){var i=t.findParentComponent();i===this&&(n.removeChildComponent(t),i.addChildComponent(t))}n.addChildComponent(this)}}},detachFromParentComponent:{value:function(){var e=this.parentComponent;e&&e.removeChildComponent(this)}},removeChildComponent:{value:function(e){var t=this.childComponents,n=t.indexOf(e);n>-1&&(e._exitDocument(),t.splice(n,1),e._parentComponent=null,e._alternateParentComponent=null,e._addedToDrawList&&(e._addedToDrawList=!1,n=this._drawList.indexOf(e),this._drawList.splice(n,1)),this.rootComponent.removeFromCannotDrawList(e))}},_childComponents:{value:null},childComponents:{enumerable:!1,get:function(){return this._childComponents||(this._childComponents=[])}},_needsEnterDocument:{value:!1},_inDocument:{value:!1},__exitDocument:{value:function(){this._inDocument&&"function"==typeof this.exitDocument&&(this.exitDocument(),this._inDocument=!1)}},_exitDocument:{value:function(){var e;this._needsEnterDocument?this._needsEnterDocument=!1:(e=function(t){for(var n,r=t.childComponents,i=0;n=r[i];i++)n._isComponentExpanded&&e(n);t._inDocument&&t.__exitDocument()})(this)}},exitDocument:{value:function(){this.isActiveTarget&&(c.activeTarget=this.nextTarget)}},_prepareForEnterDocument:{value:function(){this._firstDraw?this._needsEnterDocument=!0:(this.needsDraw=!0,this.traverseComponentTree(function(e){return!e._needsEnterDocument&&(e._needsEnterDocument=!0,void(e.needsDraw=!0))}))}},ownerComponent:{enumerable:!1,value:null},components:{enumerable:!1,value:{}},_isComponentExpanded:{enumerable:!1,value:!1},_isTemplateLoaded:{enumerable:!1,value:!1},_isTemplateInstantiated:{enumerable:!1,value:!1},cleanupDeletedComponentTree:{value:function(e){e&&this.cancelBindings(),this.needsDraw=!1,this.traverseComponentTree(function(t){e&&t.cancelBindings(),t.needsDraw=!1})}},_newDomContent:{enumerable:!1,value:null},_elementsToAppend:{value:null},domContent:{serializable:!1,get:function(){return this._element?Array.prototype.slice.call(this._element.childNodes,0):null},set:function(e){var t,n,r,i=[];if(this._elementsToAppend||(this._elementsToAppend=[]),this._newDomContent=e,this.needsDraw=!0,null===this._newDomContent&&(this._shouldClearDomContentOnNextDraw=!0),
"function"==typeof this.contentWillChange&&this.contentWillChange(e),t=this.childComponents,e)for(this._componentsPendingBuildOut||(this._componentsPendingBuildOut=[]),n=t.length-1;n>=0;n--)this._componentsPendingBuildOut.indexOf(t[n])===-1&&this._componentsPendingBuildOut.push(t[n]);else for(this._componentsPendingBuildOut=[],n=t.length-1;n>=0;n--)t[n]._shouldBuildOut=!0;if(e instanceof Element)this._elementsToAppend.push(e),this._findAndDetachComponents(e,i);else if(e&&e[0])for(n=0;n<e.length;n++)this._elementsToAppend.push(e[n]),this._findAndDetachComponents(e[n],i);for(n=0;r=i[n];n++)this.addChildComponent(r)}},_shouldClearDomContentOnNextDraw:{value:!1},_findAndDetachComponents:{value:function(e,t){var n,r=e.component;if(t||(t=[]),r)r.detachFromParentComponent(),t.push(r);else{n=e.children||e.childNodes;for(var i,o=0;i=n[o];o++)this._findAndDetachComponents(i,t)}return t}},clonesChildComponents:{writable:!1,value:!1},_innerTemplate:{value:null},innerTemplate:{serializable:!1,get:function(){var e,t,n,r,i,o,a,s=this._innerTemplate;if(!s&&(e=this._ownerDocumentPart)){t=e.template,n=this.getElementId(),s=t.createTemplateFromElementContents(n),r=s.getSerialization(),i=r.getExternalObjectLabels(),o=e.objects,a=Object.create(null);for(var l,u=0;l=i[u];u++)a[l]=o[l];s.setInstances(a),this._innerTemplate=s}return s},set:function(e){this._innerTemplate=e}},canDraw:{value:function(){return this._canDraw}},_canDraw:{get:function(){return!this._canDrawGate||this._canDrawGate.value},set:function(e){T.componentCanDraw(this,e)},enumerable:!1},_prepareCanDraw:{enumerable:!1,value:function(){if(!this._isComponentTreeLoaded)return this.loadComponentTree()}},_blocksOwnerComponentDraw:{value:!1},_updateOwnerCanDrawGate:{value:function(){this._blocksOwnerComponentDraw&&this.ownerComponent&&this.ownerComponent.canDrawGate.setField(this,this.canDrawGate.value)}},_isComponentTreeLoaded:{value:!1},shouldLoadComponentTree:{value:!0},_loadComponentTreeDeferred:{value:null},loadComponentTree:{value:function(){if(!this._loadComponentTreeDeferred){this.canDrawGate.setField("componentTreeLoaded",!1),(this.needsDraw||this.hasTemplate)&&(this._canDraw=!1);var e=this;this._loadComponentTreeDeferred=this.expandComponent().then(function(){if(e.hasTemplate||e.shouldLoadComponentTree){var t,n,r=e._childComponents;if(r&&r.length){t=[];for(var i=0;n=r[i];i++)t.push(n.loadComponentTree());return u.all(t)}return u.resolve(null)}}).then(function(){e._isComponentTreeLoaded=!0,e._needsEnterDocument&&(e.needsDraw=!0),e.canDrawGate.setField("componentTreeLoaded",!0)})["catch"](function(e){console.error(e)})}return this._loadComponentTreeDeferred}},traverseComponentTree:{value:function(e,t){function n(){var n,i,o=r.childComponents;if(e&&e(r)===!1)return void(t&&t());if(0===(i=o.length))return void(t&&t());for(var a=function(){0===--i&&t&&t()},s=0;n=o[s];s++)n.traverseComponentTree(e,a)}var r=this;this._isComponentExpanded?n():t&&t()}},_expandComponentPromise:{value:null},expandComponent:{value:function(){if(!this._expandComponentPromise)if(this.hasTemplate){var e=this;this._expandComponentPromise=this._instantiateTemplate().then(function(){e._isComponentExpanded=!0,e._addTemplateStylesIfNeeded(),e.needsDraw=!0})["catch"](function(e){console.error(e)})}else this._isComponentExpanded=!0,this._expandComponentPromise=u.resolve();return this._expandComponentPromise}},_templateObjectDescriptor:{value:{enumerable:!0,configurable:!0}},_setupTemplateObjects:{value:function(e){return this._templateObjects=this._templateObjects||Object.create(null),this._addTemplateObjects(e),this._setupTemplateObjectsCompleted=!0,this._templateObjects}},_setupTemplateObjectsCompleted:{value:!1},_addTemplateObjects:{value:function(e){var t=this._templateObjectDescriptor,n=this._templateObjects;for(var r in e){var i=e[r];"object"==typeof i&&null!=i&&(j.prototype.isPrototypeOf(i)&&i!==this&&i.parentComponent!==this?(t.get=this._makeTemplateObjectGetter(this,r,i),Object.defineProperty(n,r,t)):n[r]=i)}}},_makeTemplateObjectGetter:{value:function(e,t,n){var r,i,o,a="@"+t;return function(){if(r)return e.querySelectorAllComponent(a,e);if(i=e.querySelectorAllComponent(a,e),1===i.length)for(o=i[0];o=o.parentComponent;){if(o===e)return Object.defineProperty(this,t,{value:i[0]}),i[0];if(o.clonesChildComponents)break}else if(0===i.length)return n;return r=!0,i}}},_instantiateTemplate:{value:function(){var e=this;return this._loadTemplate().then(function(t){if(!e._element)return u.reject(new Error("Cannot instantiate template without an element.",e));var n=null,r=e._element.ownerDocument;return n||(n=Object.create(null)),n.owner=e,e._isTemplateInstantiated=!0,t.instantiateWithInstances(n,r).then(function(t){t.parentDocumentPart=e._ownerDocumentPart,e._templateDocumentPart=t,t.fragment=null,n=null},function(e){throw new Error(t.getBaseUrl()+":"+e.stack||e)})})}},_templateDidLoad:{value:function(e){this._templateDocumentPart=e,this._templateObjects&&this._setupTemplateObjects(e.objects)}},_loadTemplatePromise:{value:null},_loadTemplate:{value:function(){var e;if(!this._loadTemplatePromise){var t=this;e=i.getInfoForObject(this),this._loadTemplatePromise=a.getTemplateWithModuleId(this.templateModuleId,e.require).then(function(e){return t._template=e,t._isTemplateLoaded=!0,e})}return this._loadTemplatePromise}},templateModuleId:{get:function(){return this._templateModuleId||this._getDefaultTemplateModuleId()}},_getDefaultTemplateModuleId:{value:function(){var e,t,n,r;return r=i.getInfoForObject(this),n=r.moduleId,t=n.lastIndexOf("/"),e=n+"/"+n.slice(t===-1?0:t+1,-5)+".html"}},deserializedFromSerialization:{value:function(){this.attachToParentComponent()}},_deserializedFromTemplate:{value:function(e,t,n){i.getInfoForObject(this).label=t,this._ownerDocumentPart=n,this.hasOwnProperty("identifier")||(this.identifier=t),this.ownerComponent||(j.prototype.isPrototypeOf(e)?this.ownerComponent=e:this.ownerComponent=this.rootComponent,this._updateOwnerCanDrawGate()),this._needsDrawInDeserialization&&(this.needsDraw=!0)}},blueprintModuleId:{serializable:!1,enumerable:!1,get:function(){return this.objectDescriptorModuleId}},blueprint:e("../core/core")._objectDescriptorDescriptor,objectDescriptor:e("../core/core")._objectDescriptorDescriptor,objectDescriptorModuleId:{serializable:!1,enumerable:!1,get:function(){var e=i.getInfoForObject(this),t=e&&!e.isInstance?this:Object.getPrototypeOf(this);if(!Object.getOwnPropertyDescriptor(t,"_objectDescriptorModuleId")||!t._objectDescriptorModuleId){e=i.getInfoForObject(t);var n=e.moduleId,r=n.lastIndexOf("/"),o=n.lastIndexOf(".");r=r===-1?0:r+1,o=o===-1?n.length:o,o=o<r?n.length:o;var a;a=o<n.length&&".reel"===n.slice(o,n.length)?n+"/"+n.slice(r,o)+".meta":n.slice(0,o)+".meta",i.defineProperty(t,"_objectDescriptorModuleId",{value:a})}return t._objectDescriptorModuleId}},gateDidBecomeTrue:{value:function(e){e===this._canDrawGate?(this._canDraw=!0,this._updateOwnerCanDrawGate()):e===this._blockDrawGate&&(T.componentBlockDraw(this),this._prepareCanDraw())},enumerable:!1},gateDidBecomeFalse:{value:function(e){e===this._canDrawGate&&this._updateOwnerCanDrawGate()},enumerable:!1},_canDrawGate:{enumerable:!1,value:null},preparedForActivationEvents:{enumerable:!1,value:!1},_arrayObjectPool:{value:{pool:null,size:200,ix:0}},_getArray:{value:function(){if(null==this._arrayObjectPool.pool){this._arrayObjectPool.pool=[];for(var e=0;e<this._arrayObjectPool.size;e++)this._arrayObjectPool.pool[e]=[]}return this._arrayObjectPool.ix<this._arrayObjectPool.size?this._arrayObjectPool.pool[this._arrayObjectPool.ix++]:[]}},_disposeArray:{value:function(e){this._arrayObjectPool.ix>0&&(e.length=0,this._arrayObjectPool.pool[--this._arrayObjectPool.ix]=e)}},_drawIfNeeded:{enumerable:!1,value:function(e){var t,n,i,o,a=this._firstDraw;if(this._treeLevel=e,a&&(this.originalElement=this.element),this.needsDraw&&T.addToDrawCycle(this),this._needsEnterDocument&&(this._needsEnterDocument=!1,this._willEnterDocument(),this._enterDocument(a),"function"==typeof this.enterDocument&&this.enterDocument(a)),a&&(this.originalElement=null),null!==this._drawList&&this._drawList.length>0){for(n=this._drawList,this._drawList=this._getArray(),o=n.length,i=0;i<o;i++)t=n[i],t._addedToDrawList=!1,t.canDraw()?t._drawIfNeeded(e+1):m.isDebug&&m.debug(r(t)+" can't draw.");this._disposeArray(n)}}},_updateComponentDom:{value:function(){if(this._firstDraw){if(this._prepareForDraw(),this._composerList)for(var e,t=0,n=this._composerList.length;t<n;t++)e=this._composerList[t],e.lazyLoad||this.loadComposer(e);this._firstDraw=!1}(null!==this._newDomContent||this._shouldClearDomContentOnNextDraw)&&(m.isDebug&&p.debug("Component content changed: component ",this._montage_metadata.objectName,this.identifier," newDomContent",this._newDomContent),this._performDomContentChanges())}},_replaceElementWithTemplate:{enumerable:!1,value:function(){var e,t,n,r,i,o=this.element,a=this._templateElement,s=this.element.attributes;for(n=0;r=s[n];n++)e=r.nodeName,global._montage_le_flag&&e===y?t=r.nodeValue:"id"===e||"data-montage-id"===e?t=r.nodeValue:(i=a.getAttribute(e)||"",t=i?i+("style"===e?"; ":" ")+r.nodeValue:r.nodeValue),a.setAttribute(e,t);this._initializeClassListFromElement(a),o.parentNode?o.parentNode.replaceChild(a,o):this._canDrawOutsideDocument||console.warn("Warning: Trying to replace element ",o," which has no parentNode"),this.eventManager.unregisterEventHandlerForElement(o),this.eventManager.registerEventHandlerForElement(this,a),this._element=a,this._templateElement=null,this._newDomContent&&(this._newDomContent=null,this._shouldClearDomContentOnNextDraw=!1)}},_addTemplateStylesIfNeeded:{value:function(){var e=this._templateDocumentPart;e&&this.rootComponent.addStyleSheetsFromTemplate(e.template)}},_prepareForDraw:{value:function(){p.isDebug&&p.debug(this,"_templateElement: "+this._templateElement);var e;global._montage_le_flag&&(e=this.element.children.length>0),this._initDomArguments(),e&&this._leTagArguments(),this._templateElement&&(this._bindTemplateParametersToArguments(),this._replaceElementWithTemplate())},enumerable:!1},_leTagArguments:{value:function(){if(this!==this.rootComponent){var e=this.ownerComponent._montage_metadata.moduleId,t=this._montage_metadata.label,n=this.getDomArgumentNames();if(n&&0!==n.length)for(var r,i=0;r=n[i];i++)this._leTagNamedArgument(e,t,this._domArguments[r],r);else this._leTagStarArgument(e,t,this.element)}}},_getNodeFirstElement:{value:function(e){var t=e.firstElementChild;if(!t){t=e.firstChild;do if(t.nodeType===Node.ELEMENT_NODE)break;while(t=t.nextSibling)}return t}},_getNodeLastElement:{value:function(e){var t=e.lastElementChild;if(!t){t=e.lastChild;do if(t.nodeType===Node.ELEMENT_NODE)break;while(t=t.previousSibling)}return t}},_leTagStarArgument:{value:function(e,t,n){var r=this._getNodeFirstElement(n),i=this._getNodeLastElement(n);r.setAttribute(E,(r.getAttribute(E)||"")+" "+e+","+t),i.setAttribute(C,(i.getAttribute(C)||"")+" "+e+","+t)}},_leTagNamedArgument:{value:function(e,t,n,r){n.setAttribute(w,e+","+t+","+r)}},_bindTemplateParametersToArguments:{value:function(){var e,t,n,r,i,o,a,s=this._templateDocumentPart?this._templateDocumentPart.parameters:null,l=this._domArguments;if(n=this._validateTemplateArguments(l,s))throw n;for(var u in s)if(e=s[u],t=l?l[u]:void 0,"*"===u||"each"===u?0===this._element.childElementCount?e&&e.childElementCount>0?(o=this._element.ownerDocument.createRange(),o.selectNodeContents(e),e.parentNode.replaceChild(o.extractContents(),e)):e.parentNode.removeChild(e):(o=this._element.ownerDocument.createRange(),o.selectNodeContents(this._element),r=o.extractContents()):r=t,r){var c,h;if(r instanceof Element){var p=e.classList,d=r.component?r.component.classList:r.classList;for(c=0,h=p.length;c<h;c++)d.add(p[c])}for(i=this._findAndDetachComponents(r),e.parentNode.replaceChild(r,e),c=0;a=i[c];c++)a.attachToParentComponent()}}},_validateTemplateArguments:{value:function(e,t){var n,r=t?Object.keys(t):void 0;if(r&&0!==r.length){for(n in e)if("*"!==n&&!(n in t))return new Error('"'+n+'" parameter does not exist in '+this.templateModuleId);var i=t["*"];if(i)for(n in t)if("*"!==n&&i.contains(t[n]))return new Error('"'+n+'" parameter cannot be used within an element with the star parameter')}}},prepareForActivationEvents:{enumerable:!1,value:null},_prepareForActivationEvents:{value:function(){if("function"==typeof this.prepareForActivationEvents&&this.prepareForActivationEvents(),this._composerList)for(var e,t=0,n=this._composerList.length;t<n;t++)e=this._composerList[t],e.lazyLoad&&this.loadComposer(e);this.preparedForActivationEvents=!0}},_performDomContentChanges:{value:function(){var e,t,n,r=this._newDomContent;if(r||this._shouldClearDomContentOnNextDraw){for(e=this._element,n=e.childNodes.length-1;n>=0;n--)e.childNodes[n].component||e.removeChild(e.childNodes[n]);if(this._elementsToAppend)for(;this._elementsToAppend.length;)t=this._elementsToAppend.shift(),e.contains(t)||e.appendChild(t);this._newDomContent=null,"function"==typeof this.contentDidChange&&this.contentDidChange(),this._shouldClearDomContentOnNextDraw=!1}}},prepareForDraw:{enumerable:!1,value:null},draw:{enumerable:!1,value:Function.noop},willDraw:{enumerable:!1,value:null},didDraw:{enumerable:!1,value:Function.noop},_addedToDrawList:{value:!1},_addToParentsDrawList:{enumerable:!1,value:function(){if(!this._addedToDrawList){var e=this._parentComponent;e?(e._addToDrawList(this),this.drawListLogger.isDebug&&this.drawListLogger.debug(r(this)+" added to "+r(e)+"'s drawList")):this.drawListLogger.isDebug&&this.drawListLogger.debug(this,"parentComponent is null")}}},_needsDraw:{value:!1},_needsDrawInDeserialization:{value:!1},needsDraw:{enumerable:!1,get:function(){return this._needsDraw},set:function(e){return this.isDeserializing?void(this._needsDrawInDeserialization=!0):(e=!!e,void(this._needsDraw!==e&&(v.isDebug&&v.debug("needsDraw toggled "+e+" for "+this._montage_metadata.objectName),this._needsDraw=e,e&&(this.canDrawGate.value?this._addToParentsDrawList():this.blockDrawGate.setField("drawRequested",!0)))))}},_drawList:{value:null},__addToDrawList:{enumerable:!1,value:function(e){null===this._drawList?(this._drawList=[e],e._addedToDrawList=!0):this._drawList.indexOf(e)===-1&&(this._drawList.push(e),e._addedToDrawList=!0)}},_addToDrawList:{enumerable:!1,value:function(e){this.__addToDrawList(e),this._addToParentsDrawList()}},_templateElement:{enumerable:!1,value:null},surrenderPointer:{value:function(e,t){return!0}},_composerList:{value:null,serializable:!1},composerList:{get:function(){return this._composerList||(this._composerList=[]),this._composerList},serializable:!1},addComposer:{value:function(e){this.addComposerForElement(e,e.element)}},addComposerForElement:{value:function(e,t){e.component=this,e.element=t,this.composerList.push(e),this._firstDraw||(e.lazyLoad?this.preparedForActivationEvents&&this.loadComposer(e):this.loadComposer(e))}},loadComposer:{value:function(e){this._composerList&&this._composerList.indexOf(e)>-1&&o.prototype.loadComposer.call(this,e)}},unloadComposer:{value:function(e){this._composerList&&this._composerList.indexOf(e)>-1&&o.prototype.unloadComposer.call(this,e)}},scheduleComposer:{value:function(e){this.rootComponent.addToComposerList(e)}},removeComposer:{value:function(e){if(this._composerList)for(var t=0,n=this._composerList.length;t<n;t++)if(this._composerList[t]===e){this.unloadComposer(this._composerList[t]),this._composerList.splice(t,1);break}}},clearAllComposers:{value:function(){if(this._composerList){for(var e=this._composerList,t=0,n=e.length;t<n;t++)this.unloadComposer(e[t]);e.length=0}}},localizer:{value:null},_waitForLocalizerMessages:{value:!1},waitForLocalizerMessages:{enumerable:!1,get:function(){return this._waitForLocalizerMessages},set:function(e){if(this._waitForLocalizerMessages!==e)if(e!==!0||this.localizer.messages)this._waitForLocalizerMessages=!1,this.canDrawGate.setField("messages",!0);else{if(!this.localizer)throw"Cannot wait for messages on localizer if it is not set";this._waitForLocalizerMessages=!0,p.debug(this,"waiting for messages from localizer"),this.canDrawGate.setField("messages",!1);var t=this;this.localizer.messagesPromise.then(function(e){p.isDebug&&p.debug(t,"got messages from localizer"),t.canDrawGate.setField("messages",!0)})}}},__elementAttributeValues:{value:null},_elementAttributeValues:{get:function(){return this.__elementAttributeValues||(this.__elementAttributeValues={})}},_elementAttributeDescriptors:{value:null},_getElementAttributeDescriptor:{value:function(e){for(var t,n=this;n&&n._elementAttributeDescriptors&&!(t=n._elementAttributeDescriptors[e]);)n=Object.getPrototypeOf(n);return t}},__shouldBuildIn:{value:!0},_shouldBuildIn:{get:function(){return this.__shouldBuildIn},set:function(e){var t;e=!!e,this.__shouldBuildIn=e,e&&(this.parentComponent&&this.parentComponent._componentsPendingBuildOut&&(t=this.parentComponent._componentsPendingBuildOut.indexOf(this),t!==-1&&this.parentComponent._componentsPendingBuildOut.splice(t,1)),this._shouldBuildOut=!1,this._inDocument&&this._buildIn())}},__shouldBuildOut:{value:!1},_shouldBuildOut:{get:function(){return this.__shouldBuildOut},set:function(e){e=!!e,this.__shouldBuildOut=e,e&&(this._shouldBuildIn=!1,this._inDocument&&this._buildOut())}},buildInInitialAnimation:{get:function(){var e=null;return this._activeBuildInAnimation&&"object"==typeof this._activeBuildInAnimation&&"undefined"!=typeof this._activeBuildInAnimation.cssClass&&(e=new O,e.component=this,e.fromCssClass=this._activeBuildInAnimation.fromCssClass,e.cssClass=this._activeBuildInAnimation.cssClass,e.toCssClass=this._activeBuildInAnimation.toCssClass),e}},buildInSwitchAnimation:{get:function(){var e=null;return this._activeBuildInAnimation&&"object"==typeof this._activeBuildInAnimation&&"undefined"!=typeof this._activeBuildInAnimation.cssClass&&(e=new O,e.component=this,e.cssClass=this._activeBuildInAnimation.cssClass,e.toCssClass=this._activeBuildInAnimation.toCssClass),e}},buildOutInitialAnimation:{get:function(){var e=null;return this._activeBuildOutAnimation&&"object"==typeof this._activeBuildOutAnimation&&"undefined"!=typeof this._activeBuildOutAnimation.cssClass&&(e=new O,e.component=this,e.hasOneFrameDelay=!0,e.fromCssClass=this._activeBuildOutAnimation.fromCssClass,e.cssClass=this._activeBuildOutAnimation.cssClass,e.toCssClass=this._activeBuildOutAnimation.toCssClass),e}},buildOutSwitchAnimation:{get:function(){var e=null;return this._activeBuildOutAnimation&&"object"==typeof this._activeBuildOutAnimation&&"undefined"!=typeof this._activeBuildOutAnimation.cssClass&&(e=new O,e.component=this,e.cssClass=this._activeBuildOutAnimation.cssClass,e.toCssClass=this._activeBuildOutAnimation.toCssClass),e}},buildInAnimation:{value:null},buildOutAnimation:{value:null},buildInAnimationOverride:{value:null},buildOutAnimationOverride:{value:null},_activeBuildInAnimation:{value:null},_activeBuildOutAnimation:{value:null},_updateActiveBuildAnimations:{value:function(){this.buildInAnimationOverride?this._activeBuildInAnimation=this.buildInAnimationOverride:this._activeBuildInAnimation=this.buildInAnimation,this.buildOutAnimationOverride?this._activeBuildOutAnimation=this.buildOutAnimationOverride:this._activeBuildOutAnimation=this.buildOutAnimation}},_currentBuildAnimation:{value:null},_buildIn:{value:function(){var e=this;this._currentBuildAnimation&&this._currentBuildAnimation.cancel(),this._element&&this._element.parentNode&&this._element.parentNode.component&&(this._isElementAttachedToParent?this._currentBuildAnimation=this.buildInSwitchAnimation:(this._updateActiveBuildAnimations(),this._currentBuildAnimation=this.buildInInitialAnimation),this._currentBuildAnimation&&(this._currentBuildAnimation.play(),this._currentBuildAnimation.finished.then(function(){e._currentBuildAnimation.cancel(),e._currentBuildAnimation=null,e.dispatchEventNamed("buildInEnd",!0,!0)},function(){})))}},_buildOut:{value:function(){var e=this;this._currentBuildAnimation?(this._currentBuildAnimation.cancel(),this._currentBuildAnimation=this.buildOutSwitchAnimation):(this._updateActiveBuildAnimations(),this._currentBuildAnimation=this.buildOutInitialAnimation),this._element&&this._element.parentNode&&this._element.parentNode.component&&(this._currentBuildAnimation?(this._currentBuildAnimation.play(),this._currentBuildAnimation.finished.then(function(){var t=e.parentComponent;e._currentBuildAnimation.cancel(),e._currentBuildAnimation=null,e.detachFromParentComponent(),e.buildInAnimationOverride=null,e.buildOutAnimationOverride=null,e._element.parentNode.component&&e._element.parentNode.removeChild(e._element),e._isElementAttachedToParent=!1,t.dispatchEventNamed("buildOutEnd",!0,!0)},function(){})):(this.detachFromParentComponent(),this.buildInAnimationOverride=null,this.buildOutAnimationOverride=null,this._isElementAttachedToParent&&(this._element.parentNode&&this._element.parentNode.component&&this._element.parentNode.removeChild(this._element),this._isElementAttachedToParent=!1)))}},_willEnterDocument:{value:function(){var e;e=new CustomEvent("willEnterDocument",{details:{component:this},bubbles:!1}),this.dispatchEvent(e),this._inDocument=!0,this.parentComponent&&this.parentComponent._childWillEnterDocument(),this.__shouldBuildIn&&this._buildIn(),this._isElementAttachedToParent=!0,this.__shouldBuildOut&&this._buildOut()}},_childWillEnterDocument:{value:function(){if(this._componentsPendingBuildOut)for(;this._componentsPendingBuildOut.length;)this._componentsPendingBuildOut.pop()._shouldBuildOut=!0}},_enterDocument:{value:function(e){var t;if(e){t=this.originalElement;var n,r,i,o,a,s,l;if(n=t.attributes)for(i=n.length,r=0;r<i;r++)o=n[r].name,a=n[r].value,l=this._getElementAttributeDescriptor(o,this),(l||"undefined"!=typeof this[o])&&"undefined"==typeof this._elementAttributeValues[o]&&(this._elementAttributeValues[o]=a,"undefined"!=typeof this[o]&&null!=this[o]||(this[o]=a));if(l=this._getElementAttributeDescriptor("textContent",this)){var u=t.textContent;"undefined"==typeof this._elementAttributeValues.textContent&&(this._elementAttributeValues.textContent=u,null==this.textContent&&(this.textContent=u))}if(this._elementAttributeDescriptors)for(s in this._elementAttributeDescriptors){l=this._elementAttributeDescriptors[s];var c="_"+s;null===this[c]&&null!==l&&"value"in l&&(this[c]=l.value)}}}},_draw:{value:function(){var e,t=this.element;if(null!==this.__elementAttributeValues)for(var n in this._elementAttributeValues)if(this._elementAttributeValues.hasOwnProperty(n)){var r=this[n];e=this._getElementAttributeDescriptor(n,this),e&&("boolean"===e.dataType?r===!0?(t[n]=!0,t.setAttribute(n,n.toLowerCase())):(t[n]=!1,t.removeAttribute(n)):"undefined"!=typeof r&&("textContent"===n?t.textContent=r:t.setAttribute(n,r))),delete this._elementAttributeValues[n]}this._drawClassListIntoComponent()}},_classList:{value:null},_classListDirty:{value:!1},classList:{get:function(){return null===this._classList&&(this._classList=new b,this._subscribeToToClassListChanges(),this._initializeClassListFromElement(this.element)),this._classList}},_initializeClassListFromElement:{value:function(e){e&&e.classList&&e.classList.length>0&&(this._classList?this._unsubscribeToClassListChanges&&this._unsubscribeToClassListChanges():this._classList=new b,this._classList.addEach(e.classList),this._subscribeToToClassListChanges())}},_unsubscribeToClassListChanges:{value:null},_subscribeToToClassListChanges:{value:function(){this._unsubscribeToClassListChanges=this._classList.addRangeChangeListener(this,"classList")}},handleClassListRangeChange:{value:function(e,t){this._classListDirty=!0,this.needsDraw=!0}},_drawClassListIntoComponent:{value:function(){if(this._classListDirty){for(var e,t=this.element.classList,n=this._classList,r=0,i=t.length;r<i;r++)e=t.item(r),n.has(e)||(t.remove(e),r--,i--);this._classList.forEach(function(e){t.add(e)}),this._classListDirty=!1}}},dispose:{value:function(){this.cancelBindings(),this.detachFromParentComponent(),this._element&&(c.unregisterEventHandlerForElement(this._element),this._element=null),this.childComponents.forEach(function(e){e.dispose()})}}},{addAttributes:{value:function(e){var t,n,r;this.prototype._elementAttributeDescriptors=e;for(n in e)e.hasOwnProperty(n)&&(r=e[n],null===r||"string"==typeof r?(t={value:r,dataType:"string"},e[n]=t):t=r,"undefined"==typeof this[n]&&this.defineAttribute(n,t))}},defineAttributeSetter:{value:function(e,t,n){return function(e,t,n){return function(r,i){var o=this._getElementAttributeDescriptor(e,this);o&&"boolean"===o.dataType&&(r=!(!r&&""!==r)),"undefined"!=typeof r&&this[t]!==r&&(n?n.call(this,r):this[t]=r,this._elementAttributeValues[e]=r,i||(this.needsDraw=!0))}}(e,t,n.set)}},defineAttributeGetter:{value:function(e){return function(e){return function(){return this[e]}}(e)}},defineAttribute:{value:function(e,t){t=t||{};var n="_"+e,r={configurable:"undefined"==typeof t.configurable||t.configurable,enumerable:"undefined"==typeof t.enumerable||t.enumerable,set:this.defineAttributeSetter(e,n,t),get:t.get||this.defineAttributeGetter(n)};this.prototype.hasOwnProperty(n)||i.defineProperty(this.prototype,n,{value:t.value}),i.defineProperty(this.prototype,e,r)}}}),P=j.specialize({constructor:{value:function(){this._drawTree=this._drawTree.bind(this),this._readyToDrawListIndex=new _,this._addedStyleSheetsByTemplate=new g}},init:{value:function(){return this}},needsDraw:{enumerable:!0,get:function(){return!!this._needsDraw},set:function(e){if(this._needsDraw!==e&&(this._needsDraw=!!e,e))for(var t,n=this.childComponents,r=0;t=n[r];r++)v.isDebug&&v.debug(this,"needsDraw = true for: "+t._montage_metadata.exportedSymbol),t.needsDraw=!0}},canDrawGate:{get:function(){return this._canDrawGate||(this._canDrawGate=(new l).initWithDelegate(this))}},_clearNeedsDrawTimeOut:{value:null},_needsDrawList:{value:[]},_cannotDrawList:{value:null},componentBlockDraw:{value:function(e){this._cannotDrawList=this._cannotDrawList?this._cannotDrawList:new b,this._cannotDrawList.add(e),this._clearNeedsDrawTimeOut&&(clearTimeout(this._clearNeedsDrawTimeOut),this._clearNeedsDrawTimeOut=null)}},isComponentWaitingNeedsDraw:{value:function(e){return this._cannotDrawList.has(e)||this._needsDrawList.indexOf(e)>=0}},componentCanDraw:{value:function(e,t){if(t){if(!this._cannotDrawList)return;if(this._cannotDrawList["delete"](e),this._needsDrawList.push(e),0===this._cannotDrawList.size&&this._needsDrawList.length>0&&!this._clearNeedsDrawTimeOut){var n=this;this._clearNeedsDrawTimeOut=setTimeout(function(){n._clearNeedsDrawList()},0)}}else this._clearNeedsDrawTimeOut&&(clearTimeout(this._clearNeedsDrawTimeOut),this._clearNeedsDrawTimeOut=null)}},_clearNeedsDrawList:{value:function(){var e,t,n,r=this._needsDrawList;for(n=r.length,t=0;t<n;t++)e=r[t],(e.needsDraw||e._drawList&&e._drawList.length>0)&&e._addToParentsDrawList();this._clearNeedsDrawTimeOut=null,r.length=0}},removeFromCannotDrawList:{value:function(e){if(this._cannotDrawList&&(this._cannotDrawList["delete"](e),0===this._cannotDrawList.size&&this._needsDrawList.length>0&&!this._clearNeedsDrawTimeOut)){var t=this;this._clearNeedsDrawTimeOut=setTimeout(function(){t._clearNeedsDrawList()},0)}}},_cancelDrawIfScheduled:{value:function(){var e=this.requestedAnimationFrame,t=this.cancelAnimationFrame;null!==e&&(this._frameTime||(p.isDebug&&p.debug(this,"clearing draw"),t?t(e):clearTimeout(e),this.requestedAnimationFrame=null))}},_addToDrawList:{value:function(e){this.__addToDrawList(e),this.drawListLogger.isDebug&&this.drawListLogger.debug(this,this.canDrawGate.value,this.requestedAnimationFrame),this.drawTree()},enumerable:!1},addToComposerList:{value:function(e){this.composerList.push(e),m.isDebug&&m.debug(this,e,"Added to composer list"),this._scheduleComposerRequest=!0,this.drawTree()}},composerListSwap:{get:function(){return this._composerListSwap||(this._composerListSwap=[]),this._composerListSwap}},_composerListSwap:{value:null},_scheduleComposerRequest:{value:!1},requestedAnimationFrame:{value:null,enumerable:!1},requestAnimationFrame:{value:global.requestAnimationFrame||global.webkitRequestAnimationFrame||global.mozRequestAnimationFrame||global.msRequestAnimationFrame||setTimeout,enumerable:!1},cancelAnimationFrame:{value:global.cancelAnimationFrame||global.webkitCancelAnimationFrame||global.mozCancelAnimationFrame||global.msCancelAnimationFrame||clearTimeout,enumerable:!1},_frameTime:{value:null},_oldSource:{value:null},_diff:{value:function(e,t){for(var n={},r={},i=0;i<t.length;i++)null==n[t[i]]&&(n[t[i]]={rows:[],o:null}),n[t[i]].rows.push(i);for(i=0;i<e.length;i++)null==r[e[i]]&&(r[e[i]]={rows:[],n:null}),r[e[i]].rows.push(i);for(i in n)1===n[i].rows.length&&"undefined"!=typeof r[i]&&1===r[i].rows.length&&(t[n[i].rows[0]]={text:t[n[i].rows[0]],row:r[i].rows[0]},e[r[i].rows[0]]={text:e[r[i].rows[0]],row:n[i].rows[0]});for(i=0;i<t.length-1;i++)null!=t[i].text&&null==t[i+1].text&&t[i].row+1<e.length&&null==e[t[i].row+1].text&&t[i+1]==e[t[i].row+1]&&(t[i+1]={text:t[i+1],row:t[i].row+1},e[t[i].row+1]={text:e[t[i].row+1],row:i+1});for(i=t.length-1;i>0;i--)null!=t[i].text&&null==t[i-1].text&&t[i].row>0&&null==e[t[i].row-1].text&&t[i-1]==e[t[i].row-1]&&(t[i-1]={text:t[i-1],row:t[i].row-1},e[t[i].row-1]={text:e[t[i].row-1],row:i-1});return{o:e,n:t}}},_previousDrawDate:{enumerable:!1,value:0},_documentResources:{value:null},_needsStylesheetsDraw:{value:!1},_stylesheets:{value:[]},addStylesheet:{value:function(e){this._stylesheets.push(e),this._needsStylesheetsDraw=!0}},_addedStyleSheetsByTemplate:{value:null},addStyleSheetsFromTemplate:{value:function(e){if(!this._addedStyleSheetsByTemplate.has(e)){for(var t,n=e.getResources(),r=this.element.ownerDocument,i=n.createStylesForDocument(r),o=0;t=i[o];o++)this.addStylesheet(t);this._addedStyleSheetsByTemplate.set(e,!0)}}},__bufferDocumentFragment:{value:null},_bufferDocumentFragment:{get:function(){return this.__bufferDocumentFragment||(this.__bufferDocumentFragment=this._element.ownerDocument.createDocumentFragment())}},drawStylesheets:{value:function(){for(var e,t=this._documentResources,n=this._stylesheets,r=t._document.head,i=this._bufferDocumentFragment;e=n.shift();)t.addStyle(e,i);r.insertBefore(i,r.firstChild),this._needsStylesheetsDraw=!1}},drawTree:{value:function(){if(null===this.requestedAnimationFrame){var e=this.requestAnimationFrame;if(e)this.requestedAnimationFrame=e.call(window,this._drawTree);else{var t=Date.now(),n=17-t+this._previousDrawDate;n<0&&(n=0),this.requestedAnimationFrame=setTimeout(this._drawTree,n),this._previousDrawDate=t+n}this._scheduleComposerRequest=!1}},enumerable:!1},_drawTree:{value:function(e){var t;if(this._needsStylesheetsDraw&&this.drawStylesheets(),!this._documentResources.areStylesLoaded)return d.isDebug&&console.log("Draw Cycle Waiting Stylesheets: ",this._documentResources._expectedStyles.length),this.requestedAnimationFrame=null,void this.drawTree();if(d.isDebug&&(t=window.performance?window.performance.now():Date.now()),this._frameTime=e?e:Date.now(),this._clearNeedsDrawTimeOut&&this._clearNeedsDrawList(),m.isDebug){var n=document.body.innerHTML;if(this._oldSource&&n!==this._oldSource){for(var r=["DOM modified outside of the draw loop"],i=this._diff(this._oldSource.split("\n"),n.split("\n")),o=0;o<i.n.length;o++)if(null==i.n[o].text)r.push("+ "+i.n[o]);else for(var a=i.n[o].row+1;a<i.o.length&&null==i.o[a].text;a++)r.push("- "+i.o[a]);console.warn(r.join("\n"))}console.group((e?m.toTimeString(new Date(e))+" ":"")+"Draw Fired")}if(this.drawIfNeeded(),d.isDebug){var s;s=window.performance?window.performance.now():Date.now(),console.log("Draw Cycle Time: ",s-t,", Components: ",this._lastDrawComponentsCount)}m.isDebug&&(console.groupEnd(),this._oldSource=document.body.innerHTML),this._frameTime=null,this._scheduleComposerRequest&&this.drawTree()}},_readyToDrawList:{enumerable:!1,value:[]},_readyToDrawListIndex:{enumerable:!1,value:null},addToDrawCycle:{value:function(e){var t=this._readyToDrawListIndex;
return t.has(e)?void(m.isDebug&&this!==T&&m.debug(r(this)+" added to the draw cycle twice, this should not happen.")):(this._readyToDrawList.push(e),this._readyToDrawListIndex.set(e,!0),void e._updateComponentDom())}},_lastDrawComponentsCount:{value:null},_sortByLevel:{value:function(e,t){return e._treeLevel-t._treeLevel}},drawIfNeeded:{value:function(){var e,t,n,i,o,a,s=this._readyToDrawList,l=0,u=this._composerList,c=m.isDebug;if(s.length=0,this._readyToDrawListIndex.clear(),u&&(a=u.length)>0){for(this._composerList=this.composerListSwap,t=0;t<a;t++)o=u[t],o.needsFrame=!1,o.frame(this._frameTime);u.length=0,this._composerListSwap=u}for(this._drawIfNeeded(0),n=s.length,c&&console.groupCollapsed("willDraw - "+s.length+(s.length>1?" components.":" component."));l<n;){for(t=l;t<n;t++)e=s[t],"function"==typeof e.willDraw&&e.willDraw(this._frameTime),c&&m.debug("Level "+e._treeLevel+" "+r(e));this._drawIfNeeded(0),l=n,n=s.length}for(c&&(console.groupEnd(),console.group("draw - "+s.length+(s.length>1?" components.":" component."))),s.sort(this._sortByLevel),t=0;t<n;t++)e=s[t],e.needsDraw=!1;for(this.requestedAnimationFrame=null,t=n-1;t>=0;t--)e=s[t],e._draw(this._frameTime),e.draw(this._frameTime),c&&m.debug("Level "+e._treeLevel+" "+r(e));for(c&&(console.groupEnd(),console.groupCollapsed("didDraw - "+s.length+(s.length>1?" components.":" component."))),this._didDrawEvent||(this._didDrawEvent=new CustomEvent("didDraw",{bubbles:!1})),t=0;t<n;t++)e=s[t],e.dispatchEvent(this._didDrawEvent),e.didDraw(this._frameTime),e._completedFirstDraw||(i=document.createEvent("CustomEvent"),i.initCustomEvent("firstDraw",!0,!1,null),e.dispatchEvent(i),e._completedFirstDraw=!0),c&&m.debug("Level "+e._treeLevel+" "+r(e));return this._completedFirstDraw||(i=document.createEvent("CustomEvent"),i.initCustomEvent("firstDraw",!0,!1,null),this.dispatchEvent(i),this._completedFirstDraw=!0),c&&console.groupEnd(),d.isDebug&&(this._lastDrawComponentsCount=s.length),!!s.length}},element:{get:function(){return this._element},set:function(e){c.registerEventHandlerForElement(this,e),this._element=e.documentElement,this._documentResources=s.getInstanceForDocument(e)}}}),T=(new P).init();t.__root__=T,j.addAttributes({accesskey:null,contenteditable:null,contextmenu:null,dir:null,draggable:null,dropzone:null,hidden:{dataType:"boolean"},lang:null,spellcheck:null,tabindex:null,title:null})}}),montageDefine("ad36237","ui/text.reel/text",{dependencies:["../component"],factory:function(e,t,n){var r=e("../component").Component;t.Text=r.specialize({hasTemplate:{value:!1},_value:{value:null},value:{get:function(){return this._value},set:function(e){this._value!==e&&(this._value=e,this.needsDraw=!0)}},converter:{value:null},defaultValue:{value:""},_valueNode:{value:null},_RANGE:{value:document.createRange()},enterDocument:{value:function(e){if(e){var t=this._RANGE;t.selectNodeContents(this.element),t.deleteContents(),this._valueNode=document.createTextNode(""),t.insertNode(this._valueNode),this.element.classList.add("montage-Text")}}},draw:{value:function(){var e="undefined"!=typeof this._value&&null!==this._value?this._value:this.defaultValue;this._valueNode.data=this.converter?this.converter.convert(e):e}}})}}),montageDefine("ad36237","core/target",{dependencies:["./core","./event/event-manager","./event/mutable-event"],factory:function(e,t,n){var r=e("./core").Montage,i=e("./event/event-manager").defaultEventManager,o=e("./event/mutable-event").MutableEvent;t.Target=r.specialize({acceptsActiveTarget:{serializable:!1,value:!1},isActiveTarget:{get:function(){return this===i.activeTarget}},willBecomeActiveTarget:{value:Function.noop},didBecomeActiveTarget:{value:Function.noop},surrendersActiveTarget:{value:function(e){return!0}},nextTarget:{serializable:!1,value:null},dispatchEvent:{value:function(e){var t=e instanceof o?e:o.fromEvent(e);return t.target=this,i.handleEvent(t),!e.defaultPrevented}},dispatchEventNamed:{value:function(e,t,n,r){var a=o.fromType(e,t,n,r);return a.target=this,i.handleEvent(a),!a.defaultPrevented}},addEventListener:{value:function(e,t,n){t&&i.registerEventListener(this,e,t,n)}},removeEventListener:{value:function(e,t,n){t&&i.unregisterEventListener(this,e,t,n)}},loadComposer:{value:function(e){e&&!e._isLoaded&&(e._resolveDefaults(),e.load(),e._isLoaded=!0)}},unloadComposer:{value:function(e){e&&e._isLoaded&&(e.unload(),e._isLoaded=!1)}}})}}),montageDefine("ad36237","core/template",{dependencies:["./core","core/serialization/deserializer/montage-deserializer","./document-part","./document-resources","./serialization/serialization","./serialization/serializer/montage-labeler","./promise","./mini-url","./logger","./event/event-manager","./application"],factory:function(e,t,n){function r(e,t,n){var r,i,o=new d,a=e.documentElement.outerHTML,l=new s,u=e.documentElement;return r=o.createHtmlDocumentWithHtml(a,e.location.href),o.initWithDocument(r,t).then(function(){return o.setBaseUrl(e.location.href),i=o._createTemplateObjects(n),l.initWithTemplateAndFragment(o),o._instantiateObjects(i,u).then(function(e){return l.objects=e,o._invokeDelegates(l),l})})}var i,o=e("./core").Montage,a=e("core/serialization/deserializer/montage-deserializer").MontageDeserializer,s=e("./document-part").DocumentPart,l=e("./document-resources").DocumentResources,u=e("./serialization/serialization").Serialization,c=e("./serialization/serializer/montage-labeler").MontageLabeler,h=e("./promise").Promise,p=e("./mini-url"),d=(e("./logger").logger("template"),e("./event/event-manager").defaultEventManager,o.specialize({_SERIALIZATION_SCRIPT_TYPE:{value:"text/montage-serialization"},_ELEMENT_ID_ATTRIBUTE:{value:"data-montage-id"},PARAM_ATTRIBUTE:{value:"data-param"},_require:{value:null},_resources:{value:null},_baseUrl:{value:null},_instances:{value:null},_metadata:{value:null},_objectsString:{value:null},objectsString:{get:function(){return this._objectsString},set:function(e){this._objectsString=e,this._serialization&&this._serialization.initWithString(e),this.__deserializer=null}},__deserializer:{value:null},_deserializer:{get:function(){var e,t,n=this.__deserializer;if(!n){if(e=this._metadata){t=Object.create(null);for(var r in e)t[r]=e[r].require}n=(new a).init(this.objectsString,this._require,t),this.__deserializer=n}return n}},getDeserializer:{value:function(){return this._deserializer}},_serialization:{value:null},getSerialization:{value:function(){var e=this._serialization;return e||(e=this._serialization=new u,e.initWithString(this.objectsString)),e}},_isDirty:{value:!1},isDirty:{get:function(){return this._isDirty},set:function(e){this._isDirty!==e&&(this._isDirty=e,this.clearTemplateFromElementContentsCache())}},refresher:{value:null},_document:{value:null},document:{get:function(){return this._isDirty&&this.refresh(),this._document},set:function(e){this._document=e}},initWithRequire:{value:function(e){return this._require=e,this.document=this.createHtmlDocumentWithHtml(""),this.objectsString="",this}},initWithDocument:{value:function(e,t){var n=this;return this._require=t,this.setDocument(e),this.getObjectsString(e).then(function(e){return n.objectsString=e,n})}},initWithHtml:{value:function(e,t){var n=this;return this._require=t,this.document=this.createHtmlDocumentWithHtml(e),this.getObjectsString(this.document).then(function(e){return n.objectsString=e,n})}},initWithObjectsAndDocumentFragment:{value:function(e,t,n){return this._require=n,this.document=this.createHtmlDocumentWithHtml(""),this.document.body.appendChild(this.document.importNode(t,!0)),this.setObjects(e),this}},initWithModuleId:{value:function(e,t){var n=this;return this._require=t,this.createHtmlDocumentWithModuleId(e,t).then(function(r){var i=t(e).directory;return n.document=r,n.setBaseUrl(i),n.getObjectsString(r).then(function(e){return n.objectsString=e,n})})}},clone:{value:function(){var e=new d;return e._require=this._require,e._baseUrl=this._baseUrl,e.setDocument(this.document),e.objectsString=this.objectsString,e._instances=Object.clone(this._instances,1),e}},instantiate:{value:function(e){return this.instantiateWithInstances(null,e)}},instantiateWithInstances:{value:function(e,t){var n,r,i,o=this,a=new s;return e=e||this._instances,n=this._createMarkupDocumentFragment(t),i=this._getParameters(n),a.initWithTemplateAndFragment(this,n),a.startActingAsTopComponent(),a.parameters=i,r=this._createTemplateObjects(e),this._instantiateObjects(r,n).then(function(n){var r;return a.objects=n,o._invokeDelegates(a,e),a.stopActingAsTopComponent(),r=o.getResources(),!r.resourcesLoaded()&&r.hasResources()&&r.loadResources(t),a})}},_objectsInstantiationOptimized:{value:!1},_optimizeObjectsInstantiationPromise:{value:null},_optimizeObjectsInstantiation:{value:function(){var e,t=this;if(!this._objectsInstantiationOptimized)return this._optimizeObjectsInstantiationPromise||(e=this._deserializer.preloadModules(),e?this._optimizeObjectsInstantiationPromise=e.then(function(){t._objectsInstantiationOptimized=!0}):this._objectsInstantiationOptimized=!0),this._optimizeObjectsInstantiationPromise}},setBaseUrl:{value:function(e){this._baseUrl=e}},getBaseUrl:{value:function(){return this._baseUrl}},getResources:{value:function(){var e=this._resources;return e||(e=this._resources=new f,e.initWithTemplate(this)),e}},_createTemplateObjects:{value:function(t){var n=Object.create(t||null);return"undefined"==typeof i&&(i=e("./application").application),n.application=i,n.template=this,n}},_instantiateObjects:{value:function(e,t){var n,r=this._deserializer;return h.is(r)?r:(n=this._optimizeObjectsInstantiation(),n?n.then(function(){return r.deserialize(e,t)}):r.deserialize(e,t))}},_createMarkupDocumentFragment:{value:function(e){for(var t=e.createDocumentFragment(),n=this.document.body.childNodes,r=0,i=n.length;r<i;r++)t.appendChild(e.importNode(n[r],!0));return t}},getParameterName:{value:function(e){return e.getAttribute(this.PARAM_ATTRIBUTE)}},getParameters:{value:function(){return this._getParameters(this.document.body)}},_getParameters:{value:function(e){for(var t,n,r=e.querySelectorAll("*["+this.PARAM_ATTRIBUTE+"]"),i=r.length,o={},a=0;a<i;a++){if(t=r[a],n=this.getParameterName(t),n in o)throw new Error('The parameter "'+n+'" is declared more than once in '+this.getBaseUrl()+".");o[n]=t}return o}},hasParameters:{value:function(){return!!this.document.querySelector("*["+this.PARAM_ATTRIBUTE+"]")}},_invokeDelegates:{value:function(e,t){var n,r,i,o=e.objects,a=o.owner||t&&t.owner;for(var s in o)t&&s in t||(n=o[s],r=this._getObjectOwner(s,a),i=this._getObjectLabel(s),n&&("function"==typeof n._deserializedFromTemplate&&n._deserializedFromTemplate(r,i,e),"function"==typeof n.deserializedFromTemplate&&n.deserializedFromTemplate(r,i,e)));if(a){var l=this.getSerialization();l.isExternalObject("owner")||("function"==typeof a._templateDidLoad&&a._templateDidLoad(e),"function"==typeof a.templateDidLoad&&a.templateDidLoad(e))}}},setInstances:{value:function(e){this._instances=e}},getInstances:{value:function(){return this._instances}},setObjects:{value:function(e){this.objectsString=JSON.stringify(e,null,4)}},setObjectMetadata:{value:function(e,t,n,r){var i=this._metadata;i||(this._metadata=i=Object.create(null)),i[e]={require:t,label:n,owner:r},this.__deserializer=null}},getObjectMetadata:{value:function(e){var t=this._metadata;return t&&e in t?t[e]:{require:this._require,label:e}}},_getObjectOwner:{value:function(e,t){var n,r=this._metadata;return n=r&&e in r?r[e].owner:t}},_getObjectLabel:{value:function(e){var t,n=this._metadata;return t=n&&e in n?n[e].label:e}},setDocument:{value:function(e){this.document=this.cloneHtmlDocument(e),this.clearTemplateFromElementContentsCache()}},getObjectsString:{value:function(e){var t;return t=this.getInlineObjectsString(e),null===t?this.getExternalObjectsString(e):h.resolve(t)}},getInlineObjectsString:{value:function(e){var t="script[type='"+this._SERIALIZATION_SCRIPT_TYPE+"']",n=e.querySelector(t);return n?n.textContent:null}},getExternalObjectsString:{value:function(e){var t,n=e.querySelector('link[rel="serialization"]');return n?t=new h(function(e,t){var r=new XMLHttpRequest,i=n.getAttribute("href");r.open("GET",i),r.addEventListener("load",function(n){var r=n.target;200==r.status?e(r.responseText):t(new Error("Unable to retrive '"+i+"', code status: "+r.status))},!1),r.addEventListener("error",function(e){t(new Error("Unable to retrive '"+i+"' with error: "+e.error+"."))},!1),r.send()}):h.resolve(null)}},createHtmlDocumentWithHtml:{value:function(e,t){var n=document.implementation.createHTMLDocument("");return e&&(n.documentElement.innerHTML=e,t&&this.normalizeRelativeUrls(n,t)),n}},cloneHtmlDocument:{value:function(e){var t=document.implementation.createHTMLDocument(""),n=e.baseURI||e.URL;return t.replaceChild(t.importNode(e.documentElement,!0),t.documentElement),this.normalizeRelativeUrls(t,n),t}},createHtmlDocumentWithModuleId:{value:function(e,t){var n=this;return"function"!=typeof t?h.reject(new Error("Missing 'require' function to load module '"+e+"'.")):t.async(e).then(function(e){return n.createHtmlDocumentWithHtml(e.content,e.directory)})}},_removeObjects:{value:function(e){var t="script[type='"+this._SERIALIZATION_SCRIPT_TYPE+"'], link[rel='serialization']";Array.prototype.forEach.call(e.querySelectorAll(t),function(e){e.parentNode.removeChild(e)})}},_addObjects:{value:function(e,t){if(t){var n=e.createElement("script");n.setAttribute("type",this._SERIALIZATION_SCRIPT_TYPE),n.textContent=JSON.stringify(JSON.parse(t),null,4),e.head.appendChild(n)}}},_templateFromElementContentsCache:{value:null},clearTemplateFromElementContentsCache:{value:function(){this._templateFromElementContentsCache=null}},createTemplateFromElementContents:{value:function(e){var t,n,r,i=this._templateFromElementContentsCache;return i||(i=Object.create(null),this._templateFromElementContentsCache=i),e in i?Object.create(i[e]):(t=this.getElementById(e),r=this.document.createRange(),r.selectNodeContents(t),n=this.createTemplateFromRange(r),i[e]=n,Object.create(n))}},createTemplateFromElement:{value:function(e){var t,n;return t=this.getElementById(e),n=this.document.createRange(),n.selectNode(t),this.createTemplateFromRange(n)}},createTemplateFromRange:{value:function(e){var t,n,r,i,o,a=new u;return t=e.cloneContents(),n=this._getChildrenElementIds(t),a.initWithString(this.objectsString),r=a.getSerializationLabelsWithElements(n),o=a.extractSerialization(r,["owner"]),i=new d,i.initWithObjectsAndDocumentFragment(null,t,this._require),i.objectsString=o.getSerializationString(),i._resources=this.getResources(),i}},_createSerializationWithElementIds:{value:function(e){var t,n,r=new u;return r.initWithString(this.objectsString),t=r.getSerializationLabelsWithElements(e),n=r.extractSerialization(t,["owner"])}},expandParameters:{value:function(e){var t,n,r,i,o,a,s,l=[],u={},c=this.getSerialization(),h={};t=this.getParameters();for(var p in t)if(i=t[p],o=e.getTemplateArgumentElement(p),l.push.apply(l,this._getElementIds(o)),n=this.replaceNode(o,i))for(var d in n)u[d]=n[d];return h.elementIds=l,h.elementIdsCollisions=u,a=e.getTemplateArgumentSerialization(l),a.renameElementReferences(u),s=function(t){if(t.indexOf(":")>0)return e.resolveTemplateArgumentTemplateProperty(t)},r=c.mergeSerialization(a,{willMergeObjectWithLabel:s}),this.objectsString=c.getSerializationString(),h.labels=a.getSerializationLabels(),h.labelsCollisions=r,h}},_resolveElementIdCollisions:{value:function(e,t){var n,r,i,o,a;t=t||new c,i=this.getElementIds();for(var s,l=0;s=i[l];l++)t.addLabel(s);r=this._getElements(e);for(var s in r)this.getElementById(s)&&(o=r[s],a=t.generateLabel(t.getLabelBaseName(s)),this.setElementId(o,a),n||(n=Object.create(null)),n[s]=a);return n}},replaceNode:{value:function(e,t,n){var r;return r=this._resolveElementIdCollisions(e,n),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.parentNode.replaceChild(e,t),r}},insertNodeBefore:{value:function(e,t,n){var r;return r=this._resolveElementIdCollisions(e,n),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.parentNode.insertBefore(e,t),r}},appendNode:{value:function(e,t,n){var r;return r=this._resolveElementIdCollisions(e,n),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.appendChild(e),r}},getElementId:{value:function(e){if(e.getAttribute)return e.getAttribute(this._ELEMENT_ID_ATTRIBUTE)}},setElementId:{value:function(e,t){e.setAttribute(this._ELEMENT_ID_ATTRIBUTE,t)}},getElementIds:{value:function(){return this._getElementIds(this.document.body)}},_getElements:{value:function(e){var t,n,r="*["+this._ELEMENT_ID_ATTRIBUTE+"]",i={};t=e.querySelectorAll(r);for(var o,a=0;o=t[a];a++)n=this.getElementId(o),i[n]=o;return n=this.getElementId(e),n&&(i[n]=e),i}},_getChildrenElementIds:{value:function(e){var t,n="*["+this._ELEMENT_ID_ATTRIBUTE+"]",r=[];t=e.querySelectorAll(n);for(var i,o=0;i=t[o];o++)r.push(this.getElementId(i));return r}},_getElementIds:{value:function(e){var t,n=this._getChildrenElementIds(e);return t=this.getElementId(e),t&&n.push(t),n}},getElementById:{value:function(e){var t="*["+this._ELEMENT_ID_ATTRIBUTE+"='"+e+"']";return this.document.querySelector(t)}},html:{get:function(){var e=this.document;return this._removeObjects(e),this._addObjects(e,this.objectsString),this._getDoctypeString(e.doctype)+"\n"+e.documentElement.outerHTML}},_getDoctypeString:{value:function(e){return"<!DOCTYPE "+e.name+(e.publicId?' PUBLIC "'+e.publicId+'"':"")+(!e.publicId&&e.systemId?" SYSTEM":"")+(e.systemId?' "'+e.systemId+'"':"")+">"}},normalizeRelativeUrls:{value:function(e,t){if("string"==typeof t&&""!==t&&"about:blank"!==t)for(var n="http://www.w3.org/1999/xlink",r=/^[\w\-]+:|^\//,i=d._NORMALIZED_TAG_NAMES.indexOf(e.tagName)!==-1?[e]:e.querySelectorAll(d._NORMALIZED_TAG_NAMES_SELECTOR),o=0,a=i.length;o<a;o++){var s,l=i[o];"image"===l.tagName?(s=l.getAttributeNS(n,"href"),r.test(s)||l.setAttributeNS(n,"href",p.resolve(t,s))):l.hasAttribute("src")?(s=l.getAttribute("src"),""===s||r.test(s)||l.setAttribute("src",p.resolve(t,s))):l.hasAttribute("href")&&(s=l.getAttribute("href"),""===s||r.test(s)||l.setAttribute("href",p.resolve(t,s)))}}},replaceContentsWithTemplate:{value:function(e){this._require=e._require,this._baseUrl=e._baseUrl,this._document=e._document,this.objectsString=e.objectsString,this._instances=e._instances,this._templateFromElementContentsCache=e._templateFromElementContentsCache,this._metadata=e._metadata}},refresh:{value:function(){this.isDirty&&(this.refresher&&"function"==typeof this.refresher.refreshTemplate?(this.refresher.refreshTemplate(this),this.isDirty=!1):console.warn("Not able to refresh without a refresher.refreshTemplate."))}}},{_templateCache:{value:{moduleId:Object.create(null)}},_getTemplateCacheKey:{value:function(e,t){return e=t.resolve(e),t.location+"#"+e}},getTemplateWithModuleId:{value:function(e,t){var n,r;return n=this._getTemplateCacheKey(e,t),r=this._templateCache.moduleId[n],r||(r=(new d).initWithModuleId(e,t),this._templateCache.moduleId[n]=r),r}},_NORMALIZED_TAG_NAMES:{value:["IMG","image","IFRAME","link","script"]},__NORMALIZED_TAG_NAMES_SELECTOR:{value:null},_NORMALIZED_TAG_NAMES_SELECTOR:{get:function(){return this.__NORMALIZED_TAG_NAMES_SELECTOR||(this.__NORMALIZED_TAG_NAMES_SELECTOR=this._NORMALIZED_TAG_NAMES.join(",")),this.__NORMALIZED_TAG_NAMES_SELECTOR}}})),f=o.specialize({_resources:{value:null},_resourcesLoaded:{value:!1},template:{value:null},rootUrl:{value:""},constructor:{value:function(){this._resources=Object.create(null)}},initWithTemplate:{value:function(e){this.template=e}},hasResources:{value:function(){return this.getStyles().length>0||this.getScripts().length>0}},resourcesLoaded:{value:function(){return this._resourcesLoaded}},loadResources:{value:function(e){return this._resourcesLoaded=!0,h.all([this.loadScripts(e),this.loadStyles(e)])}},getScripts:{value:function(){var e,t,n,r=this._resources.scripts;if(!r){t=this.template,r=this._resources.scripts=[],n=t.document.querySelectorAll("script");for(var i=0,o=n.length;i<o;i++)e=n[i],e.type!==this.template._SERIALIZATION_SCRIPT_TYPE&&r.push(e)}return r}},loadScripts:{value:function(e){var t=this.getScripts(),n=t.length;if(n){for(var r=[],i=0;i<n;i++)r.push(this.loadScript(t[i],e));return h.all(r)}return h.resolve()}},loadScript:{value:function(e,t){var n,r;return n=l.getInstanceForDocument(t),r=this._cloneScriptElement(e,t),n.addScript(r)}},_cloneScriptElement:{value:function(e,t){for(var n,r=t.createElement("script"),i=e.attributes,o=0,a=i.length;o<a;o++)n=i[o],r.setAttribute(n.name,n.value);return r.textContent=e.textContent,r}},getStyles:{value:function(){var e,t,n,r=this._resources.styles;return r||(n='link[rel="stylesheet"], style',e=this.template,t=e.document.querySelectorAll(n),r=Array.prototype.slice.call(t,0),this._resources.styles=r),r}},loadStyles:{value:function(e){var t,n=[];t=this.getStyles();for(var r=0,i=t.length;r<i;r++)n.push(this.loadStyle(t[r],e));return h.all(n)}},loadStyle:{value:function(e,t){var n,r;return n=e.getAttribute("href"),n?(r=l.getInstanceForDocument(t),r.preloadResource(n)):h.resolve()}},createStylesForDocument:{value:function(e){for(var t,n,r=this.getStyles(),i=[],o=0;n=r[o];o++)t=e.importNode(n,!0),i.push(t);return i}}}),v=o.specialize({getTemplateArgumentElement:{value:Function.noop},getTemplateArgumentSerialization:{value:Function.noop},resolveTemplateArgumentTemplateProperty:{value:Function.noop}});t.Template=d,t.TemplateArgumentProvider=v,t.TemplateResources=f,t.instantiateDocument=r}}),montageDefine("ad36237","core/document-resources",{dependencies:["./core","./promise","./mini-url"],factory:function(e,t,n){var r=e("./core").Montage,i=e("./promise").Promise,o=e("./mini-url"),a=r.specialize({_SCRIPT_TIMEOUT:{value:5e3},_document:{value:null},_resources:{value:null},_preloaded:{value:null},_expectedStyles:{value:null},constructor:{value:function(){this._expectedStyles=[],this._isPollingDocumentStyleSheets=!this._isLinkLoadEventAvailable()}},_webkitVersion:{value:function(){var e=/AppleWebKit\/([\d.]+)/.exec(navigator.userAgent);return e?parseInt(e[1]):null}},_isLinkLoadEventAvailable:{value:function(){var e=document.createElement("link"),t=this._webkitVersion();return"onload"in e&&!(null!==t&&t<535)}},initWithDocument:{value:function(e){return this.clear(),this._document=e,this._populateWithDocument(e),this}},_populateWithDocument:{value:function(e){var t=e.querySelectorAll("script"),n=Array.prototype.forEach;n.call(t,function(e){e.src&&this._addResource(this.normalizeUrl(e.src))},this);var r=e.querySelectorAll("link");n.call(r,function(e){"stylesheet"===e.rel&&this._addResource(this.normalizeUrl(e.href))},this)}},clear:{value:function(){this._resources=Object.create(null),this._preloaded=Object.create(null)}},_addResource:{value:function(e){this._resources[e]=!0}},hasResource:{value:function(e){return e in this._resources}},isResourcePreloaded:{value:function(e){return this._preloaded[e]===!0}},isResourcePreloading:{value:function(e){return i.is(this._preloaded[e])}},setResourcePreloadedPromise:{value:function(e,t){this._preloaded[e]=t}},setResourcePreloaded:{value:function(e){this._preloaded[e]=!0}},getResourcePreloadedPromise:{value:function(e){return this._preloaded[e]}},addScript:{value:function(e){var t=this.normalizeUrl(e.src);return t?this.isResourcePreloaded(t)?i.resolve():this.isResourcePreloading(t)?this.getResourcePreloadedPromise(t):this._importScript(e):this._importScript(e)}},_importScript:{value:function(e){var t,n=this,r=this._document,o=r.head,a=e.src;return a?(n._addResource(a),t=new i(function(t,r){var i=function s(r){n.setResourcePreloaded(a),e.removeEventListener("load",s,!1),e.removeEventListener("error",s,!1),clearTimeout(o),t(r)};e.addEventListener("load",i,!1),e.addEventListener("error",i,!1);var o=setTimeout(function(){n.setResourcePreloaded(a),t()},n._SCRIPT_TIMEOUT)}),this.setResourcePreloadedPromise(a,t)):t=new i(function(e,t){e()}),o.appendChild(r.createComment("Inserted from FIXME")),o.appendChild(e),t}},handleEvent:{value:function(e){var t,n=e.target;"LINK"===n.tagName&&(t=this._expectedStyles.indexOf(n.href),t>=0&&this._expectedStyles.splice(t,1),n.removeEventListener("load",this,!1),n.removeEventListener("error",this,!1))}},addStyle:{value:function(e,t){var n,r=e.getAttribute("href");if(r){if(r=this.normalizeUrl(r),this.hasResource(r))return;this._addResource(r),this._expectedStyles.push(r),this._isPollingDocumentStyleSheets||(e.setAttribute("href",r),e.addEventListener("load",this,!1),e.addEventListener("error",this,!1))}n=t||this._document.head,n.insertBefore(e,n.firstChild)}},normalizeUrl:{value:function(e,t){return t||(t=this._document.location.href),o.resolve(t,e)}},domain:{value:global.location?global.location.protocol+"//"+global.location.host:""},isCrossDomain:{value:function(e){return 0!==e.indexOf(this.domain+"/")||0===e.indexOf("file://")}},preloadResource:{value:function(e,t){var n;return e=this.normalizeUrl(e),!t&&this.isCrossDomain(e)&&(n=!0),n||this.isResourcePreloaded(e)?i.resolve():this.isResourcePreloading(e)?this.getResourcePreloadedPromise(e):this._preloadResource(e)}},_preloadResource:{value:function(e){var t=this,n=new i(function(n,r){var i=new XMLHttpRequest;i.open("GET",e),i.addEventListener("load",n,!1),i.addEventListener("error",n,!1),i.addEventListener("timeout",n,!1),i.timeout=t._SCRIPT_TIMEOUT,i.send(),i.listener=n}).bind(this).then(function(t){this.setResourcePreloaded(e),t.target.removeEventListener("load",t.target.listener),t.target.removeEventListener("error",t.target.listener),t.target.removeEventListener("timeout",t.target.listener)});return this.setResourcePreloadedPromise(e,n),n}},areStylesLoaded:{get:function(){var e,t;if(this._isPollingDocumentStyleSheets&&this._expectedStyles.length>0){e=this._document.styleSheets;for(var n,r=0;n=e[r];r++)t=this._expectedStyles.indexOf(n.href),t>=0&&this._expectedStyles.splice(t,1)}return 0===this._expectedStyles.length}}},{getInstanceForDocument:{value:function(e){var t=e.__montage_resources__;return t||(t=e.__montage_resources__=(new a).initWithDocument(e)),t}}});t.DocumentResources=a}}),montageDefine("ad36237","core/gate",{dependencies:["./core","./logger","collections/map"],factory:function(e,t,n){var r=e("./core").Montage,i=e("./logger").logger("gate"),o=e("collections/map");t.Gate=r.specialize({init:{enumerable:!1,value:function(){return this.reset(),this}},initWithDelegate:{enumerable:!1,value:function(e){return this.reset(),this.delegate=e,this}},initWithDescriptor:{enumerable:!1,value:function(e){var t;this.reset();for(t in e)this.setField(t,e[t].value);return this}},count:{value:0},table:{value:null},getField:{enumerable:!1,value:function(e){var t=this.table;return!t||t[e]}},setField:{enumerable:!1,value:function(e,t){var n,r=this.table||(this.table=new o),a=this.count;n=r[e],"undefined"!=typeof n||t?"undefined"!=typeof n&&n!==t?t?this.count--:this.count++:t&&i.isDebug&&i.debug(this,e+" was not set before."):this.count++,r[e]=!!t,0===this.count&&a>0?this.callDelegateMethod(!0):0===a&&this.count>0&&this.callDelegateMethod(!1)}},removeField:{enumerable:!1,value:function(e){var t=this.table,n=t[e];"undefined"==typeof n||n||this.count--,delete t[e]}},delegate:{enumerable:!1,value:null},callDelegateMethod:{value:function(e){var t;this.delegate&&"function"==typeof(t=this.delegate["gateDidBecome"+(e?"True":"False")])&&t.call(this.delegate,this)},enumerable:!1},value:{enumerable:!1,get:function(){return 0===this.count}},reset:{enumerable:!1,value:function(){this.table={},this.count=0}},toString:{value:function(){var e,t,n=this._fields,r="";for(e=0;t=n[e];e++)r+=t+"["+(this._value&n[t])+"], ";return r}}})}}),montageDefine("ad36237","core/application",{dependencies:["./target","../window-loader/montage-window","./dom","./template"],factory:function(e,t,n){var r,i=e("./target").Target,o=e("../window-loader/montage-window").MontageWindow;e("./dom");var a="-is-first-load";t.Application=i.specialize({eventManager:{value:null},parentApplication:{value:null},name:{value:null},_isFirstLoad:{value:null},isFirstLoad:{get:function(){return this._isFirstLoad}},mainApplication:{get:function(){for(var e=this;e.parentApplication;)e=e.parentApplication;return e}},_windowsSortOrder:{value:"reverse-z-order"},windowsSortOrder:{get:function(){return null==this.parentApplication?this._windowsSortOrder:this.mainApplication.windowsSortOrder},set:function(e){null==this.parentApplication?["z-order","reverse-z-order","z-order","reverse-open-order"].indexOf(e)!==-1&&(this._windowsSortOrder=e):this.mainApplication.windowsSortOrder=e}},windows:{get:function(){if(null==this.parentApplication){if(!this._windows){var e=new o;e.application=this,e.window=window,this.window=e,this._windows=[this.window],this._multipleWindow=!0}return this._windows}return this.mainApplication.windows}},_window:{value:null},window:{get:function(){if(!this._window&&this==this.mainApplication){var e=new o;e.application=this,e.window=window,this._window=e}return this._window},set:function(e){this._window||(this._window=e)}},attachedWindows:{value:[]},eventManagerForWindow:{value:function(e){return e.defaultEventMananger}},focusWindow:{get:function(){var e=this.windows,t=this.windowsSortOrder;if("z-order"==t)return e[0];if("reverse-z-order"==t)return e[e.length-1];for(var n in e)if(e[n].focused)return e[n]}},delegate:{value:null},nextTarget:{get:function(){return this.delegate}},openWindow:{value:function(e,t,n){var r,i,a=this,s=new o,l={location:!1,menubar:!1,resizable:!0,scrollbars:!0,status:!1,titlebar:!0,toolbar:!1},u={module:e,name:t,parent:window,callback:function(e,t){var n;r=e.document.application,s.window=e,s.application=r,s.component=t,r.window=s,a.attachedWindows.push(s),n=a.mainApplication.windowsSortOrder,"z-order"==n||"reverse-open-order"==n?a.windows.unshift(s):a.windows.push(s),i=document.createEvent("CustomEvent"),i.initCustomEvent("load",!0,!0,null),s.dispatchEvent(i)}};if(this!==this.mainApplication||this._multipleWindow||this.window,"object"==typeof n){var c,h,p="",d="";for(c in n)n.hasOwnProperty(c)&&(l[c]=n[c])}var f=["name"];for(c in l)f.indexOf(c)==-1&&(h=l[c],"boolean"==typeof h?h=h?"yes":"no":(h=String(h),h.match(/[ ,"]/)&&(h='"'+h.replace(/"/g,'\\"')+'"')),d+=p+c+"="+h,p=",");return global.require.loadPackage({name:"montage"}).then(function(e){var t=window.open(e.location+"window-loader/index.html","_blank",d);t.loadInfo=u}),s}},attachWindow:{value:function(e){var t,n=e.application.parentApplication;return n!==this&&(n&&n.detachWindow(e),e.parentApplication=this,this.attachedWindows.push(e),t=this.mainApplication.windowsSortOrder,"z-order"==t||"reverse-open-order"==t?this.windows.unshift(e):this.windows.push(e),e.focus()),e}},detachWindow:{value:function(e){var t,n,r=this.windows;return void 0===e&&(e=this.window),n=e.application.parentApplication,n==this?(t=this.attachedWindows.indexOf(e),t!==-1&&this.attachedWindows.splice(t,1),t=r.indexOf(e),t!==-1&&r.splice(t,1),e.application.parentApplication=null):n&&n.detachWindow(e),e}},constructor:{value:function(){window.loadInfo&&!this.parentApplication&&(this.parentApplication=window.loadInfo.parent.document.application)}},_load:{value:function(n,r){var i,o=this;return this.name=n.packageDescription.name,this._loadApplicationContext(),t.application=o,e.async("ui/component").then(function(t){return i=t.__root__,i.element=document,e("./template").instantiateDocument(window.document,n).then(function(e){return o.callDelegateMethod("willFinishLoading",o),i.needsDraw=!0,r&&r(o),o})})}},_loadApplicationContext:{value:function(){if(null===this._isFirstLoad){var e=this.name+a,t=localStorage.getItem(e);if(null===t)try{localStorage.setItem(e,!0)}catch(n){console.log("In private mode you are")}this._isFirstLoad=!t}}},_alertPopup:{value:null,enumerable:!1},_confirmPopup:{value:null,enumerable:!1},_notifyPopup:{value:null,enumerable:!1},_zIndex:{value:null},_isSystemPopup:{value:function(e){return"alert"===e||"confirm"===e||"notify"===e}},_createPopupSlot:{value:function(e){var t=document.createElement("div");
document.body.appendChild(t),t.style.zIndex=e,t.style.position="absolute";var n=new r;return n.element=t,n.attachToParentComponent(),n}},getPopupSlot:{value:function(t,n,i){var o=this;e.async("ui/slot.reel/slot").then(function(e){r=r||e.Slot,t=t||"custom";var a,s,l=o._isSystemPopup(t);if(o.popupSlots=o.popupSlots||{},l)switch(t){case"alert":a=19004;break;case"confirm":a=19003;break;case"notify":a=19002}else o._zIndex?o._zIndex=o._zIndex+1:o._zIndex=17e3,a=o._zIndex;s=o.popupSlots[t],s||(s=o.popupSlots[t]=o._createPopupSlot(a)),l||(s.element.style.zIndex=a),s.content=n,i.call(this,s)})}},returnPopupSlot:{value:function(e){var t=this;if(t.popupSlots&&t.popupSlots[e]){var n=t.popupSlots[e];n.content=null}}},_getActivePopupSlots:{value:function(){var e=[];if(this.popupSlots){var t=Object.keys(this.popupSlots);if(t&&t.length>0){var n,r,i=t.length;for(n=0;n<i;n++)r=this.popupSlots[t[n]],r&&null!==r.content&&e.push(r)}}return e}}})}}),montageDefine("ad36237","core/mini-url",{dependencies:[],factory:function(e,t,n){"use strict";function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(e,t,n,r){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var s=1e3;r&&"number"==typeof r.maxKeys&&(s=r.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var u=0;u<l;++u){var c,h,p,d,f=e[u].replace(a,"%20"),v=f.indexOf(n);v>=0?(c=f.substr(0,v),h=f.substr(v+1)):(c=f,h=""),p=decodeURIComponent(c),d=decodeURIComponent(h),i(o,p)?Array.isArray(o[p])?o[p].push(d):o[p]=[o[p],d]:o[p]=d}return o}function a(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function s(e,t,n,r){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(r){var i=encodeURIComponent(a(r))+n;return Array.isArray(e[r])?e[r].map(function(e){return i+encodeURIComponent(a(e))}).join(t):i+encodeURIComponent(a(e[r]))}).join(t):r?encodeURIComponent(a(r))+n+encodeURIComponent(a(e)):""}function l(e){return null===e}function u(e){return null===e||void 0===e}function c(e){return"string"==typeof e}function h(e){return"object"==typeof e}function p(e,t,n){if(e&&h(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}var d=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,v=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,m=["<",">",'"',"`"," ","\r","\n","\t"],g=["{","}","|","\\","^","`"].concat(m),_=["'"].concat(g),b=["%","/","?",";","#"].concat(_),y=["/","?","#"],w=255,E=/^[+a-z0-9A-Z_-]{0,63}$/,C=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,O={javascript:!0,"javascript:":!0},j={javascript:!0,"javascript:":!0},P={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};r.prototype.parse=function(e,t,n){if(!c(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),i=r!==-1&&r<e.indexOf("#")?"?":"#",a=e.split(i),s=/\\/g;a[0]=a[0].replace(s,"/"),e=a.join(i);var l=e;if(l=l.trim(),!n&&1===e.split("#").length){var u=v.exec(l);if(u)return this.path=l,this.href=l,this.pathname=u[1],u[2]?(this.search=u[2],t?this.query=decodeDuerystring(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=d.exec(l);if(h){h=h[0];var p=h.toLowerCase();this.protocol=p,l=l.substr(h.length)}if(n||h||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var f="//"===l.substr(0,2);!f||h&&j[h]||(l=l.substr(2),this.slashes=!0)}if(!j[h]&&(f||h&&!P[h])){for(var m=-1,g=0;g<y.length;g++){var T=l.indexOf(y[g]);T!==-1&&(m===-1||T<m)&&(m=T)}var k,x;x=m===-1?l.lastIndexOf("@"):l.lastIndexOf("@",m),x!==-1&&(k=l.slice(0,x),l=l.slice(x+1),this.auth=decodeURIComponent(k)),m=-1;for(var g=0;g<b.length;g++){var T=l.indexOf(b[g]);T!==-1&&(m===-1||T<m)&&(m=T)}m===-1&&(m=l.length),this.host=l.slice(0,m),l=l.slice(m),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var D=this.hostname.split(/\./),g=0,S=D.length;g<S;g++){var L=D[g];if(L&&!L.match(E)){for(var M="",R=0,F=L.length;R<F;R++)M+=L.charCodeAt(R)>127?"x":L[R];if(!M.match(E)){var z=D.slice(0,g),I=D.slice(g+1),N=L.match(C);N&&(z.push(N[1]),I.unshift(N[2])),I.length&&(l="/"+I.join(".")+l),this.hostname=z.join(".");break}}}this.hostname.length>w?this.hostname="":this.hostname=this.hostname.toLowerCase();var B=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+B,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==l[0]&&(l="/"+l))}if(!O[p])for(var g=0,S=_.length;g<S;g++){var q=_[g];if(l.indexOf(q)!==-1){var V=encodeURIComponent(q);V===q&&(V=escape(q)),l=l.split(q).join(V)}}var W=l.indexOf("#");W!==-1&&(this.hash=l.substr(W),l=l.slice(0,W));var H=l.indexOf("?");if(H!==-1?(this.search=l.substr(H),this.query=l.substr(H+1),t&&(this.query=o(this.query)),l=l.slice(0,H)):t&&(this.search="",this.query={}),l&&(this.pathname=l),P[p]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var B=this.pathname||"",X=this.search||"";this.path=B+X}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&h(this.query)&&Object.keys(this.query).length&&(o=s(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||P[t])&&i!==!1?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),a=a.replace("#","%23"),t+i+n+a+r},r.prototype.resolve=function(e){return this.resolveObject(p(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(c(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),h=0;h<s.length;h++){var p=s[h];"protocol"!==p&&(n[p]=e[p])}return P[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!P[e.protocol]){for(var d=Object.keys(e),f=0;f<d.length;f++){var v=d[f];n[v]=e[v]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||j[e.protocol])n.pathname=e.pathname;else{for(var m=(e.pathname||"").split("/");m.length&&!(e.host=m.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),n.pathname=m.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var g=n.pathname||"",_=n.search||"";n.path=g+_}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=y||b||n.host&&e.pathname,E=w,C=n.pathname&&n.pathname.split("/")||[],m=e.pathname&&e.pathname.split("/")||[],O=n.protocol&&!P[n.protocol];if(O&&(n.hostname="",n.port=null,n.host&&(""===C[0]?C[0]=n.host:C.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===m[0]?m[0]=e.host:m.unshift(e.host)),e.host=null),w=w&&(""===m[0]||""===C[0])),y)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,C=m;else if(m.length)C||(C=[]),C.pop(),C=C.concat(m),n.search=e.search,n.query=e.query;else if(!u(e.search)){if(O){n.hostname=n.host=C.shift();var T=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");T&&(n.auth=T.shift(),n.host=n.hostname=T.shift())}return n.search=e.search,n.query=e.query,l(n.pathname)&&l(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!C.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var k=C.slice(-1)[0],x=(n.host||e.host||C.length>1)&&("."===k||".."===k)||""===k,A=0,D=C.length;D>=0;D--)k=C[D],"."===k?C.splice(D,1):".."===k?(C.splice(D,1),A++):A&&(C.splice(D,1),A--);if(!w&&!E)for(;A--;A)C.unshift("..");!w||""===C[0]||C[0]&&"/"===C[0].charAt(0)||C.unshift(""),x&&"/"!==C.join("/").substr(-1)&&C.push("");var S=""===C[0]||C[0]&&"/"===C[0].charAt(0);if(O){n.hostname=n.host=S?"":C.length?C.shift():"";var T=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@");T&&(n.auth=T.shift(),n.host=n.hostname=T.shift())}return w=w||n.host&&C.length,w&&!S&&C.unshift(""),C.length?n.pathname=C.join("/"):(n.pathname=null,n.path=null),l(n.pathname)&&l(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},n.exports.resolve=function(e,t){return p(e,!1,!0).resolve(t)}}}),montageDefine("ad36237","core/document-part",{dependencies:["./core","./logger","./promise","./event/event-manager"],factory:function(e,t,n){var r=e("./core").Montage,i=(e("./logger").logger("document-part"),e("./promise").Promise),o=e("./event/event-manager").defaultEventManager,a=r.specialize({parentDocumentPart:{value:null},template:{value:null},fragment:{value:null},objects:{value:null},childComponents:{value:null},parameters:{value:null},initWithTemplateAndFragment:{value:function(e,t){this.template=e,this.fragment=t,this.objects=null,this.childComponents=[],this.parameters=null}},startActingAsTopComponent:{value:function(){this.fragment&&o.registerEventHandlerForElement(this,this.fragment)}},stopActingAsTopComponent:{value:function(){this.fragment&&o.unregisterEventHandlerForElement(this.fragment)}},addChildComponent:{value:function(e){this.childComponents.indexOf(e)==-1&&this.childComponents.push(e)}},removeChildComponent:{value:function(e){var t=this.childComponents,n=t.indexOf(e);n>-1&&(t.splice(n,1),e._parentComponent=null,e._alternateParentComponent=null)}},_addToDrawList:{value:Function.noop},_componentTreeLoadedDeferred:{value:null},loadComponentTree:{value:function(){if(!this._componentTreeLoadedDeferred){for(var e=[],t=this.childComponents,n=0,r=t.length;n<r;n++)e.push(t[n].loadComponentTree());this._componentTreeLoadedDeferred=i.all(e)}return this._componentTreeLoadedDeferred}}});t.DocumentPart=a}}),montageDefine("ad36237","core/serialization/serialization",{dependencies:["../core","./serializer/montage-labeler","./deserializer/montage-reviver","frb/parse","frb/stringify"],factory:function(e,t,n){var r=e("../core").Montage,i=e("./serializer/montage-labeler").MontageLabeler,o=e("./deserializer/montage-reviver").MontageReviver,a=e("frb/parse"),s=e("frb/stringify"),l=r.specialize({_serializationString:{value:null},_serializationObject:{value:null},_serializationLabels:{value:null},initWithString:{value:function(e){return this._serializationString=e,this._serializationObject=null,this._serializationLabels=null,this}},initWithObject:{value:function(e){return this._serializationString=null,this._serializationObject=e,this._serializationLabels=null,this}},clone:{value:function(){var e=new l;return e.initWithString(this.getSerializationString()),e}},getSerializationObject:{value:function(){return this._serializationObject||(this._serializationObject=JSON.parse(this._serializationString)),this._serializationObject}},getSerializationString:{value:function(){return this._serializationString||(this._serializationString=JSON.stringify(this._serializationObject)),this._serializationString}},getSerializationLabels:{value:function(){var e;return this._serializationLabels||(e=this.getSerializationObject())&&(this._serializationLabels=Object.keys(e)),this._serializationLabels}},getExternalObjectLabels:{value:function(){var e=this.getSerializationObject(),t=[];for(var n in e)0===Object.keys(e[n]).length&&t.push(n);return t}},hasSerializationLabel:{value:function(e){return e in this.getSerializationObject()}},isExternalObject:{value:function(e){var t=this.getSerializationObject();return!!(t&&e in t)&&0===Object.keys(t[e]).length}},isAlias:{value:function(e){var t=this.getSerializationObject();return!!(t&&e in t)&&"alias"in t[e]}},getElementId:{value:function(e){var t=this.getSerializationObject(),n=r.getPath.call(t,e+".properties.element");if(n)return n["#"]}},getSerializationLabelsWithElements:{value:function(e){var t=new c,n=[];return t.initWithSerialization(this),t.visitSerialization(function(t){"Element"===t.type&&e.indexOf(t.data)>=0&&(t=t.parent,t&&"properties"===t.name&&(t=t.parent,t&&"montageObject"===t.type&&n.push(t.label)))}),n}},renameElementReferences:{value:function(e){var t=new c;t.initWithSerialization(this),t.visitSerialization(function(t){"Element"===t.type&&t.data in e&&(t.data=e[t.data])})}},renameSerializationLabels:{value:function(e){var t=new c;t.initWithSerialization(this),t.visitSerialization(function(t){if(t.label){var n=t.label;n in e&&(t.label=e[n])}if("reference"===t.type){var r=t.data;r in e&&(t.data=e[r])}})}},mergeSerialization:{value:function(e,t){return u.mergeSerializations(this,e,t)}},extractSerialization:{value:function(e,t){var n=new h;return n.initWithSerialization(this),n.extractSerialization(e,t)}}}),u=r.specialize(null,{mergeSerializations:{value:function(e,t,n){var r,i,o,a,s,l,u={};o=e.getSerializationLabels(),a=t.getSerializationLabels(),s=this._createCollisionTable(o,a,u,n&&n.labeler),n&&n.willMergeObjectWithLabel&&(l=this._willMergeObjectWithLabel(n,e,t,u),s=s||l),s&&(t=t.clone(),t.renameSerializationLabels(u),a=t.getSerializationLabels()),r=e.getSerializationObject(),i=t.getSerializationObject();for(var c,h=0;c=a[h];h++)o.indexOf(c)===-1&&(r[c]=i[c]);return e.initWithObject(r),u}},_willMergeObjectWithLabel:{value:function(e,t,n,r){var i,o,a,s,l,u=!1,c=n.getSerializationLabels();r&&(a=[],Object.keys(r).forEach(function(e){a.push(r[e])}));for(var h,p=0;h=c[p];p++)if(o=r&&r[h],i=e.willMergeObjectWithLabel(h,o),"string"==typeof i){if(s=this._isLabelValidInSerialization(i,t),s||(l=!this._isLabelValidInSerialization(i,n)&&a.indexOf(i)===-1),!s&&!l)throw new Error("willMergeObjectWithLabel either needs to return a label that exists in the destination serialization to indicate it's the same object or return a completely new label to rename the object being merged. \""+i+'"  destination: '+t.getSerializationString()+"\n source: "+n.getSerializationString()+"\n collision table: "+JSON.stringify(r,null,4));u=!0,r[h]=i}return u}},_isLabelValidInSerialization:{value:function(e,t){var n,r;return!!t.hasSerializationLabel(e)||(r=e.indexOf(":"),!!(r>0&&(n=e.slice(0,r),t.hasSerializationLabel(n))))}},_createCollisionTable:{value:function(e,t,n,r){for(var o,a,s,l,r=r||new i,u=!1,c=Object.create(null),h=0;h<e.length;h++)s=e[h],l=s.indexOf(":"),l>0&&(o=s.slice(0,l),r.addLabel(o),c[o]=1),r.addLabel(s),c[s]=1;for(var h=0;s=t[h];h++)l=s.indexOf(":"),l>0?(o=s.slice(0,l),a=n[o],a?(n[s]=a+":"+s.slice(l+1),u=!0):o in c?(a=r.generateLabel(r.getLabelBaseName(o)),t.indexOf(o)>=0&&(n[o]=a),n[s]=a+s.slice(l),u=!0):r.addLabel(o)):s in c&&!(s in n)?(n[s]=r.generateLabel(r.getLabelBaseName(s)),u=!0):r.addLabel(s);return u}}}),c=r.specialize({initWithSerialization:{value:function(e){this._serialization=e}},visitSerialization:{value:function(e){var t=this._serialization.getSerializationObject();this._walkRootObjects(e,t),this._serialization.initWithObject(t)}},visitSerializationObject:{value:function(e,t){var n=this._serialization.getSerializationObject();if(!(e in n))throw new Error('Object "'+e+'" does not exist in '+this._serialization.getSerializationString());this._walkRootObject(t,n,e),this._serialization.initWithObject(n)}},changeLabel:{value:function(e,t){var n,r=this._serialization.getSerializationObject();n=r[e],delete r[e],r[t]=n}},_walkRootObjects:{value:function(e,t){for(var n in t)this._walkRootObject(e,t,n)}},_walkRootObject:{value:function(e,t,n){var r=t[n];"value"in r?this._walkObject(e,r,"value",n):this._walkCustomObject(e,t,n)}},_walkObject:{value:function(e,t,n,r,i){var a,s=t[n],l=o.getTypeOf(s);if(a={type:l},r?a.label=r:a.name=n,i&&(a.parent=i),"number"===l||"string"===l||"null"===l)a.data=s,e(a),t[n]=a.data;else if("regexp"===l)a.data=s["/"],e(a),s["/"]=a.data;else if("reference"===l)a.data=s["@"],e(a),s["@"]=a.data;else if("Element"===l)a.data=s["#"],e(a),s["#"]=a.data;else if("array"===l){a.data=s,e(a),t[n]=s=a.data;for(var u=0,c=s.length;u<c;u++)this._walkObject(e,s,""+u,null,a)}else if("object"===l){a.data=s,e(a),t[n]=s=a.data;for(var n in s)this._walkObject(e,s,n,null,a)}a.label!=r&&this.changeLabel(r,a.label)}},_walkCustomObject:{value:function(e,t,n){var r,i=t[n];r={type:"montageObject",label:n,data:i},e(r),t[n]=i=r.data,r.label!=n&&this.changeLabel(n,r.label),i.properties&&this._walkObject(e,i,"properties",null,r),i.listeners&&this._walkObject(e,i,"listeners",null,r),i.bindings&&this._walkBindings(e,i,null,r),i.localizations&&this._walkLocalizations(e,i,null,r)}},_walkBindings:{value:function(e,t,n){var r,i=t.bindings;r={type:"bindings",data:i,parent:n},e(r),t.bindings=i=r.data;for(var o in i)this._walkBinding(e,i,o,r)}},_walkBinding:{value:function(e,t,n,r){var i,o=t[n];i={type:"binding",name:n,data:o,parent:r},e(i),t[n]=o=i.data,this._walkBindingData(e,o,i)}},_walkBindingData:{value:function(e,t,n){var r,i,o=!1;r=t["<-"]||t["<->"],i=Object.clone(a(r)),this._walksBindingReferences(i,function(t){var n={type:"reference",data:t.label};e(n),t.label!==n.data&&(t.label=n.data,o=!0)}),o&&("<-"in t?t["<-"]=s(i):t["<->"]=s(i)),t.converter&&this._walkObject(e,t,"converter",null,n)}},_walkLocalizations:{value:function(e,t,n){var r,i=t.localizations;r={type:"localizations",data:i,parent:n},e(r),t.localizations=i=r.data;for(var o in i)this._walkLocalization(e,i,o,r)}},_walkLocalization:{value:function(e,t,n,r){var i,o,a=t[n];if(i={type:"localization",name:n,data:a,parent:r},e(i),t[n]=a=i.data,"object"==typeof a.key&&this._walkBindingData(e,a.key,i),"object"==typeof a["default"]&&this._walkBindingData(e,a["default"],i),"object"==typeof a.data){o=a.data;for(var n in o)this._walkBindingData(e,o[n],i)}}},_walksBindingReferences:{value:function(e,t){var n=e.args;if("component"===e.type&&t(e),n)for(var r=0,i=n.length;r<i;r++)this._walksBindingReferences(n[r],t)}}}),h=r.specialize({_serialization:{value:null},initWithSerialization:{value:function(e){this._serialization=e}},extractSerialization:{value:function(e,t){var n,r=new c,i={},o=[];n=this._serialization.getSerializationObject(),r.initWithSerialization(this._serialization);for(var a,s=0;a=e[s];s++)i[a]=n[a],r.visitSerializationObject(a,function(t){var n;"reference"===t.type&&(n=t.data,o.indexOf(n)===-1&&e.indexOf(n)===-1&&o.push(n))});if(t)for(var a,s=0;a=t[s];s++)a in n&&!(a in i)&&(i[a]={});for(var a,s=0;a=o[s];s++)i[a]={};return(new l).initWithObject(i)}}});t.Serialization=l,t.SerializationMerger=u,t.SerializationInspector=c,t.SerializationExtractor=h}}),montageDefine("ad36237","window-loader/montage-window",{dependencies:["../core/core"],factory:function(e,t,n){var r=e("../core/core").Montage;t.MontageWindow=r.specialize({_application:{value:null},application:{get:function(){return this._application},set:function(e){null===this._application&&(this._application=e,this.focused&&this._setFocusedWindow(this))}},_window:{value:null},window:{get:function(){return this._window},set:function(e){if(null===this._window){var t=e.document.body;this._window=e,e.addEventListener("beforeunload",this,!0),e.addEventListener("focus",this,!0),e.addEventListener("mousedown",this,!0),null===t.getAttribute("tabIndex")&&(t.setAttribute("tabIndex",-1),t.focus())}}},document:{get:function(){return this._window.document}},_component:{value:null},component:{get:function(){return this._component},set:function(e){null===this._component&&(this._component=e)}},title:{get:function(){return this.document.title},set:function(e){this.document.title=e}},focused:{value:!1},focus:{value:function(){this._window&&this._window.focus()}},_setFocusedWindow:{value:function(e){var t,n,r,i=this.application;if(i._multipleWindow){t=i.windows;for(r in t)n=t[r],n.window===e?n.focused!==!0&&(n.focused=!0,"z-order"==i.windowsSortOrder?(t.splice(r,1),t.unshift(n)):"reverse-z-order"==i.windowsSortOrder&&(t.splice(r,1),t.push(n))):n.focused=!1}else this.focused=!0}},closed:{get:function(){return!!this._window&&this._window.closed}},close:{value:function(){this._window&&this._window.close()}},resizeTo:{value:function(e,t){this._window&&this._window.resizeTo(e,t)}},moveTo:{value:function(e,t){this._window&&this._window.moveTo(e,t)}},captureFocus:{value:function(e){var t=this.application;if(!this.application)return void(this.focused=!0);if(t.parentApplication)t.mainApplication.window.captureFocus(e);else{var n=(e.target.ownerDocument?e.target.ownerDocument.defaultView:null)||e.target.defaultView||e.target;this._setFocusedWindow(n)}}},captureMousedown:{value:function(e){this.captureFocus(e)}},captureBeforeunload:{value:function(e){var t,n=this.application,r=n.windows,i=n.attachedWindows;n.attachedWindows=[];for(var t in i)i[t].close();n.parentApplication&&(i=n.parentApplication.attachedWindows,t=i.indexOf(this),t!==-1&&i.splice(t,1),t=r.indexOf(this),t!==-1&&r.splice(t,1),this.window.removeEventListener("beforeunload",this,!0),this.close())}}})}}),montageDefine("ad36237","core/dom",{dependencies:["./extras/dom"],factory:function(e,t,n){e("./extras/dom")}}),montageDefine("ad36237","ui/base/abstract-number-field",{dependencies:["./abstract-control","../../composer/key-composer"],factory:function(e,t,n){var r=e("./abstract-control").AbstractControl,i=e("../../composer/key-composer").KeyComposer;t.AbstractNumberField=r.specialize({constructor:{value:function o(){if(this.constructor===o)throw new Error("AbstractNumberField cannot be instantiated.");this._propertyNamesUsed={},this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"})}},enterDocument:{value:function(e){if(e){var t=this._propertyNamesUsed;t.min||(this.min=this.element.getAttribute("min")||this._min),t.max||(this.max=this.element.getAttribute("max")||this._max),t.step||(this.step=this.element.getAttribute("step")||this._step),t.value||(this.value=this.element.getAttribute("value")||this._value),delete this._propertyNamesUsed,this._numberFieldTextFieldComponent.addEventListener("action",this,!1),this._numberFieldMinusComponent.addEventListener("action",this,!1),this._numberFieldPlusComponent.addEventListener("action",this,!1),this._numberFieldTextFieldComponent.delegate=this,this.element.addEventListener("mousedown",this,!1),this.element.tabIndex="-1",this._upKeyComposer=i.createKey(this,"up","increase"),this._downKeyComposer=i.createKey(this,"down","decrease"),this._rightKeyComposer=i.createKey(this,"right","increase"),this._leftKeyComposer=i.createKey(this,"left","decrease")}}},textFieldShouldBeginEditing:{value:function(){return this.enabled}},textFieldDidChange:{value:function(){}},textFieldDidEndEditing:{value:function(){this.value=this._numberFieldTextFieldComponent.value}},textFieldShouldAcceptValue:{value:function(e,t){if(this._activeValueChange===!0)return!0}},prepareForActivationEvents:{value:function(){this._upKeyComposer.addEventListener("keyPress",this,!1),this._downKeyComposer.addEventListener("keyPress",this,!1),this._leftKeyComposer.addEventListener("keyPress",this,!1),this._rightKeyComposer.addEventListener("keyPress",this,!1)}},draw:{value:function(){this.element.setAttribute("aria-valuemax",this.max),this.element.setAttribute("aria-valuemin",this.min),this.element.setAttribute("aria-valuenow",this.value)}},acceptsActiveTarget:{value:!0},handleMousedown:{value:function(){this.element.focus()}},handlePlusAction:{value:function(){this._activeValueChange=!0;var e=this.step*this._stepDecimal,t="number"==typeof this.min?this.min*this._stepDecimal:0,n=this.value*this._stepDecimal-t;n%e?n<0?n-=n%e:n+=e-n%e:n+=e,this.value=(n+t)/this._stepDecimal,this._activeValueChange=!1}},handleMinusAction:{value:function(){this._activeValueChange=!0;var e=this.step*this._stepDecimal,t="number"==typeof this.min?this.min*this._stepDecimal:0,n=this.value*this._stepDecimal-t;n-=n%e?n>0?n%e:e+n%e:e,this.value=(n+t)/this._stepDecimal,this._activeValueChange=!1}},handleKeyPress:{value:function(e){this.enabled&&("increase"===e.identifier?this.handlePlusAction():"decrease"===e.identifier&&this.handleMinusAction())}},handleAction:{value:function(e){e.target!==this._numberFieldTextFieldComponent&&e.target!==this._numberFieldMinusComponent&&e.target!==this._numberFieldPlusComponent||(e.stopPropagation(),this.dispatchActionEvent())}},_value:{value:0},_required:{value:!1},_min:{value:"any"},_max:{value:"any"},_step:{value:1},min:{get:function(){return this._min},set:function(e){return("any"===e||!isNaN(e=parseFloat(e)))&&void(this._min!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.min=!0),this._min=e,this.needsDraw=!0,"number"==typeof e&&this.value<e&&(this.value=e)))}},max:{get:function(){return this._max},set:function(e){return("any"===e||!isNaN(e=parseFloat(e)))&&void(this._max!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.max=!0),this._max=e,this.needsDraw=!0,"number"==typeof e&&this.value>e&&(this.value=e)))}},_stepDecimal:{value:1},step:{get:function(){return this._step},set:function(e){if(isNaN(e=parseFloat(e))||e<=0)return!1;if(this._step!==e){this._propertyNamesUsed&&(this._propertyNamesUsed.step=!0),this._step=e;var t=String(e).match(/\.(\d+)$/);t?this._stepDecimal=Math.pow(10,t[1].length):this._stepDecimal=1}}},value:{get:function(){return this._value},set:function(e){null==e||"undefined"==typeof e.valueOf?this._value="":isNaN(e=parseFloat(e))||("number"==typeof this.min&&e<this.min&&(e=this.min),"number"==typeof this.max&&e>this.max&&(e=this.max),this._value!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.value=!0),this._value=e,this.needsDraw=!0)),this._numberFieldTextFieldComponent&&this._value!==this._numberFieldTextFieldComponent.value&&(this._numberFieldTextFieldComponent.value=this._value)}},enabled:{value:!0},_numberFieldTextFieldComponent:{value:null},_numberFieldMinusComponent:{value:null},_numberFieldPlusComponent:{value:null},_activeValueChange:{value:!1}})}}),montageDefine("ad36237","ui/base/abstract-slider",{dependencies:["./abstract-control","../../composer/translate-composer","../../composer/key-composer"],factory:function(e,t,n){var r=e("./abstract-control").AbstractControl,i=e("../../composer/translate-composer").TranslateComposer,o=e("../../composer/key-composer").KeyComposer;t.AbstractSlider=r.specialize({constructor:{value:function a(){if(this.constructor===a)throw new Error("AbstractSlider cannot be instantiated.");this._propertyNamesUsed={},this.addOwnPropertyChangeListener("_sliderMagnitude",this),this.addOwnPropertyChangeListener("_min",this),this.addOwnPropertyChangeListener("_max",this),this.addOwnPropertyChangeListener("_value",this),this.addOwnPropertyChangeListener("_step",this),this.addOwnPropertyChangeListener("axis",this),this.axis="horizontal",this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"}),this.defineBinding("classList.has('montage-Slider--active')",{"<-":"active"})}},enterDocument:{value:function(e){if(e){this._translateComposer=new i,this._translateComposer.identifier="thumb",this._translateComposer.axis=this.axis,this._translateComposer.hasMomentum=!1,this.addComposerForElement(this._translateComposer,this._sliderThumbElement),"webkitTransform"in this.element.style?this._transform="webkitTransform":"MozTransform"in this.element.style?this._transform="MozTransform":"oTransform"in this.element.style?this._transform="oTransform":this._transform="transform";var t=this._propertyNamesUsed;t._min||(this.min=this.element.getAttribute("min")||this._min),t._max||(this.max=this.element.getAttribute("max")||this._max),t._step||(this.step=this.element.getAttribute("step")||this._step),t._value||(this.value=this.element.getAttribute("value")||this._value),delete this._propertyNamesUsed,this.element.setAttribute("role","slider"),this.element.tabIndex="-1",this._upKeyComposer=o.createKey(this,"up","increase"),this._downKeyComposer=o.createKey(this,"down","decrease"),this._rightKeyComposer=o.createKey(this,"right","increase"),this._leftKeyComposer=o.createKey(this,"left","decrease")}}},prepareForActivationEvents:{value:function(){this._translateComposer.addEventListener("translateStart",this,!1),this._translateComposer.addEventListener("translate",this,!1),this._translateComposer.addEventListener("translateEnd",this,!1),this._sliderThumbElement.addEventListener("touchstart",this,!1),document.addEventListener("touchend",this,!1),this._sliderThumbElement.addEventListener("mousedown",this,!1),document.addEventListener("mouseup",this,!1),this._upKeyComposer.addEventListener("keyPress",this,!1),this._downKeyComposer.addEventListener("keyPress",this,!1),this._leftKeyComposer.addEventListener("keyPress",this,!1),this._rightKeyComposer.addEventListener("keyPress",this,!1)}},willDraw:{value:function(){this._sliderMagnitude=this._calculateSliderMagnitude()}},_previousPercentage:{value:null},draw:{value:function(){"vertical"===this.axis?this._isUpdatingTranslate?(this._sliderThumbElement.style[this._transform]="translate3d(0,"+(this._previousPercentage-this._valuePercentage)*this._sliderMagnitude*.01+"px,0)",this._isUpdatingTranslate=!1):(this._sliderThumbElement.style.top=100-this._valuePercentage+"%",this._sliderThumbElement.style.left=0,this._sliderThumbElement.style[this._transform]="translate3d(0,0,0)",this._previousPercentage=this._valuePercentage):this._isUpdatingTranslate?(this._sliderThumbElement.style[this._transform]="translate3d("+(this._valuePercentage-this._previousPercentage)*this._sliderMagnitude*.01+"px,0,0)",this._isUpdatingTranslate=!1):(this._sliderThumbElement.style.left=this._valuePercentage+"%",this._sliderThumbElement.style.top=0,this._sliderThumbElement.style[this._transform]="translate3d(0,0,0)",this._previousPercentage=this._valuePercentage),this.element.setAttribute("aria-valuemax",this.max),this.element.setAttribute("aria-valuemin",this.min),this.element.setAttribute("aria-valuenow",this.value)}},acceptsActiveTarget:{value:!0},handleTouchstart:{value:function(e){this.active=!0,this.element.focus(),this._isUpdatingTranslate=!0}},handleTouchend:{value:function(e){this.active=!1}},handleMousedown:{value:function(e){this.active=!0,this.element.focus(),e.preventDefault(),this._isUpdatingTranslate=!0}},handleMouseup:{value:function(e){this.active=!1}},_isUpdatingTranslate:{value:!1},handleThumbTranslateStart:{value:function(e){"vertical"===this.axis?this._startTranslate=e.translateY:this._startTranslate=e.translateX,this._startValue=this.value}},handleThumbTranslate:{value:function(e){"vertical"===this.axis?this.value=this._startValue+(this._startTranslate-e.translateY)/this._sliderMagnitude*(this._max-this._min):this.value=this._startValue+(e.translateX-this._startTranslate)/this._sliderMagnitude*(this._max-this._min),this._isUpdatingTranslate=!0}},handleThumbTranslateEnd:{value:function(e){this.active=!1,this._isUpdatingTranslate=!1}},_increase:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e,n=this.step|(this.max-this.min)/100;t%n?t<0?t-=t%n:t+=n-t%n:t+=n,this.value=t+e}},_decrease:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e,n=this.step|(this.max-this.min)/100;t-=t%n?t>0?t%n:n+t%n:n,this.value=t+e}},handleKeyPress:{value:function(e){this.enabled&&("increase"===e.identifier?this._increase():"decrease"===e.identifier&&this._decrease());
}},surrenderPointer:{value:function(e,t){return!1}},active:{value:!1},_min:{value:0},_max:{value:100},_step:{value:"any"},min:{get:function(){return this._min},set:function(e){isNaN(e=parseFloat(e))||this._min!==e&&(this._min=e)}},max:{get:function(){return this._max},set:function(e){isNaN(e=parseFloat(e))||this._max!==e&&(this._max=e)}},step:{get:function(){return this._step},set:function(e){!isNaN(e=parseFloat(e))&&e>=0&&this._step!==e&&(this._step=e)}},_value:{value:50},value:{get:function(){return this._value},set:function(e){isNaN(e=parseFloat(e))||(e>this._max?e=this._max:e<this._min&&(e=this._min),this._value!==e&&(this._value=e))}},enabled:{value:!0},axis:{value:null},_sliderThumbElement:{value:null},_translateComposer:{value:null},_transform:{value:null},_transition:{value:null},_sliderMagnitude:{value:null},_startTranslate:{value:null},_startValue:{value:null},_valuePercentage:{value:null},_calculateSliderMagnitude:{value:function(){var e=window.getComputedStyle(this._element);return"vertical"===this.axis?this._element.clientHeight-parseFloat(e.getPropertyValue("padding-top"))-parseFloat(e.getPropertyValue("padding-bottom")):this._element.clientWidth-parseFloat(e.getPropertyValue("padding-left"))-parseFloat(e.getPropertyValue("padding-right"))}},handleAxisChange:{value:function(){this._translateComposer&&(this._translateComposer.axis=this.axis),"vertical"===this.axis?(this.classList.add("montage-Slider--vertical"),this.classList.remove("montage-Slider--horizontal")):(this.classList.remove("montage-Slider--vertical"),this.classList.add("montage-Slider--horizontal"))}},_propertyRegex:{value:/_sliderMagnitude|_min|_max|_value|_step/},handlePropertyChange:{value:function(e,t,n){if(null!==t.match(this._propertyRegex)){if(this._propertyNamesUsed&&(this._propertyNamesUsed[t]=!0),this._value<=this._min)this._value=this._min;else{var r=this._value-this._min,i=r%this._step;if(i){var o=i>=.5*this._step&&this._value-i+this._step<=this._max;o?this._value=this._value-i+this._step:this._value=this._value-i}}this._value>this._max&&(this._value=this._max),this._valuePercentage=100*(this._value-this._min)/(this._max-this._min),this.needsDraw=!0}}}})}}),montageDefine("ad36237","core/extras/dom",{dependencies:[],factory:function(e,t,n){if("undefined"!=typeof Node){var r=Node.prototype;r.get=function(e){return this.getAttribute(e)||this[e]},r.parentOf=function(e){for(;(e=e.parentNode)&&e!==this;);return!!e}}if("undefined"!=typeof Element){var i=Element.prototype;Object.defineProperty(i,"set",{value:function(e,t,n){var r,i,o,a,s,l=e.indexOf(".",n);n=n||0,i=e.substring(n,l===-1?e.length:l),l===-1?this.setAttribute(i,t):(o=e.lastIndexOf("."),"style"===i?(a=e.substring(l+1,e.length),this.style[a]=t):"classList"===i?(s=e.substring(l+1,e.length),t?this.classList.add(s):this.classList.remove(s)):(r=this.get(e.substring(0,o)))&&(r[e.substring(o+1,e.length)]=t))},enumerable:!1});var o="classList";if(!i.hasOwnProperty(o)){var a=/^\s+|\s+$/g,s=function(e,t){e.setAttribute("class",t.join(" "))},l=function(e,t){if(""===t)throw"SYNTAX_ERR";if(/\s/.test(t))throw"INVALID_CHARACTER_ERR";return e.indexOf(t)},u=function(){var e=this,t=e.getAttribute("class")||"";return t=t.replace(a,"").split(/\s+/),{length:t.length,item:function(e){return t[e]||null},contains:function(e){return l(t,e)!==-1},add:function(n){l(t,n)===-1&&(t.push(n),this.length=t.length,s(e,t))},remove:function(n){var r=l(t,n);r!==-1&&(t.splice(r,1),this.length=t.length,s(e,t))},toggle:function(e){l(t,e)===-1?this.add(e):this.remove(e)},toString:function(){return e.getAttribute("class")||""}}};Object.defineProperty?Object.defineProperty(i,o,{get:u,enumerable:!0}):Object.prototype.__defineGetter__&&i.__defineGetter__(o,u)}}if("undefined"!=typeof Node){var c=Object.getPrototypeOf(document);c.addRule=function(e,t){var n,r;if(null==(n=document.styleSheets[0])){var i=document.createElement("style");i.type="text/css",document.head.appendChild(i),n=document.styleSheets[0]}else r=document.getRule(e,n);r||n.insertRule(e+" "+t,n.cssRules.length)},c.getRule=function(e,t){var n;if(t.cssRules)for(var r=0;n=t.cssRules[r];r++){if(n.name&&n.name===e)return n;if(n.selectorText===e)return n}}}}}),montageDefine("ad36237","ui/base/abstract-control",{dependencies:["../component","collections/map"],factory:function(e,t,n){var r=e("../component").Component,i=e("collections/map");t.AbstractControl=r.specialize({dispatchActionEvent:{value:function(){return this.dispatchEvent(this.createActionEvent())}},_detail:{value:null},detail:{get:function(){return null==this._detail&&(this._detail=new i),this._detail}},createActionEvent:{value:function(){var e,t=document.createEvent("CustomEvent");return e=this._detail,t.initCustomEvent("action",!0,!0,e),t}},disabled:{get:function(){return!this.enabled},set:function(e){"boolean"==typeof e&&(this.enabled=!e)}}})}}),montageDefine("ad36237","composer/translate-composer",{dependencies:["./composer","../core/event/event-manager"],factory:function(e,t,n){var r=e("./composer").Composer,i=e("../core/event/event-manager").defaultEventManager,o=t.TranslateComposer=r.specialize({_NATIVE_ELEMENTS:{value:["A","IFRAME","EMBED","OBJECT","VIDEO","AUDIO","CANVAS","LABEL","INPUT","BUTTON","SELECT","TEXTAREA","KEYGEN","DETAILS","COMMAND"]},_WHEEL_POINTER:{value:"wheel",writable:!1},_MOUSE_POINTER:{value:"mouse",writable:!1},_TOUCH_POINTER:{value:"touch",writable:!1},CLAIM_POINTER_POLICIES:{value:{DEFAULT:"default",MOVE:"move"}},enabled:{value:!0},_externalUpdate:{value:!0},isAnimating:{value:!1},isMoving:{value:!1},frame:{value:function(){this.isAnimating&&this._animationInterval(),this._externalUpdate=!1}},_pointerSpeedMultiplier:{value:1},pointerSpeedMultiplier:{get:function(){return this._pointerSpeedMultiplier},set:function(e){this._pointerSpeedMultiplier=e}},pointerStartEventPosition:{value:null},_shouldDispatchTranslate:{value:!1},_isSelfUpdate:{value:!1},_allowFloats:{value:!1},allowFloats:{get:function(){return this._allowFloats},set:function(e){this._allowFloats!==e&&(this._allowFloats=e,this.translateX=this._translateX,this.translateY=this._translateY)}},allowTranslateOuterExtreme:{value:!1},_translateX:{value:0},translateX:{get:function(){return this._translateX},set:function(e){if("vertical"===this._axis)this._translateX=this._minTranslateX||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateX&&t<this._minTranslateX&&(t=this._minTranslateX),null!==this._maxTranslateX&&t>this._maxTranslateX&&(t=this._maxTranslateX),this._isSelfUpdate||(this.isAnimating=!1),this._translateX=t}}},_translateY:{value:0},translateY:{get:function(){return this._translateY},set:function(e){if("horizontal"===this._axis)this._translateY=this._minTranslateY||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateY&&t<this._minTranslateY&&(t=this._minTranslateY),null!==this._maxTranslateY&&t>this._maxTranslateY&&(t=this._maxTranslateY),this._isSelfUpdate||(this.isAnimating=!1),this._translateY=t}}},_minTranslateX:{value:null},minTranslateX:{get:function(){return this._minTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateX!==e&&(null!==e&&this._translateX<e&&(this.translateX=e),this._minTranslateX=e)}},_maxTranslateX:{value:null},maxTranslateX:{get:function(){return this._maxTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateX!==e&&(null!==e&&this._translateX>e&&(this.translateX=e),this._maxTranslateX=e)}},_minTranslateY:{value:null},minTranslateY:{get:function(){return this._minTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateY!==e&&(null!==e&&this._translateY<e&&(this.translateY=e),this._minTranslateY=e)}},_maxTranslateY:{value:null},maxTranslateY:{get:function(){return this._maxTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateY!==e&&(null!==e&&this._translateY>e&&(this.translateY=e),this._maxTranslateY=e)}},_axis:{value:"both"},axis:{get:function(){return this._axis},set:function(e){switch(e){case"vertical":case"horizontal":this._axis=e,this.translateX=this._translateX,this.translateY=this._translateY;break;default:this._axis="both"}}},invertAxis:{depends:["invertXAxis","invertYAxis"],get:function(){return this._invertXAxis===this._invertYAxis?this._invertXAxis:null},set:function(e){this.invertXAxis=e,this.invertYAxis=e}},_invertXAxis:{value:!1},invertXAxis:{get:function(){return this._invertXAxis},set:function(e){this._invertXAxis=!!e}},_invertYAxis:{value:!1},invertYAxis:{get:function(){return this._invertYAxis},set:function(e){this._invertYAxis=!!e}},_hasMomentum:{value:!0},hasMomentum:{get:function(){return this._hasMomentum},set:function(e){this._hasMomentum=!!e}},__momentumDuration:{value:650},_momentumDuration:{get:function(){return this.__momentumDuration},set:function(e){this.__momentumDuration=isNaN(e)?1:e>>0,this.__momentumDuration<1&&(this.__momentumDuration=1)}},_pointerX:{value:null},_pointerY:{value:null},_touchIdentifier:{value:null},_isFirstMove:{value:!1},_observedPointer:{value:null},eventManager:{get:function(){return i}},_mouseRadiusThreshold:{value:2},_touchRadiusThreshold:{value:8},_listenToWheelEvent:{value:!1},listenToWheelEvent:{set:function(e){e=!!e,this._listenToWheelEvent!==e&&(this._listenToWheelEvent=e,this._isLoaded&&(e?this._addWheelEventListener():this._removeWheelEventListener()))},get:function(){return this._listenToWheelEvent}},_claimPointerPolicy:{value:null},load:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!0):(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("mousedown",this,!0)),this._listenToWheelEvent&&this._addWheelEventListener(),this.eventManager.isStoringPointerEvents=!0}},unload:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!0):(this._element.removeEventListener("touchstart",this,!0),this._element.removeEventListener("mousedown",this,!0)),this._listenToWheelEvent&&this._removeWheelEventListener()}},surrenderPointer:{value:function(e,t){var n=this.callDelegateMethod("surrenderPointer",e,t);return("undefined"==typeof n||n!==!1)&&(this._cancel(),!0)}},addEventListener:{value:function(e,t,n){r.prototype.addEventListener.call(this,e,t,n),"translate"===e&&(this._shouldDispatchTranslate=!0)}},capturePointerdown:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.captureMousedown(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.captureTouchstart(e)}},capturePointermove:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.captureMousemove(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.captureTouchmove(e)}},handlePointerup:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.handleMouseup(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchend(e)}},handlePointercancel:{value:function(e){(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchcancel(e)}},captureMousedown:{value:function(e){this.enabled&&0===e.button&&(this._observedPointer=this._MOUSE_POINTER,this._start(e.clientX,e.clientY,e.target,e.timeStamp))}},captureMousemove:{value:function(e){this.enabled&&this._handleMove(e)}},handleMouseup:{value:function(e){this.enabled&&this._end(e)}},captureTouchstart:{value:function(e){if(this.enabled&&null===this._observedPointer)if(void 0!==e.pointerId)this._observedPointer=e.pointerId,this._start(e.clientX,e.clientY,e.target,e.timeStamp),this._preventDefaultIfNeeded(e);else{var t=e.targetTouches;if(t&&1===t.length){var n=t[0];this._preventDefaultIfNeeded(e),this._observedPointer=n.identifier,this._start(n.clientX,n.clientY,n.target,e.timeStamp)}}}},captureTouchmove:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._handleMove(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._handleMove(e,t)}}},handleTouchend:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._end(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._end(t)}}},handleTouchcancel:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._cancel(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._cancel(t)}}},captureScroll:{value:function(e){e.target.contains(this.element)&&this._cancel(e)}},_shouldPreventDefault:{value:function(e){return!!e.target.tagName&&this._NATIVE_ELEMENTS.indexOf(e.target.tagName)===-1&&!e.target.isContentEditable}},_preventDefaultIfNeeded:{value:function(e){!e.defaultPrevented&&this._shouldPreventDefault(e)&&e.preventDefault()}},_addWheelEventListener:{value:function(){if(this._element){var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";this._element.addEventListener(e,this,!1),this._element.addEventListener(e,this,!0)}}},_removeWheelEventListener:{value:function(){if(this._element){var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";this._element.removeEventListener(e,this,!1),this._element.removeEventListener(e,this,!0)}}},_start:{value:function(e,t,n,r){this.pointerStartEventPosition={pageX:e,pageY:t,target:n,timeStamp:r},this._pointerX=e,this._pointerY=t,window.PointerEvent?(this._element.addEventListener("pointerdown",this,!1),document.addEventListener("pointermove",this,!0),document.addEventListener("pointerup",this,!1),document.addEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(this._element.addEventListener("MSPointerDown",this,!1),document.addEventListener("MSPointerMove",this,!0),document.addEventListener("MSPointerUp",this,!1),document.addEventListener("MSPointerCancel",this,!1)):this._observedPointer===this._MOUSE_POINTER?(this._element.addEventListener("mousedown",this,!1),document.addEventListener("mousemove",this,!0),document.addEventListener("mouseup",this,!1)):(this._element.addEventListener("touchstart",this,!1),this._element.addEventListener("touchmove",this,!0),this._element.addEventListener("touchend",this,!1),this._element.addEventListener("touchcancel",this,!1)),document.addEventListener("scroll",this,!0),this.isAnimating&&(this.isAnimating=!1,this._dispatchTranslateEnd()),this._isFirstMove=!0}},_handleStart:{value:function(e){this._claimPointerPolicy=this.eventManager.componentClaimingPointer(this._observedPointer)?this.CLAIM_POINTER_POLICIES.MOVE:this.CLAIM_POINTER_POLICIES.DEFAULT}},_findObservedTouch:{value:function(e){for(var t,n=null,r=0;(t=e[r])&&null===n;r++)t.identifier===this._observedPointer&&(n=t);return n}},_handleMove:{value:function(e,t){var n=this.eventManager,i=this.pointerStartEventPosition;if(t||(t=e),this._isFirstMove){var o=n.componentClaimingPointer(this._observedPointer);if(o){var a=!0;if(this._claimPointerPolicy===this.CLAIM_POINTER_POLICIES.MOVE){var s=this._observedPointer===this._MOUSE_POINTER?this._mouseRadiusThreshold:this._touchRadiusThreshold,l=i.pageX-t.clientX,u=i.pageY-t.clientY;a=r.isCoordinateOutsideRadius(l,u,s),a&&(i.pageX=t.clientX,i.pageY=t.clientY,i.target=t.target,i.timeStamp=e.timeStamp,this._pointerX=t.clientX,this._pointerY=t.clientY)}if(!a)return void this._preventDefaultIfNeeded(e)}n.claimPointer(this._observedPointer,this)}n.isPointerClaimedByComponent(this._observedPointer,this)?(this._preventDefaultIfNeeded(e),(this.allowTranslateOuterExtreme||this._shouldMove(e,t.clientX,t.clientY))&&(this._isFirstMove?this._firstMove():this._move(t.clientX,t.clientY))):this._releaseInterest()}},_shouldMove:{value:function(e,t,n){var r,i,o,a,s=this._translateY,l=this._translateX,u=this._minTranslateY,c=this._maxTranslateY,h=this._minTranslateX,p=this._maxTranslateX,d=!0;return"wheel"===e.type||"mousewheel"===e.type?("vertical"!==this._axis&&(o=20*(e.wheelDeltaX||-e.deltaX||0)/120),"horizontal"!==this._axis&&(a=20*(e.wheelDeltaY||-e.deltaY||0)/120),d=!("horizontal"===this._axis&&0===o||"vertical"===this._axis&&0===a||0===o&&0===a)):("vertical"!==this._axis&&(o=-(this._invertXAxis?this._pointerX-t:t-this._pointerX)),"horizontal"!==this._axis&&(a=-(this._invertYAxis?this._pointerY-n:n-this._pointerY))),d&&(a&&(r=this._isNegativeNumber(a),null!==u&&(d=s!==u||s===u&&r),null!==c&&d&&(d=s!==c||s===c&&!r)),o&&(i=this._isNegativeNumber(o),null!==h&&d&&(d=l!==h||l===h&&i),null!==p&&d&&(d=l!==p||l===p&&!i))),d}},_firstMove:{value:function(){this._isFirstMove&&(this._dispatchTranslateStart(this._translateX,this._translateY),this._isFirstMove=!1,this.isMoving=!0)}},_move:{value:function(e,t){var n;this._isSelfUpdate=!0,"vertical"!==this._axis&&(n=this._invertXAxis?this._pointerX-e:e-this._pointerX,this.translateX+=n*this._pointerSpeedMultiplier),"horizontal"!==this._axis&&(n=this._invertYAxis?this._pointerY-t:t-this._pointerY,this.translateY+=n*this._pointerSpeedMultiplier),this._isSelfUpdate=!1,this._pointerX=e,this._pointerY=t,this._shouldDispatchTranslate&&this._dispatchTranslate()}},_end:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY;var t=e.velocity;this._hasMomentum&&(t.speed>40||this.translateStrideX||this.translateStrideY)?("vertical"!==this._axis?this.momentumX=t.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):this.momentumX=0,"horizontal"!==this._axis?this.momentumY=t.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):this.momentumY=0,this.endX=this.startX-this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY-this.momentumY*this.__momentumDuration/2e3,this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateEnd()),this._releaseInterest()}},_cancel:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY,this.animateMomentum=!1,this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateCancel()),this._releaseInterest()}},_releaseInterest:{value:function(){window.PointerEvent?(this._element.removeEventListener("pointerdown",this,!1),document.removeEventListener("pointermove",this,!0),document.removeEventListener("pointerup",this,!1),document.removeEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(this._element.removeEventListener("MSPointerDown",this,!1),document.removeEventListener("MSPointerMove",this,!0),document.removeEventListener("MSPointerUp",this,!1),document.removeEventListener("MSPointerCancel",this,!1)):this._observedPointer===this._MOUSE_POINTER?(this._element.removeEventListener("mousedown",this,!1),document.removeEventListener("mousemove",this,!0),document.removeEventListener("mouseup",this,!1)):(this._element.removeEventListener("touchstart",this,!1),this._element.removeEventListener("touchmove",this,!0),this._element.removeEventListener("touchend",this,!1),this._element.removeEventListener("touchcancel",this,!1)),document.removeEventListener("scroll",this,!0),this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._isFirstMove=!1,this.isMoving=!1}},_isAxisMovement:{value:function(e){var t,n,r,i,o,a,s,l=e.velocity,u=.7853981633974483,c=2.356194490192345,h=-2.356194490192345,p=-.7853981633974483;if("both"===this.axis)return!0;if(!l||0===l.speed||isNaN(l.speed)?(a=this.pointerStartEventPosition.pageX-e.clientX,s=this.pointerStartEventPosition.pageY-e.clientY,o=Math.atan2(s,a)):o=l.angle,"horizontal"===this.axis){if(r=o<=u&&o>=p,i=o>=c||o<=h,r||i)return!0}else if("vertical"===this.axis&&(t=o<=p&&o>=h,n=o>=u&&o<=c,t||n))return!0;return!1}},_translateEndTimeout:{value:null},_handleWheelTimeout:{value:null},_isNegativeNumber:{value:function(e){return e=+e,isNaN(e)||(e=1/e),e<0}},captureWheel:{value:function(e){this._shouldMove(e)?this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)||this.eventManager.claimPointer(this._WHEEL_POINTER,this):this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)&&this.eventManager.forfeitPointer(this._WHEEL_POINTER,this)}},handleWheel:{value:function(e){if(this.enabled&&this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)){if(this._observedPointer=this._WHEEL_POINTER,this._translateEndTimeout?clearTimeout(this._translateEndTimeout):this._dispatchTranslateStart(),"vertical"!==this.axis&&(this.translateX=this._translateX-20*(e.wheelDeltaX||-e.deltaX||0)/120),"horizontal"!==this.axis&&(this.translateY=this._translateY-20*(e.wheelDeltaY||-e.deltaY||0)/120),this.isMoving=!0,this._dispatchTranslate(),"function"!=typeof this._handleWheelTimeout){var t=function(){this._translateEndTimeout=null,this._dispatchTranslateEnd(),this.isMoving=!1,this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)&&this.eventManager.forfeitPointer(this._WHEEL_POINTER,this)};this._handleWheelTimeout=t.bind(this)}this._translateEndTimeout=setTimeout(this._handleWheelTimeout,400),e.preventDefault()}}},_bezierTValue:{value:function(e,t,n,r,i){var o,a,s,l,u=1-3*r+3*t,c=3*r-6*t,h=3*t,p=.5;for(a=0;a<10;a++)l=p*p,o=3*u*l+2*c*p+h,s=1-p,p-=(3*(s*s*p*t+s*l*r)+l*p-e)/o;return l=p*p,s=1-p,3*(s*s*p*n+s*l*i)+l*p}},_dispatchTranslateStart:{value:function(e,t){var n=document.createEvent("CustomEvent");n.initCustomEvent("translateStart",!0,!0,null),n.translateX=e,n.translateY=t,n.scroll=0,n.pointer=this._observedPointer,this.dispatchEvent(n)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslateCancel:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateCancel",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},animateBouncingX:{value:!1,enumerable:!1},startTimeBounceX:{value:!1,enumerable:!1},animateBouncingY:{value:!1,enumerable:!1},startTimeBounceY:{value:!1,enumerable:!1},animateMomentum:{value:!1,enumerable:!1},startTime:{value:null,enumerable:!1},startX:{value:null,enumerable:!1},posX:{value:null,enumerable:!1},endX:{value:null,enumerable:!1},startY:{value:null,enumerable:!1},posY:{value:null,enumerable:!1},endY:{value:null,enumerable:!1},translateStrideX:{value:null},translateStrideY:{value:null},translateStrideDuration:{value:330},_animationInterval:{value:function(){var e,t,n,r,i=Date.now(),o=!1;this.animateMomentum&&(e=i-this.startTime,e<this.__momentumDuration?(this.posX=this.startX-(this.momentumX+this.momentumX*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.posY=this.startY-(this.momentumY+this.momentumY*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.translateStrideX&&null===this.startStrideXTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posX-this.endX)<.75*this.translateStrideX)&&(this.startStrideXTime=i),this.translateStrideY&&null===this.startStrideYTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posY-this.endY)<.75*this.translateStrideY)&&(this.startStrideYTime=i)):this.animateMomentum=!1),t=Math.round(this.endX/this.translateStrideX),this.startStrideXTime&&i-this.startStrideXTime>0&&(i-this.startStrideXTime<this.translateStrideDuration?(e=this._bezierTValue((i-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),this.posX=this.posX*(1-e)+t*this.translateStrideX*e,o=!0):this.posX=t*this.translateStrideX),t=Math.round(this.endY/this.translateStrideY),this.startStrideYTime&&i-this.startStrideYTime>0&&(i-this.startStrideYTime<this.translateStrideDuration?(e=this._bezierTValue((i-this.startStrideYTime)/this.translateStrideDuration,.275,0,.275,1),this.posY=this.posY*(1-e)+t*this.translateStrideY*e,o=!0):this.posY=t*this.translateStrideY),n=this.posX,r=this.posY,this._isSelfUpdate=!0,this.translateX=n,this.translateY=r,this._shouldDispatchTranslate&&this._dispatchTranslate(),this._isSelfUpdate=!1,this.isAnimating=this.animateMomentum||o,this.isAnimating?this.needsFrame=!0:this._dispatchTranslateEnd()}}});o.prototype.captureMSPointerDown=o.prototype.capturePointerdown,o.prototype.captureMSPointerMove=o.prototype.capturePointermove,o.prototype.handleMSPointerUp=o.prototype.handlePointerup,o.prototype.handleMSPointerCancel=o.prototype.handlePointercancel,o.prototype.handleMousewheel=o.prototype.handleWheel,o.prototype.handleMSPointerDown=o.prototype._handleStart,o.prototype.handlePointerdown=o.prototype._handleStart,o.prototype.handleMousedown=o.prototype._handleStart,o.prototype.handleTouchstart=o.prototype._handleStart,void 0!==Math.sign&&(o.prototype._isNegativeNumber=function(e){return Math.sign(e)===-1})}}),montageDefine("ad36237","composer/key-composer",{dependencies:["../core/core","./composer"],factory:function(e,t,n){var r=e("../core/core").Montage,i=e("./composer").Composer,o="keyPress",a="longKeyPress",s="keyRelease",l=t.KeyComposer=i.specialize({_shouldDispatchEvent:{value:!1},shouldDispatchLongPress:{value:!1},_longPressTimeout:{value:null},_keyRegistered:{value:!1},_keys:{value:null},keys:{get:function(){return this._keys},set:function(e){this._keyRegistered?(c.defaultKeyManager.unregisterKey(this),this._keys=e,c.defaultKeyManager.registerKey(this)):this._keys=e}},load:{value:function(){this._shouldDispatchEvent&&!this._keyRegistered&&(c.defaultKeyManager.registerKey(this),this._keyRegistered=!0)}},unload:{value:function(){c.defaultKeyManager.unregisterKey(this),this._keyRegistered=!1}},addEventListener:{value:function(e,t,n){var r=this.component;i.prototype.addEventListener.call(this,e,t,n),e!=o&&e!=a&&e!=s||(this._shouldDispatchEvent=!0,e==a&&(this._shouldDispatchLongPress=!0),this._isLoaded?this._keyRegistered||(c.defaultKeyManager.registerKey(this),this._keyRegistered=!0):r&&"function"!=typeof r.addComposer&&(this.element||(this.element=window),this.component.loadComposer(this)))}},deserializedFromTemplate:{value:function(){var e=this.component;null===this.identifier&&(this.identifier=r.getInfoForObject(this).label),e&&("function"==typeof e.addComposer?e.addComposer(this):this._isLoaded||(this.element||(this.element=window),this.component.loadComposer(this)))}}},{createKey:{value:function(e,t,n){var r=this;return this===l&&(r=new l),n||(n=e.identifier?e.identifier+t.toLowerCase().replace(/[ +]/g).toCapitalized():t.toLowerCase().replace(/[ +]/g)),r.keys=t,r.identifier=n,e.addComposer(r),r}},createGlobalKey:{value:function(e,t,n){var r=this;return this===l&&(r=new l),r.keys=t,r.identifier=n,e.addComposerForElement(r,window),r}}}),u=null,c=r.specialize({_defaultKeyManager:{value:null},_loadingDefaultKeyManager:{value:!1},_keysToRegister:{value:[]},registerKey:{value:function(t){var n=this;this._defaultKeyManager?this._defaultKeyManager.registerKey(t):(this._keysToRegister.push(t),this._loadingDefaultKeyManager||(this._loadingDefaultKeyManager=!0,e.async("core/event/key-manager").then(function(e){var t=n._defaultKeyManager=e.defaultKeyManager;n._keysToRegister.forEach(function(e){t.registerKey(e)}),n._keysToRegister.length=0})))}},unregisterKey:{value:function(e){this._defaultKeyManager&&this._defaultKeyManager.unregisterKey(e)}}},{defaultKeyManager:{get:function(){return u||(u=new c),this._defaultKeyManager?this._defaultKeyManager:u}}})}}),montageDefine("ad36237","composer/composer",{dependencies:["../core/target"],factory:function(e,t,n){var r=e("../core/target").Target;t.Composer=r.specialize({_component:{value:null},component:{get:function(){return this._component},set:function(e){this._component=e}},_element:{value:null},element:{get:function(){return this._element},set:function(e){this._element=e}},lazyLoad:{value:!0},_needsFrame:{value:!1},needsFrame:{set:function(e){this._needsFrame!==e&&(this._needsFrame=e,this._component&&e&&this._component.scheduleComposer(this))},get:function(){return this._needsFrame}},frame:{value:Function.noop},_resolveDefaults:{value:function(){this.element||null!=this.element||null==this.component||(this.element=this.component.element)}},_isLoaded:{value:!1},isLoaded:{get:function(){return this._isLoaded}},load:{value:Function.noop},unload:{value:Function.noop},deserializedFromTemplate:{value:function(){this.component&&this.component.addComposer(this)}}},{isCoordinateOutsideRadius:{value:function(e,t,n){return e*e+t*t>n*n}}})}}),montageDefine("ad36237","ui/base/abstract-text-field",{dependencies:["./abstract-control","../../composer/key-composer","../../core/deprecate"],factory:function(e,t,n){var r=e("./abstract-control").AbstractControl,i=e("../../composer/key-composer").KeyComposer,o=e("../../core/deprecate");t.AbstractTextField=r.specialize({constructor:{value:function a(){if(this.constructor===a)throw new Error("AbstractTextField cannot be instantiated.");this.defineBindings({"classList.has('montage--disabled')":{"<-":"!enabled"}})}},hasTemplate:{value:!1},acceptsActiveTarget:{get:function(){return this.callDelegateMethod("shouldBeginEditing",this)!==!1}},delegate:{value:null},enabled:{value:!0},_placeholder:{value:null},placeholderValue:{set:function(e){o.deprecationWarning("placeholderValue","placeholder"),this.placeholder=e},get:function(){return this.placeholder}},placeholder:{set:function(e){this._placeholder=e,this.needsDraw=!0},get:function(){return this._placeholder}},_value:{value:null},value:{set:function(e){e!==this._value&&(this.hasFocus&&!this.callDelegateMethod("shouldAcceptValue",this,e)||(this._value=e,this.needsDraw=!0))},get:function(){return this._value}},errorMessage:{value:null},converter:{value:null},_hasFocus:{value:!1},hasFocus:{set:function(e){this._hasFocus=e},get:function(){return this._hasFocus}},__keyComposer:{value:null},_keyComposer:{get:function(){return this.__keyComposer||(this.__keyComposer=new i,this.__keyComposer.component=this,this.__keyComposer.keys="enter",this.addComposer(this.__keyComposer)),this.__keyComposer}},handleKeyPress:{value:function(e){this.enabled&&e.keyComposer===this._keyComposer&&this.dispatchActionEvent()}},prepareForActivationEvents:{value:function(){this._keyComposer.addEventListener("keyPress",this,!1)}},enterDocument:{value:function(e){e&&(this.element.addEventListener("input",this,!1),this.element.addEventListener("change",this,!1))}},draw:{value:function(){var e,t=this.value,n=this.element.selectionStart,r=this.element.selectionEnd;this.converter&&(t=this.converter.convert(t)),e=typeof t,null===t||"undefined"===e?this.element.value="":"boolean"===e||"object"===e||"number"===e?this.element.value=t.toString():this.element.value=t,this.eventManager.activeTarget===this&&"function"==typeof this.element.setSelectionRange&&this.element.setSelectionRange(n,r),this._placeholder&&this.element.setAttribute("placeholder",this._placeholder),this.element.disabled=!this.enabled}},handleChange:{value:function(){
this._updateValueFromDom()}},handleInput:{value:function(e){this._updateValueFromDom()}},willBecomeActiveTarget:{value:function(e){this.hasFocus=!0,this.callDelegateMethod("didBeginEditing",this)}},surrendersActiveTarget:{value:function(e){return this.callDelegateMethod("shouldEndEditing",this)!==!1&&(this._hasFocus=!1,this.callDelegateMethod("didEndEditing",this),!0)}},_updateValueFromDom:{value:function(){var e,t=e=this.element.value;if(this.converter)try{t=this.converter.revert(e),this.errorMessage=null}catch(n){this.errorMessage=n.message||n}this._value!==t&&(this._value=t,this.dispatchOwnPropertyChange("value",this._value),this.callDelegateMethod("didChange",this)),this.converter&&(this.needsDraw=!0)}}})}}),montageDefine("ad36237","ui/base/abstract-button",{dependencies:["./abstract-control","../../composer/press-composer"],factory:function(e,t,n){var r=e("./abstract-control").AbstractControl,i=e("../../composer/press-composer").PressComposer;t.AbstractButton=r.specialize({constructor:{value:function o(){if(this.constructor===o)throw new Error("AbstractButton cannot be instantiated.");this._pressComposer=new i,this.addComposer(this._pressComposer),this._pressComposer.defineBinding("longPressThreshold ",{"<-":"holdThreshold",source:this}),this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"}),this.defineBinding("classList.has('montage--active')",{"<-":"active"})}},enabled:{value:!0},_preventFocus:{value:!1},preventFocus:{get:function(){return this._preventFocus},set:function(e){this._preventFocus=!!e,this.needsDraw=!0}},acceptsActiveTarget:{value:function(){return!this._preventFocus}},willBecomeActiveTarget:{value:function(e){}},_labelNode:{value:void 0,enumerable:!1},_label:{value:void 0,enumerable:!1},label:{get:function(){return this._label},set:function(e){if("undefined"!=typeof e&&this.converter)try{e=this.converter.convert(e),this.error&&(this.error=null)}catch(t){this.error=t}this._label=""+e,this.needsDraw=!0}},holdThreshold:{value:1e3},_pressComposer:{value:null},_active:{value:!1},active:{get:function(){return this._active},set:function(e){this._active=e,this.needsDraw=!0}},prepareForActivationEvents:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1),this._pressComposer.addEventListener("press",this,!1),this._pressComposer.addEventListener("pressCancel",this,!1)}},addEventListener:{value:function(e,t,n){r.prototype.addEventListener.call(this,e,t,n),"longAction"===e&&this._pressComposer.addEventListener("longPress",this,!1)}},handlePressStart:{value:function(e){this.active=!0,e.touch&&document.addEventListener("touchmove",this,!1),this._preventFocus||this._element.focus()}},handlePress:{value:function(e){this.active=!1,this.dispatchActionEvent(),document.removeEventListener("touchmove",this,!1)}},handleKeyup:{value:function(e){32===e.keyCode&&(this.active=!1,this.dispatchActionEvent())}},handleLongPress:{value:function(e){this._pressComposer.cancelPress();var t=document.createEvent("CustomEvent");t.initCustomEvent("longAction",!0,!0,null),this.dispatchEvent(t)}},handlePressCancel:{value:function(e){this.active=!1,document.removeEventListener("touchmove",this,!1)}},handleTouchmove:{value:function(e){e.preventDefault()}},isInputElement:{value:!1},enterDocument:{value:function(e){e&&(this.isInputElement="INPUT"===this.originalElement.tagName,this.isInputElement?void 0===this._label&&(this.label=this.originalElement.value):(this.originalElement.firstChild||this.originalElement.appendChild(document.createTextNode("")),this._labelNode=this.originalElement.firstChild,void 0===this._label&&(this.label=this._labelNode.data)),this.element.setAttribute("role","button"),this.element.addEventListener("keyup",this,!1))}},_drawLabel:{enumerable:!1,value:function(e){this.isInputElement?this._element.value=e:this._labelNode&&(this._labelNode.data=e)}},draw:{value:function(){this._elementNeedsTabIndex()&&(this._preventFocus?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex","-1")),this.isInputElement&&(this.element.disabled=!this.enabled),this._drawLabel(this.label)}},_elementNeedsTabIndexRegex:{value:/INPUT|TEXTAREA|A|SELECT|BUTTON|LABEL/},_elementNeedsTabIndex:{value:function(){return null===this.element.tagName.match(this._elementNeedsTabIndexRegex)}}})}}),montageDefine("ad36237","composer/press-composer",{dependencies:["../core/core","./composer","../core/event/mutable-event"],factory:function(e,t,n){var r=e("../core/core").Montage,i=e("./composer").Composer,o=e("../core/event/mutable-event").MutableEvent,a=t.PressComposer=i.specialize({load:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!0):(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("mousedown",this,!0))}},unload:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!0):(this._element.removeEventListener("touchstart",this,!0),this._element.removeEventListener("mousedown",this,!0))}},delegate:{value:null},cancelPress:{value:function(){return this._state===a.PRESSED&&(this._cancelPress(),!0)}},_cancelPress:{value:function(e){this._dispatchPressCancel(e),this._endInteraction()}},addEventListener:{value:function(e,t,n){i.prototype.addEventListener.call(this,e,t,n),"longPress"===e&&(this._shouldDispatchLongPress=!0)}},_state:{value:0},state:{get:function(){return this._state}},_shouldDispatchLongPress:{value:!1},_longPressThreshold:{value:1e3},longPressThreshold:{get:function(){return this._longPressThreshold},set:function(e){this._longPressThreshold!==e&&(this._longPressThreshold=e)}},_needDispatchSafePress:{value:!1},_longPressTimeout:{value:null},_observedPointer:{value:null},_initialCenterPositionX:{value:0},_initialCenterPositionY:{value:0},_shouldSaveInitialCenterPosition:{value:!1},_targetElementOnLastTouchMove:{value:null},_endInteraction:{value:function(){this._element&&(this._removeEventListeners(),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.component.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._targetElementOnLastTouchMove=null,this._state=a.UNPRESSED,this._initialCenterPositionX=0,this._initialCenterPositionY=0,this._shouldSaveInitialCenterPosition=!1)}},_changedTouchisObserved:{value:function(e){if(null===this._observedPointer)return!1;for(var t=0,n=e.length;t<n;t++)if(e[t].identifier===this._observedPointer)return t;return!1}},surrenderPointer:{value:function(e,t){var n=this.callDelegateMethod("shouldComposerSurrenderPointerToComponent",this,e,t);return("undefined"==typeof n||n!==!1)&&(this.cancelPress(),!0)}},_shouldPerformPress:{value:function(){return!(this.component.disabled||null!==this._observedPointer)}},capturePointerdown:{value:function(e){"touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?this.captureTouchstart(e):("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&this.captureMousedown(e)}},handlePointerup:{value:function(e){"touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?this.handleTouchend(e):("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&this.handleMouseup(e)}},handlePointercancel:{value:function(e){("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchcancel(e)}},captureTouchstart:{value:function(e){this._shouldPerformPress()&&(void 0!==e.pointerId?this._observedPointer=e.pointerId:e.changedTouches&&1===e.changedTouches.length&&(this._observedPointer=e.changedTouches[0].identifier),null!==this._observedPointer&&this.component.eventManager.claimPointer(this._observedPointer,this)?this._addPointerDownListener():this._observedPointer=null)}},handleTouchend:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);var t;e.pointerId===this._observedPointer?t=e.target:this._changedTouchisObserved(e.changedTouches)!==!1&&(t=this._targetElementOnLastTouchMove||e.target),t&&this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&(this.element===t||this.element.contains(t)?this._dispatchPress(e,"undefined"==typeof e.pointerId?t:null):this._dispatchPressCancel(e),this._endInteraction(e))}},_saveInitialCenterPositionIfNeeded:{value:function(){this._shouldSaveInitialCenterPosition&&(this._saveInitialCenterPosition(),this._shouldSaveInitialCenterPosition=!1)}},_cancelPressIfCenterPositionChange:{value:function(e){return this._saveInitialCenterPositionIfNeeded(),!!this._isPositionChanged(e)&&(this._cancelPress(e),!0)}},_handleMove:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);if(this._needDispatchSafePress=!1,("mouse"===this._observedPointer||e.pointerId===this._observedPointer||e.changedTouches&&this._changedTouchisObserved(e.changedTouches)!==!1)&&this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&!this._cancelPressIfCenterPositionChange(e)&&"touchmove"===e.type){var t=e.changedTouches[0];this._targetElementOnLastTouchMove=document.elementFromPoint(t.clientX,t.clientY)}}},captureWheel:{value:function(e){return null===this._observedPointer?void this._endInteraction(e):void((e.target===this.element||e.target===window||"function"==typeof e.target.contains&&e.target.contains(this.element)||this.element.contains(e.target))&&this._cancelPressIfCenterPositionChange(e))}},handleTouchcancel:{value:function(e){null!==this._observedPointer&&e.pointerId!==this._observedPointer&&this._changedTouchisObserved(e.changedTouches)===!1||(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this._dispatchPressCancel(e),this._endInteraction(e))}},captureMousedown:{value:function(e){0===e.button&&this._shouldPerformPress()&&(this._observedPointer="mouse",this.component.eventManager.claimPointer(this._observedPointer,this),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?this._addPointerDownListener():this._observedPointer=null)}},_handlePointerDown:{value:function(e){if(this._removePointerDownListener(),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){if(this._needDispatchSafePress=!1,"touchstart"===e.type){var t=this;window.nativeAddEventListener("touchstart",function n(e){window.nativeRemoveEventListener("touchstart",n,!1),t._needDispatchSafePress=!e.defaultPrevented},!1)}this._shouldSaveInitialCenterPosition=!0,this._addEventListeners(),this._dispatchPressStart(e)}else this._observedPointer=null}},captureScroll:{value:function(e){(e.target===this.element||e.target===window||"function"==typeof e.target.contains&&e.target.contains(this.element)||this.element.contains(e.target))&&this._cancelPressIfCenterPositionChange(e)}},handleMouseup:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);if(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){for(var t=e.target;t!==this._element&&t&&t.parentNode;)t=t.parentNode;if(t===this._element)return this._dispatchPress(e),void this._endInteraction(e)}this._cancelPress(e)}},handleDragstart:{value:function(e){this._cancelPress(e)}},_saveInitialCenterPosition:{value:function(){if(this.element instanceof HTMLElement){var e=this.element.getBoundingClientRect();this._initialCenterPositionX=e.left+e.width/2,this._initialCenterPositionY=e.top+e.height/2}}},_isPositionChanged:{value:function(e){if(this.element instanceof HTMLElement){var t=this.element.getBoundingClientRect(),n=t.left+t.width/2,r=t.top+t.height/2;if(this._initialCenterPositionX!==n||this._initialCenterPositionY!==r){var o=e.type,a=Math.abs(this._initialCenterPositionX-n),s=Math.abs(this._initialCenterPositionY-r),l="mouse"===this._observedPointer||"wheel"===o||"mousewheel"===o||"scroll"===o?this._mouseRadiusThreshold:this._touchRadiusThreshold;return i.isCoordinateOutsideRadius(a,s,l)}}return!1}},_mouseRadiusThreshold:{value:2},_touchRadiusThreshold:{value:4},_addPointerDownListener:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!1):"mouse"===this._observedPointer?this._element.addEventListener("mousedown",this,!1):this._element.addEventListener("touchstart",this,!1)}},_removePointerDownListener:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!1):"mouse"===this._observedPointer?this._element.removeEventListener("mousedown",this,!1):this._element.removeEventListener("touchstart",this,!1)}},_addEventListeners:{value:function(){window.PointerEvent?(document.addEventListener("pointerup",this,!1),document.addEventListener("pointermove",this,!1),document.addEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(document.addEventListener("MSPointerUp",this,!1),document.addEventListener("MSPointerMove",this,!1),document.addEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(document.addEventListener("mouseup",this,!1),document.addEventListener("mousemove",this,!1),this._element.addEventListener("dragstart",this,!1)):(document.addEventListener("touchend",this,!1),document.addEventListener("touchcancel",this,!1),document.addEventListener("touchmove",this,!1));var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";document.addEventListener(e,this,!0),document.addEventListener("scroll",this,!0)}},_removeEventListeners:{value:function(){window.PointerEvent?(document.removeEventListener("pointerup",this,!1),document.removeEventListener("pointermove",this,!1),document.removeEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(document.removeEventListener("MSPointerUp",this,!1),document.removeEventListener("MSPointerMove",this,!1),document.removeEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(document.removeEventListener("mouseup",this,!1),document.removeEventListener("mousemove",this,!1),this._element.removeEventListener("dragstart",this,!1)):(document.removeEventListener("touchend",this,!1),document.removeEventListener("touchcancel",this,!1),document.removeEventListener("touchmove",this,!1));var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";document.removeEventListener(e,this,!0),document.removeEventListener("scroll",this,!0)}},_createPressEvent:{enumerable:!1,value:function(e,t){var n,r,i=t;return t||(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!0,!0,null)),n=new s,n.event=t,n.type=e,n.pointer=this._observedPointer,n.targetElement=t.target,t.changedTouches&&(r=this._changedTouchisObserved(t.changedTouches))!==!1&&(i=n.touch=t.changedTouches[r]),i&&(n.clientX=i.clientX,n.clientY=i.clientY,n.pageX=i.pageX,n.pageY=i.pageY),n}},_dispatchPressStart:{enumerable:!1,value:function(e){if(this._state=a.PRESSED,this.dispatchEvent(this._createPressEvent("pressStart",e)),this._shouldDispatchLongPress){var t=this;this._longPressTimeout=setTimeout(function(){t._dispatchLongPress()},this._longPressThreshold)}}},_dispatchPress:{enumerable:!1,value:function(e,t){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null);var n=this._createPressEvent("press",e);if(t&&(n.targetElement=t,this._needDispatchSafePress||e.defaultPrevented)){var r=this,i=document.defaultView.defaultEventManager,o=function(a){(t===a.target||i._couldEmulatedEventHaveWrongTarget(e.changedTouches[0],a,i._emulatedEventRadiusThreshold,i._emulatedEventTimestampThreshold))&&r._dispatchSafePress(n,o)};return window.nativeAddEventListener("mousedown",o,!0),void(o.timeoutID=setTimeout(function(){r._dispatchSafePress(n,o)},300))}this.dispatchEvent(n),this._state=a.UNPRESSED}},_dispatchSafePress:{value:function(e,t){clearTimeout(t.timeoutID),t.timeoutID=null,window.nativeRemoveEventListener("mousedown",t,!0),this.dispatchEvent(e),this._state=a.UNPRESSED}},_dispatchLongPress:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(this.dispatchEvent(this._createPressEvent("longPress",e)),this._longPressTimeout=null)}},_dispatchPressCancel:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this._state=a.CANCELLED,this.dispatchEvent(this._createPressEvent("pressCancel",e))}}},{UNPRESSED:{value:0},PRESSED:{value:1},CANCELLED:{value:2}});a.prototype.captureMSPointerDown=a.prototype.capturePointerdown,a.prototype.handleMSPointerUp=a.prototype.handlePointerup,a.prototype.handleMSPointerCancel=a.prototype.handlePointercancel,a.prototype.handleMSPointerMove=a.prototype._handleMove,a.prototype.handlePointermove=a.prototype._handleMove,a.prototype.handleTouchmove=a.prototype._handleMove,a.prototype.handleMousemove=a.prototype._handleMove,a.prototype.handleMousewheel=a.prototype.handleWheel,a.prototype.handleMSPointerDown=a.prototype._handlePointerDown,a.prototype.handlePointerdown=a.prototype._handlePointerDown,a.prototype.handleMousedown=a.prototype._handlePointerDown,a.prototype.handleTouchstart=a.prototype._handlePointerDown;var s=function(){var e,t,n,i,a,s;for(e=o.specialize({type:{value:"press"},_event:{enumerable:!1,value:null},event:{get:function(){return this._event},set:function(e){this._event=e}},_touch:{enumerable:!1,value:null},touch:{get:function(){return this._touch},set:function(e){this._touch=e}}}),t=["altKey","ctrlKey","metaKey","shiftKey","cancelBubble","currentTarget","defaultPrevented","eventPhase","timeStamp","preventDefault","stopImmediatePropagation","stopPropagation"],n=["clientX","clientY","pageX","pageY","screenX","screenY","target"],i=function(e){return{get:function(){return this._event[e]}}},a=function(e){return{get:function(){return this._touch?this._touch[e]:this._event[e]}}},s=t.length-1;s>=0;s--)r.defineProperty(e,t[s],i(t[s]));for(s=n.length-1;s>=0;s--)r.defineProperty(e,n[s],a(n[s]));return e}()}}),montageDefine("489b8c2","js/release/bluebird",{dependencies:["./promise"],factory:function(e,t,n){"use strict";function r(){try{Promise===o&&(Promise=i)}catch(e){}return o}var i;"undefined"!=typeof Promise&&(i=Promise);var o=e("./promise")();o.noConflict=r,n.exports=o}}),montageDefine("489b8c2","js/release/promise",{dependencies:["./util","./es5","./async","./errors","./thenables","./promise_array","./context","./debuggability","./finally","./catch_filter","./nodeback","./method","./bind","./cancel","./direct_resolve","./synchronous_inspection","./join","./map.js","./call_get.js","./using.js","./timers.js","./generators.js","./nodeify.js","./promisify.js","./props.js","./race.js","./reduce.js","./settle.js","./some.js","./filter.js","./each.js","./any.js"],factory:function(e,t,n){"use strict";n.exports=function(){function t(){}function r(e,t){if("function"!=typeof t)throw new _("expecting a function but got "+d.classString(t));if(e.constructor!==i)throw new _("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}function i(e){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,e!==y&&(r(this,e),this._resolveFromExecutor(e)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(e){this.promise._resolveCallback(e)}function a(e){this.promise._rejectCallback(e,!1)}function s(e){var t=new i(y);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}var l,u=function(){return new _("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},c=function(){return new i.PromiseInspection(this._target())},h=function(e){return i.reject(new _(e))},p={},d=e("./util");l=d.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},d.notEnumerableProp(i,"_getDomain",l);var f=e("./es5"),v=e("./async"),m=new v;f.defineProperty(i,"_async",{value:m});var g=e("./errors"),_=i.TypeError=g.TypeError;i.RangeError=g.RangeError;var b=i.CancellationError=g.CancellationError;i.TimeoutError=g.TimeoutError,i.OperationalError=g.OperationalError,i.RejectionError=g.OperationalError,i.AggregateError=g.AggregateError;var y=function(){},w={},E={},C=e("./thenables")(i,y),O=e("./promise_array")(i,y,C,h,t),j=e("./context")(i),P=j.create,T=e("./debuggability")(i,j),k=(T.CapturedTrace,e("./finally")(i,C)),x=e("./catch_filter")(E),A=e("./nodeback"),D=d.errorObj,S=d.tryCatch;return i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype["catch"]=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),i=0;for(n=0;n<t-1;++n){var o=arguments[n];if(!d.isObject(o))return h("expecting an object but got A catch statement predicate "+d.classString(o));r[i++]=o}return r.length=i,e=arguments[n],this.then(void 0,x(r,e,this))}return this.then(void 0,e)},i.prototype.reflect=function(){return this._then(c,c,void 0,this,void 0)},i.prototype.then=function(e,t){if(T.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+d.classString(e);arguments.length>1&&(n+=", "+d.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},i.prototype.done=function(e,t){var n=this._then(e,t,void 0,void 0,void 0);n._setIsFinal()},i.prototype.spread=function(e){return"function"!=typeof e?h("expecting a function but got "+d.classString(e)):this.all()._then(e,void 0,void 0,w,void 0)},i.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},i.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new O(this).promise()},i.prototype.error=function(e){return this.caught(d.originatesFromRejection,e)},i.getNewLibraryCopy=n.exports,i.is=function(e){return e instanceof i},i.fromNode=i.fromCallback=function(e){var t=new i(y);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=S(e)(A(t,n));return r===D&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},i.all=function(e){return new O(e).promise()},i.cast=function(e){var t=C(e);return t instanceof i||(t=new i(y),t._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},i.resolve=i.fulfilled=i.cast,i.reject=i.rejected=function(e){var t=new i(y);return t._captureStackTrace(),t._rejectCallback(e,!0),t},i.setScheduler=function(e){if("function"!=typeof e)throw new _("expecting a function but got "+d.classString(e));return m.setScheduler(e)},i.prototype._then=function(e,t,n,r,o){var a=void 0!==o,s=a?o:new i(y),u=this._target(),c=u._bitField;a||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===r&&0!==(2097152&this._bitField)&&(r=0!==(50397184&c)?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var h=l();if(0!==(50397184&c)){var p,f,v=u._settlePromiseCtx;0!==(33554432&c)?(f=u._rejectionHandler0,p=e):0!==(16777216&c)?(f=u._fulfillmentHandler0,p=t,u._unsetRejectionIsUnhandled()):(v=u._settlePromiseLateCancellationObserver,f=new b("late cancellation observer"),u._attachExtraTrace(f),p=t),m.invoke(v,u,{handler:null===h?p:"function"==typeof p&&d.domainBind(h,p),promise:s,receiver:r,value:f})}else u._addCallbacks(e,t,s,r,h);return s},i.prototype._length=function(){return 65535&this._bitField},i.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},i.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},i.prototype._setLength=function(e){this._bitField=this._bitField&-65536|65535&e},i.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},i.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},i.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},i.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},i.prototype._isFinal=function(){return(4194304&this._bitField)>0},i.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},i.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},i.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},i.prototype._setAsyncGuaranteed=function(){m.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},i.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==p)return void 0===t&&this._isBound()?this._boundValue():t},i.prototype._promiseAt=function(e){return this[4*e-4+2]},i.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},i.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},i.prototype._boundValue=function(){},i.prototype._migrateCallback0=function(e){var t=(e._bitField,e._fulfillmentHandler0),n=e._rejectionHandler0,r=e._promise0,i=e._receiverAt(0);void 0===i&&(i=p),this._addCallbacks(t,n,r,i,null)},i.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),i=e._promiseAt(t),o=e._receiverAt(t);void 0===o&&(o=p),this._addCallbacks(n,r,i,o,null)},i.prototype._addCallbacks=function(e,t,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=null===i?e:d.domainBind(i,e)),"function"==typeof t&&(this._rejectionHandler0=null===i?t:d.domainBind(i,t));else{var a=4*o-4;this[a+2]=n,this[a+3]=r,"function"==typeof e&&(this[a+0]=null===i?e:d.domainBind(i,e)),"function"==typeof t&&(this[a+1]=null===i?t:d.domainBind(i,t))}return this._setLength(o+1),o},i.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},i.prototype._resolveCallback=function(e,t){if(0===(117506048&this._bitField)){if(e===this)return this._rejectCallback(u(),!1);var n=C(e,this);if(!(n instanceof i))return this._fulfill(e);t&&this._propagateFrom(n,2);var r=n._target();if(r===this)return void this._reject(u());var o=r._bitField;if(0===(50397184&o)){var a=this._length();a>0&&r._migrateCallback0(this);for(var s=1;s<a;++s)r._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!==(33554432&o))this._fulfill(r._value());else if(0!==(16777216&o))this._reject(r._reason());else{var l=new b("late cancellation observer");r._attachExtraTrace(l),this._reject(l)}}},i.prototype._rejectCallback=function(e,t,n){var r=d.ensureErrorObject(e),i=r===e;if(!i&&!n&&T.warnings()){var o="a promise was rejected with a non-error: "+d.classString(e);this._warn(o,!0)}this._attachExtraTrace(r,!!t&&i),this._reject(e)},i.prototype._resolveFromExecutor=function(e){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,n)});n=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)},i.prototype._settlePromiseFromHandler=function(e,t,n,r){var i=r._bitField;if(0===(65536&i)){r._pushContext();var o;t===w?n&&"number"==typeof n.length?o=S(e).apply(this._boundValue(),n):(o=D,o.e=new _("cannot .spread() a non-array: "+d.classString(n))):o=S(e).call(t,n);var a=r._popContext();i=r._bitField,0===(65536&i)&&(o===E?r._reject(n):o===D?r._rejectCallback(o.e,!1):(T.checkForgottenReturns(o,a,"",r,this),r._resolveCallback(o)))}},i.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},i.prototype._followee=function(){return this._rejectionHandler0},i.prototype._setFollowee=function(e){this._rejectionHandler0=e},i.prototype._settlePromise=function(e,n,r,o){var a=e instanceof i,s=this._bitField,l=0!==(134217728&s);0!==(65536&s)?(a&&e._invokeInternalOnCancel(),r instanceof k&&r.isFinallyHandler()?(r.cancelPromise=e,S(n).call(r,o)===D&&e._reject(D.e)):n===c?e._fulfill(c.call(r)):r instanceof t?r._promiseCancelled(e):a||e instanceof O?e._cancel():r.cancel()):"function"==typeof n?a?(l&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(n,r,o,e)):n.call(r,o,e):r instanceof t?r._isResolved()||(0!==(33554432&s)?r._promiseFulfilled(o,e):r._promiseRejected(o,e)):a&&(l&&e._setAsyncGuaranteed(),0!==(33554432&s)?e._fulfill(o):e._reject(o))},i.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,r=e.receiver,o=e.value;"function"==typeof t?n instanceof i?this._settlePromiseFromHandler(t,r,o,n):t.call(r,o,n):n instanceof i&&n._reject(o)},i.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},i.prototype._settlePromise0=function(e,t,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,i,t)},i.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},i.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var n=u();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!==(134217728&t)?this._settlePromises():m.settlePromises(this))}},i.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16))return this._setRejected(),this._fulfillmentHandler0=e,this._isFinal()?m.fatalError(e,d.isNode):void((65535&t)>0?m.settlePromises(this):this._ensurePossibleRejectionHandled())},i.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,t)}},i.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,t)}},i.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!==(16842752&e)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},i.prototype._settledValue=function(){var e=this._bitField;return 0!==(33554432&e)?this._rejectionHandler0:0!==(16777216&e)?this._fulfillmentHandler0:void 0},i.defer=i.pending=function(){T.deprecated("Promise.defer","new Promise");var e=new i(y);return{promise:e,resolve:o,reject:a}},d.notEnumerableProp(i,"_makeSelfResolutionError",u),e("./method")(i,y,C,h,T),e("./bind")(i,y,C,T),e("./cancel")(i,O,h,T),e("./direct_resolve")(i),e("./synchronous_inspection")(i),e("./join")(i,O,C,y,m,l),i.Promise=i,i.version="3.4.7",e("./map.js")(i,O,h,C,y,T),e("./call_get.js")(i),e("./using.js")(i,h,C,P,y,T),e("./timers.js")(i,y,T),e("./generators.js")(i,h,y,C,t,T),e("./nodeify.js")(i),e("./promisify.js")(i,y),e("./props.js")(i,O,C,h),e("./race.js")(i,y,C,h),e("./reduce.js")(i,O,h,C,y,T),e("./settle.js")(i,O,T),e("./some.js")(i,O,h),e("./filter.js")(i,y),e("./each.js")(i,y),e("./any.js")(i),d.toFastProperties(i),d.toFastProperties(i.prototype),s({a:1}),s({b:2}),s({c:3}),s(1),s(function(){}),s(void 0),s(!1),
s(new i(y)),T.setBounds(v.firstLineError,d.lastLineError),i}}}),montageDefine("489b8c2","js/release/util",{dependencies:["./es5"],factory:function(e,t,n){"use strict";function r(){try{var e=P;return P=null,e.apply(this,arguments)}catch(t){return x.e=t,x}}function i(e){return P=e,r}function o(e){return null==e||e===!0||e===!1||"string"==typeof e||"number"==typeof e}function a(e){return"function"==typeof e||"object"==typeof e&&null!==e}function s(e){return o(e)?new Error(m(e)):e}function l(e,t){var n,r=e.length,i=new Array(r+1);for(n=0;n<r;++n)i[n]=e[n];return i[n]=t,i}function u(e,t,n){if(!T.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function c(e,t,n){if(o(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return T.defineProperty(e,t,r),e}function h(e){throw e}function p(e){try{if("function"==typeof e){var t=T.names(e.prototype),n=T.isES5&&t.length>1,r=t.length>0&&!(1===t.length&&"constructor"===t[0]),i=L.test(e+"")&&T.names(e).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}}function d(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e}function f(e){return M.test(e)}function v(e,t,n){for(var r=new Array(e),i=0;i<e;++i)r[i]=t+i+n;return r}function m(e){try{return e+""}catch(t){return"[no string representation]"}}function g(e){return null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function _(e){try{c(e,"isOperational",!0)}catch(t){}}function b(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||e.isOperational===!0)}function y(e){return g(e)&&T.propertyIsWritable(e,"stack")}function w(e){return{}.toString.call(e)}function E(e,t,n){for(var r=T.names(e),i=0;i<r.length;++i){var o=r[i];if(n(o))try{T.defineProperty(t,o,T.getDescriptor(e,o))}catch(a){}}}function C(e){return N?process.env[e]:void 0}function O(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"==={}.toString.call(e))return Promise}catch(t){}}function j(e,t){return e.bind(t)}var P,T=e("./es5"),k="undefined"==typeof navigator,x={e:{}},A="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,D=function(e,t){function n(){this.constructor=e,this.constructor$=t;for(var n in t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}var r={}.hasOwnProperty;return n.prototype=t.prototype,e.prototype=new n,e.prototype},S=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(T.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var r=[],i=Object.create(null);null!=e&&!t(e);){var o;try{o=n(e)}catch(a){return r}for(var s=0;s<o.length;++s){var l=o[s];if(!i[l]){i[l]=!0;var u=Object.getOwnPropertyDescriptor(e,l);null!=u&&null==u.get&&null==u.set&&r.push(l)}}e=T.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var i=[];e:for(var o in n)if(r.call(n,o))i.push(o);else{for(var a=0;a<e.length;++a)if(r.call(e[a],o))continue e;i.push(o)}return i}}(),L=/this\s*\.\s*\S+\s*=/,M=/^[a-z$_][a-z$_0-9]*$/i,R=function(){return"stack"in new Error?function(e){return y(e)?e:new Error(m(e))}:function(e){if(y(e))return e;try{throw new Error(m(e))}catch(t){return t}}}(),F=function(e){return T.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var z="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],r=e[Symbol.iterator]();!(t=r.next()).done;)n.push(t.value);return n};F=function(e){return T.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?z(e):null}}var I="undefined"!=typeof process&&"[object process]"===w(process).toLowerCase(),N="undefined"!=typeof process&&"undefined"!=typeof process.env,B={isClass:p,isIdentifier:f,inheritedDataKeys:S,getDataPropertyOrDefault:u,thrower:h,isArray:T.isArray,asArray:F,notEnumerableProp:c,isPrimitive:o,isObject:a,isError:g,canEvaluate:k,errorObj:x,tryCatch:i,inherits:D,withAppended:l,maybeWrapAsError:s,toFastProperties:d,filledRange:v,toString:m,canAttachTrace:y,ensureErrorObject:R,originatesFromRejection:b,markAsOriginatingFromRejection:_,classString:w,copyDescriptors:E,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:I,hasEnvVariables:N,env:C,global:A,getNativePromise:O,domainBind:j};B.isRecentNode=B.isNode&&function(){var e=process.versions.node.split(".").map(Number);return 0===e[0]&&e[1]>10||e[0]>0}(),B.isNode&&B.toFastProperties(process);try{throw new Error}catch(U){B.lastLineError=U}n.exports=B}}),montageDefine("489b8c2","js/release/es5",{dependencies:[],factory:function(e,t,n){var r=function(){"use strict";return void 0===this}();if(r)n.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},l=function(e,t){return{value:e[t]}},u=function(e,t,n){return e[t]=n.value,e},c=function(e){return e},h=function(e){try{return Object(e).constructor.prototype}catch(t){return a}},p=function(e){try{return"[object Array]"===o.call(e)}catch(t){return!1}};n.exports={isArray:p,keys:s,names:s,defineProperty:u,getDescriptor:l,freeze:c,getPrototypeOf:h,isES5:r,propertyIsWritable:function(){return!0}}}}}),montageDefine("489b8c2","js/release/async",{dependencies:["./schedule","./queue","./util"],factory:function(e,t,n){"use strict";function r(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new c(16),this._normalQueue=new c(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=u}function i(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function o(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function a(e){this._normalQueue._pushOne(e),this._queueTick()}var s;try{throw new Error}catch(l){s=l}var u=e("./schedule"),c=e("./queue"),h=e("./util");r.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},r.prototype.hasCustomScheduler=function(){return this._customScheduler},r.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},r.prototype.disableTrampolineIfNecessary=function(){h.hasDevTools&&(this._trampolineEnabled=!1)},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},r.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},h.hasDevTools?(r.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?i.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},r.prototype.invoke=function(e,t,n){this._trampolineEnabled?o.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},r.prototype.settlePromises=function(e){this._trampolineEnabled?a.call(this,e):this._schedule(function(){e._settlePromises()})}):(r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=a),r.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),r=e.shift();t.call(n,r)}else t._settlePromises()}},r.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},n.exports=r,n.exports.firstLineError=s}}),montageDefine("489b8c2","js/release/errors",{dependencies:["./es5","./util"],factory:function(e,t,n){"use strict";function r(e,t){function n(r){return this instanceof n?(h(this,"message","string"==typeof r?r:t),h(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return c(n,Error),n}function i(e){return this instanceof i?(h(this,"name","OperationalError"),h(this,"message",e),this.cause=e,this.isOperational=!0,void(e instanceof Error?(h(this,"message",e.message),h(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(e)}var o,a,s=e("./es5"),l=s.freeze,u=e("./util"),c=u.inherits,h=u.notEnumerableProp,p=r("Warning","warning"),d=r("CancellationError","cancellation error"),f=r("TimeoutError","timeout error"),v=r("AggregateError","aggregate error");try{o=TypeError,a=RangeError}catch(m){o=r("TypeError","type error"),a=r("RangeError","range error")}for(var g="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),_=0;_<g.length;++_)"function"==typeof Array.prototype[g[_]]&&(v.prototype[g[_]]=Array.prototype[g[_]]);s.defineProperty(v.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),v.prototype.isOperational=!0;var b=0;v.prototype.toString=function(){var e=Array(4*b+1).join(" "),t="\n"+e+"AggregateError of:\n";b++,e=Array(4*b+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=e+i[o];r=i.join("\n"),t+=r+"\n"}return b--,t},c(i,Error);var y=Error.__BluebirdErrorTypes__;y||(y=l({CancellationError:d,TimeoutError:f,OperationalError:i,RejectionError:i,AggregateError:v}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:y,writable:!1,enumerable:!1,configurable:!1})),n.exports={Error:Error,TypeError:o,RangeError:a,CancellationError:y.CancellationError,OperationalError:y.OperationalError,TimeoutError:y.TimeoutError,AggregateError:y.AggregateError,Warning:p}}}),montageDefine("489b8c2","js/release/thenables",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n){function r(e,r){if(c(e)){if(e instanceof t)return e;var i=o(e);if(i===u){r&&r._pushContext();var l=t.reject(i.e);return r&&r._popContext(),l}if("function"==typeof i){if(a(e)){var l=new t(n);return e._then(l._fulfill,l._reject,void 0,l,null),l}return s(e,i,r)}}return e}function i(e){return e.then}function o(e){try{return i(e)}catch(t){return u.e=t,u}}function a(e){try{return h.call(e,"_promise0")}catch(t){return!1}}function s(e,r,i){function o(e){s&&(s._resolveCallback(e),s=null)}function a(e){s&&(s._rejectCallback(e,h,!0),s=null)}var s=new t(n),c=s;i&&i._pushContext(),s._captureStackTrace(),i&&i._popContext();var h=!0,p=l.tryCatch(r).call(e,o,a);return h=!1,s&&p===u&&(s._rejectCallback(p.e,!0,!0),s=null),c}var l=e("./util"),u=l.errorObj,c=l.isObject,h={}.hasOwnProperty;return r}}}),montageDefine("489b8c2","js/release/promise_array",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i,o){function a(e){switch(e){case-2:return[];case-3:return{}}}function s(e){var r=this._promise=new t(n);e instanceof t&&r._propagateFrom(e,3),r._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var l=e("./util");return l.isArray,l.inherits(s,o),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function u(e,n){var o=r(this._values,this._promise);if(o instanceof t){o=o._target();var s=o._bitField;if(this._values=o,0===(50397184&s))return this._promise._setAsyncGuaranteed(),o._then(u,this._reject,void 0,this,n);if(0===(33554432&s))return 0!==(16777216&s)?this._reject(o._reason()):this._cancel();o=o._value()}if(o=l.asArray(o),null===o){var c=i("expecting an array or an iterable object but got "+l.classString(o)).reason();return void this._promise._rejectCallback(c,!1)}return 0===o.length?void(n===-5?this._resolveEmptyArray():this._resolve(a(n))):void this._iterate(o)},s.prototype._iterate=function(e){var n=this.getActualLength(e.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,a=null,s=0;s<n;++s){var l=r(e[s],i);l instanceof t?(l=l._target(),a=l._bitField):a=null,o?null!==a&&l.suppressUnhandledRejections():null!==a?0===(50397184&a)?(l._proxy(this,s),this._values[s]=l):o=0!==(33554432&a)?this._promiseFulfilled(l._value(),s):0!==(16777216&a)?this._promiseRejected(l._reason(),s):this._promiseCancelled(s):o=this._promiseFulfilled(l,s)}o||i._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var n=0;n<e.length;++n)e[n]instanceof t&&e[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}}}),montageDefine("489b8c2","js/release/context",{dependencies:[],factory:function(e,t,n){"use strict";n.exports=function(e){function t(){this._trace=new t.CapturedTrace(r())}function n(){if(i)return new t}function r(){var e=o.length-1;if(e>=0)return o[e]}var i=!1,o=[];return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var e=o.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=n,t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var n=e.prototype._pushContext,o=e.prototype._popContext,a=e._peekContext,s=e.prototype._peekContext,l=e.prototype._promiseCreated;t.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=o,e._peekContext=a,e.prototype._peekContext=s,e.prototype._promiseCreated=l,i=!1},i=!0,e.prototype._pushContext=t.prototype._pushContext,e.prototype._popContext=t.prototype._popContext,e._peekContext=e.prototype._peekContext=r,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},t}}}),montageDefine("489b8c2","js/release/debuggability",{dependencies:["./errors","./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n){function r(e,t){return{promise:t}}function i(){return!1}function o(e,t,n){var r=this;try{e(t,n,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+I.toString(e));r._attachCancellationCallback(e)})}catch(i){return i}}function a(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?I.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function s(){return this._onCancelField}function l(e){this._onCancelField=e}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function c(e,t){if(0!==(1&t)){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function h(e,t){0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function p(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e}function d(){this._trace=new D(this._peekContext())}function f(e,t){if(N(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=C(e);I.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),I.notEnumerableProp(e,"__stackCleaned__",!0)}}}function v(e,t,n,r,i){if(void 0===e&&null!==t&&$){if(void 0!==i&&i._returnedNonUndefined())return;if(0===(65535&r._bitField))return;n&&(n+=" ");var o="",a="";if(t._trace){for(var s=t._trace.stack.split("\n"),l=w(s),u=l.length-1;u>=0;--u){var c=l[u];if(!U.test(c)){var h=c.match(q);h&&(o="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(l.length>0)for(var p=l[0],u=0;u<s.length;++u)if(s[u]===p){u>0&&(a="\n"+s[u-1]);break}}var d="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+a;r._warn(d,!0,t)}}function m(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),g(n)}function g(e,n,r){if(oe.warnings){var i,o=new z(e);if(n)r._attachExtraTrace(o);else if(oe.longStackTraces&&(i=t._peekContext()))i.attachExtraTrace(o);else{var a=C(o);o.stack=a.message+"\n"+a.stack.join("\n")}ee("warning",o)||O(o,"",!0)}}function _(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function b(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function y(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],i=t.length-1,o=t[i],a=-1,s=r.length-1;s>=0;--s)if(r[s]===o){a=s;break}for(var s=a;s>=0;--s){var l=r[s];if(t[i]!==l)break;t.pop(),i--}t=r}}function w(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],i="    (No stack trace)"===r||V.test(r),o=i&&ne(r);i&&!o&&(H&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function E(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||V.test(r))break}return n>0&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}function C(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?E(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:w(t)}}function O(e,t,n){if("undefined"!=typeof console){var r;if(I.isObject(e)){var i=e.stack;r=t+W(i,e)}else r=t+String(e);"function"==typeof M?M(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function j(e,t,n,r){var i=!1;try{"function"==typeof t&&(i=!0,"rejectionHandled"===e?t(r):t(n,r))}catch(o){F.throwLater(o)}"unhandledRejection"===e?ee(e,n,r)||i||O(n,"Unhandled rejection "):ee(e,r)}function P(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():I.toString(e);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(t))try{var r=JSON.stringify(e);t=r}catch(i){}0===t.length&&(t="(empty array)")}return"(<"+T(t)+">, no stack trace)"}function T(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function k(){return"function"==typeof ie}function x(e){var t=e.match(re);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function A(e,t){if(k()){for(var n,r,i=e.stack.split("\n"),o=t.stack.split("\n"),a=-1,s=-1,l=0;l<i.length;++l){var u=x(i[l]);if(u){n=u.fileName,a=u.line;break}}for(var l=0;l<o.length;++l){var u=x(o[l]);if(u){r=u.fileName,s=u.line;break}}a<0||s<0||!n||!r||n!==r||a>=s||(ne=function(e){if(B.test(e))return!0;var t=x(e);return!!(t&&t.fileName===n&&a<=t.line&&t.line<=s)})}}function D(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);ie(this,D),t>32&&this.uncycle()}var S,L,M,R=t._getDomain,F=t._async,z=e("./errors").Warning,I=e("./util"),N=I.canAttachTrace,B=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,U=/\((?:timers\.js):\d+:\d+\)/,q=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,V=null,W=null,H=!1,X=!(0==I.env("BLUEBIRD_DEBUG")||!I.env("BLUEBIRD_DEBUG")&&"development"!==I.env("NODE_ENV")),G=!(0==I.env("BLUEBIRD_WARNINGS")||!X&&!I.env("BLUEBIRD_WARNINGS")),Y=!(0==I.env("BLUEBIRD_LONG_STACK_TRACES")||!X&&!I.env("BLUEBIRD_LONG_STACK_TRACES")),$=0!=I.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(G||!!I.env("BLUEBIRD_W_FORGOTTEN_RETURN"));t.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=e._bitField&-1048577|524288},t.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),F.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){j("rejectionHandled",S,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},t.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),j("unhandledRejection",L,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},t.prototype._warn=function(e,t,n){return g(e,t,n||this)},t.onPossiblyUnhandledRejection=function(e){var t=R();L="function"==typeof e?null===t?e:I.domainBind(t,e):void 0},t.onUnhandledRejectionHandled=function(e){var t=R();S="function"==typeof e?null===t?e:I.domainBind(t,e):void 0};var K=function(){};t.longStackTraces=function(){if(F.haveItemsQueued()&&!oe.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!oe.longStackTraces&&k()){var e=t.prototype._captureStackTrace,r=t.prototype._attachExtraTrace;oe.longStackTraces=!0,K=function(){if(F.haveItemsQueued()&&!oe.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=r,n.deactivateLongStackTraces(),F.enableTrampoline(),oe.longStackTraces=!1},t.prototype._captureStackTrace=d,t.prototype._attachExtraTrace=f,n.activateLongStackTraces(),F.disableTrampolineIfNecessary()}},t.hasLongStackTraces=function(){return oe.longStackTraces&&k()};var J=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return I.global.dispatchEvent(e),function(e,t){var n=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!I.global.dispatchEvent(n)}}if("function"==typeof Event){var e=new Event("CustomEvent");return I.global.dispatchEvent(e),function(e,t){var n=new Event(e.toLowerCase(),{cancelable:!0});return n.detail=t,!I.global.dispatchEvent(n)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),I.global.dispatchEvent(e),function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e.toLowerCase(),!1,!0,t),!I.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),Q=function(){return I.isNode?function(){return process.emit.apply(process,arguments)}:I.global?function(e){var t="on"+e.toLowerCase(),n=I.global[t];return!!n&&(n.apply(I.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),Z={promiseCreated:r,promiseFulfilled:r,promiseRejected:r,promiseResolved:r,promiseCancelled:r,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:r},ee=function(e){var t=!1;try{t=Q.apply(null,arguments)}catch(n){F.throwLater(n),t=!0}var r=!1;try{r=J(e,Z[e].apply(null,arguments))}catch(n){F.throwLater(n),r=!0}return r||t};t.config=function(e){if(e=Object(e),"longStackTraces"in e&&(e.longStackTraces?t.longStackTraces():!e.longStackTraces&&t.hasLongStackTraces()&&K()),"warnings"in e){var n=e.warnings;oe.warnings=!!n,$=oe.warnings,I.isObject(n)&&"wForgottenReturn"in n&&($=!!n.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!oe.cancellation){if(F.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=u,t.prototype._propagateFrom=c,t.prototype._onCancel=s,t.prototype._setOnCancel=l,t.prototype._attachCancellationCallback=a,t.prototype._execute=o,te=c,oe.cancellation=!0}return"monitoring"in e&&(e.monitoring&&!oe.monitoring?(oe.monitoring=!0,t.prototype._fireEvent=ee):!e.monitoring&&oe.monitoring&&(oe.monitoring=!1,t.prototype._fireEvent=i)),t},t.prototype._fireEvent=i,t.prototype._execute=function(e,t,n){try{e(t,n)}catch(r){return r}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(e){},t.prototype._attachCancellationCallback=function(e){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(e,t){};var te=h,ne=function(){return!1},re=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;I.inherits(D,Error),n.CapturedTrace=D,D.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},r=0,i=this;void 0!==i;++r)t.push(i),i=i._parent;e=this._length=r;for(var r=e-1;r>=0;--r){var o=t[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;r<e;++r){var a=t[r].stack,s=n[a];if(void 0!==s&&s!==r){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var l=r>0?t[r-1]:this;s<e-1?(l._parent=t[s+1],l._parent.uncycle(),l._length=l._parent._length+1):(l._parent=void 0,l._length=1);for(var u=l._length+1,c=r-2;c>=0;--c)t[c]._length=u,u++;return}}}},D.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=C(e),n=t.message,r=[t.stack],i=this;void 0!==i;)r.push(w(i.stack.split("\n"))),i=i._parent;y(r),b(r),I.notEnumerableProp(e,"stack",_(n,r)),I.notEnumerableProp(e,"__stackCleaned__",!0)}};var ie=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():P(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,V=e,W=t;var n=Error.captureStackTrace;return ne=function(e){return B.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return V=/@/,W=t,H=!0,function(e){e.stack=(new Error).stack};var i;try{throw new Error}catch(o){i="stack"in o}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(W=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?P(t):t.toString()},null):(V=e,W=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(M=function(e){console.warn(e)},I.isNode&&process.stderr.isTTY?M=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:I.isNode||"string"!=typeof(new Error).stack||(M=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var oe={warnings:G,longStackTraces:!1,cancellation:!1,monitoring:!1};return Y&&t.longStackTraces(),{longStackTraces:function(){return oe.longStackTraces},warnings:function(){return oe.warnings},cancellation:function(){return oe.cancellation},monitoring:function(){return oe.monitoring},propagateFromFunction:function(){return te},boundValueFunction:function(){return p},checkForgottenReturns:v,setBounds:A,warn:g,deprecated:m,CapturedTrace:D,fireDomEvent:J,fireGlobalEvent:Q}}}}),montageDefine("489b8c2","js/release/finally",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n){function r(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function i(e){this.finallyHandler=e}function o(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function a(){return l.call(this,this.promise._target()._settledValue())}function s(e){if(!o(this,e))return h.e=e,h}function l(e){var r=this.promise,l=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?l.call(r._boundValue()):l.call(r._boundValue(),e);if(void 0!==u){r._setReturnedNonUndefined();var p=n(u,r);if(p instanceof t){if(null!=this.cancelPromise){if(p._isCancelled()){var d=new c("late cancellation observer");return r._attachExtraTrace(d),h.e=d,h}p.isPending()&&p._attachCancellationCallback(new i(this))}return p._then(a,s,void 0,this,void 0)}}}return r.isRejected()?(o(this),h.e=e,h):(o(this),e)}var u=e("./util"),c=t.CancellationError,h=u.errorObj;return r.prototype.isFinallyHandler=function(){return 0===this.type},i.prototype._resultCancelled=function(){o(this.finallyHandler)},t.prototype._passThrough=function(e,t,n,i){return"function"!=typeof e?this.then():this._then(n,i,void 0,new r(this,t,e),void 0)},t.prototype.lastly=t.prototype["finally"]=function(e){return this._passThrough(e,0,l,l)},t.prototype.tap=function(e){return this._passThrough(e,1,l)},r}}}),montageDefine("489b8c2","js/release/catch_filter",{dependencies:["./util","./es5"],factory:function(e,t,n){"use strict";n.exports=function(t){function n(e,n,s){return function(l){var u=s._boundValue();e:for(var c=0;c<e.length;++c){var h=e[c];if(h===Error||null!=h&&h.prototype instanceof Error){if(l instanceof h)return o(n).call(u,l)}else if("function"==typeof h){var p=o(h).call(u,l);if(p===a)return p;if(p)return o(n).call(u,l)}else if(r.isObject(l)){for(var d=i(h),f=0;f<d.length;++f){var v=d[f];if(h[v]!=l[v])continue e}return o(n).call(u,l)}}return t}}var r=e("./util"),i=e("./es5").keys,o=r.tryCatch,a=r.errorObj;return n}}}),montageDefine("489b8c2","js/release/nodeback",{dependencies:["./util","./errors","./es5"],factory:function(e,t,n){"use strict";function r(e){return e instanceof Error&&c.getPrototypeOf(e)===Error.prototype}function i(e){var t;if(r(e)){t=new u(e),t.name=e.name,t.message=e.message,t.stack=e.stack;for(var n=c.keys(e),i=0;i<n.length;++i){var o=n[i];h.test(o)||(t[o]=e[o])}return t}return a.markAsOriginatingFromRejection(e),e}function o(e,t){return function(n,r){if(null!==e){if(n){var o=i(s(n));e._attachExtraTrace(o),e._reject(o)}else if(t){for(var a=arguments.length,l=new Array(Math.max(a-1,0)),u=1;u<a;++u)l[u-1]=arguments[u];e._fulfill(l)}else e._fulfill(r);e=null}}}var a=e("./util"),s=a.maybeWrapAsError,l=e("./errors"),u=l.OperationalError,c=e("./es5"),h=/^(?:name|message|stack|cause)$/;n.exports=o}}),montageDefine("489b8c2","js/release/method",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i,o){var a=e("./util"),s=a.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+a.classString(e));return function(){var r=new t(n);r._captureStackTrace(),r._pushContext();var i=s(e).apply(this,arguments),a=r._popContext();return o.checkForgottenReturns(i,a,"Promise.method",r),r._resolveFromSyncValue(i),r}},t.attempt=t["try"]=function(e){if("function"!=typeof e)return i("expecting a function but got "+a.classString(e));
var r=new t(n);r._captureStackTrace(),r._pushContext();var l;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],c=arguments[2];l=a.isArray(u)?s(e).apply(c,u):s(e).call(c,u)}else l=s(e)();var h=r._popContext();return o.checkForgottenReturns(l,h,"Promise.try",r),r._resolveFromSyncValue(l),r},t.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}}}),montageDefine("489b8c2","js/release/bind",{dependencies:[],factory:function(e,t,n){"use strict";n.exports=function(e,t,n,r){var i=!1,o=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(o,o,null,this,e)},s=function(e,t){0===(50397184&this._bitField)&&this._resolveCallback(t.target)},l=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(o){i||(i=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var u=n(o),c=new e(t);c._propagateFrom(this,1);var h=this._target();if(c._setBoundTo(u),u instanceof e){var p={promiseRejectionQueued:!1,promise:c,target:h,bindingPromise:u};h._then(t,a,void 0,c,p),u._then(s,l,void 0,c,p),c._setOnCancel(u)}else c._resolveCallback(h);return c},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=this._bitField&-2097153},e.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}}}),montageDefine("489b8c2","js/release/cancel",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i){var o=e("./util"),a=o.tryCatch,s=o.errorObj,l=t._async;t.prototype["break"]=t.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(o.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var r=a(e).call(this._boundValue());r===s&&(this._attachExtraTrace(r.e),l.throwLater(r.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}}}),montageDefine("489b8c2","js/release/direct_resolve",{dependencies:[],factory:function(e,t,n){"use strict";n.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype["return"]=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype["throw"]=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1],r=function(){throw t};return this.caught(e,r)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var r=arguments[1];r instanceof e&&r.suppressUnhandledRejections();var i=function(){return r};return this.caught(n,i)}}}}),montageDefine("489b8c2","js/release/synchronous_inspection",{dependencies:[],factory:function(e,t,n){"use strict";n.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},o=t.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0===(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return o.call(this._target())},e.prototype.isFulfilled=function(){return i.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}}}),montageDefine("489b8c2","js/release/join",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i,o,a){var s,l=e("./util"),u=l.canEvaluate,c=l.tryCatch,h=l.errorObj;if(u){for(var p=function(e){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,e))},d=function(e){return new Function("promise","holder","                           \n            'use strict';                                                    \n            holder.pIndex = promise;                                         \n            ".replace(/Index/g,e))},f=function(e){for(var n=new Array(e),r=0;r<n.length;++r)n[r]="this.p"+(r+1);var i=n.join(" = ")+" = null;",a="var promise;\n"+n.map(function(e){return"                                                         \n                promise = "+e+";                                      \n                if (promise instanceof Promise) {                            \n                    promise.cancel();                                        \n                }                                                            \n            "}).join("\n"),s=n.join(", "),l="Holder$"+e,u="return function(tryCatch, errorObj, Promise, async) {    \n            'use strict';                                                    \n            function [TheName](fn) {                                         \n                [TheProperties]                                              \n                this.fn = fn;                                                \n                this.asyncNeeded = true;                                     \n                this.now = 0;                                                \n            }                                                                \n                                                                             \n            [TheName].prototype._callFunction = function(promise) {          \n                promise._pushContext();                                      \n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n                promise._popContext();                                       \n                if (ret === errorObj) {                                      \n                    promise._rejectCallback(ret.e, false);                   \n                } else {                                                     \n                    promise._resolveCallback(ret);                           \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype.checkFulfillment = function(promise) {       \n                var now = ++this.now;                                        \n                if (now === [TheTotal]) {                                    \n                    if (this.asyncNeeded) {                                  \n                        async.invoke(this._callFunction, this, promise);     \n                    } else {                                                 \n                        this._callFunction(promise);                         \n                    }                                                        \n                                                                             \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype._resultCancelled = function() {              \n                [CancellationCode]                                           \n            };                                                               \n                                                                             \n            return [TheName];                                                \n        }(tryCatch, errorObj, Promise, async);                               \n        ";return u=u.replace(/\[TheName\]/g,l).replace(/\[TheTotal\]/g,e).replace(/\[ThePassedArguments\]/g,s).replace(/\[TheProperties\]/g,i).replace(/\[CancellationCode\]/g,a),new Function("tryCatch","errorObj","Promise","async",u)(c,h,t,o)},v=[],m=[],g=[],_=0;_<8;++_)v.push(f(_+1)),m.push(p(_+1)),g.push(d(_+1));s=function(e){this._reject(e)}}t.join=function(){var e,o=arguments.length-1;if(o>0&&"function"==typeof arguments[o]&&(e=arguments[o],o<=8&&u)){var c=new t(i);c._captureStackTrace();for(var h=v[o-1],p=new h(e),d=m,f=0;f<o;++f){var _=r(arguments[f],c);if(_ instanceof t){_=_._target();var b=_._bitField;0===(50397184&b)?(_._then(d[f],s,void 0,c,p),g[f](_,p),p.asyncNeeded=!1):0!==(33554432&b)?d[f].call(c,_._value(),p):0!==(16777216&b)?c._reject(_._reason()):c._cancel()}else d[f].call(c,_,p)}if(!c._isFateSealed()){if(p.asyncNeeded){var y=a();null!==y&&(p.fn=l.domainBind(y,p.fn))}c._setAsyncGuaranteed(),c._setOnCancel(p)}return c}for(var w=arguments.length,E=new Array(w),C=0;C<w;++C)E[C]=arguments[C];e&&E.pop();var c=new n(E).promise();return void 0!==e?c.spread(e):c}}}}),montageDefine("489b8c2","js/release/map",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i,o,a){function s(e,t,n,r){this.constructor$(e),this._promise._captureStackTrace();var i=u();this._callback=null===i?t:c.domainBind(i,t),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],d.invoke(this._asyncInit,this,void 0)}function l(e,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+c.classString(n));var a=0;if(void 0!==i){if("object"!=typeof i||null===i)return t.reject(new TypeError("options argument must be an object but it is "+c.classString(i)));if("number"!=typeof i.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(i.concurrency)));a=i.concurrency}return a="number"==typeof a&&isFinite(a)&&a>=1?a:0,new s(e,n,a,o).promise()}var u=t._getDomain,c=e("./util"),h=c.tryCatch,p=c.errorObj,d=t._async;c.inherits(s,n),s.prototype._asyncInit=function(){this._init$(void 0,-2)},s.prototype._init=function(){},s.prototype._promiseFulfilled=function(e,n){var r=this._values,o=this.length(),s=this._preservedValues,l=this._limit;if(n<0){if(n=n*-1-1,r[n]=e,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return r[n]=e,this._queue.push(n),!1;null!==s&&(s[n]=e);var u=this._promise,c=this._callback,d=u._boundValue();u._pushContext();var f=h(c).call(d,e,n,o),v=u._popContext();if(a.checkForgottenReturns(f,v,null!==s?"Promise.filter":"Promise.map",u),f===p)return this._reject(f.e),!0;var m=i(f,this._promise);if(m instanceof t){m=m._target();var g=m._bitField;if(0===(50397184&g))return l>=1&&this._inFlight++,r[n]=m,m._proxy(this,(n+1)*-1),!1;if(0===(33554432&g))return 0!==(16777216&g)?(this._reject(m._reason()),!0):(this._cancel(),!0);f=m._value()}r[n]=f}var _=++this._totalResolved;return _>=o&&(null!==s?this._filter(r,s):this._resolve(r),!0)},s.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(n[r],r)}},s.prototype._filter=function(e,t){for(var n=t.length,r=new Array(n),i=0,o=0;o<n;++o)e[o]&&(r[i++]=t[o]);r.length=i,this._resolve(r)},s.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return l(this,e,t,null)},t.map=function(e,t,n,r){return l(e,t,n,r)}}}}),montageDefine("489b8c2","js/release/call_get",{dependencies:["./util"],factory:function(e,t,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}n.exports=function(t){function n(e,n){var r;if(null!=e&&(r=e[n]),"function"!=typeof r){var i="Object "+c.classString(e)+" has no method '"+c.toString(n)+"'";throw new t.TypeError(i)}return r}function r(e){var t=this.pop(),r=n(e,t);return r.apply(e,this)}function a(e){return e[this]}function s(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}var l,u,c=e("./util"),h=c.canEvaluate,p=c.isIdentifier,d=function(e){return new Function("ensureMethod","                                    \n        return function(obj) {                                               \n            'use strict'                                                     \n            var len = this.length;                                           \n            ensureMethod(obj, 'methodName');                                 \n            switch(len) {                                                    \n                case 1: return obj.methodName(this[0]);                      \n                case 2: return obj.methodName(this[0], this[1]);             \n                case 3: return obj.methodName(this[0], this[1], this[2]);    \n                case 0: return obj.methodName();                             \n                default:                                                     \n                    return obj.methodName.apply(obj, this);                  \n            }                                                                \n        };                                                                   \n        ".replace(/methodName/g,e))(n)},f=function(e){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",e))},v=function(e,t,n){var r=n[e];if("function"!=typeof r){if(!p(e))return null;if(r=t(e),n[e]=r,n[" size"]++,n[" size"]>512){for(var i=Object.keys(n),o=0;o<256;++o)delete n[i[o]];n[" size"]=i.length-256}}return r};l=function(e){return v(e,d,i)},u=function(e){return v(e,f,o)},t.prototype.call=function(e){for(var t=arguments.length,n=new Array(Math.max(t-1,0)),i=1;i<t;++i)n[i-1]=arguments[i];if(h){var o=l(e);if(null!==o)return this._then(o,void 0,void 0,n,void 0)}return n.push(e),this._then(r,void 0,void 0,n,void 0)},t.prototype.get=function(e){var t,n="number"==typeof e;if(n)t=s;else if(h){var r=u(e);t=null!==r?r:a}else t=a;return this._then(t,void 0,void 0,e,void 0)}}}}),montageDefine("489b8c2","js/release/using",{dependencies:["./util","./errors","./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i,o,a){function s(e){setTimeout(function(){throw e},0)}function l(e){var t=r(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function u(e,n){function i(){if(a>=u)return c._fulfill();var o=l(e[a++]);if(o instanceof t&&o._isDisposable()){try{o=r(o._getDisposer().tryDispose(n),e.promise)}catch(h){return s(h)}if(o instanceof t)return o._then(i,s,null,null,null)}i()}var a=0,u=e.length,c=new t(o);return i(),c}function c(e,t,n){this._data=e,this._promise=t,this._context=n}function h(e,t,n){this.constructor$(e,t,n)}function p(e){return c.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function d(e){this.length=e,this.promise=null,this[e-1]=null}var f=e("./util"),v=e("./errors").TypeError,m=e("./util").inherits,g=f.errorObj,_=f.tryCatch,b={};c.prototype.data=function(){return this._data},c.prototype.promise=function(){return this._promise},c.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():b},c.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=t!==b?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},c.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},m(h,c),h.prototype.doDispose=function(e,t){var n=this.data();return n.call(e,e,t)},d.prototype._resultCancelled=function(){for(var e=this.length,n=0;n<e;++n){var r=this[n];r instanceof t&&r.cancel()}},t.using=function(){var e=arguments.length;if(e<2)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[e-1];if("function"!=typeof i)return n("expecting a function but got "+f.classString(i));var o,s=!0;2===e&&Array.isArray(arguments[0])?(o=arguments[0],e=o.length,s=!1):(o=arguments,e--);for(var l=new d(e),h=0;h<e;++h){var v=o[h];if(c.isDisposer(v)){var m=v;v=v.promise(),v._setDisposable(m)}else{var b=r(v);b instanceof t&&(v=b._then(p,null,null,{resources:l,index:h},void 0))}l[h]=v}for(var y=new Array(l.length),h=0;h<y.length;++h)y[h]=t.resolve(l[h]).reflect();var w=t.all(y).then(function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return g.e=n.error(),g;if(!n.isFulfilled())return void w.cancel();e[t]=n.value()}E._pushContext(),i=_(i);var r=s?i.apply(void 0,e):i(e),o=E._popContext();return a.checkForgottenReturns(r,o,"Promise.using",E),r}),E=w.lastly(function(){var e=new t.PromiseInspection(w);return u(l,e)});return l.promise=E,E._setOnCancel(l),E},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new h(e,this,i());throw new v}}}}),montageDefine("489b8c2","js/release/timers",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r){function i(e){this.handle=e}function o(e){return clearTimeout(this.handle),e}function a(e){throw clearTimeout(this.handle),e}var s=e("./util"),l=t.TimeoutError;i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var u=function(e){return c(+this).thenReturn(e)},c=t.delay=function(e,o){var a,s;return void 0!==o?(a=t.resolve(o)._then(u,null,null,e,void 0),r.cancellation()&&o instanceof t&&a._setOnCancel(o)):(a=new t(n),s=setTimeout(function(){a._fulfill()},+e),r.cancellation()&&a._setOnCancel(new i(s)),a._captureStackTrace()),a._setAsyncGuaranteed(),a};t.prototype.delay=function(e){return c(e,this)};var h=function(e,t,n){var r;r="string"!=typeof t?t instanceof Error?t:new l("operation timed out"):new l(t),s.markAsOriginatingFromRejection(r),e._attachExtraTrace(r),e._reject(r),null!=n&&n.cancel()};t.prototype.timeout=function(e,t){e=+e;var n,s,l=new i(setTimeout(function(){n.isPending()&&h(n,t,s)},e));return r.cancellation()?(s=this.then(),n=s._then(o,a,void 0,l,void 0),n._setOnCancel(l)):n=this._then(o,a,void 0,l,void 0),n}}}}),montageDefine("489b8c2","js/release/generators",{dependencies:["./errors","./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i,o,a){function s(e,n,r){for(var o=0;o<n.length;++o){r._pushContext();var a=d(n[o])(e);if(r._popContext(),a===p){r._pushContext();var s=t.reject(p.e);return r._popContext(),s}var l=i(a,r);if(l instanceof t)return l}return null}function l(e,n,i,o){if(a.cancellation()){var s=new t(r),l=this._finallyPromise=new t(r);this._promise=s.lastly(function(){return l}),s._captureStackTrace(),s._setOnCancel(this)}else{var u=this._promise=new t(r);u._captureStackTrace()}this._stack=o,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}var u=e("./errors"),c=u.TypeError,h=e("./util"),p=h.errorObj,d=h.tryCatch,f=[];h.inherits(l,o),l.prototype._isResolved=function(){return null===this._promise},l.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},l.prototype._promiseCancelled=function(){if(!this._isResolved()){var e,n="undefined"!=typeof this._generator["return"];if(n)this._promise._pushContext(),e=d(this._generator["return"]).call(this._generator,void 0),this._promise._popContext();else{var r=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),e=d(this._generator["throw"]).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},l.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=d(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},l.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=d(this._generator["throw"]).call(this._generator,e);this._promise._popContext(),this._continue(t)},l.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},l.prototype.promise=function(){return this._promise},l.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},l.prototype._continue=function(e){var n=this._promise;if(e===p)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(e.e,!1);var r=e.value;if(e.done===!0)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var o=i(r,this._promise);if(!(o instanceof t)&&(o=s(o,this._yieldHandlers,this._promise),null===o))return void this._promiseRejected(new c("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",r)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));o=o._target();var a=o._bitField;0===(50397184&a)?(this._yieldedPromise=o,o._proxy(this,null)):0!==(33554432&a)?t._async.invoke(this._promiseFulfilled,this,o._value()):0!==(16777216&a)?t._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()},t.coroutine=function(e,t){if("function"!=typeof e)throw new c("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,r=l,i=(new Error).stack;return function(){var t=e.apply(this,arguments),o=new r((void 0),(void 0),n,i),a=o.promise();return o._generator=t,o._promiseFulfilled(void 0),a}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new c("expecting a function but got "+h.classString(e));f.push(e)},t.spawn=function(e){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new l(e,this),i=r.promise();return r._run(t.spawn),i}}}}),montageDefine("489b8c2","js/release/nodeify",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t){function n(e,t){var n=this;if(!o.isArray(e))return r.call(n,e,t);var i=s(t).apply(n._boundValue(),[null].concat(e));i===l&&a.throwLater(i.e)}function r(e,t){var n=this,r=n._boundValue(),i=void 0===e?s(t).call(r,null):s(t).call(r,null,e);i===l&&a.throwLater(i.e)}function i(e,t){var n=this;if(!e){var r=new Error(e+"");r.cause=e,e=r}var i=s(t).call(n._boundValue(),e);i===l&&a.throwLater(i.e)}var o=e("./util"),a=t._async,s=o.tryCatch,l=o.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var o=r;void 0!==t&&Object(t).spread&&(o=n),this._then(o,i,void 0,this,e)}return this}}}}),montageDefine("489b8c2","js/release/promisify",{dependencies:["./util","./nodeback","./errors"],factory:function(e,t,n){"use strict";n.exports=function(t,n){function r(e){return!E.test(e)}function i(e){try{return e.__isPromisified__===!0}catch(t){return!1}}function o(e,t,n){var r=d.getDataPropertyOrDefault(e,t+n,y);return!!r&&i(r)}function a(e,t,n){for(var r=0;r<e.length;r+=2){var i=e[r];if(n.test(i))for(var o=i.replace(n,""),a=0;a<e.length;a+=2)if(e[a]===o)throw new _("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}function s(e,t,n,r){for(var s=d.inheritedDataKeys(e),l=[],u=0;u<s.length;++u){var c=s[u],h=e[c],p=r===C||C(c,h,e);"function"!=typeof h||i(h)||o(e,c,t)||!r(c,h,e,p)||l.push(c,h)}return a(l,t,n),l}function l(e,r,i,o,a,s){function l(){var i=r;r===p&&(i=this);var o=new t(n);o._captureStackTrace();var a="string"==typeof c&&this!==u?this[c]:e,l=f(o,s);try{a.apply(i,v(arguments,l))}catch(h){o._rejectCallback(m(h),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var u=function(){return this}(),c=e;return"string"==typeof c&&(e=o),d.notEnumerableProp(l,"__isPromisified__",!0),l}function u(e,t,n,r,i){for(var o=new RegExp(O(t)+"$"),a=s(e,t,o,n),l=0,u=a.length;l<u;l+=2){var c=a[l],h=a[l+1],f=c+t;if(r===x)e[f]=x(c,p,c,h,t,i);else{var v=r(h,function(){return x(c,p,c,h,t,i)});d.notEnumerableProp(v,"__isPromisified__",!0),e[f]=v}}return d.toFastProperties(e),e}function c(e,t,n){return x(e,t,void 0,e,null,n)}var h,p={},d=e("./util"),f=e("./nodeback"),v=d.withAppended,m=d.maybeWrapAsError,g=d.canEvaluate,_=e("./errors").TypeError,b="Async",y={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],E=new RegExp("^(?:"+w.join("|")+")$"),C=function(e){return d.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e},O=function(e){return e.replace(/([$])/,"\\$")},j=function(e){for(var t=[e],n=Math.max(0,e-1-3),r=e-1;r>=n;--r)t.push(r);for(var r=e+1;r<=3;++r)t.push(r);return t},P=function(e){return d.filledRange(e,"_arg","")},T=function(e){return d.filledRange(Math.max(e,3),"_arg","")},k=function(e){return"number"==typeof e.length?Math.max(Math.min(e.length,1024),0):0};h=function(e,r,i,o,a,s){function l(e){var t,n=P(e).join(", "),i=e>0?", ":"";return t=g?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===r?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n",t.replace("{{args}}",n).replace(", ",i)}function u(){for(var e="",t=0;t<h.length;++t)e+="case "+h[t]+":"+l(h[t]);return e+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = nodeback;                                              \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",g?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}var c=Math.max(0,k(o)-1),h=j(c),g="string"==typeof e||r===p,_="string"==typeof e?"this != null ? this['"+e+"'] : fn":"fn",b="'use strict';                                                \n        var ret = function (Parameters) {                                    \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._captureStackTrace();                                    \n            var nodeback = nodebackForPromise(promise, "+s+");   \n            var ret;                                                         \n            var callback = tryCatch([GetFunctionCode]);                      \n            switch(len) {                                                    \n                [CodeForSwitchCase]                                          \n            }                                                                \n            if (ret === errorObj) {                                          \n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n            }                                                                \n            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n            return promise;                                                  \n        };                                                                   \n        notEnumerableProp(ret, '__isPromisified__', true);                   \n        return ret;                                                          \n    ".replace("[CodeForSwitchCase]",u()).replace("[GetFunctionCode]",_);return b=b.replace("Parameters",T(c)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",b)(t,o,r,v,m,f,d.tryCatch,d.errorObj,d.notEnumerableProp,n)};var x=g?h:l;t.promisify=function(e,t){
if("function"!=typeof e)throw new _("expecting a function but got "+d.classString(e));if(i(e))return e;t=Object(t);var n=void 0===t.context?p:t.context,o=!!t.multiArgs,a=c(e,n,o);return d.copyDescriptors(e,a,r),a},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new _("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");t=Object(t);var n=!!t.multiArgs,r=t.suffix;"string"!=typeof r&&(r=b);var i=t.filter;"function"!=typeof i&&(i=C);var o=t.promisifier;if("function"!=typeof o&&(o=x),!d.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=d.inheritedDataKeys(e),s=0;s<a.length;++s){var l=e[a[s]];"constructor"!==a[s]&&d.isClass(l)&&(u(l.prototype,r,i,o,n),u(l,r,i,o,n))}return u(e,r,i,o,n)}}}}),montageDefine("489b8c2","js/release/props",{dependencies:["./util","./es5"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i){function o(e){var t,n=!1;if(void 0!==s&&e instanceof s)t=h(e),n=!0;else{var r=c.keys(e),i=r.length;t=new Array(2*i);for(var o=0;o<i;++o){var a=r[o];t[o]=e[a],t[o+i]=a}}this.constructor$(t),this._isMap=n,this._init$(void 0,-3)}function a(e){var n,a=r(e);return u(a)?(n=a instanceof t?a._then(t.props,void 0,void 0,void 0,void 0):new o(a).promise(),a instanceof t&&n._propagateFrom(a,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,l=e("./util"),u=l.isObject,c=e("./es5");"function"==typeof Map&&(s=Map);var h=function(){function e(e,r){this[t]=e,this[t+n]=r,t++}var t=0,n=0;return function(r){n=r.size,t=0;var i=new Array(2*r.size);return r.forEach(e,i),i}}(),p=function(e){for(var t=new s,n=e.length/2|0,r=0;r<n;++r){var i=e[n+r],o=e[r];t.set(i,o)}return t};l.inherits(o,n),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;if(n>=this._length){var r;if(this._isMap)r=p(this._values);else{r={};for(var i=this.length(),o=0,a=this.length();o<a;++o)r[this._values[o+i]]=this._values[o]}return this._resolve(r),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return a(this)},t.props=function(e){return a(e)}}}}),montageDefine("489b8c2","js/release/race",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i){function o(e,o){var l=r(e);if(l instanceof t)return s(l);if(e=a.asArray(e),null===e)return i("expecting an array or an iterable object but got "+a.classString(e));var u=new t(n);void 0!==o&&u._propagateFrom(o,3);for(var c=u._fulfill,h=u._reject,p=0,d=e.length;p<d;++p){var f=e[p];(void 0!==f||p in e)&&t.cast(f)._then(c,h,void 0,u,null)}return u}var a=e("./util"),s=function(e){return e.then(function(t){return o(t,e)})};t.race=function(e){return o(e,void 0)},t.prototype.race=function(){return o(this,void 0)}}}}),montageDefine("489b8c2","js/release/reduce",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r,i,o,a){function s(e,n,r,i){this.constructor$(e);var a=p();this._fn=null===a?n:d.domainBind(a,n),void 0!==r&&(r=t.resolve(r),r._attachCancellationCallback(this)),this._initialValue=r,this._currentCancellable=null,i===o?this._eachValues=Array(this._length):0===i?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function u(e,t,n,i){if("function"!=typeof t)return r("expecting a function but got "+d.classString(t));var o=new s(e,t,n,i);return o.promise()}function c(e){this.accum=e,this.array._gotAccum(e);var n=i(this.value,this.array._promise);return n instanceof t?(this.array._currentCancellable=n,n._then(h,void 0,void 0,this,void 0)):h.call(this,n)}function h(e){var n=this.array,r=n._promise,i=f(n._fn);r._pushContext();var o;o=void 0!==n._eachValues?i.call(r._boundValue(),e,this.index,this.length):i.call(r._boundValue(),this.accum,e,this.index,this.length),o instanceof t&&(n._currentCancellable=o);var s=r._popContext();return a.checkForgottenReturns(o,s,void 0!==n._eachValues?"Promise.each":"Promise.reduce",r),o}var p=t._getDomain,d=e("./util"),f=d.tryCatch;d.inherits(s,n),s.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==o&&this._eachValues.push(e)},s.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},s.prototype.shouldCopyValues=function(){return!1},s.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},s.prototype._resultCancelled=function(e){return e===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel()))},s.prototype._iterate=function(e){this._values=e;var n,r,i=e.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=t.resolve(e[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;r<i;++r){var o={accum:null,value:e[r],index:r,length:i,array:this};n=n._then(c,void 0,void 0,o,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(l,l,void 0,n,this)},t.prototype.reduce=function(e,t){return u(this,e,t,null)},t.reduce=function(e,t,n,r){return u(e,t,n,r)}}}}),montageDefine("489b8c2","js/release/settle",{dependencies:["./util"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r){function i(e){this.constructor$(e)}var o=t.PromiseInspection,a=e("./util");a.inherits(i,n),i.prototype._promiseResolved=function(e,t){this._values[e]=t;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var n=new o;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},i.prototype._promiseRejected=function(e,t){var n=new o;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},t.settle=function(e){return r.deprecated(".settle()",".reflect()"),new i(e).promise()},t.prototype.settle=function(){return t.settle(this)}}}}),montageDefine("489b8c2","js/release/some",{dependencies:["./util","./errors","./errors"],factory:function(e,t,n){"use strict";n.exports=function(t,n,r){function i(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(e,t){if((0|t)!==t||t<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new i(e),o=n.promise();return n.setHowMany(t),n.init(),o}var a=e("./util"),s=e("./errors").RangeError,l=e("./errors").AggregateError,u=a.isArray,c={};a.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var e=u(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(e){this._howMany=e},i.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},i.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new l,t=this.length();t<this._values.length;++t)this._values[t]!==c&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(e){this._values.push(e)},i.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return o(e,t)},t.prototype.some=function(e){return o(this,e)},t._SomePromiseArray=i}}}),montageDefine("489b8c2","js/release/filter",{dependencies:[],factory:function(e,t,n){"use strict";n.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,r){return n(this,e,r,t)},e.filter=function(e,r,i){return n(e,r,i,t)}}}}),montageDefine("489b8c2","js/release/each",{dependencies:[],factory:function(e,t,n){"use strict";n.exports=function(e,t){function n(){return o(this)}function r(e,n){return i(e,n,t,t)}var i=e.reduce,o=e.all;e.prototype.each=function(e){return i(this,e,t,0)._then(n,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return i(this,e,t,t)},e.each=function(e,r){return i(e,r,t,0)._then(n,void 0,void 0,e,void 0)},e.mapSeries=r}}}),montageDefine("489b8c2","js/release/any",{dependencies:[],factory:function(e,t,n){"use strict";n.exports=function(e){function t(e){var t=new n(e),r=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),r}var n=e._SomePromiseArray;e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}}}),montageDefine("489b8c2","js/release/schedule",{dependencies:["./util"],factory:function(e,t,n){"use strict";var r,i=e("./util"),o=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},a=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var s=global.setImmediate,l=process.nextTick;r=i.isRecentNode?function(e){s.call(global,e)}:function(e){l.call(process,e)}}else if("function"==typeof a&&"function"==typeof a.resolve){var u=a.resolve();r=function(e){u.then(e)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:o:function(){var e=document.createElement("div"),t={attributes:!0},n=!1,r=document.createElement("div"),i=new MutationObserver(function(){e.classList.toggle("foo"),n=!1});i.observe(r,t);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(e,t),o()}}();n.exports=r}}),montageDefine("489b8c2","js/release/queue",{dependencies:[],factory:function(e,t,n){"use strict";function r(e,t,n,r,i){for(var o=0;o<i;++o)n[o+r]=e[o+t],e[o+t]=void 0}function i(e){this._capacity=e,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(e){return this._capacity<e},i.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var n=this._front+t&this._capacity-1;this[n]=e,this._length=t+1},i.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=e,this[i+1&o]=t,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,i=this._length,o=n+i&t-1;r(this,0,this,t,o)},n.exports=i}}),montageDefine("449c0c3","shim",{dependencies:["./shim-array","./shim-object","./shim-function","./shim-regexp"],factory:function(e,t,n){e("./shim-array"),e("./shim-object"),e("./shim-function"),e("./shim-regexp")}}),montageDefine("449c0c3","map",{dependencies:["./_map","./listen/property-changes","./listen/map-changes"],factory:function(e,t,n){"use strict";var r=e("./_map"),i=e("./listen/property-changes"),o=e("./listen/map-changes");n.exports=r,void 0===global.Map||"function"!=typeof global.Set.prototype.values?(Object.addEach(r.prototype,i.prototype),Object.addEach(r.prototype,o.prototype)):(Object.defineEach(r.prototype,i.prototype,!1,!0,!1,!0),Object.defineEach(r.prototype,o.prototype,!1,!0,!1,!0))}}),montageDefine("449c0c3","set",{dependencies:["./_set","./listen/property-changes","./listen/range-changes","./listen/map-changes","set","./list","./fast-set"],factory:function(e,t,n){"use strict";function r(){var t=o.CollectionsSet,r=function u(e,n,r,i){return t._init(u,this,e,n,r,i)};r.Set=r,r.from=t.from,o.CollectionsSet=r,r.prototype=new t,r.prototype.constructor=r;var i=e("./list"),l=e("./fast-set");r.prototype.Order=i,r.prototype.Store=l,Object.defineProperty(r.prototype,"_dispatchEmptyArray",{value:[]}),r.prototype.add=function(e){var t=new this.order.Node(e);if(!this.store.has(t)){var n=this.length,r=[e];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(r,this._dispatchEmptyArray,n),this.order.add(e),t=this.order.head.prev,this.store.add(t),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange(r,this._dispatchEmptyArray,n),!0}return!1},r.prototype["delete"]=function(e,t){if(t)throw new Error("Set#delete does not support second argument: equals");var n=new this.order.Node(e);if(this.store.has(n)){n=this.store.get(n);var r=[e];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(this._dispatchEmptyArray,r,n.index),this.store["delete"](n),this.order.splice(n,1),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,r,n.index),!0}return!1},r.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange(this._dispatchEmptyArray,e,0)),this._clear(),this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,e,0)},Object.addEach(o.CollectionsSet.prototype,a.prototype),Object.addEach(o.CollectionsSet.prototype,s.prototype),o.CollectionsSet.prototype.makeObservable=function(){this.order.makeObservable()},n.exports=r}var i,o=e("./_set"),a=e("./listen/property-changes"),s=e("./listen/range-changes"),l=e("./listen/map-changes");if(void 0!==global.Set&&"function"==typeof global.Set.prototype.values){i=global.Set,n.exports=o;var u,c={}.__proto__===Object.prototype;u=c?function(){this.__proto__=v}:function(){Object.defineProperties(this,f)},Object.defineProperty(i.prototype,"makeObservable",{value:u,writable:!0,configurable:!0,enumerable:!1});var h=i.prototype.clear,p=i.prototype.add,d=i.prototype["delete"],f={_dispatchEmptyArray:{value:[]},clear:{value:function(){var e;this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange(this._dispatchEmptyArray,e,0)),h.call(this),this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,e,0)},writable:!0,configurable:!0},add:{value:function(e){if(!this.has(e)){var t=this.size,n=[e];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(n,this._dispatchEmptyArray,t),p.call(this,e),this.dispatchesRangeChanges&&this.dispatchRangeChange(n,this._dispatchEmptyArray,t),!0}return!1},writable:!0,configurable:!0},"delete":{value:function(e,t){if(this.has(e)){if(void 0===t){var n=this.values();for(t=0;n.next().value!==e;)t++}var r=[e];return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(this._dispatchEmptyArray,r,t),d.call(this,e),this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,r,t),!0}return!1}}},v=Object.create(i.prototype,f);Object.defineEach(o.prototype,a.prototype,!1,!0,!1,!0),Object.defineProperty(o.prototype,"makePropertyObservable",{value:function(){},writable:!0,configurable:!0,enumerable:!1}),Object.defineEach(o.prototype,s.prototype,!1,!0,!1,!0),Object.defineEach(o.prototype,l.prototype,!1,!0,!1,!0),Object.defineProperty(o,"_setupCollectionSet",{value:r,writable:!0,configurable:!0,enumerable:!1})}else r()}}),montageDefine("449c0c3","listen/property-changes",{dependencies:["../shim","../_map","../weak-map","./change-descriptor"],factory:function(e,t,n){function r(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}function i(e,t,n,r){if(e&&e._current){var i,o,a,s,l,c=e.specificHandlerMethodName,h=e.genericHandlerMethodName,p=u;if(Array.isArray(e._current)){for(i=e.removeCurrentGostListenersIfNeeded(),a=0,s=i.length;a<s;a++)if((l=i[a])!==p){if(o=l[c]||l[h]||l,!o.call)throw new Error("No event listener for "+e.specificHandlerName+" or "+e.genericHandlerName+" or call on "+o);o.call(l,n,t,r)}}else{if(l=e._current,o=l[c]||l[h]||l,!o.call)throw new Error("No event listener for "+e.specificHandlerName+" or "+e.genericHandlerName+" or call on "+o);o.call(l,n,t,r)}}}Object.prototype.hasOwnProperty,n.exports=r,e("../shim");var o=e("../_map"),a=e("../weak-map"),s=e("./change-descriptor"),l=s.ObjectChangeDescriptor,u=s.ListenerGhost;r.debug=!0;var c=new a,h=new o;r.ObjectChangeDescriptor=function(){},r.prototype.getOwnPropertyChangeDescriptor=function(e){var t,n=c.get(this);if(n||(n=Object.create(null),c.set(this,n)),void 0===(t=n[e])){var r=h.get(e);return r||(r=String(e),r=r&&r[0].toUpperCase()+r.slice(1),h.set(e,r)),n[e]=new l(r)}return t},r.prototype.hasOwnPropertyChangeDescriptor=function(e){var t=c.get(this);return!(!t||e&&void 0===t[e])},r.prototype.addOwnPropertyChangeListener=function(e,t,n){this.makeObservable&&!this.isObservable&&this.makeObservable();var i=r.getOwnPropertyChangeDescriptor(this,e),o=n?i.willChangeListeners:i.changeListeners;r.makePropertyObservable(this,e),o._current?Array.isArray(o._current)?o._current.push(t):o._current=[o._current,t]:o._current=t;var a=this;return function(){r.removeOwnPropertyChangeListener(a,e,t,n),a=null}},r.prototype.addBeforeOwnPropertyChangeListener=function(e,t){return r.addOwnPropertyChangeListener(this,e,t,!0)},r.prototype.removeOwnPropertyChangeListener=function f(e,t,n){var i,o=r.getOwnPropertyChangeDescriptor(this,e);if(i=n?o._willChangeListeners:o._changeListeners,i&&i._current)if(i._current===t)i._current=null;else{var a=i._current.lastIndexOf(t);if(a===-1)throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(e));o.isActive?(i.ghostCount=i.ghostCount+1,i._current[a]=f.ListenerGhost):i._current.spliceOne(a)}},r.prototype.removeOwnPropertyChangeListener.ListenerGhost=u,r.prototype.removeBeforeOwnPropertyChangeListener=function(e,t){return r.removeOwnPropertyChangeListener(this,e,t,!0)},r.prototype.dispatchOwnPropertyChange=function v(e,t,n){var i,o=r.getOwnPropertyChangeDescriptor(this,e);if(!o.isActive){o.isActive=!0,i=n?o._willChangeListeners:o._changeListeners;try{v.dispatchEach(i,e,t,this)}finally{o.isActive=!1}}},r.prototype.dispatchOwnPropertyChange.dispatchEach=i,i.ListenerGhost=u,r.prototype.dispatchBeforeOwnPropertyChange=function(e,t){return r.dispatchOwnPropertyChange(this,e,t,!0)};var p=new a,d=(new a,{get:void 0,set:void 0,configurable:!0,enumerable:!1});r.prototype.makePropertyObservable=function(e){var t=p.get(this);if(!t||void 0===t.get(e)){if(!t){if(Array.isArray(this))return;if(!Object.isExtensible(this))throw new Error("Can't make property "+JSON.stringify(e)+" observable on "+this+" because object is not extensible");t=new o,p.set(this,t)}var n,r=this;do{if(n=Object.getOwnPropertyDescriptor(r,e))break;r=Object.getPrototypeOf(r)}while(r);if(n){if(!n.configurable)return;if(!n.writable&&!n.set)return}else n={value:void 0,enumerable:!0,writable:!0,configurable:!0};t.set(e,n),"value"in n?(d.get=function a(){return a.overriddenDescriptor.value},d.set=function s(e){var t,n,r=s.overriddenDescriptor;if(e!==r.value){if(!(n=(t=s.descriptor).isActive)){t.isActive=!0;try{s.dispatchEach(t._willChangeListeners,s.key,r.value,this)}finally{}}if(r.value=e,!n)try{s.dispatchEach(t._changeListeners,s.key,e,this)}finally{t.isActive=!1}}},d.set.dispatchEach=i,d.set.key=e,d.get.overriddenDescriptor=d.set.overriddenDescriptor=n,d.set.descriptor=c.get(this)[e],d.enumerable=n.enumerable,d.configurable=!0):(d.get=n.get,d.set=function l(){var t,n,r,i=l.overriddenGetter.call(this);if(1===arguments.length?l.overriddenSetter.call(this,arguments[0]):2===arguments.length?l.overriddenSetter.call(this,arguments[0],arguments[1]):l.overriddenSetter.apply(this,arguments),(r=l.overriddenGetter.call(this))!==i){if(t=l.descriptor,!(n=t.isActive)){t.isActive=!0;try{l.dispatchEach(t._willChangeListeners,e,i,this)}finally{}}if(!n)try{l.dispatchEach(t._changeListeners,e,r,this)}finally{t.isActive=!1}}},d.enumerable=n.enumerable,d.configurable=!0,d.set.dispatchEach=i,d.set.overriddenSetter=n.set,d.set.overriddenGetter=n.get,d.set.descriptor=c.get(this)[e]),Object.defineProperty(this,e,d)}},r.getOwnPropertyChangeDescriptor=function(e,t){return e.getOwnPropertyChangeDescriptor?e.getOwnPropertyChangeDescriptor(t):r.prototype.getOwnPropertyChangeDescriptor.call(e,t)},r.hasOwnPropertyChangeDescriptor=function(e,t){return e.hasOwnPropertyChangeDescriptor?e.hasOwnPropertyChangeDescriptor(t):r.prototype.hasOwnPropertyChangeDescriptor.call(e,t)},r.addOwnPropertyChangeListener=function(e,t,n,r){if(Object.isObject(e))return e.addOwnPropertyChangeListener?e.addOwnPropertyChangeListener(t,n,r):this.prototype.addOwnPropertyChangeListener.call(e,t,n,r)},r.removeOwnPropertyChangeListener=function(e,t,n,i){if(Object.isObject(e))return e.removeOwnPropertyChangeListener?e.removeOwnPropertyChangeListener(t,n,i):r.prototype.removeOwnPropertyChangeListener.call(e,t,n,i)},r.dispatchOwnPropertyChange=function(e,t,n,i){if(Object.isObject(e))return e.dispatchOwnPropertyChange?e.dispatchOwnPropertyChange(t,n,i):r.prototype.dispatchOwnPropertyChange.call(e,t,n,i)},r.addBeforeOwnPropertyChangeListener=function(e,t,n){return r.addOwnPropertyChangeListener(e,t,n,!0)},r.removeBeforeOwnPropertyChangeListener=function(e,t,n){return r.removeOwnPropertyChangeListener(e,t,n,!0)},r.dispatchBeforeOwnPropertyChange=function(e,t,n){return r.dispatchOwnPropertyChange(e,t,n,!0)},r.makePropertyObservable=function(e,t){return e.makePropertyObservable?e.makePropertyObservable(t):r.prototype.makePropertyObservable.call(e,t)}}}),montageDefine("449c0c3","shim-array",{dependencies:["./shim-function","./generic-collection","./generic-order","./weak-map"],factory:function(e,t,n){"use strict";function r(e,t){Object.defineProperty(Array.prototype,e,{value:t,writable:!0,configurable:!0,enumerable:!1})}function i(e,t,n){this.array=e,this.start=null==t?0:t,this.end=n}var o=(e("./shim-function"),e("./generic-collection")),a=e("./generic-order"),s=e("./weak-map");n.exports=Array;var l=Array.prototype.splice,u=Array.prototype.slice;Array.empty=[],Object.freeze&&Object.freeze(Array.empty),Array.from=function(e){var t=[];return t.addEach(e),t},Array.unzip=function(e){for(var t=[],n=1/0,r=0;r<e.length;r++){var i=e[r];e[r]=i.toArray(),i.length<n&&(n=i.length)}for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<i.length;o++)o<n&&o in i&&(t[o]=t[o]||[],t[o][r]=i[o]);return t},r("addEach",o.prototype.addEach),r("deleteEach",o.prototype.deleteEach),r("toArray",o.prototype.toArray),r("toObject",o.prototype.toObject),r("all",o.prototype.all),r("any",o.prototype.any),r("min",o.prototype.min),r("max",o.prototype.max),r("sum",o.prototype.sum),r("average",o.prototype.average),r("only",o.prototype.only),r("flatten",o.prototype.flatten),r("zip",o.prototype.zip),r("enumerate",o.prototype.enumerate),r("group",o.prototype.group),r("sorted",o.prototype.sorted),r("reversed",o.prototype.reversed),r("constructClone",function(e){var t=new this.constructor;return t.addEach(e),t}),r("has",function(e,t){return this.find(e,t)!==-1}),r("get",function(e,t){if(+e!==e)throw new Error("Indicies must be numbers");return!e in this?t:this[e]}),r("set",function(e,t){return this[e]=t,!0}),r("add",function(e){return this.push(e),!0}),r("delete",function(e,t){var n=this.find(e,t);return n!==-1&&(this.spliceOne(n),!0)}),r("deleteAll",function(e,t){t=t||this.contentEquals||Object.equals;for(var n=0,r=0;r<this.length;)t(e,this[r])?(this.swap(r,1),n++):r++;return n}),r("find",function(e,t){t=t||this.contentEquals||Object.equals;for(var n=0;n<this.length;n++)if(n in this&&t(e,this[n]))return n;return-1}),r("findLast",function(e,t){t=t||this.contentEquals||Object.equals;var n=this.length;do if(n--,n in this&&t(this[n],e))return n;while(n>0);return-1}),r("swap",function(e,t,n){var r,i,o,a,s;if(e>this.length&&(this.length=e),"undefined"!=typeof n){if(r=[e,t],Array.isArray(n)||(n=u.call(n)),o=0,i=n.length,i<1e3){for(o;o<i;o++)r[o+2]=n[o];return l.apply(this,r)}for(s=l.apply(this,r),o;o<i;){for(r=[e+o,0],a=2;a<1002&&o<i;a++,o++)r[a]=n[o];l.apply(this,r)}return s}return"undefined"!=typeof t?l.call(this,e,t):"undefined"!=typeof e?l.call(this,e):[]}),r("peek",function(){return this[0]}),r("poke",function(e){this.length>0&&(this[0]=e)}),r("peekBack",function(){if(this.length>0)return this[this.length-1]}),r("pokeBack",function(e){this.length>0&&(this[this.length-1]=e)}),r("one",function(){for(var e in this)if(Object.owns(this,e))return this[e]}),Array.prototype.clear||r("clear",function(){return this.length=0,this}),r("compare",function(e,t){t=t||Object.compare;var n,r,i,o,s;if(this===e)return 0;if(!e||!Array.isArray(e))return a.prototype.compare.call(this,e,t);for(r=this.length<e.length?this.length:e.length,n=0;n<r;n++)if(n in this){if(!(n in e))return-1;if(i=this[n],o=e[n],s=t(i,o))return s}else if(n in e)return 1;return this.length-e.length}),r("equals",function(e,t){t=t||Object.equals;var n,r,i=0,o=this.length;if(this===e)return!0;if(!e||!Array.isArray(e))return a.prototype.equals.call(this,e);if(o!==e.length)return!1;for(;i<o;++i)if(i in this){if(!(i in e))return!1;if(n=this[i],r=e[i],!t(n,r))return!1}else if(i in e)return!1;return!0}),r("clone",function(e,t){if(null==e)e=1/0;else if(0===e)return this;if(t=t||new s,t.has(this))return t.get(this);var n=new Array(this.length);t.set(this,n);for(var r in this)n[r]=Object.clone(this[r],e-1,t);return n}),r("iterate",function(e,t){return new i(this,e,t)}),void 0===Array.prototype.spliceOne&&r("spliceOne",function(e,t){var n=this.length;if(n)if(1===arguments.length){for(;e<n;)this[e]=this[e+1],e++;this.length--}else this[e]=t}),r("Iterator",i),i.prototype.__iterationObject=null,Object.defineProperty(i.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:null})}}),i.prototype.next=function(){return this.start===(null==this.end?this.array.length:this.end)?(this._iterationObject.done=!0,this._iterationObject.value=void 0):this._iterationObject.value=this.array[this.start++],this._iterationObject}}}),montageDefine("449c0c3","shim-object",{dependencies:["./weak-map"],factory:function(e,t,n){"use strict";var r=e("./weak-map");n.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.isObject=function(e){return Object(e)===e},Object.getValueOf=function(e){return e&&"function"==typeof e.valueOf&&(e=e.valueOf()),e};var i=new r;Object.hash=function(e){return e&&"function"==typeof e.hash?""+e.hash():Object(e)===e?(i.has(e)||i.set(e,Math.random().toString(36).slice(2)),i.get(e)):""+e};var o=Object.prototype.hasOwnProperty;Object.owns=function(e,t){return o.call(e,t)},Object.has=function(e,t){if("object"!=typeof e)throw new Error("Object.has can't accept non-object: "+typeof e);if(e&&"function"==typeof e.has)return e.has(t);if("string"==typeof t)return t in e&&e[t]!==Object.prototype[t];throw new Error("Key must be a string for Object.has on plain objects")},Object.get=function(e,t,n){if("object"!=typeof e)throw new Error("Object.get can't accept non-object: "+typeof e);return e&&"function"==typeof e.get?e.get(t,n):Object.has(e,t)?e[t]:n},Object.set=function(e,t,n){e&&"function"==typeof e.set?e.set(t,n):e[t]=n},Object.addEach=function(e,t,n){var r=3!==arguments.length||n;if(t)if("function"!=typeof t.forEach||t.hasOwnProperty("forEach"))if("number"==typeof t.length)for(var i=0;i<t.length;i++)e[i]=t[i];else for(var o,a=Object.keys(t),s=0;o=a[s];s++)!r&&Object.owns(e,o)||(e[o]=t[o]);else t.isMap===!0?t.forEach(function(t,n){e[n]=t}):t.forEach(function(t){e[t[0]]=t[1]});return e},Object.defineEach=function(e,t,n,r,i,o){var a=3!==arguments.length||n;if(t)if("function"!=typeof t.forEach||t.hasOwnProperty("forEach"))if("number"==typeof t.length)for(var s=0;s<t.length;s++)Object.defineProperty(e,s,{value:t[s],writable:o,configurable:r,enumerable:i});else for(var l,u=Object.keys(t),c=0;l=u[c];c++)!a&&Object.owns(e,l)||Object.defineProperty(e,l,{value:t[l],writable:o,configurable:r,enumerable:i});else t.isMap===!0?t.forEach(function(t,n){Object.defineProperty(e,n,{value:t,writable:o,configurable:r,enumerable:i})}):t.forEach(function(t){Object.defineProperty(e,t[0],{value:t[1],writable:o,configurable:r,enumerable:i})});return e},Object.forEach=function(e,t,n){for(var r,i=Object.keys(e),o=0;r=i[o];o++)t.call(n,e[r],r,e)},Object.map=function(e,t,n){for(var r,i=Object.keys(e),o=0,a=[];r=i[o];o++)a.push(t.call(n,e[r],r,e));return a},Object.values=function(e){return Object.map(e,Function.identity)},Object.concat=function(){for(var e={},t=0;t<arguments.length;t++)Object.addEach(e,arguments[t]);return e},Object.from=Object.concat,Object.is=function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t},Object.equals=function(e,t,n,i){if(n=n||Object.equals,e=Object.getValueOf(e),t=Object.getValueOf(t),e===t)return!0;if(Object.isObject(e)){if(i=i||new r,i.has(e))return!0;i.set(e,!0)}if(Object.isObject(e)&&"function"==typeof e.equals)return e.equals(t,n,i);if(Object.isObject(t)&&"function"==typeof t.equals)return t.equals(e,n,i);if(Object.isObject(e)&&Object.isObject(t)&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype){for(var o in e)if(!n(e[o],t[o],n,i))return!1;for(var o in t)if(!(o in e&&n(t[o],e[o],n,i)))return!1;return!0}return e!==e&&t!==t||(!e||!t)&&e===t},Object.compare=function(e,t){if(e=Object.getValueOf(e),t=Object.getValueOf(t),e===t)return 0;var n=typeof e,r=typeof t;return"number"===n&&"number"===r?e-t:"string"===n&&"string"===r?e<t?-(1/0):1/0:e&&"function"==typeof e.compare?e.compare(t):t&&"function"==typeof t.compare?-t.compare(e):0},Object.clone=function(e,t,n){if(e=Object.getValueOf(e),n=n||new r,void 0===t)t=1/0;else if(0===t)return e;if(Object.isObject(e)){if(!n.has(e))if(e&&"function"==typeof e.clone)n.set(e,e.clone(t,n));else{var i=Object.getPrototypeOf(e);if(null!==i&&i!==Object.prototype)throw new Error("Can't clone "+e);var o=Object.create(i);n.set(e,o);for(var a in e)o[a]=Object.clone(e[a],t-1,n)}return n.get(e)}return e},Object.clear=function(e){if(e&&"function"==typeof e.clear)e.clear();else for(var t=Object.keys(e),n=t.length;n;)n--,delete e[t[n]];return e}}}),montageDefine("449c0c3","shim-function",{dependencies:[],factory:function(e,t,n){n.exports=Function,Function.noop=function(){},Function.identity=function(e){return e},Function.by=function(e,t){t=t||Object.compare,e=e||Function.identity;var n=function(n,r){return t(e(n),e(r))};return n.compare=t,n.by=e,n},Function.get=function(e){return function(t){return Object.get(t,e)}}}}),montageDefine("449c0c3","shim-regexp",{dependencies:[],factory:function(e,t,n){if(!RegExp.escape){var r=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(e){return e.replace(r,"\\$&")}}}}),montageDefine("449c0c3","_map",{dependencies:["./shim","./generic-collection","map","./_set","./generic-map","map"],factory:function(e,t,n){"use strict";var r,i,o,a=(e("./shim"),e("./generic-collection"));if(void 0!==global.Map&&"function"==typeof global.Set.prototype.values){
r=n.exports=global.Map,i=r,r.Map=r;var s,l={}.__proto__===Object.prototype;s=l?function(){this.__proto__=m}:function(){Object.defineProperties(this,observableSetProperties)},Object.defineProperty(r.prototype,"makeObservable",{value:s,writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(r.prototype,"makePropertyObservable",{value:function(){},writable:!0,configurable:!0,enumerable:!1}),r.prototype.constructClone=function(e){return new this.constructor(e)},r.prototype.isMap=!0,r.prototype.addEach=function(e){if(e&&Object(e)===e)if("function"==typeof e.forEach)e.isMap===!0?e.forEach(function(e,t){this.set(t,e)},this):e.forEach(function(e){this.set(e[0],e[1])},this);else if("number"==typeof e.length)for(var t=0;t<e.length;t++)this.add(e[t],t);else Object.keys(e).forEach(function(t){this.set(t,e[t])},this);else if(e&&"number"==typeof e.length)for(var t=0;t<e.length;t++)this.add(e[t],t);return this},r.prototype.add=function(e,t){return this.set(t,e)},r.prototype.reduce=function(e,t){var n=arguments[2];return this.forEach(function(r,i,o){t=e.call(n,t,r,i,this)}),t},r.prototype.reduceRight=function(e,t){for(var n,r=arguments[2],i=this.keys(),o=this.size,a=new Array(this.size),s=0;n=i.next().value;)a[--o]=n;for(;s++<o;)t=e.call(r,t,this.get(a[s]),a[s],this);return t},r.prototype.equals=function(e,t){if(t=t||Object.equals,this===e)return!0;if(e&&"function"==typeof e.every)return e.size===this.size&&e.every(function(e,n){return t(this.get(n),e)},this);var n=Object.keys(e);return n.length===this.size&&Object.keys(e).every(function(n){return t(this.get(n),e[n])},this)};var u=function(e,t){return t};r.prototype.keysArray=function(){return this.map(u)};var c=function(e,t){return e};r.prototype.valuesArray=function(){return this.map(c)};var h=function(e,t){return[t,e]};r.prototype.entriesArray=function(){return this.map(h)},r.prototype.toJSON=function(){return this.entriesArray()},r.prototype.items=function(){return this.entriesArray()},r.from=function(e){var t=new this;return t.addEach(e),t},Object.defineProperty(r.prototype,"length",{get:function(){return this.size},enumerable:!0,configurable:!0});var p=r.prototype.clear,d=r.prototype.set,f=r.prototype["delete"],v={clear:{value:function(){var e;this.dispatchesMapChanges&&(this.forEach(function(e,t){this.dispatchBeforeMapChange(t,e)},this),e=this.keysArray()),p.call(this),this.dispatchesMapChanges&&e.forEach(function(e){this.dispatchMapChange(e)},this)},writable:!0,configurable:!0},set:{value:function(e,t){var n=this.get(e);return n?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,n),d.call(this,e,t),this.dispatchesMapChanges&&this.dispatchMapChange(e,t)):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,void 0),d.call(this,e,t),this.dispatchesMapChanges&&this.dispatchMapChange(e,t)),this},writable:!0,configurable:!0},"delete":{value:function(e){return!!this.has(e)&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this.get(e)),f.call(this,e),this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0)}}};Object.addEach(r.prototype,a.prototype,!1);var m=Object.create(r.prototype,v)}var g=e("./_set").CollectionsSet,_=e("./generic-map");o=r=function b(e,t,n,r){return this instanceof b?(t=t||Object.equals,n=n||Object.hash,r=r||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=r,this.store=new g((void 0),function(e,n){return t(e.key,n.key)},function(e){return n(e.key)}),this.length=0,void this.addEach(e)):new b(e,t,n,r)},r.Map=r,Object.addEach(r.prototype,a.prototype),Object.addEach(r.prototype,_.prototype),Object.defineProperty(r.prototype,"size",a._sizePropertyDescriptor),r.from=a.from,r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},r.prototype.log=function(e,t,n,r){t=t||this.logNode,this.store.log(e,function(e,n,r){t(e.value.value,n,r)},n,r)},r.prototype.logNode=function(e,t){t(" key: "+e.key),t(" value: "+e.value)},i?(n.exports=i,i.CollectionsMap=o):n.exports=o}}),montageDefine("449c0c3","listen/map-changes",{dependencies:["../weak-map","../_map","./change-descriptor"],factory:function(e,t,n){"use strict";function r(){throw new Error("Can't construct. MapChanges is a mixin.")}function i(e){this.name=e,this.isActive=!1,this._willChangeListeners=null,this._changeListeners=null}function o(e){var t=f.get(e);return t||(t="handle",t+=e.slice(0,1).toUpperCase(),t+=e.slice(1),t+="MapChange",f.set(e,t)),this.specificHandlerMethodName=t,this}function a(e){var t=v.get(e);return t||(t="handle",t+=e.slice(0,1).toUpperCase(),t+=e.slice(1),t+="MapWillChange",v.set(e,t)),this.specificHandlerMethodName=t,this}var s=e("../weak-map"),l=e("../_map"),u=e("./change-descriptor"),c=u.ObjectChangeDescriptor,h=u.ChangeListenersRecord,p=u.ListenerGhost;n.exports=r;var d=(Object.prototype.hasOwnProperty,new s);i.prototype=new c,i.prototype.constructor=i,i.prototype.changeListenersRecordConstructor=o,i.prototype.willChangeListenersRecordConstructor=a;var f=new l;o.prototype=new h,o.prototype.constructor=o,o.prototype.genericHandlerMethodName="handleMapChange";var v=new l;a.prototype=new h,a.prototype.constructor=a,a.prototype.genericHandlerMethodName="handleMapWillChange",r.prototype.getAllMapChangeDescriptors=function(){return d.has(this)||d.set(this,new l),d.get(this)},r.prototype.getMapChangeDescriptor=function(e){var t=this.getAllMapChangeDescriptors();return e=e||"",t.has(e)||t.set(e,new i(e)),t.get(e)};var m=new s,g=function(){return m.get(this)},_=function(e){return m.set(this,e)},b="dispatchesMapChanges",y={get:g,set:_,configurable:!0,enumerable:!1};r.prototype.addMapChangeListener=function(e,t,n){!this.isObservable&&this.makeObservable&&this.makeObservable();var r,i=this.getMapChangeDescriptor(t);r=n?i.willChangeListeners:i.changeListeners,r._current?Array.isArray(r._current)?r._current.push(e):r._current=[r._current,e]:r._current=e,void 0===Object.getOwnPropertyDescriptor(this.__proto__||Object.getPrototypeOf(this),b)&&Object.defineProperty(this.__proto__||Object.getPrototypeOf(this),b,y),this.dispatchesMapChanges=!0;var o=this;return function(){o&&(o.removeMapChangeListener(e,t,n),o=null)}},r.prototype.removeMapChangeListener=function(e,t,n){var r,i=this.getMapChangeDescriptor(t);if(r=n?i.willChangeListeners:i.changeListeners,r._current)if(r._current===e)r._current=null;else{var o=r._current.lastIndexOf(e);if(o===-1)throw new Error("Can't remove map change listener: does not exist: token "+JSON.stringify(t));i.isActive?(r.ghostCount=r.ghostCount+1,r._current[o]=p):r._current.spliceOne(o)}},r.prototype.dispatchMapChange=function(e,t,n){var r=this.getAllMapChangeDescriptors(),i=p;r.forEach(function(r,o){if(!r.isActive){var a=n?r.willChangeListeners:r.changeListeners;if(a&&a._current){var s=a.specificHandlerMethodName;if(Array.isArray(a._current)&&a._current.length){var l,u,c,h=a.removeCurrentGostListenersIfNeeded();r.isActive=!0;try{for(l=0,u=h.length;l<u;l++)if((c=h[l])!==i)if(c[s])c[s](t,e,this);else{if(!c.call)throw new Error("Handler "+c+" has no method "+s+" and is not callable");c.call(c,t,e,this)}}finally{r.isActive=!1}}else{r.isActive=!0;try{if(c=a._current,c[s])c[s](t,e,this);else{if(!c.call)throw new Error("Handler "+c+" has no method "+s+" and is not callable");c.call(c,t,e,this)}}finally{r.isActive=!1}}}}},this)},r.prototype.addBeforeMapChangeListener=function(e,t){return this.addMapChangeListener(e,t,!0)},r.prototype.removeBeforeMapChangeListener=function(e,t){return this.removeMapChangeListener(e,t,!0)},r.prototype.dispatchBeforeMapChange=function(e,t){return this.dispatchMapChange(e,t,!0)}}}),montageDefine("449c0c3","_set",{dependencies:["./shim","./generic-collection","./generic-set","set","./_list","./_fast-set","./iterator","set"],factory:function(e,t,n){"use strict";var r,i,o=(e("./shim"),e("./generic-collection")),a=e("./generic-set");void 0!==global.Set&&"function"==typeof global.Set.prototype.values&&(r=n.exports=global.Set,r.Set=r,r.prototype.reduce=function(e,t){var n=arguments[2];return this.forEach(function(r){t=e.call(n,t,r,this)}),t},r.prototype.reduceRight=function(e,t){for(var n,r=arguments[2],i=this.values(),o=this.size,a=new Array(this.size),s=0;n=i.next().value;)a[--o]=n;for(;s++<o;)t=e.call(r,t,n,this);return t},r.prototype.equals=function(e,t){var n=this;return e&&"function"==typeof e.reduce&&this.size===(e.size||e.length)&&e.reduce(function(e,r){return e&&n.has(r,t)},!0)},r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},r.prototype.toJSON=function(){return this.entriesArray()},r.prototype.one=function(){if(this.size>0)return this.values().next().value},r.prototype.pop=function(){if(this.size){for(var e,t,n=this.values();e=n.next().value;)t=e;return this["delete"](t,this.size-1),t}},r.prototype.shift=function(){if(this.size){var e=this.values().next().value;return this["delete"](e,0),e}},Object.defineProperty(r.prototype,"length",{get:function(){return this.size},enumerable:!0,configurable:!0}),r.from=function(e){var t=new this;return t.addEach(e),t},Object.addEach(r.prototype,o.prototype,!1),Object.addEach(r.prototype,a.prototype,!1));var s=e("./_list"),l=e("./_fast-set"),u=e("./iterator");i=function c(e,t,n,r){return c._init(c,this,e,t,n,r)},i._init=function(e,t,n,r,i,o){return t instanceof e?(r=r||Object.equals,i=i||Object.hash,o=o||Function.noop,t.contentEquals=r,t.contentHash=i,t.getDefault=o,t.order=new t.Order((void 0),r),t.store=new t.Store((void 0),function(e,t){return r(e.value,t.value)},function(e){return i(e.value)}),t.length=0,void t.addEach(n)):new e(n,r,i,o)},i.Set=i,i.CollectionsSet=i,Object.addEach(i.prototype,o.prototype),Object.addEach(i.prototype,a.prototype),i.from=o.from,Object.defineProperty(i.prototype,"size",o._sizePropertyDescriptor),i.prototype.Order=s,i.prototype.Store=l,i.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},i.prototype.has=function(e){var t=new this.order.Node(e);return this.store.has(t)},i.prototype.get=function(e,t){if(t)throw new Error("Set#get does not support second argument: equals");var n=new this.order.Node(e);return n=this.store.get(n),n?n.value:this.getDefault(e)},i.prototype.add=function(e){var t=new this.order.Node(e);return!this.store.has(t)&&(this.length,this.order.add(e),t=this.order.head.prev,this.store.add(t),this.length++,!0)},i.prototype["delete"]=function(e,t){if(t)throw new Error("Set#delete does not support second argument: equals");var n=new this.order.Node(e);return!!this.store.has(n)&&(n=this.store.get(n),this.store["delete"](n),this.order.splice(n,1),this.length--,!0)},i.prototype.pop=function(){if(this.length){var e=this.order.head.prev.value;return this["delete"](e),e}},i.prototype.shift=function(){if(this.length){var e=this.order.head.next.value;return this["delete"](e),e}},i.prototype.one=function(){if(this.length>0)return this.store.one().value},i.prototype.clear=function(){this.store.clear(),this.order.clear(),this.length=0},Object.defineProperty(i.prototype,"_clear",{value:i.prototype.clear}),i.prototype.reduce=function(e,t){var n=arguments[2],r=this.order,i=0;return r.reduce(function(t,r){return e.call(n,t,r,i++,this)},t,this)},i.prototype.reduceRight=function(e,t){var n=arguments[2],r=this.order,i=this.length-1;return r.reduceRight(function(t,r){return e.call(n,t,r,i--,this)},t,this)},i.prototype.iterate=function(){return this.order.iterate()},i.prototype.values=function(){return new u(this.valuesArray())},i.prototype.log=function(){var e=this.store;return e.log.apply(e,arguments)},r?(r.prototype.valuesArray=a.prototype.valuesArray,r.prototype.entriesArray=a.prototype.entriesArray,n.exports=r,r.CollectionsSet=i):n.exports=i}}),montageDefine("449c0c3","listen/range-changes",{dependencies:["../weak-map","../_map","./change-descriptor"],factory:function(e,t,n){"use strict";function r(e){this.name=e,this.isActive=!1,this._willChangeListeners=null,this._changeListeners=null}function i(e){var t=f.get(e);return t||(t="handle",t+=e.slice(0,1).toUpperCase(),t+=e.slice(1),t+="RangeChange",f.set(e,t)),this.specificHandlerMethodName=t,this}function o(e){var t=v.get(e);return t||(t="handle",t+=e.slice(0,1).toUpperCase(),t+=e.slice(1),t+="RangeWillChange",v.set(e,t)),this.specificHandlerMethodName=t,this}function a(){throw new Error("Can't construct. RangeChanges is a mixin.")}var s=e("../weak-map"),l=e("../_map"),u=e("./change-descriptor"),c=u.ObjectChangeDescriptor,h=u.ChangeListenersRecord,p=u.ListenerGhost,d=new s;r.prototype=new c,r.prototype.constructor=r,r.prototype.changeListenersRecordConstructor=i,r.prototype.willChangeListenersRecordConstructor=o,Object.defineProperty(r.prototype,"active",{get:function(){return this._active||(this._active=this._current?this._current.slice():[])}});var f=new l;i.prototype=new h,i.prototype.constructor=i;var v=new l;o.prototype=new h,o.prototype.constructor=o,n.exports=a,a.prototype.getAllRangeChangeDescriptors=function(){return d.has(this)||d.set(this,new l),d.get(this)},a.prototype.getRangeChangeDescriptor=function(e){var t=this.getAllRangeChangeDescriptors();return e=e||"",t.has(e)||t.set(e,new r(e)),t.get(e)};var m=new s,g=function(){return m.get(this)},_=function(e){return m.set(this,e)},b="dispatchesRangeChanges",y={get:g,set:_,configurable:!0,enumerable:!1};a.prototype.addRangeChangeListener=function(e,t,n){!this.isObservable&&this.makeObservable&&this.makeObservable();var r,i=this.getRangeChangeDescriptor(t);r=n?i.willChangeListeners:i.changeListeners,r._current?Array.isArray(r._current)?r._current.push(e):r._current=[r._current,e]:r._current=e,void 0===Object.getOwnPropertyDescriptor(this.__proto__||Object.getPrototypeOf(this),b)&&Object.defineProperty(this.__proto__||Object.getPrototypeOf(this),b,y),this.dispatchesRangeChanges=!0;var o=this;return function(){o&&(o.removeRangeChangeListener(e,t,n),o=null)}},a.prototype.removeRangeChangeListener=function(e,t,n){var r,i=this.getRangeChangeDescriptor(t);if(r=n?i._willChangeListeners:i._changeListeners,r._current)if(r._current===e)r._current=null;else{var o=r._current.lastIndexOf(e);if(o===-1)throw new Error("Can't remove range change listener: does not exist: token "+JSON.stringify(t));i.isActive?(r.ghostCount=r.ghostCount+1,r._current[o]=p):r._current.spliceOne(o)}},a.prototype.dispatchRangeChange=function(e,t,n,r){var i,o,a,s,l,u,c,h,d=this.getAllRangeChangeDescriptors(),f=d.values();for(d.dispatchBeforeChange=r;i=f.next().value;){if(i.isActive)return;if(o=r?i._willChangeListeners:i._changeListeners,o&&o._current)if(a=o.specificHandlerMethodName,Array.isArray(o._current)){if(o._current.length){i.isActive=!0;try{for(c=o.removeCurrentGostListenersIfNeeded(),h=p,s=0,l=c.length;s<l;s++)if((u=c[s])!==h)if(u[a])u[a](e,t,n,this,r);else{if(!u.call)throw new Error("Handler "+u+" has no method "+a+" and is not callable");u.call(this,e,t,n,this,r)}}finally{i.isActive=!1}}}else{i.isActive=!0;try{if(u=o._current,u[a])u[a](e,t,n,this,r);else{if(!u.call)throw new Error("Handler "+u+" has no method "+a+" and is not callable");u.call(this,e,t,n,this,r)}}finally{i.isActive=!1}}}},a.prototype.addBeforeRangeChangeListener=function(e,t){return this.addRangeChangeListener(e,t,!0)},a.prototype.removeBeforeRangeChangeListener=function(e,t){return this.removeRangeChangeListener(e,t,!0)},a.prototype.dispatchBeforeRangeChange=function(e,t,n){return this.dispatchRangeChange(e,t,n,!0)}}}),montageDefine("449c0c3","list",{dependencies:["./_list","./listen/property-changes","./listen/range-changes","list"],factory:function(e,t,n){"use strict";function r(e,t,n){return i._init(r,this,e,t,n)}var i=e("./_list"),o=e("./listen/property-changes"),a=e("./listen/range-changes");n.exports=r,r.prototype=new i,r.prototype.constructor=r,r.List=r,r.from=i.from,Object.addEach(r.prototype,o.prototype),Object.addEach(r.prototype,a.prototype),r.prototype.makeObservable=function(){this.head.index=-1,this.updateIndexes(this.head.next,0),this.dispatchesRangeChanges=!0},Object.defineProperties(r.prototype,{_dispatchEmptyArray:{value:[]}}),r.prototype["delete"]=function(e,t){var n=this.findLast(e,t);if(n){if(this.dispatchesRangeChanges){var r=[],i=[e];this.dispatchBeforeRangeChange(r,i,n.index)}return n["delete"](),this.length--,this.dispatchesRangeChanges&&(this.updateIndexes(n.next,n.index),this.dispatchRangeChange(r,i,n.index)),!0}return!1},Object.defineProperty(r.prototype,"superClear",{value:i.prototype.clear,enumerable:!1,configurable:!0,writable:!0}),r.prototype.clear=function(){var e,t;this.dispatchesRangeChanges&&(t=this.toArray(),e=[],this.dispatchBeforeRangeChange(e,t,0)),this.superClear(),this.dispatchesRangeChanges&&this.dispatchRangeChange(e,t,0)},r.prototype.add=function(e){var t=new this.Node(e);return this.dispatchesRangeChanges&&(t.index=this.length,this.dispatchBeforeRangeChange([e],[],t.index)),this._addNode(t),this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],t.index),!0},Object.defineProperty(r.prototype,"superPush",{value:i.prototype.push,enumerable:!1,configurable:!0,writable:!0}),r.prototype.push=function(){if(this.dispatchesRangeChanges){var e=Array.prototype.slice.call(arguments),t=[],n=this.length;this.dispatchBeforeRangeChange(e,t,n);var r=this.head.prev}1===arguments.length?this.superPush.call(this,arguments[0]):2===arguments.length?this.superPush.call(this,arguments[0],arguments[1]):this.superPush.apply(this,arguments),this.dispatchesRangeChanges&&(this.updateIndexes(r.next,void 0===r.index?0:r.index+1),this.dispatchRangeChange(e,t,n))},Object.defineProperty(r.prototype,"superUnshift",{value:i.prototype.unshift,enumerable:!1,configurable:!0,writable:!0}),r.prototype.unshift=function(){if(this.dispatchesRangeChanges){var e=Array.prototype.slice.call(arguments),t=[];this.dispatchBeforeRangeChange(e,t,0)}1===arguments.length?this.superUnshift.call(this,arguments[0]):2===arguments.length?this.superUnshift.call(this,arguments[0],arguments[1]):this.superUnshift.apply(this,arguments),this.dispatchesRangeChanges&&(this.updateIndexes(this.head.next,0),this.dispatchRangeChange(e,t,0))},Object.defineProperty(r.prototype,"_beforePop",{value:function(e,t){var n;return this.dispatchesRangeChanges&&(n=[e],this.dispatchBeforeRangeChange(this._dispatchEmptyArray,n,t)),n},enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(r.prototype,"_afterPop",{value:function(e,t,n){this.dispatchesRangeChanges&&this.dispatchRangeChange(this._dispatchEmptyArray,n,t)},enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(r.prototype,"superPop",{value:i.prototype.pop,enumerable:!1,configurable:!0,writable:!0}),r.prototype.pop=function(){return this.superPop(this._beforePop,this._afterPop)},Object.defineProperty(r.prototype,"_beforeShift",{value:function(e,t){var n;return this.dispatchesRangeChanges&&(n=[e],this.dispatchBeforeRangeChange(this._dispatchEmptyArray,n,t)),n},enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(r.prototype,"_afterShift",{value:function(e,t,n){this.dispatchesRangeChanges&&(this.updateIndexes(this.head.next,t),this.dispatchRangeChange(this._dispatchEmptyArray,n,t))},enumerable:!1,configurable:!0,writable:!0}),Object.defineProperty(r.prototype,"superShift",{value:i.prototype.shift,enumerable:!1,configurable:!0,writable:!0}),r.prototype.shift=function(){return this.superShift(this._beforeShift,this._afterShift)},Object.defineProperty(r.prototype,"superSwap",{value:i.prototype.swap,enumerable:!1,configurable:!0,writable:!0}),r.prototype.swap=function(e,t,n){var r,i,o=function(e,t,n){this.dispatchesRangeChanges&&(r=e===this.head?this.length:e.prev===this.head?0:e.index,i=e.prev,this.dispatchBeforeRangeChange(t,n,r))},a=function(e,t,n){this.dispatchesRangeChanges&&(e===this.head?this.updateIndexes(this.head.next,0):this.updateIndexes(i.next,i.index+1),this.dispatchRangeChange(t,n,r))};return this.superSwap(e,t,n,o,a)},Object.defineProperty(r.prototype,"superReverse",{value:i.prototype.reverse,enumerable:!1,configurable:!0,writable:!0}),r.prototype.reverse=function(){if(this.dispatchesRangeChanges){var e=this.toArray(),t=e.reversed();this.dispatchBeforeRangeChange(t,e,0)}return this.superReverse(),this.dispatchesRangeChanges&&this.dispatchRangeChange(t,e,0),this}}}),montageDefine("449c0c3","fast-set",{dependencies:["./shim","./_fast-set","./listen/property-changes"],factory:function(e,t,n){"use strict";var r=(e("./shim"),e("./_fast-set")),i=e("./listen/property-changes");n.exports=r,Object.addEach(r.prototype,i.prototype)}}),montageDefine("449c0c3","listen/change-descriptor",{dependencies:["../_map"],factory:function(e,t,n){function r(e){var t=l.get(e);return t||(t="handle",t+=e,t+="Change",l.set(e,t)),this._current=null,this._current=null,this.specificHandlerMethodName=t,this}function i(e){var t=u.get(e);return t||(t="handle",t+=e,t+="WillChange",u.set(e,t)),this.specificHandlerMethodName=t,this}var o=e("../_map"),a=n.exports.ObjectChangeDescriptor=function(e){return this.name=e,this.isActive=!1,this._willChangeListeners=null,this._changeListeners=null,this};Object.defineProperties(a.prototype,{name:{value:null,writable:!0},isActive:{value:!1,writable:!0},_willChangeListeners:{value:null,writable:!0},willChangeListeners:{get:function(){return this._willChangeListeners||(this._willChangeListeners=new this.willChangeListenersRecordConstructor(this.name))}},_changeListeners:{value:null,writable:!0},changeListeners:{get:function(){return this._changeListeners||(this._changeListeners=new this.changeListenersRecordConstructor(this.name))}},changeListenersRecordConstructor:{value:r,writable:!0},willChangeListenersRecordConstructor:{value:r,writable:!0}});var s=n.exports.ListenerGhost=Object.create(null),l=new o;n.exports.ChangeListenersRecord=r,Object.defineProperties(r.prototype,{_current:{value:null,writable:!0},current:{get:function(){return this._current},set:function(e){this._current=e}},ListenerGhost:{value:s,writable:!0},ghostCount:{value:0,writable:!0},maxListenerGhostRatio:{value:.3,writable:!0},listenerGhostFilter:{value:function(e){return e!==this.ListenerGhost}},removeCurrentGostListenersIfNeeded:{value:function(){return this._current&&this.ghostCount/this._current.length>this.maxListenerGhostRatio&&(this.ghostCount=0,this._current=this._current.filter(this.listenerGhostFilter,this)),this._current}},dispatchBeforeChange:{value:!1,writable:!0},genericHandlerMethodName:{value:"handlePropertyChange",writable:!0}}),n.exports.WillChangeListenersRecord=i;var u=new o;i.prototype=new r,i.prototype.constructor=i,i.prototype.genericHandlerMethodName="handlePropertyWillChange"}}),montageDefine("449c0c3","listen/array-changes",{dependencies:["../shim","./property-changes","./range-changes","./map-changes"],factory:function(e,t,n){e("../shim");var r,i=(Array.prototype.splice,Array.prototype.spliceOne),o=Array.prototype.slice,a=(Array.prototype.reverse,Array.prototype.sort),s=Array.prototype.swap,l=Array.prototype.push,u={}.__proto__===Object.prototype,c="length";r=u?function(){this.__proto__=p}:function(){Object.defineProperties(this,h)},Object.defineProperty(Array.prototype,"makeObservable",{value:r,writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Array.prototype,"makePropertyObservable",{value:function(){},writable:!0,configurable:!0,enumerable:!1});var h={isObservable:{value:!0,writable:!0,configurable:!0},makeObservable:{value:Function.noop,writable:!0,configurable:!0},reverse:{value:function(){var e=this.constructClone(this);return e.reverse(),this.swap(0,this.length,e),this},writable:!0,configurable:!0},sort:{value:function(){var e,t;for(this.dispatchBeforeRangeChange(this,this,0),e=0,t=this.length;e<t;e++)d.dispatchBeforeOwnPropertyChange(this,e,this[e]),this.dispatchBeforeMapChange(e,this[e]);for(a.apply(this,arguments),e=0,t=this.length;e<t;e++)d.dispatchOwnPropertyChange(this,e,this[e]),this.dispatchMapChange(e,this[e]);return this.dispatchRangeChange(this,this,0),this},writable:!0,configurable:!0},_dispatchBeforeOwnPropertyChange:{value:function(e,t){for(var n=e,r=e+t;n<r;n++)d.dispatchBeforeOwnPropertyChange(this,n,this[n]),this.dispatchBeforeMapChange(n,this[n])}},_dispatchOwnPropertyChange:{value:function(e,t){for(var n=e,r=e+t;n<r;n++)this.dispatchOwnPropertyChange(n,this[n]),this.dispatchMapChange(n,this[n])}},swap:{value:function(e,t,n){var r,i,a,l;if(n?Array.isArray(n)||(n=o.call(n)):n=Array.empty,l=n.length,e<0)e=this.length+e;else if(e>this.length){var u=e-this.length,h=Array(u+l);for(i=0,a=u;i<l;i++,a++)i in n&&(h[a]=n[i]);n=h,l=n.length,e=this.length}var p;if(0===t){if(0===l)return[];p=Array.empty}else p=o.call(this,e,e+t);var f=l-p.length,v=this.length,m=Math.max(this.length+f,e+l),g=v>m?v:m;f&&d.dispatchBeforeOwnPropertyChange(this,c,this.length),this.dispatchBeforeRangeChange(n,p,e),0===f?this._dispatchBeforeOwnPropertyChange(e,l):(r=d.hasOwnPropertyChangeDescriptor(this))&&this._dispatchBeforeOwnPropertyChange(e,g-e),e>v&&(this.length=e);var _=s.call(this,e,t,n);return 0===f?this._dispatchOwnPropertyChange(e,l):r&&this._dispatchOwnPropertyChange(e,g-e),this.dispatchRangeChange(n,p,e),f&&this.dispatchOwnPropertyChange(c,this.length),_},writable:!0,configurable:!0},splice:{value:function(e,t){return e>this.length&&(e=this.length),this.swap.call(this,e,t,o.call(arguments,2))},writable:!0,configurable:!0},spliceOne:{value:function(e,t){var n,r,o,a,s,l=this.length,u=arguments.length;1===u?(d.dispatchBeforeOwnPropertyChange(this,c,this.length),o=this.length-1,n=Array.empty):(n=[t],o=this.length),r=[this[e]],a=l>o?l:o,this.dispatchBeforeRangeChange(n,r,e),2===u?this._dispatchBeforeOwnPropertyChange(e,1):(s=d.hasOwnPropertyChangeDescriptor(this))&&this._dispatchBeforeOwnPropertyChange(e,a-e),1===u?i.call(this,e):i.call(this,e,t),2===u?this._dispatchOwnPropertyChange(e,1):s&&this._dispatchOwnPropertyChange(e,a-e),this.dispatchRangeChange(n,r,e),1===u&&this.dispatchOwnPropertyChange(c,this.length)},writable:!0,configurable:!0},_setSwapBuffer:{get:function(){return this.__setSwapBuffer||Object.defineProperty(this,"__setSwapBuffer",{value:[],writable:!0,configurable:!0,enumerable:!1}).__setSwapBuffer},enumerable:!1},set:{value:function(e,t){var n,r,i,o,a=void 0!==typeof t,s=a?[]:Array.empty;return e>=this.length?(s[e-this.length]=t,n=e+1-this.length,i=this.length):(s[0]=t,n=0,i=e),r=0===n?[this[e]]:Array.empty,n>0&&d.dispatchBeforeOwnPropertyChange(this,c,this.length),this.dispatchBeforeRangeChange(s,r,i),0===n?this._dispatchBeforeOwnPropertyChange(i,1):(o=d.hasOwnPropertyChangeDescriptor(this))&&this._dispatchBeforeOwnPropertyChange(i,n),this[e]=t,0===n?this._dispatchOwnPropertyChange(i,1):o&&this._dispatchOwnPropertyChange(i,n),this.dispatchRangeChange(s,r,i),n&&this.dispatchOwnPropertyChange(c,this.length),!0},writable:!0,configurable:!0},shift:{value:function(){return this.splice(0,1)[0]},writable:!0,configurable:!0},pop:{value:function(){if(this.length)return this.splice(this.length-1,1)[0]},writable:!0,configurable:!0},push:{value:function(e){var t,n,r=this.length,i=arguments.length;t=1===i?[arguments[0]]:Array.apply(null,arguments),i>0&&(d.dispatchBeforeOwnPropertyChange(this,c,r),this.dispatchBeforeRangeChange(t,Array.empty,r),(n=d.hasOwnPropertyChangeDescriptor(this))&&this._dispatchBeforeOwnPropertyChange(r,i)),l.apply(this,arguments),i>0&&(n&&this._dispatchOwnPropertyChange(r,i),this.dispatchRangeChange(t,Array.empty,r),this.dispatchOwnPropertyChange(c,this.length))},writable:!0,configurable:!0},unshift:{value:function(e){if(1===arguments.length)return this.splice(0,0,e);var t=o.call(arguments);return this.swap(0,0,t)},writable:!0,configurable:!0},clear:{value:function(){return this.splice(0,this.length)},writable:!0,configurable:!0}},p=Object.create(Array.prototype,h);t.observableArrayProperties=h;var d=e("./property-changes"),f=e("./range-changes"),v=e("./map-changes");Object.defineEach(Array.prototype,d.prototype,!1,!0,!1,!0),Object.defineEach(Array.prototype,f.prototype,!1,!0,!1,!0),Object.defineEach(Array.prototype,v.prototype,!1,!0,!1,!0)}}),montageDefine("449c0c3","sorted-array",{dependencies:["./shim","./generic-collection","./listen/property-changes","./listen/range-changes"],factory:function(e,t,n){"use strict";function r(e,t,n,i){return this instanceof r?(Array.isArray(e)?(this.array=e,e=e.splice(0,e.length)):this.array=[],this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.getDefault=i||Function.noop,this.length=0,void this.addEach(e)):new r(e,t,n,i)}function i(e,t,n){for(var r=0,i=e.length-1;r<=i;){var o=r+i>>1,a=n(t,e[o]);if(a>0)r=o+1;else{if(!(a<0))return o;i=o-1}}return-(r+1)}function o(e,t,n,r){var o=i(e,t,n);if(o<0)return-1;for(;o>0&&r(t,e[o-1]);)o--;return r(t,e[o])?o:-1}function a(e,t,n,r){var o=i(e,t,n);if(o<0)return-1;for(;o<e.length-1&&r(t,e[o+1]);)o++;return r(t,e[o])?o:-1}function s(e,t,n){var r=i(e,t,n);if(r<0)return-r-1;for(var o=e.length-1;r<o&&0===n(t,e[r+1]);)r++;return r}n.exports=r;var l=(e("./shim"),e("./generic-collection")),u=e("./listen/property-changes"),c=e("./listen/range-changes");r.SortedArray=r,r.from=l.from,Object.addEach(r.prototype,l.prototype),Object.addEach(r.prototype,u.prototype),Object.addEach(r.prototype,c.prototype),r.prototype.isSorted=!0,r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare,this.getDefault)},r.prototype.has=function(e,t){if(t)throw new Error("SortedSet#has does not support second argument: equals");var n=i(this.array,e,this.contentCompare);return n>=0&&this.contentEquals(this.array[n],e)},r.prototype.get=function(e,t){if(t)throw new Error("SortedArray#get does not support second argument: equals");var n=o(this.array,e,this.contentCompare,this.contentEquals);return n!==-1?this.array[n]:this.getDefault(e)},r.prototype.add=function(e){var t=s(this.array,e,this.contentCompare);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],Array.empty,t),this.array.splice(t,0,e),this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],Array.empty,t),!0},r.prototype["delete"]=function(e,t){if(t)throw new Error("SortedArray#delete does not support second argument: equals");var n=o(this.array,e,this.contentCompare,this.contentEquals);return n!==-1&&(this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(Array.empty,[e],n),this.array.spliceOne(n),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange(Array.empty,[e],n),!0)},r.prototype.deleteAll=function(e,t){if(t){var n=this.array.deleteAll(e,t);return this.length-=n,n}var r=o(this.array,e,this.contentCompare,this.contentEquals);if(r!==-1){for(var i=r;this.contentEquals(e,this.array[i]);)i++;var a=this.slice(r,i);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(Array.empty,a,r),this.array.splice(r,a.length),this.length-=a.length,this.dispatchesRangeChanges&&this.dispatchRangeChange(Array.empty,a,r),a.length}return 0},r.prototype.indexOf=function(e){return o(this.array,e,this.contentCompare,this.contentEquals)},r.prototype.lastIndexOf=function(e){return a(this.array,e,this.contentCompare,this.contentEquals)},r.prototype.find=function(e,t,n){if(t)throw new Error("SortedArray#find does not support second argument: equals");if(n)throw new Error("SortedArray#find does not support third argument: index");return o(this.array,e,this.contentCompare,this.contentEquals)},r.prototype.findLast=function(e,t,n){if(t)throw new Error("SortedArray#findLast does not support second argument: equals");if(n)throw new Error("SortedArray#findLast does not support third argument: index");return a(this.array,e,this.contentCompare,this.contentEquals)},r.prototype.push=function(){this.addEach(arguments)},r.prototype.unshift=function(){this.addEach(arguments)},r.prototype.pop=function(){var e=this.array.pop();return this.length=this.array.length,e},r.prototype.shift=function(){var e=this.array.shift();return this.length=this.array.length,e},r.prototype.slice=function(){return this.array.slice.apply(this.array,arguments)},
r.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},r.prototype.swap=function(e,t,n){if(void 0===e&&void 0===t)return Array.empty;e=e||0,e<0&&(e+=this.length),void 0===t&&(t=1/0);var r=this.slice(e,e+t);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(n,r,e),this.array.splice(e,t),this.length-=r.length,this.dispatchesRangeChanges&&this.dispatchRangeChange(Array.empty,r,e),this.addEach(n),r},r.prototype.reduce=function(e,t){var n=arguments[2];return this.array.reduce(function(t,r,i){return e.call(n,t,r,i,this)},t,this)},r.prototype.reduceRight=function(){var e=arguments[2];return this.array.reduceRight(function(t,n,r){return callback.call(e,t,n,r,this)},basis,this)},r.prototype.min=function(){if(this.length)return this.array[0]},r.prototype.max=function(){if(this.length)return this.array[this.length-1]},r.prototype.one=function(){return this.array.one()},r.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.array.slice(),this.dispatchBeforeRangeChange(Array.empty,e,0)),this.length=0,this.array.clear(),this.dispatchesRangeChanges&&this.dispatchRangeChange(Array.empty,e,0)},r.prototype.equals=function(e,t){return this.array.equals(e,t)},r.prototype.compare=function(e,t){return this.array.compare(e,t)},r.prototype.iterate=function(e,t){return new this.Iterator(this.array,e,t)},r.prototype.toJSON=function(){return this.toArray()},r.prototype.Iterator=Array.prototype.Iterator}}),montageDefine("449c0c3","sorted-set",{dependencies:["./shim","./generic-collection","./generic-set","./listen/property-changes","./listen/range-changes","./tree-log"],factory:function(e,t,n){"use strict";function r(e,t,n,i){return this instanceof r?(this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.getDefault=i||Function.noop,this.root=null,this.length=0,void this.addEach(e)):new r(e,t,n,i)}function i(e){this.value=e,this.left=null,this.right=null,this.length=1}function o(e,t,n){if(this.set=e,this.prev=null,this.end=n,t){var r=this.set.findLeastGreaterThanOrEqual(t);r&&(this.set.splay(r.value),this.prev=r.getPrevious())}}n.exports=r;var a=(e("./shim"),e("./generic-collection")),s=e("./generic-set"),l=e("./listen/property-changes"),u=e("./listen/range-changes"),c=e("./tree-log");r.SortedSet=r,Object.addEach(r.prototype,a.prototype),Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,l.prototype),Object.addEach(r.prototype,u.prototype),Object.defineProperty(r.prototype,"size",a._sizePropertyDescriptor),r.from=a.from,r.prototype.isSorted=!0,r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare,this.getDefault)},r.prototype.has=function(e,t){if(t)throw new Error("SortedSet#has does not support second argument: equals");return!!this.root&&(this.splay(e),this.contentEquals(e,this.root.value))},r.prototype.get=function(e,t){if(t)throw new Error("SortedSet#get does not support second argument: equals");return this.root&&(this.splay(e),this.contentEquals(e,this.root.value))?this.root.value:this.getDefault(e)},r.prototype.add=function(e){var t=new this.Node(e);if(!this.root)return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],0),this.root=t,this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],0),!0;if(this.splay(e),!this.contentEquals(e,this.root.value)){var n=this.contentCompare(e,this.root.value);if(0===n)throw new Error("SortedSet cannot contain incomparable but inequal values: "+e+" and "+this.root.value);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([e],[],this.root.index),n<0?(t.right=this.root,t.left=this.root.left,this.root.left=null,this.root.touch()):(t.left=this.root,t.right=this.root.right,this.root.right=null,this.root.touch()),t.touch(),this.root=t,this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([e],[],this.root.index),!0}return!1},r.prototype["delete"]=function(e,t){if(t)throw new Error("SortedSet#delete does not support second argument: equals");if(this.root&&(this.splay(e),this.contentEquals(e,this.root.value))){var n=this.root.index;if(this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],n),this.root.left){var r=this.root.right;this.root=this.root.left,this.splay(e),this.root.right=r}else this.root=this.root.right;return this.length--,this.root&&this.root.touch(),this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],n),!0}return!1},r.prototype.indexOf=function(e,t){if(t)throw new Error("SortedSet#indexOf does not support second argument: startIndex");return this.root&&(this.splay(e),this.contentEquals(e,this.root.value))?this.root.index:-1},r.prototype.find=function(e,t,n){if(t)throw new Error("SortedSet#find does not support second argument: equals");if(n)throw new Error("SortedSet#find does not support third argument: index");if(this.root&&(this.splay(e),this.contentEquals(e,this.root.value)))return this.root},r.prototype.findGreatest=function(e){if(this.root){for(e=e||this.root;e.right;)e=e.right;return e}},r.prototype.findLeast=function(e){if(this.root){for(e=e||this.root;e.left;)e=e.left;return e}},r.prototype.findGreatestLessThanOrEqual=function(e){if(this.root)return this.splay(e),this.contentCompare(this.root.value,e)>0?this.root.getPrevious():this.root},r.prototype.findGreatestLessThan=function(e){if(this.root)return this.splay(e),this.contentCompare(this.root.value,e)>=0?this.root.getPrevious():this.root},r.prototype.findLeastGreaterThanOrEqual=function(e){if(this.root)return this.splay(e),this.contentCompare(this.root.value,e)>=0?this.root:this.root.getNext()},r.prototype.findLeastGreaterThan=function(e){if(this.root)return this.splay(e),this.contentCompare(this.root.value,e)<=0?this.root.getNext():this.root},r.prototype.pop=function(){if(this.root){var e=this.findGreatest();return this["delete"](e.value),e.value}},r.prototype.shift=function(){if(this.root){var e=this.findLeast();return this["delete"](e.value),e.value}},r.prototype.push=function(){this.addEach(arguments)},r.prototype.unshift=function(){this.addEach(arguments)},r.prototype.slice=function(e,t){e=e||0,t=t||this.length,e<0&&(e+=this.length),t<0&&(t+=this.length);var n=[];if(this.root)for(this.splayIndex(e);this.root.index<t&&(n.push(this.root.value),this.root.right);)this.splay(this.root.getNext().value);return n},r.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},r.prototype.swap=function(e,t,n){if(void 0===e&&void 0===t)return[];e=e||0,e<0&&(e+=this.length),void 0===t&&(t=1/0);var r=[];if(this.root){this.splayIndex(e);for(var i=0;i<t;i++){r.push(this.root.value);var o=this.root.getNext();if(this["delete"](this.root.value),!o)break;this.splay(o.value)}}return this.addEach(n),r},r.prototype.splay=function(e){var t,n,r,o,a,s;if(this.root){for(t=n=r=new this.Node,s=new this.Node,a=this.root;;){var l=this.contentCompare(e,a.value);if(l<0){if(!a.left)break;if(this.contentCompare(e,a.left.value)<0&&(o=a.left,a.left=o.right,a.touch(),o.right=a,o.touch(),a=o,!a.left))break;o=new i,o.right=a,o.left=s.left,s.left=o,r.left=a,r.touch(),r=a,a=a.left}else{if(!(l>0))break;if(!a.right)break;if(this.contentCompare(e,a.right.value)>0&&(o=a.right,a.right=o.left,a.touch(),o.left=a,o.touch(),a=o,!a.right))break;o=new i,o.left=a,o.right=s.right,s.right=o,n.right=a,n.touch(),n=a,a=a.right}}for(n.right=a.left,n.touch(),r.left=a.right,r.touch(),a.left=t.right,a.right=t.left;s.left;)s.left.right.touch(),s.left=s.left.left;for(;s.right;)s.right.left.touch(),s.right=s.right.right;a.touch(),this.root=a}},r.prototype.splayIndex=function(e){if(this.root){for(var t=this.root,n=this.root.index;n!==e;)if(n>e&&t.left)t=t.left,n-=1+(t.right?t.right.length:0);else{if(!(n<e&&t.right))break;t=t.right,n+=1+(t.left?t.left.length:0)}return this.splay(t.value),this.root.index===e}return!1},r.prototype.reduce=function(e,t,n){return this.root&&(t=this.root.reduce(e,t,0,n,this)),t},r.prototype.reduceRight=function(e,t,n){return this.root&&(t=this.root.reduceRight(e,t,this.length-1,n,this)),t},r.prototype.min=function(e){var t=this.findLeast(e);if(t)return t.value},r.prototype.max=function(e){var t=this.findGreatest(e);if(t)return t.value},r.prototype.one=function(){return this.min()},r.prototype.clear=function(){var e;this.dispatchesRangeChanges&&(e=this.toArray(),this.dispatchBeforeRangeChange([],e,0)),this.root=null,this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange([],e,0)},r.prototype.iterate=function(e,t){return new this.Iterator(this,e,t)},r.prototype.Iterator=o,r.prototype.summary=function(){return this.root?this.root.summary():"()"},r.prototype.log=function(e,t,n,r){e=e||c.unicodeRound,t=t||this.logNode,n||(n=console.log,r=console),n=n.bind(r),this.root&&this.root.log(e,t,n,n)},r.prototype.logNode=function(e,t,n){t(" "+e.value)},r.logCharsets=c,r.prototype.Node=i,i.prototype.reduce=function(e,t,n,r,i,o){if(o=o||0,this.left){var a=this.left.length;t=this.left.reduce(e,t,n,r,i,o+1),n+=a}return t=e.call(r,t,this.value,n,i,this,o),n+=1,this.right&&(t=this.right.reduce(e,t,n,r,i,o+1)),t},i.prototype.reduceRight=function(e,t,n,r,i,o){return o=o||0,this.right&&(t=this.right.reduce(e,t,n,r,i,o+1),n-=this.right.length),t=e.call(r,t,this.value,this.value,i,this,o),n-=1,this.left&&(t=this.left.reduce(e,t,n,r,i,o+1)),t},i.prototype.touch=function(){this.length=1+(this.left?this.left.length:0)+(this.right?this.right.length:0),this.index=this.left?this.left.length:0},i.prototype.checkIntegrity=function(){var e=1;if(e+=this.left?this.left.checkIntegrity():0,e+=this.right?this.right.checkIntegrity():0,this.length!==e)throw new Error("Integrity check failed: "+this.summary());return e},i.prototype.getNext=function(){var e=this;if(e.right){for(e=e.right;e.left;)e=e.left;return e}},i.prototype.getPrevious=function(){var e=this;if(e.left){for(e=e.left;e.right;)e=e.right;return e}},i.prototype.summary=function(){var e=this.value||"-";return e+=" <"+this.length,this.left||this.right?"("+e+" "+(this.left?this.left.summary():"()")+", "+(this.right?this.right.summary():"()")+")":"("+e+")"},i.prototype.log=function(e,t,n,r){var i,o=this;i=this.left&&this.right?e.intersection:this.left?e.branchUp:this.right?e.branchDown:e.through;var a;this.left&&this.left.log(e,t,function(t){a?r(e.strafe+" "+t):(a=!0,r(e.fromBelow+e.through+t))},function(e){r("  "+e)});var s;t(this,function(t){s?n((o.right?e.strafe:" ")+t):(s=!0,n(i+t))},function(t){r((o.left?e.strafe:" ")+t)});var l;this.right&&this.right.log(e,t,function(t){l?n("  "+t):(l=!0,n(e.fromAbove+e.through+t))},function(t){n(e.strafe+" "+t)})},o.prototype.__iterationObject=null,Object.defineProperty(o.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:null})}}),o.prototype.next=function(){var e;return e=this.prev?this.set.findLeastGreaterThan(this.prev.value):this.set.findLeast(),e?void 0!==this.end&&this.set.contentCompare(e.value,this.end)>=0?(this._iterationObject.done=!0,this._iterationObject.value=void 0):(this.prev=e,this._iterationObject.value=e.value):(this._iterationObject.done=!0,this._iterationObject.value=void 0),this._iterationObject}}}),montageDefine("449c0c3","heap",{dependencies:["./listen/array-changes","./shim","./generic-collection","./listen/map-changes","./listen/range-changes","./listen/property-changes","heap"],factory:function(e,t,n){function r(e,t,n){return this instanceof r?(this.contentEquals=t||Object.equals,this.contentCompare=n||Object.compare,this.content=[],this.length=0,void this.addEach(e)):new r(e,t,n)}var i=(e("./listen/array-changes"),e("./shim"),e("./generic-collection")),o=e("./listen/map-changes"),a=e("./listen/range-changes"),s=e("./listen/property-changes");n.exports=r,r.Heap=r,Object.addEach(r.prototype,i.prototype),Object.addEach(r.prototype,s.prototype),Object.addEach(r.prototype,a.prototype),Object.addEach(r.prototype,o.prototype),r.from=i.from,r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentCompare)},r.prototype.push=function(e){this.content.push(e),this["float"](this.content.length-1),this.length++},r.prototype.pop=function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content.set(0,t),this.sink(0)),this.length--,e},r.prototype.add=function(e){this.push(e)},r.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this.contentEquals(this.content[t],e))return t;return-1},r.prototype["delete"]=function(e,t){if(t)throw new Error("Heap#delete does not support second argument: equals");var n=this.indexOf(e);if(n===-1)return!1;var r=this.content.pop();if(this.length=this.content.length,n===this.content.length)return!0;this.content.set(n,r);var i=this.contentCompare(r,e);return i>0?this["float"](n):i<0&&this.sink(n),!0},r.prototype.peek=function(){if(this.length)return this.content[0]},r.prototype.max=function(){return this.peek()},r.prototype.one=function(){return this.peek()},r.prototype["float"]=function(e){for(var t=this.content[e];e>0;){var n=Math.floor((e+1)/2)-1,r=this.content[n];if(!(this.contentCompare(r,t)<0))break;this.content.set(n,t),this.content.set(e,r),e=n}},r.prototype.sink=function(e){for(var t,n,r,i,o,a,s=this.content.length,l=this.content[e];;){if(i=2*(e+1),r=i-1,a=!1,r<s){var t=this.content[r],u=this.contentCompare(t,l);u>0&&(o=r,a=!0)}if(i<s){var n=this.content[i],u=this.contentCompare(n,a?t:l);u>0&&(o=i,a=!0)}if(!a)break;this.content.set(e,this.content[o]),this.content.set(o,l),e=o}},r.prototype.clear=function(){this.content.clear(),this.length=0},r.prototype.reduce=function(e,t){var n=arguments[2];return this.content.reduce(function(t,r,i){return e.call(n,t,r,i,this)},t,this)},r.prototype.reduceRight=function(e,t){var n=arguments[2];return this.content.reduceRight(function(t,r,i){return e.call(n,t,r,i,this)},t,this)},r.prototype.toJSON=function(){return this.toArray()},r.prototype.makeObservable=function(){this.content.addRangeChangeListener(this,"content"),this.content.addBeforeRangeChangeListener(this,"content"),this.content.addMapChangeListener(this,"content"),this.content.addBeforeMapChangeListener(this,"content")},r.prototype.handleContentRangeChange=function(e,t,n){this.dispatchRangeChange(e,t,n)},r.prototype.handleContentRangeWillChange=function(e,t,n){this.dispatchBeforeRangeChange(e,t,n)},r.prototype.handleContentMapChange=function(e,t){this.dispatchMapChange(t,e)},r.prototype.handleContentMapWillChange=function(e,t){this.dispatchBeforeMapChange(t,e)}}}),montageDefine("449c0c3","generic-collection",{dependencies:["./shim-array"],factory:function(e,t,n){"use strict";function r(){throw new Error("Can't construct. GenericCollection is a mixin.")}n.exports=r;var i=global.DOMTokenList||function(){};r.EmptyArray=Object.freeze([]),r.prototype.addEach=function(e){if(e&&(e instanceof Array||e instanceof i||e instanceof String))for(var t=0;t<e.length;t++)this.add(e[t],t);else if(e&&Object(e)===e)if("function"==typeof e.forEach)e.forEach(this.add,this);else if("number"==typeof e.length)for(var t=0;t<e.length;t++)this.add(e[t],t);else Object.keys(e).forEach(function(t){this.add(e[t],t)},this);return this},r.prototype.deleteEach=function(e,t){return e.forEach(function(e){this["delete"](e,t)},this),this},r.prototype.forEach=function(e){var t=arguments[1];return this.reduce(function(n,r,i,o,a){e.call(t,r,i,o,a)},void 0)},r.prototype.map=function(e){var t=arguments[1],n=[];return this.reduce(function(r,i,o,a,s){n.push(e.call(t,i,o,a,s))},void 0),n},r.prototype.enumerate=function(e){null==e&&(e=0);var t=[];return this.reduce(function(n,r){t.push([e++,r])},void 0),t},r.prototype.group=function(e,t,n){n=n||Object.equals;var r=[],i=[];return this.forEach(function(o,a,s){var l,a=e.call(t,o,a,s),u=i.indexOf(a,n);u===-1?(l=[],r.push([a,l]),i.push(a)):l=r[u][1],l.push(o)}),r},r.prototype.toArray=function(){return this.map(Function.identity)},r.prototype.toObject=function(){var e={};return this.reduce(function(t,n,r){e[r]=n},void 0),e},r.from=function(){return this.apply(this,arguments)},r.prototype.filter=function(e){var t=arguments[1],n=this.constructClone();return this.reduce(function(r,i,o,a,s){e.call(t,i,o,a,s)&&n.add(i,o)},void 0),n},r.prototype.every=function(e){var t=arguments[1];return this.reduce(function(n,r,i,o,a){return n&&e.call(t,r,i,o,a)},!0)},r.prototype.some=function(e){var t=arguments[1];return this.reduce(function(n,r,i,o,a){return n||e.call(t,r,i,o,a)},!1)},r.prototype.all=function(){return this.every(Boolean)},r.prototype.any=function(){return this.some(Boolean)},r.prototype.min=function(e){e=e||this.contentCompare||Object.compare;var t=!0;return this.reduce(function(n,r){return t?(t=!1,r):e(r,n)<0?r:n},void 0)},r.prototype.max=function(e){e=e||this.contentCompare||Object.compare;var t=!0;return this.reduce(function(n,r){return t?(t=!1,r):e(r,n)>0?r:n},void 0)},r.prototype.sum=function(e){return e=void 0===e?0:e,this.reduce(function(e,t){return e+t},e)},r.prototype.average=function(e){var t=void 0===e?0:e,n=void 0===e?0:e;return this.reduce(function(e,r){t+=r,n+=1},void 0),t/n},r.prototype.concat=function(){for(var e=this.constructClone(this),t=0;t<arguments.length;t++)e.addEach(arguments[t]);return e},r.prototype.flatten=function(){var e=this;return this.reduce(function(t,n){return n.forEach(function(e){this.push(e)},t,e),t},[])},r.prototype.zip=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(this),Array.unzip(e)},r.prototype.join=function(e){return this.reduce(function(t,n){return void 0===t?n:t+e+n},void 0)},r.prototype.sorted=function(e,t,n){return e=e||this.contentCompare||Object.compare,e.by?(t=e.by,e=e.compare||this.contentCompare||Object.compare):t=t||Function.identity,void 0===n&&(n=1),this.map(function(e){return{by:t(e),value:e}}).sort(function(t,r){return e(t.by,r.by)*n}).map(function(e){return e.value})},r.prototype.reversed=function(){return this.constructClone(this).reverse()},r.prototype.clone=function(e,t){if(void 0===e)e=1/0;else if(0===e)return this;var n=this.constructClone();return this.forEach(function(r,i){n.add(Object.clone(r,e-1,t),i)},this),n},r.prototype.only=function(){if(1===this.length)return this.one()},r.prototype.iterator=function(){return this.iterate.apply(this,arguments)},r._sizePropertyDescriptor={get:function(){return this.length},enumerable:!1,configurable:!0},Object.defineProperty(r.prototype,"size",r._sizePropertyDescriptor),e("./shim-array")}}),montageDefine("449c0c3","generic-order",{dependencies:["./shim-object"],factory:function(e,t,n){function r(){throw new Error("Can't construct. GenericOrder is a mixin.")}var i=e("./shim-object");n.exports=r,r.prototype.equals=function(e,t){return t=t||this.contentEquals||i.equals,this===e||!!e&&(this.length===e.length&&this.zip(e).every(function(e){return t(e[0],e[1])}))},r.prototype.compare=function(e,t){if(t=t||this.contentCompare||i.compare,this===e)return 0;if(!e)return 1;var n=Math.min(this.length,e.length),r=this.zip(e).reduce(function(e,r,i){return 0===e?i>=n?e:t(r[0],r[1]):e},0);return 0===r?this.length-e.length:r},r.prototype.toJSON=function(){return this.toArray()}}}),montageDefine("449c0c3","generic-map",{dependencies:["./shim-object","./iterator"],factory:function(e,t,n){"use strict";function r(){throw new Error("Can't construct. GenericMap is a mixin.")}function i(e,t){this.key=e,this.value=t}var o=e("./shim-object"),a=e("./iterator");n.exports=r,r.prototype.isMap=!0,r.prototype.addEach=function(e){var t;if(e&&o(e)===e)if("function"==typeof e.forEach)e.isMap===!0?e.forEach(function(e,t){this.set(t,e)},this):e.forEach(function(e){this.set(e[0],e[1])},this);else if("number"==typeof e.length)for(t=0;t<e.length;t++)this.add(e[t],t);else o.keys(e).forEach(function(t){this.set(t,e[t])},this);else if(e&&"number"==typeof e.length)for(t=0;t<e.length;t++)this.add(e[t],t);return this},r.prototype.get=function(e,t){var n=this.store.get(new this.Item(e));return n?n.value:arguments.length>1?(console.log("Use of a second argument as default value is deprecated to match standards"),t):this.getDefault(e)},r.prototype.set=function(e,t){var n=new this.Item(e,t),r=this.store.get(n),i=!1;return r?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,r.value),r.value=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t)):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,void 0),this.store.add(n)&&(this.length++,i=!0),this.dispatchesMapChanges&&this.dispatchMapChange(e,t)),this},r.prototype.add=function(e,t){return this.set(t,e)},r.prototype.has=function(e){return this.store.has(new this.Item(e))},r.prototype["delete"]=function(e){var t=new this.Item(e);if(this.store.has(t)){var n=this.store.get(t).value;return this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,n),this.store["delete"](t),this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0}return!1},r.prototype.clear=function(){var e,t;if(this.dispatchesMapChanges&&(this.forEach(function(e,t){this.dispatchBeforeMapChange(t,e)},this),e=this.keysArray()),this.store.clear(),this.length=0,this.dispatchesMapChanges)for(var n=0;t=e[n];n++)this.dispatchMapChange(t)},r.prototype.reduce=function(e,t,n){return this.store.reduce(function(t,r){return e.call(n,t,r.value,r.key,this)},t,this)},r.prototype.reduceRight=function(e,t,n){return this.store.reduceRight(function(t,r){return e.call(n,t,r.value,r.key,this)},t,this)},r.prototype.keysArray=function(){return this.map(function(e,t){return t})},r.prototype.keys=function(){return new a(this.keysArray())},r.prototype.valuesArray=function(){return this.map(Function.identity)},r.prototype.values=function(){return new a(this.valuesArray())},r.prototype.entriesArray=function(){return this.map(function(e,t){return[t,e]})},r.prototype.entries=function(){return new a(this.entriesArray())},r.prototype.items=function(){return this.entriesArray()},r.prototype.equals=function(e,t){if(t=t||o.equals,this===e)return!0;if(e&&"function"==typeof e.every)return e.length===this.length&&e.every(function(e,n){return t(this.get(n),e)},this);var n=o.keys(e);return n.length===this.length&&o.keys(e).every(function(n){return t(this.get(n),e[n])},this)},r.prototype.toJSON=function(){return this.entriesArray()},r.prototype.Item=i,i.prototype.equals=function(e){return o.equals(this.key,e.key)&&o.equals(this.value,e.value)},i.prototype.compare=function(e){return o.compare(this.key,e.key)}}}),montageDefine("449c0c3","generic-set",{dependencies:[],factory:function(e,t,n){function r(){throw new Error("Can't construct. GenericSet is a mixin.")}n.exports=r,r.prototype.isSet=!0,r.prototype.union=function(e){var t=this.constructClone(this);return t.addEach(e),t},r.prototype.intersection=function(e){return this.constructClone(this.filter(function(t){return e.has(t)}))},r.prototype.difference=function(e){var t=this.constructClone(this);return t.deleteEach(e),t},r.prototype.symmetricDifference=function(e){var t=this.union(e),n=this.intersection(e);return t.difference(n)},r.prototype.deleteAll=function(e){return+this["delete"](e)},r.prototype.equals=function(e,t){var n=this;return e&&"function"==typeof e.reduce&&this.length===e.length&&e.reduce(function(e,r){return e&&n.has(r,t)},!0)},r.prototype.forEach=function(e){var t=arguments[1];return this.reduce(function(n,r,i,o,a){e.call(t,r,r,o,a)},void 0)},r.prototype.toJSON=function(){return this.toArray()},r.prototype.contains=function(e){return this.has(e)},r.prototype.remove=function(e){return this["delete"](e)},r.prototype.toggle=function(e){this.has(e)?this["delete"](e):this.add(e)};var i=function(e,t){return e};r.prototype.valuesArray=function(){return this.map(i)};var o=function(e,t){return[t,e]};r.prototype.entriesArray=function(){return this.map(o)}}}),montageDefine("449c0c3","_list",{dependencies:["./shim","./generic-collection","./generic-order","list"],factory:function(e,t,n){"use strict";function r(e,t,n){return r._init(r,this,e,t,n)}function i(e){this.head=e,this.at=e.next}function o(e){this.value=e,this.prev=null,this.next=null}n.exports=r;var a=(e("./shim"),e("./generic-collection")),s=e("./generic-order");r._init=function(e,t,n,r,i){if(!(t instanceof e))return new e(n,r,i);var o=t.head=new t.Node;o.next=o,o.prev=o,t.contentEquals=r||Object.equals,t.getDefault=i||Function.noop,t.length=0,t.addEach(n)},r.List=r,Object.addEach(r.prototype,a.prototype),Object.addEach(r.prototype,s.prototype),r.from=a.from,r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.getDefault)},r.prototype.find=function(e,t,n){t=t||this.contentEquals;for(var r=this.head,i=this.scan(n,r.next);i!==r;){if(t(i.value,e))return i;i=i.next}},r.prototype.findLast=function(e,t,n){t=t||this.contentEquals;for(var r=this.head,i=this.scan(n,r.prev);i!==r;){if(t(i.value,e))return i;i=i.prev}},r.prototype.has=function(e,t){return!!this.find(e,t)},r.prototype.get=function(e,t){var n=this.find(e,t);return n?n.value:this.getDefault(e)},r.prototype["delete"]=function(e,t){var n=this.findLast(e,t);return!!n&&(n["delete"](),this.length--,!0)},r.prototype.deleteAll=function(e,t){t=t||this.contentEquals;for(var n=this.head,r=n.next,i=0;r!==n;)t(e,r.value)&&(r["delete"](),i++),r=r.next;return this.length-=i,i},r.prototype.clear=function(){this.head.next=this.head.prev=this.head,this.length=0},r.prototype.add=function(e){var t=new this.Node(e);return this._addNode(t)},r.prototype._addNode=function(e){return this.head.addBefore(e),this.length++,!0},r.prototype.push=function(){for(var e=this.head,t=0;t<arguments.length;t++){var n=arguments[t],r=new this.Node(n);e.addBefore(r)}this.length+=arguments.length},r.prototype.unshift=function(){for(var e=this.head,t=0;t<arguments.length;t++){var n=arguments[t],r=new this.Node(n);e.addAfter(r),e=r}this.length+=arguments.length},r.prototype._shouldPop=function(){var e,t=this.head;return t.prev!==t&&(e=t.prev.value),e},r.prototype.pop=function(e,t){var n,r=this.head;if(r.prev!==r){n=r.prev.value;var i=this.length-1,o=e?e.call(this,n,i):void 0;r.prev["delete"](),this.length--,t?t.call(this,n,i,o):void 0}return n},r.prototype.shift=function(e,t){var n,r=this.head;if(r.prev!==r){n=r.next.value;var i=e?e.call(this,n,0):void 0;r.next["delete"](),this.length--,t?t.call(this,n,0,i):void 0}return n},r.prototype.peek=function(){if(this.head!==this.head.next)return this.head.next.value},r.prototype.poke=function(e){this.head!==this.head.next?this.head.next.value=e:this.push(e)},r.prototype.one=function(){return this.peek()},r.prototype.scan=function(e,t){var n=this.head;if("number"==typeof e){var r=e;if(r>=0)for(e=n.next;r&&(r--,e=e.next,e!=n););else for(e=n;r<0&&(r++,e=e.prev,e!=n););return e}return e||t},r.prototype.slice=function(e,t){var n=[],r=this.head;for(e=this.scan(e,r.next),t=this.scan(t,r);e!==t&&e!==r;)n.push(e.value),e=e.next;return n},r.prototype.splice=function(e,t){return this.swap(e,t,Array.prototype.slice.call(arguments,2))},r.prototype.swap=function(e,t,n,r,i){var o=e;e=this.scan(e,this.head),null==t&&(t=1/0),n=Array.from(n);for(var a=[],s=e;t--&&t>=0&&s!==this.head;)a.push(s.value),s=s.next;var l;l=r?r.call(this,e,n,a):void 0;for(var s=e,u=0,s=e;u<a.length;u++,s=s.next)s["delete"]();null==o&&s===this.head&&(s=this.head.next);for(var u=0;u<n.length;u++){var c=new this.Node(n[u]);s.addBefore(c)}return this.length+=n.length-a.length,i?i.call(this,e,n,a):void 0,a},r.prototype.reverse=function(){var e=this.head;do{var t=e.next;e.next=e.prev,e.prev=t,e=e.next}while(e!==this.head);return this},r.prototype.sort=function(){this.swap(0,this.length,this.sorted())},r.prototype.reduce=function(e,t){for(var n=arguments[2],r=this.head,i=r.next;i!==r;)t=e.call(n,t,i.value,i,this),i=i.next;return t},r.prototype.reduceRight=function(e,t){for(var n=arguments[2],r=this.head,i=r.prev;i!==r;)t=e.call(n,t,i.value,i,this),i=i.prev;return t},r.prototype.updateIndexes=function(e,t){for(;e!==this.head;)e.index=t++,e=e.next},r.prototype.iterate=function(){return new i(this.head)},i.prototype.__iterationObject=null,Object.defineProperty(i.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:null})}}),i.prototype.next=function(){if(this.at===this.head)this._iterationObject.done=!0,this._iterationObject.value=void 0;else{var e=this.at.value;this.at=this.at.next,this._iterationObject.value=e}return this._iterationObject},r.prototype.Node=o,o.prototype["delete"]=function(){this.prev.next=this.next,this.next.prev=this.prev},o.prototype.addBefore=function(e){var t=this.prev;this.prev=e,e.prev=t,t.next=e,e.next=this},o.prototype.addAfter=function(e){var t=this.next;this.next=e,e.next=t,t.prev=e,e.prev=this}}}),montageDefine("449c0c3","_fast-set",{dependencies:["./shim","./_dict","./_list","./generic-collection","./generic-set","./tree-log","fast-set"],factory:function(e,t,n){"use strict";function r(e,t,n,i){if(!(this instanceof r))return new r(e,t,n,i);t=t||Object.equals,n=n||Object.hash,i=i||Function.noop,this.contentEquals=t,this.contentHash=n,this.getDefault=i;var o=this;this.buckets=new this.Buckets(null,function(){return new o.Bucket}),this.length=0,this.addEach(e)}var i=(e("./shim"),e("./_dict")),o=e("./_list"),a=e("./generic-collection"),s=e("./generic-set"),l=e("./tree-log");Object.prototype.hasOwnProperty,n.exports=r,r.FastSet=r,Object.addEach(r.prototype,a.prototype),Object.addEach(r.prototype,s.prototype),r.from=a.from,r.prototype.Buckets=i,r.prototype.Bucket=o,r.prototype.constructClone=function(e){return new this.constructor(e,this.contentEquals,this.contentHash,this.getDefault)},r.prototype.has=function(e){var t=this.contentHash(e);return this.buckets.get(t).has(e)},r.prototype.get=function(e,t){if(t)throw new Error("FastSet#get does not support second argument: equals");var n=this.contentHash(e),r=this.buckets;return r.has(n)?r.get(n).get(e):this.getDefault(e)},r.prototype["delete"]=function(e,t){if(t)throw new Error("FastSet#delete does not support second argument: equals");var n=this.contentHash(e),r=this.buckets;if(r.has(n)){var i=r.get(n);if(i["delete"](e))return this.length--,0===i.length&&r["delete"](n),!0}return!1},r.prototype.clear=function(){this.buckets.clear(),this.length=0},r.prototype.add=function(e){var t=this.contentHash(e),n=this.buckets;return n.has(t)||n.set(t,new this.Bucket(null,this.contentEquals)),!n.get(t).has(e)&&(n.get(t).add(e),this.length++,!0)},r.prototype.reduce=function(e,t){var n=arguments[2],r=this.buckets,i=0;return r.reduce(function(t,r){return r.reduce(function(t,r){return e.call(n,t,r,i++,this)},t,this)},t,this)},r.prototype.one=function(){if(this.length>0)return this.buckets.one().one()},r.prototype.iterate=function(){return this.buckets.valuesArray().flatten().iterate()},r.prototype.log=function(e,t,n,r){e=e||l.unicodeSharp,t=t||this.logNode,n||(n=console.log,r=console),n=n.bind(r);for(var i,o,a,s,u=this.buckets,c=u.size,h=u.keys(),p=0;i=h.next().value;)p===c-1?(o=e.fromAbove,a=" "):0===p?(o=e.branchDown,a=e.strafe):(o=e.fromBoth,a=e.strafe),s=u.get(i),n.call(r,o+e.through+e.branchDown+" "+i),s.forEach(function(i,o){var l,u,c;o===s.head.prev?(l=e.fromAbove,u=" "):(l=e.fromBoth,u=e.strafe),t(o,function(t){c?n.call(r,a+" "+u+"  "+t):(n.call(r,a+" "+l+e.through+e.through+t),c=!0)},function(t){n.call(r,a+" "+e.strafe+"  "+t)})}),p++},r.prototype.logNode=function(e,t){var n=e.value;Object(n)===n?JSON.stringify(n,null,4).split("\n").forEach(function(e){t(" "+e)}):t(" "+n)}}}),montageDefine("449c0c3","iterator",{dependencies:["./shim-object","./generic-collection"],factory:function(e,t,n){"use strict";function r(e){var t=e&&e.values&&e.values();if(t&&"function"==typeof t.next)return t;if(!(this instanceof r))return new r(e);if(Array.isArray(e)||"string"==typeof e)return r.iterate(e);if(e=i(e),e instanceof r)return e;if(e.next)this.next=function(){return e.next()};else if(e.iterate){var n=e.iterate();this.next=function(){return n.next()}}else{if("[object Function]"!==i.prototype.toString.call(e))throw new TypeError("Can't iterate "+e);
this.next=e}}n.exports=r;var i=e("./shim-object"),o=e("./generic-collection");r.prototype.forEach=o.prototype.forEach,r.prototype.map=o.prototype.map,r.prototype.filter=o.prototype.filter,r.prototype.every=o.prototype.every,r.prototype.some=o.prototype.some,r.prototype.any=o.prototype.any,r.prototype.all=o.prototype.all,r.prototype.min=o.prototype.min,r.prototype.max=o.prototype.max,r.prototype.sum=o.prototype.sum,r.prototype.average=o.prototype.average,r.prototype.flatten=o.prototype.flatten,r.prototype.zip=o.prototype.zip,r.prototype.enumerate=o.prototype.enumerate,r.prototype.sorted=o.prototype.sorted,r.prototype.group=o.prototype.group,r.prototype.reversed=o.prototype.reversed,r.prototype.toArray=o.prototype.toArray,r.prototype.toObject=o.prototype.toObject,r.prototype.iterator=o.prototype.iterator,r.prototype.__iterationObject=null,i.defineProperty(r.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:void 0})}}),r.prototype.constructClone=function(e){var t=[];return t.addEach(e),t},r.prototype.mapIterator=function(e){var t=r(this),n=arguments[1],o=0;if("[object Function]"!=i.prototype.toString.call(e))throw new TypeError;return new t.constructor(function(){if(t._iterationObject.done!==!0){var r=e.call(n,t.next().value,o++,t);t._iterationObject.value=r}return t._iterationObject})},r.prototype.filterIterator=function(e){var t=r(this),n=arguments[1],o=0;if("[object Function]"!=i.prototype.toString.call(e))throw new TypeError;return new t.constructor(function(){for(var r;;){if(r=t.next(),r.done===!0)return r;if(e.call(n,r.value,o++,t))return r}})},r.prototype.reduce=function(e){var t,n=r(this),o=arguments[1],a=arguments[2],s=0;if("[object Function]"!=i.prototype.toString.call(e))throw new TypeError;if(t=n.next(),t.done===!0){if(arguments.length>1)return arguments[1];throw TypeError("cannot reduce a value from an empty iterator with no initial value")}for(o=arguments.length>1?e.call(a,o,t.value,s,n):t.value,s++;;){if(t=n.next(),t.done===!0)return o;o=e.call(a,o,t.value,s,n),s++}},r.prototype.concat=function(){return r.concat(Array.prototype.concat.apply(this,arguments))},r.prototype.dropWhile=function(e){var t,n,o=r(this),a=arguments[1],s=!1,l=0;if("[object Function]"!=i.prototype.toString.call(e))throw new TypeError;for(;n=o.next(),n.done!==!0;){if(!e.call(a,n.value,l,o)){s=!0,t=n.value;break}l++}return s?o.constructor([t]).concat(o):o.constructor([])},r.prototype.takeWhile=function(e){var t=r(this),n=arguments[1],o=0;if("[object Function]"!=i.prototype.toString.call(e))throw new TypeError;return new t.constructor(function(){if(t._iterationObject.done!==!0){var r=t.next().value;e.call(n,r,o++,t)?t._iterationObject.value=r:(t._iterationObject.done=!0,t._iterationObject.value=void 0)}return t._iterationObject})},r.prototype.zipIterator=function(){return r.unzip(Array.prototype.concat.apply(this,arguments))},r.prototype.enumerateIterator=function(e){return r.count(e).zipIterator(this)},r.iterate=function(e){var t;return t=0,new r(function(){if("object"==typeof e)for(;!(t in e);){if(t>=e.length){this._iterationObject.done=!0,this._iterationObject.value=void 0;break}t+=1}else t>=e.length&&(this._iterationObject.done=!0,this._iterationObject.value=void 0);return this._iterationObject.done||(this._iterationObject.value=e[t],t+=1),this._iterationObject})},r.cycle=function(e,t){var n;return arguments.length<2&&(t=1/0),new r(function(){var i,o;return n&&(o=n()),n&&o.done!==!0||(t>0?(t--,i=r.iterate(e),o=(n=i.next.bind(i))()):(this._iterationObject.done=!0,o=this._iterationObject)),o})},r.concat=function(e){e=r(e);var t;return new r(function(){var n,i;return t&&(i=t()),i&&i.done!==!0?i:(i=e.next(),i.done===!1?(n=r(i.value),(t=n.next.bind(n))()):i)})},r.unzip=function(e){return e=r(e).map(r),new r(0===e.length?[]:function(){var t,n,r=e.map(function(e){return n=e.next(),n.done===!0&&(t=!0),n.value});return t?(this._iterationObject.done=!0,this._iterationObject.value=void 0):this._iterationObject.value=r,this._iterationObject})},r.zip=function(){return r.unzip(Array.prototype.slice.call(arguments))},r.chain=function(){return r.concat(Array.prototype.slice.call(arguments))},r.range=function(e,t,n){return arguments.length<3&&(n=1),arguments.length<2&&(t=e,e=0),e=e||0,n=n||1,new r(function(){e>=t&&(this._iterationObject.done=!0,this._iterationObject.value=void 0);var r=e;return e+=n,this._iterationObject.value=r,this._iterationObject})},r.count=function(e,t){return r.range(e,1/0,t)},r.repeat=function(e,t){return new r.range(t).mapIterator(function(){return e})}}}),montageDefine("449c0c3","tree-log",{dependencies:[],factory:function(e,t,n){"use strict";function r(){}n.exports=r,r.ascii={intersection:"+",through:"-",branchUp:"+",branchDown:"+",fromBelow:".",fromAbove:"'",fromBoth:"+",strafe:"|"},r.unicodeRound={intersection:"╋",through:"━",branchUp:"┻",branchDown:"┳",fromBelow:"╭",fromAbove:"╰",fromBoth:"┣",strafe:"┃"},r.unicodeSharp={intersection:"╋",through:"━",branchUp:"┻",branchDown:"┳",fromBelow:"┏",fromAbove:"┗",fromBoth:"┣",strafe:"┃"}}}),montageDefine("449c0c3","_dict",{dependencies:["./shim","./generic-collection","./generic-map","dict"],factory:function(e,t,n){"use strict";function r(e,t){return this instanceof r?(t=t||Function.noop,this.getDefault=t,this.store=Object.create(null),this.length=0,void this.addEach(e)):new r(e,t)}var i=(e("./shim"),e("./generic-collection")),o=e("./generic-map");n.exports=r,r.Dict=r,Object.addEach(r.prototype,i.prototype),Object.addEach(r.prototype,o.prototype),r.from=i.from,r.prototype.constructClone=function(e){return new this.constructor(e,this.getDefault)},r.prototype.assertString=function(e){if("string"!=typeof e)throw new TypeError("key must be a string but Got "+e)},Object.defineProperty(r.prototype,"$__proto__",{writable:!0}),Object.defineProperty(r.prototype,"_hasProto",{get:function(){return this.hasOwnProperty("$__proto__")&&"undefined"!=typeof this._protoValue}}),Object.defineProperty(r.prototype,"_protoValue",{get:function(){return this.$__proto__},set:function(e){this.$__proto__=e}}),Object.defineProperty(r.prototype,"size",i._sizePropertyDescriptor),r.prototype.get=function(e,t){return this.assertString(e),"__proto__"===e?this._hasProto?this._protoValue:arguments.length>1?t:this.getDefault(e):e in this.store?this.store[e]:arguments.length>1?t:this.getDefault(e)},r.prototype.set=function(e,t){this.assertString(e);var n="__proto__"===e;return(n?this._hasProto:e in this.store)?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,n?this._protoValue:this.store[e]),n?this._protoValue=t:this.store[e]=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t),!1):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,void 0),this.length++,n?this._protoValue=t:this.store[e]=t,this.dispatchesMapChanges&&this.dispatchMapChange(e,t),!0)},r.prototype.has=function(e){return this.assertString(e),"__proto__"===e?this._hasProto:e in this.store},r.prototype["delete"]=function(e){return this.assertString(e),"__proto__"===e?!!this._hasProto&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this._protoValue),this._protoValue=void 0,this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0):e in this.store&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this.store[e]),delete this.store[e],this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0),!0)},r.prototype.clear=function(){var e;this._hasProto&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange("__proto__",this._protoValue),this._protoValue=void 0,this.dispatchesMapChanges&&this.dispatchMapChange("__proto__",void 0));for(e in this.store)this.dispatchesMapChanges&&this.dispatchBeforeMapChange(e,this.store[e]),delete this.store[e],this.dispatchesMapChanges&&this.dispatchMapChange(e,void 0);this.length=0},r.prototype.reduce=function(e,t,n){this._hasProto&&(t=e.call(n,t,"$__proto__","__proto__",this));var r=this.store;for(var i in this.store)t=e.call(n,t,r[i],i,this);return t},r.prototype.reduceRight=function(e,t,n){var r=this,i=this.store;return t=Object.keys(this.store).reduceRight(function(t,o){return e.call(n,t,i[o],o,r)},t),this._hasProto?e.call(n,t,this._protoValue,"__proto__",r):t},r.prototype.one=function(){var e;for(e in this.store)return this.store[e];return this._protoValue},r.prototype.toJSON=function(){return this.toObject()}}}),montageDefine("449c0c3","dict",{dependencies:["./_dict","./listen/property-changes","./listen/map-changes"],factory:function(e,t,n){"use strict";var r=e("./_dict"),i=e("./listen/property-changes"),o=e("./listen/map-changes");n.exports=r,Object.addEach(r.prototype,i.prototype),Object.addEach(r.prototype,o.prototype)}}),montageDefine("afa97d9","parse",{dependencies:["collections/shim","./grammar","collections/map"],factory:function(e,t,n){function r(e,t){var n;if(Array.isArray(e))return{type:"tuple",args:e.map(function(e){return r(e,t)})};if(!t&&(n=a.get(e)))return n;try{var o=i.parse(e,t||Object.empty);return t||a.set(e,o),o}catch(s){throw s.message=s.message.replace(/[\s\.]+$/,"")+"  on line "+s.line+" column "+s.column,s}}e("collections/shim");var i=e("./grammar"),o=e("collections/map"),a=new o;n.exports=r}}),montageDefine("afa97d9","evaluate",{dependencies:["./parse","./compile-evaluator","./scope"],factory:function(e,t,n){function r(e,t,n,r,s){var l;l="string"==typeof e?i(e):e;var u=o(l),c=new a(t);return c.parameters=n,c.document=r,c.components=s,u(c)}var i=e("./parse"),o=e("./compile-evaluator"),a=e("./scope");n.exports=r}}),montageDefine("afa97d9","assign",{dependencies:["./parse","./compile-assigner","./scope"],factory:function(e,t,n){function r(e,t,n,r,s,l){var u;u="string"==typeof t?i(t):t;var c=o(u),h=new a(e);return h.parameters=r,h.document=s,h.components=l,c(n,h)}var i=e("./parse"),o=e("./compile-assigner"),a=e("./scope");n.exports=r}}),montageDefine("afa97d9","bind",{dependencies:["./parse","./algebra","./stringify","./compile-observer","./compile-binder","./compile-assigner","./observers","./binders","./scope"],factory:function(e,t,n){function r(e,t,n){n.target=e,n.targetPath=t;var r=n.source=n.source||e,u=n.twoWay=g in n,c=n.sourcePath=u?n[g]||"":n[v],h=n.parameters=n.parameters||r,p=n.document,d=n.components,_=n.trace,b=new f(r),y=new f(e);if(b.parameters=h,b.document=p,b.components=d,y.parameters=h,y.document=p,y.components=d,n.converter){var w=n.converter;w.convert&&(n.convert=w.convert.bind(w)),w.revert&&(n.revert=w.revert.bind(w))}else if(n.reverter){var E=n.reverter;E.convert&&(n.revert=E.convert.bind(E)),E.revert&&(n.convert=E.revert.bind(E))}var C=n.convert,O=n.revert,j=n.sourceSyntax=a(c),P=n.targetSyntax=a(t),T=s(P,j);if(P=T[0],j=T[1],u&&"rangeContent"===P.type)return o(y,P.args[0],b,j,C,O,n,_?{sourcePath:l(j),targetPath:l(P.args[0])}:null);_&&console.log("DEFINE BINDING",t,v,c,e);var k=i(y,P,b,j,C,n,_),T=s(j,P);j=T[0],P=T[1];var x=Function.noop;return u&&(_&&console.log("DEFINE BINDING",t,m,c,r),x=i(b,j,y,P,O,n,_)),function(){k(),x()}}function i(e,t,n,r,i,o,a){var s=u(r);i&&(s=p.makeConverterObserver(s,i,n));var h=c(t);return h(s,n,e,o,a?{sourcePath:l(r),targetPath:l(t)}:null)}function o(e,t,n,r,i,o,a,s){function l(e,t,n){b||(b=!0,s&&console.log("RANGE CONTENT PROPAGATED",s.targetPath,v,s.sourcePath,"PLUS",e,"MINUS",t,"AT",n),f.swap(n,t.length,e),b=!1)}function c(e,t,n){b||(b=!0,s&&console.log("RANGE CONTENT PROPAGATED",s.targetPath,m,s.sourcePath,"PLUS",e,"MINUS",t,"AT",n),_.swap(n,t.length,e),b=!1)}function p(){if(_!==f){s&&console.log("RANGE CONTENT BOUND",s.targetPath,g,s.sourcePath),b=!0;var t=d(_,l,n),r=d(f,c,e);return b=!1,function(){s&&console.log("RANGE CONTENT UNBOUND",s.targetPath,g,s.sourcePath),t(),r()}}}var f,_,b,y=u(r),w=u(t),E=h(r),C=h(t),O=Function.noop;b=!0;var j=w(function(e){O(),O=Function.noop,s&&console.log("RANGE CONTENT TARGET",s.targetPath,"SET TO",e),e&&e.addRangeChangeListener&&(f=e,_&&f?(s&&console.log("RANGE CONTENT TARGET REPLACES SOURCE",s.targetPath,m,s.sourcePath,"WITH",f),b=!0,_.swap(0,_.length,f),b=!1,O=p()):_||b||(s&&console.log("RANGE CONTENT TARGET INITIALIZED TO COPY OF SOURCE",s.targetPath,v,tarce.sourcePath,"WITH",_),E(f.clone(),n)))},e);b=!1;var P=y(function(t){O(),O=Function.noop,s&&console.log("RANGE CONTENT SOURCE",s.sourcePath,"SET TO",t),t&&t.addRangeChangeListener&&(_=t,f&&_?(s&&console.log("RANGE CONTENT SOURCE REPLACES TARGET",s.targetPath,v,s.sourcePath,"WITH",_),b=!0,f.swap(0,f.length,_),b=!1,O=p()):f||C(_.clone(),e))},n);return f||_||E([],n),function(){O(),j(),P()}}var a=e("./parse"),s=e("./algebra"),l=e("./stringify"),u=e("./compile-observer"),c=e("./compile-binder"),h=e("./compile-assigner"),p=e("./observers"),d=p.observeRangeChange,f=(e("./binders"),e("./scope")),v="<-",m="->",g="<->";n.exports=r}}),montageDefine("afa97d9","compile-observer",{dependencies:["./observers","./operators"],factory:function(e,t,n){function r(e){return d.compile(e)}var i=e("./observers"),o=e("./operators"),a="literal",s="value",l="parameters",u="element",c="component",h="record";n.exports=r;for(var p,d=r.semantics={compilers:{property:i.makePropertyObserver,get:i.makeGetObserver,path:i.makePathObserver,"with":i.makeWithObserver,"if":i.makeConditionalObserver,parent:i.makeParentObserver,not:i.makeNotObserver,and:i.makeAndObserver,or:i.makeOrObserver,"default":i.makeDefaultObserver,defined:i.makeDefinedObserver,rangeContent:Function.identity,mapContent:Function.identity,keys:i.makeKeysObserver,keysArray:i.makeKeysObserver,values:i.makeValuesObserver,valuesArray:i.makeValuesObserver,items:i.makeEntriesObserver,entries:i.makeEntriesObserver,entriesArray:i.makeEntriesObserver,toMap:i.makeToMapObserver,mapBlock:i.makeMapBlockObserver,filterBlock:i.makeFilterBlockObserver,everyBlock:i.makeEveryBlockObserver,someBlock:i.makeSomeBlockObserver,sortedBlock:i.makeSortedBlockObserver,sortedSetBlock:i.makeSortedSetBlockObserver,groupBlock:i.makeGroupBlockObserver,groupMapBlock:i.makeGroupMapBlockObserver,minBlock:i.makeMinBlockObserver,maxBlock:i.makeMaxBlockObserver,min:i.makeMinObserver,max:i.makeMaxObserver,enumerate:i.makeEnumerationObserver,reversed:i.makeReversedObserver,flatten:i.makeFlattenObserver,concat:i.makeConcatObserver,view:i.makeViewObserver,sum:i.makeSumObserver,average:i.makeAverageObserver,last:i.makeLastObserver,only:i.makeOnlyObserver,one:i.makeOneObserver,has:i.makeHasObserver,tuple:i.makeArrayObserver,range:i.makeRangeObserver,startsWith:i.makeStartsWithObserver,endsWith:i.makeEndsWithObserver,contains:i.makeContainsObserver,join:i.makeJoinObserver,toArray:i.makeToArrayObserver,asArray:i.makeToArrayObserver},compile:function(e){var t=this.compilers,n=e.type;if(e.type===a)return i.makeLiteralObserver(e.value);if(n===s)return i.observeValue;if(n===l)return i.observeParameters;if(n===u)return i.makeElementObserver(e.id);if(n===c)return i.makeComponentObserver(e.label,e);if(n===h){for(var r={},o=e.args,d=Object.keys(o),f=0;p=d[f];f++)r[p]=this.compile(o[p]);return i.makeObjectObserver(r)}t.hasOwnProperty(n)||(t[n]=i.makeMethodObserverMaker(n));for(var v=[],f=0,o=e.args,m=o.length;f<m;f++)v[f]=this.compile(o[f]);return 1===m?t[n].call(null,v[0]):2===m?t[n].call(null,v[0],v[1]):t[n].apply(null,v)}},f=d.compilers,v=Object.keys(o),m=0;p=v[m];m++)f[p]||(f[p]=i.makeOperatorObserverMaker(o[p]));f.toString=i.makeOperatorObserverMaker(o.toString)}}),montageDefine("afa97d9","scope",{dependencies:[],factory:function(e,t,n){function r(e){this.parent=null,this.value=e}n.exports=r,r.prototype.nest=function(e){var t=Object.create(this);return t.value=e,t.parent=this,t}}}),montageDefine("afa97d9","observers",{dependencies:["collections/shim","collections/listen/property-changes","collections/listen/array-changes","collections/sorted-array","collections/sorted-set","collections/map","collections/set","collections/heap","./scope","./operators","./parse","./compile-observer","./merge"],factory:function(e,t,n){function r(e){return function(t){return t(e)}}function i(e,t){return e(t.value)}function o(e,t){return e(t.parameters)}function a(e){return function(t,n){return t(n.document.getElementById(e))}}function s(e,t){return function(t,n){var r=n.components,i=r.getObjectByLabel||r.getComponentByLabel,o=i.call(r,e);return t(o)}}function l(e,t,n,r){function i(e,t,r){o&&o(),o=n(e,t,r)}if(null==e)return n();var o;return je.addOwnPropertyChangeListener(e,t,i,r.beforeChange),i(e[t],t,e),function(){o&&o(),je.removeOwnPropertyChangeListener(e,t,i,r.beforeChange)}}function u(e,t){return function(n,r){return t(function(t){function i(e){return null==e?i.emit():e.observeProperty?e.observeProperty(t,i.emit,i.scope):i.observeProperty(e,t,i.emit,i.scope)}return"string"!=typeof t&&"number"!=typeof t?n():(i.observeProperty=De,i.emit=n,i.scope=r,e(i,r))},r)}}function c(e,t,n,r){function i(e,r,i){a(t,r)&&(o&&o(),o=n(e,t,i))}var o,a=e.contentEquals||Object.equals;return i(e.get(t),t,e),e.addMapChangeListener(i,r.beforeChange),function(){o&&o(),e.removeMapChangeListener(i)}}function h(e,t){return function(n,r){return e(function(e){function i(t){return null==t?n():e.observeGet?e.observeGet(t,n,r):i.observeGet(e,t,n,r)}return e?(i.observeGet=Se,t(i,r)):n()},r)}}function p(e,t){return function(n,r){return n=we(n),t(function(t){return e(function(e){return e?e.addRangeChangeListener?Q(e,function(){return n((e.has||e.contains).call(e,t))},r):e.addMapChangeListener?se(e,function(){return n(e.has(t))},r):n():n()},r)},r)}}function d(e){return function(t,n){for(var r=[],i=[],o=0,a=e.length;o<a;o++)r[o]=void 0,i[o]=function(e,t){return e(function(e){r.set(t,e)},n)}(e[o],o);var s=t(r);return function(){s&&s();for(var e=0,t=i.length;e<t;e++)s=i[e],s&&s()}}}function f(e){return function(t,n){var r,i={},o={},a=Object.keys(e);for(r=0;name=a[r];r++)!function(e,t){o[e]=void 0,i[e]=t(function(t){o[e]=t},n)}(name,e[name]);var s=t(o);return function(){s&&s();var e,t=Object.keys(i);for(e=0;name=t[e];e++)s=i[name],s&&s()}}}function v(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return d(e)}function m(e){return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var r=d(t),i=oe(r);return function(t,n){return i(function(n){return n.every(Ae.defined)?t(1===n.length?e.call(void 0,n[0]):2===n.length?e.call(void 0,n[0],n[1]):e.apply(void 0,n)):t()},n)}}}function g(e){var t=e.slice(0,1).toUpperCase();t+=e.slice(1);var n="make";n+=t,n+="Observer";var r="observe";return r+=t,function(){var t=arguments[0],i=Array.prototype.slice.call(arguments,1),o=d(i),a=oe(o);return function(o,s){return t(function(t){return t?t[n]?1===i.length?t[n].call(t,i[0])(o,s):2===i.length?t[n].call(t,i[0],i[1])(o,s):t[n].apply(t,i)(o,s):t[r]?t[r](o,s):a(function(n){return n.every(Ae.defined)&&"function"==typeof t[e]?o(1===n.length?t[e].call(t,n[0]):2===n.length?t[e].call(t,n[0],n[1]):t[e].apply(t,n)):o()},s):o()},s)}}}function _(e){return function(t,n){return e(function(e){return t(!e)},n)}}function b(e,t){return function(n,r){return e(function(e){return e?t(n,r):n(e)},r)}}function y(e,t){return function(n,r){return e(function(e){return e?n(e):t(n,r)},r)}}function w(e,t,n){return function(r,i){return e(function(e){return null==e?r():e?t(r,i):n(r,i)},i)}}function E(e){return function(t,n){return e(function(e){return t(null!=e)},n)}}function C(e,t){return function(n,r){return e(function(e){return null==e?t(n,r):n(e)},r)}}function O(e,t){return function(n,r){return e(function(e){function i(t){for(var n=0,r=e.length;n<r;n++)s[n].index=n}function o(e,n,o){function u(e,t,n,r,i,o,a,s){function l(e){d?i.set(u.index,e):o[t]=e}var u=r[n+t];return a(l,s.nest(e))}var c,h,p=[];for(c=0,h=e.length;c<h;c++)p[c]={index:o+c};Oe(s,o,n.length,p),i(o+e.length);var d,f,v=[],m=o,g=o+n.length;for(m=o,g=o+n.length;m<g;m++)f=l[m],f&&f();for(c=0,h=e.length;c<h;c++)p[c]=u(e[c],c,o,s,a,v,t,r);Oe(l,o,n.length,p),d=!0,a.swap(o,n.length,v)}if(!e)return n();var a=[],s=[],l=[],u=Q(e,o,r),c=n(a,e);return function(){c&&c();for(var e=0,t=l.length;e<t;e++)c=l[e],c&&c();u()}},r)}}function j(e,t){var n=O(e,t);return function(e,t){return n(function(n,r){function i(e){for(;e<n.length;e++)l[e+1]=l[e]+!!n[e]}function o(e,t,n){var o=r.slice(n,n+e.length),s=t.map(Boolean).sum(),u=o.filter(function(t,n){return e[n]}),c=l[n],h=a.slice(c,c+s);(h.length!==u.length||h.some(function(e,t){return e!==u[t]}))&&a.swap(c,s,u),i(c)}if(!r)return e();var a=[],s=[],l=[0],u=Q(n,o,t),c=e(a);return function(){c&&c();for(var e=0,t=s.length;e<t;e++)c=s[e],c&&c();u()}},t)}}function P(e,t){var n=x(t),r=O(e,n),i=function(e,t){return r(function(n){function r(e,t){o.deleteEach(t),o.addEach(e)}if(!n)return e();var i=[],o=Pe(i,T,k),a=Q(n,r,t),s=e(i);return function(){s&&s(),a()}},t)};return Le(i,he)}function T(e,t){return Object.equals(e[1],t[1])}function k(e,t){return Object.compare(e[1],t[1])}function x(e){return function(t,n){return e(function(e){return t([n.value,e])},n)}}function A(e,t){var n=x(t),r=O(e,n),i=F(r,de),o=O(i,Z(de));return function(e,t){function n(e,t){return e=s.get(e),t=s.get(t),Object.compare(e,t)}function r(e,t){return e=s.get(e),t=s.get(t),Object.equals(e,t)}function i(e,t){var n,r,i;for(n=0,r=t.length;n<r;n++)i=t[n],l["delete"](i[0]),s["delete"](i[0]);for(n=0,r=e.length;n<r;n++)i=e[n],s.set(i[0],i[1]),l.add(i[0])}function a(e){return l.clear(),Q(e,i,t)}var s=new ke,l=new Te(null,r,n),u=e(l),c=o(a,t);return function(){u&&u(),c()}}}function D(e){return function(t,n){return e(function(e){function r(e,t,n){var r=i.length-n-t.length;i.swap(r,t.length,e.reversed())}if(!e)return t();var i=[],o=Q(e,r,n),a=t(i);return function(){a&&a(),o()}},n)}}function S(e){return function(t,n){return e(function(e){function r(t){for(var n=t;n<e.length;n++)l[n].index=n,e[n]?s[n+1]=s[n]+e[n].length:s[n+1]=s[n]}function i(e,t,i){var u=s[i],c=s[i+t.length],h=c-u;o.swap(u,h,[]),Oe(l,i,t.length,e.map(function(){return{index:null}})),r(i);for(var p,d=i,c=i+t.length;d<c;d++)p=a[d],p&&p();Oe(a,i,t.length,e.map(function(e,t){function a(e,t,n){r(u.index);var i=s[u.index]+n,a=s[u.index]+n+t.length,l=a-i;o.swap(i,l,e)}var u=l[i+t];return Q(e,a,n)}))}if(!e)return t();var o=[],a=[],s=[0],l=[],u=Q(e,i,n),c=t(o);return function(){c&&c();for(var e=0,t=a.length;e<t;e++)c=a[e],c&&c();u()}},n)}}function L(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Re(d(e))}function M(e,t){var n=Me(e,t),r=u(n,Fe);return me(r,Boolean)}function R(e,t){var n=me(t,Ae.not),r=Me(e,n),i=u(r,Fe);return me(i,Ae.not)}function F(e,t){var n=z(e,t);return Be(n)}function z(e,t){var n=x(t),r=O(e,n);return function(e,t){return r(function(n,r){function i(e,t,n){var i,a,s,l,u;for(i=0,a=t.length;i<a;i++)s=t[i],l=o.get(s[1]),1===l.length?o["delete"](s[1]):l["delete"](s[0]);for(i=0,a=e.length;i<a;i++)s=e[i],u=!o.has(s[1]),l=u?r.constructClone():o.get(s[1]),l.add(s[0]),u&&o.set(s[1],l)}if(!n)return e();var o=new ke,a=Q(n,i,t),s=e(o);return function(){a(),s&&s()}},t)}}function I(e,t,n){function r(e,t){return Object.compare(e[1],t[1])*n}var i=x(t),o=O(e,i);return function(e,t){return o(function(n){function i(e,t){a.addEach(e),a.deleteEach(t)}function o(t,n){if(0===n)return t?e(t[0]):e()}if(!n)return e();var a=new xe(null,T,r),s=Q(n,i,t),l=se(a,o,t);return function(){s(),l()}},t)}}function N(e,t){return I(e,t,1)}function B(e,t){return I(e,t,-1)}function U(e){return I(e,i,1)}function q(e){return I(e,i,-1)}function V(e){return function(t){return function(n,r){return n=we(n),t(function(t){if(!t)return n();var i=e(t,n);return Q(t,function(e,t,r){return n(i(e,t,r))},r)},r)}}}function W(e){return"number"==typeof e&&!isNaN(e)}function H(e,t,n){return n||(n=t,t=ze),function(r,i){return e(function(e){function o(t,n,r){if(h){var i=t.length-n.length;r<=s?i>0?(c.swap(0,0,e.slice(s,s+i)),c.splice(a,c.length-a)):(c.splice(0,-i),c.swap(c.length,0,e.slice(s+c.length,s+a))):r<s+a&&(c.swap(r-s,n.length,t),i>0?c.splice(a,c.length-a):c.swap(c.length,0,e.slice(s+c.length,s+a)))}}if(!e)return r();var a,s,l,u,c=[],h=!1,p=Q(e,o,i),d=n(function(t){t=+t,isNaN(t)&&(t=void 0);var n="number"==typeof t&&"number"==typeof s,r=Math.max(0,t);"number"==typeof u&&(r=Math.min(r,e.length-u)),h!==n?(n?c.swap(0,0,e.slice(u,u+r)):c.clear(),h=n):h&&l!==r&&(r<l?c.splice(t,l-r):c.swap(l,0,e.slice(u+l,u+r))),a=t,l=r},i),f=t(function(t){t=+t,isNaN(t)&&(t=void 0);var n="number"==typeof a&&"number"==typeof t,r=Math.max(0,t);"number"==typeof a&&(r=Math.min(r,e.length));var i=Math.max(0,a);if("number"==typeof r&&(i=Math.min(i,e.length-r)),h!==n)n?c.swap(0,c.length,e.slice(r,r+i)):c.clear(),h=n;else if(h&&u!==r){var o=Math.abs(r-u);o<l&&r<u?(c.swap(0,0,e.slice(r,u)),c.splice(i,c.length-i)):o<l&&r>u?(c.swap(c.length,0,e.slice(u+l,r+i)),c.splice(0,c.length-i)):c.swap(0,c.length,e.slice(r,r+i))}s=t,u=r,l=i},i),v=r(c);return function(){v&&v(),d(),f(),p()}},i)}}function X(e){return function(t,n){return e(function(e){function r(e){for(;e<o.length;e++)o[e].set(0,e)}function i(e,t,n){o.swap(n,t.length,e.map(function(e,t){return[n+t,e]})),r(n+e.length)}if(!e)return t();var o=[],a=Q(e,i,n),s=t(o);return function(){s&&s(),a()}},n)}}function G(e){return function(t,n){var r=[],i=t(r),o=e(function(e){if(e>>>=0,null==e)r.clear();else if(e>r.length){for(var t=[],n=r.length;n<e;n++)t.push(n);r.swap(r.length,0,t)}else e<r.length&&r.splice(e,r.length)},n);return function(){i&&i(),o&&o()}}}function Y(e,t){return function(n,r){return t(function(t){if("string"!=typeof t)return n();var i=new RegExp("^"+RegExp.escape(t));return e(function(e){return"string"!=typeof e?n():n(i.test(e))},r)},r)}}function $(e,t){return function(n,r){return t(function(t){if("string"!=typeof t)return n();var i=new RegExp(RegExp.escape(t)+"$");return e(function(e){return"string"!=typeof e?n():n(i.test(e))},r)},r)}}function K(e,t){return function(n,r){return t(function(t){if("string"!=typeof t)return n();var i=new RegExp(RegExp.escape(t));return e(function(e){return"string"!=typeof e?n():n(i.test(e))},r)},r)}}function J(e,t){return t=t||Ie,function(n,r){return e(function(e){return e?t(function(t){function i(){o&&o(),o=n(e.join(t))}if("string"!=typeof t)return n();var o,a=Q(e,i,r);return function(){a(),o&&o()}},r):n()},r)}}function Q(e,t,n){function r(e,n,r){i&&i(),i=t(e,n,r)}if(!e||!e.toArray||!e.addRangeChangeListener)return Function.noop;var i,o;return r(Array.isArray(e)?e:e.toArray(),Array.empty,0),o=e.addRangeChangeListener(r,null,n.beforeChange),function(){i&&i(),o()}}function Z(e){return function(t,n){return e(function(e){return Ne(e,t,n)},n)}}function ee(e,t,n){function r(n,r,s){if(o+=n.length-r.length,!(s+r.length<o&&s+n.length<o)){var l=o<0?null:e.get(o);i&&i(),i=t(l),a=l}}var i,o=-1,a=null,s=Q(e,r,n);return function(){i&&i(),s&&s()}}function te(e){return function(t,n){return e(we(function(e){return ne(e,t,n)}),n)}}function ne(e,t,n){function r(n,r,o){return i+=n.length-r.length,1!==i?t():t(e.only())}var i=0;return Q(e,r,n)}function re(e){return function(t,n){return e(we(function(e){return ie(e,t,n)}),n)}}function ie(e,t,n){function r(n,r,o){return i+=n.length-r.length,0===i?t():t(e.one())}var i=0;return Q(e,r,n)}function oe(e){return function(t,n){return e(function(e){return e&&e.addRangeChangeListener?Q(e,function(){return t(e)},n):t(e)},n)}}function ae(e){return function(t,n){return e(function(e){return e&&e.addMapChangeListener?se(e,function(){return t(e)},n):t(e)},n)}}function se(e,t,n){function r(e,n,r){var o=i.get(n);i["delete"](n),o&&o(),o=t(e,n,r),void 0===e?o&&o():i.set(n,o)}if(e.addMapChangeListener){var i=new ke;e.forEach(r);var o=e.addMapChangeListener(r,n.beforeChange);return function(){i.forEach(function(e){e&&e()}),o()}}}function le(e){return function(t,n){return e(function(e){return e?ue(e,t,n):t()},n)}}function ue(e,t,n){function r(e,t,n){var r,a;o.has(t)?null==e?(r=o.get(t),o["delete"](t),a=i.indexOf(r),i.splice(a,1)):(r=o.get(t),r.set(1,e)):(r=[t,e],o.set(t,r),i.push(r))}var i=[],o=new ke,a=t(i),s=se(e,r,n);return function(){a&&a(),s&&s()}}function ce(e){var t=Be(e);return Le(t,he)}function he(e,t){return t.value?e(t.value[0]):e()}function pe(e){var t=Be(e);return Le(t,de)}function de(e,t){return t.value?e(t.value[1]):e()}function fe(e){return function(t,n){var r=new ke,i=t(r),o=e(function(e){if(r.clear(),e&&"object"==typeof e){if(e.addRangeChangeListener)return Ue(function(e){function t(e,t){var n,i;for(n=0,i=t.length;n<i;n++)r["delete"](t[n][0]);for(n=0,i=e.length;n<i;n++)r.set(e[n][0],e[n][1])}return Q(e,t,n)},n.nest(e));if(e.addMapChangeListener)return se(e,function(e,t){void 0===e?r["delete"](t):r.set(t,e)},n);var t=[],i=0;for(var o in e)t[i++]=De(e,o,function(e){void 0===e?r["delete"](o):r.set(o,e)},n);return function(){for(var e=0,n=t.length;e<n;e++)t[e]()}}},n)||Function.noop;return function(){i&&i(),o()}}}function ve(e){return function(t,n){return n.parent?e(t,n.parent):t()}}function me(e,t,n){return function(r,i){return r=we(r),e(function(e){return r(t.call(n,e))},i)}}function ge(e,t,n){return function(r,i){return r=we(r),e(function(e){if(e&&e.every(Ae.defined))return r(1===e.length?t.call(n,e[0]):2===e.length?t.call(n,e[0],e[1]):t.apply(n,e))},i)}}function _e(t,n){var r=e("./parse"),i=e("./compile-observer");return function(e,o){return e=we(e),n(function(n){if(null==n)return e();var a,s;try{a=r(n),s=i(a)}catch(l){return e()}return t(function(t){return s(e,o.nest(t))},o)},o)}}function be(e,t){return function(n,r){return e(function(e){return null==e?n():t(function(e){return null==e?n():n(e)},r.nest(e))},r)}}function ye(e){return function(){var t;return t=1===arguments.length?e.call(this,arguments[0]):2===arguments.length?e.call(this,arguments[0],arguments[1]):e.apply(this,arguments),function(e,n){var r=[],i=t(function(e){function t(e,t,n){r.swap(n,t.length,e)}return e&&e.addRangeChangeListener?(qe(r,e),e.addRangeChangeListener(t,null,n.beforeChange),function(){e.removeRangeChangeListener(t,null,n.beforeChange)}):void r.clear()},n),o=e(r);return function(){i&&i(),o&&o()}}}}function we(e){var t;return function(n){if(n!==t){var r;return r=1===arguments.length?e.call(this,arguments[0]):2===arguments.length?e.apply(this,arguments[0],arguments[1]):e.apply(this,arguments),t=n,r}}}function Ee(e){e.forEach(function(e){e&&e()})}function Ce(e){var t;return function(){if(t&&t(),1===arguments.length)t=e.call(void 0,arguments[0]);else if(2===arguments.length)t=e.call(void 0,arguments[0],arguments[1]);else if(3===arguments.length)t=e.call(void 0,arguments[0],arguments[1],arguments[2]);else{for(var n=new Array(arguments.length),r=0,i=arguments.length;r<i;r++)n[r]=arguments[r];t=e.apply(void 0,n)}return function(){t&&t(),t=void 0}}}function Oe(e,t,n,r){t<0?t=e.length+t:t>e.length&&(e.length=t),t+n>e.length?n=e.length-t:n<0&&(n=0);var i=r.length-n,o=e.length,a=e.length+i;if(i>0)for(var s=o-1;s>=t+n;s--){var l=s+i;s in e?e[l]=e[s]:(e[l]=void 0,delete e[l])}for(var s=0;s<r.length;s++)s in r?e[t+s]=r[s]:(e[t+s]=void 0,delete e[t+s]);if(i<0)for(var s=t+r.length;s<o-i;s++){var l=s-i;l in e?e[s]=e[l]:(e[s]=void 0,delete e[s])}e.length=a}e("collections/shim");var je=e("collections/listen/property-changes");e("collections/listen/array-changes");var Pe=e("collections/sorted-array"),Te=e("collections/sorted-set"),ke=e("collections/map"),xe=(e("collections/set"),e("collections/heap")),Ae=(e("./scope"),e("./operators"));t.makeLiteralObserver=r,t.observeValue=i,t.observeParameters=o,t.makeElementObserver=a,t.makeComponentObserver=s,t.observeProperty=l;var De=l;t.makePropertyObserver=u,t.observeKey=c,t.observeGet=c;var Se=c;t.makeGetObserver=h,t.makeHasObserver=p,t.makeObserversObserver=d,t.makeRecordObserver=f,t.makeObjectObserver=f,t.makeTupleObserver=v,t.makeArrayObserver=v,t.makeOperatorObserverMaker=m,t.makeMethodObserverMaker=g,t.makeNotObserver=_,t.makeAndObserver=b,t.makeOrObserver=y,t.makeConditionalObserver=w,t.makeDefinedObserver=E,t.makeDefaultObserver=C;var Le=t.makeMapBlockObserver=ye(O),Me=t.makeFilterBlockObserver=ye(j);t.makeSortedBlockObserver=P,t.makeSortedSetBlockObserver=A,t.makeReversedObserver=ye(D);var Re=t.makeFlattenObserver=ye(S);t.makeConcatObserver=L,t.makeSomeBlockObserver=M,t.makeEveryBlockObserver=R,t.makeGroupBlockObserver=F,t.makeGroupMapBlockObserver=z,
t.makeMaxBlockObserver=N,t.makeMinBlockObserver=B,t.makeMaxObserver=U,t.makeMinObserver=q;var Fe=r("length");t.makeSumObserver=V(function(){var e=0;return function(t,n,r){return t=t.filter(W),n=n.filter(W),e+=t.sum()-n.sum()}}),t.makeAverageObserver=V(function(){var e=0,t=0;return function(n,r,i){return n=n.filter(W),r=r.filter(W),e+=n.sum()-r.sum(),t+=n.length-r.length,e/t}}),t.makeViewObserver=ye(H);var ze=r(0);t.makeEnumerateObserver=ye(X),t.makeEnumerationObserver=t.makeEnumerateObserver,t.makeRangeObserver=G,t.makeStartsWithObserver=Y,t.makeEndsWithObserver=$,t.makeContainsObserver=K,t.makeJoinObserver=J;var Ie=r("");t.observeRangeChange=Q,t.makeLastObserver=Z,t.observeLast=ee;var Ne=ee;t.makeOnlyObserver=te,t.observeOnly=ne,t.makeOneObserver=re,t.observeOne=ie,t.makeRangeContentObserver=oe,t.makeMapContentObserver=ae,t.observeMapChange=se;var Be=t.makeEntriesObserver=ye(le);t.observeEntries=ue,t.makeKeysObserver=ce,t.observeEntryKey=he,t.makeValuesObserver=pe,t.observeEntryValue=de,t.makeToMapObserver=fe;var Ue=Le(F(i,he),Z(de));t.makeParentObserver=ve,t.makeConverterObserver=me,t.makeComputerObserver=ge,t.makePathObserver=_e,t.makeExpressionObserver=_e,t.makeWithObserver=be,t.makeToArrayObserver=ye(Function.identity),t.makeAsArrayObserver=t.makeToArrayObserver;var qe=e("./merge").merge;t.makeUniq=we,t.cancelEach=Ee,t.autoCancelPrevious=Ce}}),montageDefine("afa97d9","bindings",{dependencies:["collections/map","./bind","./compute","./observe","./stringify"],factory:function(e,t,n){function r(e,t,n){if(t)for(var r in t)i(e,r,t[r],n);return e}function i(e,n,r,o){o=o||i.empty;var a,s,l=i.getBindings(e);if(l.has(n))throw new Error("Can't bind to already bound target, "+JSON.stringify(n));return d in r||f in r||v in r?(l.set(n,r),r.target=e,(a=r.parameters||o.parameters)&&(r.parameters=a),(s=r.document||o.document)&&(r.document=s),r.components=r.components||o.components,r.cancel=v in r?i.compute(e,n,r):i.bind(e,n,r),t.count++):(m in r||g in r||_ in r||(r.writable=!0),b in r||(r.configurable=!0),y in r||(r.enumerable=!0),Object.defineProperty(e,n,r)),e}function o(e){var t;return p.get(e)||p.set(e,t=new u)&&t}function a(e,t){var n=o(e);return n.get(t)}function s(e){for(var t=o(e),n=t.keys();name=n.next().value;)l(e,name,t)}function l(e,n,r){if(!r&&(r=o(e),!r.has(n)))throw new Error("Can't cancel non-existent binding to "+JSON.stringify(n));var i=r.get(n);i&&i.cancel&&(i.cancel(),r["delete"](n),t.count--,r.size<1&&p["delete"](e))}var u=e("collections/map"),c=e("./bind"),h=e("./compute"),p=(e("./observe"),e("./stringify"),new u),d=(Object.prototype.hasOwnProperty,"<-"),f="<->",v="compute",m="get",g="set",_="writable",b="configurable",y="enumerable";t.count=0,t.bindings=p,t.defineBindings=r,t.defineBinding=i,i.empty=Object.empty,i.getBindings=o,i.compute=h,i.bind=c,t.getBindings=o,t.getBinding=a,t.cancelBindings=s,t.cancelBinding=l}}),montageDefine("afa97d9","stringify",{dependencies:["./parse","./language","./language","./language"],factory:function(e,t,n){"use strict";function r(e,t){return r.semantics.stringify(e,t)}function i(e){return function(t,n,r){var i=e+"{"+r(t.args[1],n)+"}";return"value"===t.args[0].type?i:r(t.args[0],n)+"."+i}}var o=(e("./parse"),e("./language").precedence),a=e("./language").operatorTypes;e("./language").operatorTokens,n.exports=r,r.semantics={makeBlockStringifier:i,stringify:function(e,t,n){function r(e){var n=a(e,t);return n?n:"this"}var i,a=this.stringify.bind(this),s=this.stringifiers;if(s[e.type])i=s[e.type](e,t,a);else if(e.inline)i="&"+e.type+"("+e.args.map(r).join(", ")+")";else{var l;1===e.args.length&&"mapBlock"===e.args[0].type?(l=e.type+"{"+a(e.args[0].args[1],t)+"}",e=e.args[0]):l=e.type+"("+e.args.slice(1).map(r).join(", ")+")",i="value"===e.args[0].type?l:a(e.args[0],t)+"."+l}return!n||n.type===e.type&&"if"!==n.type||o.get(n.type).has(e.type)?i:"("+i+")"},stringifiers:{value:function(e,t,n){return""},literal:function(e,t,n){return"string"==typeof e.value?"'"+e.value.replace("'","\\'")+"'":""+e.value},parameters:function(e,t,n){return"$"},record:function(e,t,n){return"{"+Object.map(e.args,function(e,r){var i;return i="value"===e.type?"this":n(e,t),r+": "+i}).join(", ")+"}"},tuple:function(e,t,n){return"["+Object.map(e.args,function(e){return"value"===e.type?"this":n(e)}).join(", ")+"]"},component:function(e,t){var n;return t&&t.components&&e.component?t.components.getObjectLabel?n=t.components.getObjectLabel(e.component):t.components.getLabelForObject&&(n=t.components.getLabelForObject(e.component)):n=e.label,"@"+n},element:function(e){return"#"+e.id},mapBlock:i("map"),filterBlock:i("filter"),someBlock:i("some"),everyBlock:i("every"),sortedBlock:i("sorted"),sortedSetBlock:i("sortedSet"),groupBlock:i("group"),groupMapBlock:i("groupMap"),minBlock:i("min"),maxBlock:i("max"),property:function(e,t,n){return"value"===e.args[0].type?"string"==typeof e.args[1].value?e.args[1].value:"literal"===e.args[1].type?"."+e.args[1].value:"this["+n(e.args[1],t)+"]":"parameters"===e.args[0].type?"$"+e.args[1].value:"literal"===e.args[1].type&&/^[\w\d_]+$/.test(e.args[1].value)?n(e.args[0],t,{type:"scope"})+"."+e.args[1].value:n(e.args[0],{type:"scope"},t)+"["+n(e.args[1],t)+"]"},"with":function(e,t,n){var r=n(e.args[1],t,e);return n(e.args[0],t)+"."+r},not:function(e,t,n){return"equals"===e.args[0].type?n(e.args[0].args[0],t,{type:"equals"})+" != "+n(e.args[0].args[1],t,{type:"equals"}):"!"+n(e.args[0],t,e)},neg:function(e,t,n){return"-"+n(e.args[0],t,e)},toNumber:function(e,t,n){return"+"+n(e.args[0],t,e)},parent:function(e,t,n){return"^"+n(e.args[0],t,e)},"if":function(e,t,n){return n(e.args[0],t,e)+" ? "+n(e.args[1],t)+" : "+n(e.args[2],t)},event:function(e,t,n){return e.when+" "+e.event+" -> "+n(e.listener,t)},binding:function(e,t,n,r){var i=r(t.args[0],n)+" "+e+" "+r(t.args[1],n),o="",a=t.descriptor;if(a)for(var s in a)o+=", "+s+": "+r(a[s],n);return i+o},bind:function(e,t,n){return this.binding("<-",e,t,n)},bind2:function(e,t,n){return this.binding("<->",e,t,n)},assign:function(e,t,n){return n(e.args[0],t)+": "+n(e.args[1],t)},block:function(e,t,n){var r="@"+e.label;return e.connection&&("prototype"===e.connection?r+=" < ":"object"===e.connection&&(r+=" : "),r+=n({type:"literal",value:e.module}),e.exports&&"value"!==e.exports.type&&(r+=" "+n(e.exports,t))),r+" {\n"+e.statements.map(function(e){return"    "+n(e,t)+";\n"}).join("")+"}\n"},sheet:function(e,t,n){return"\n"+e.blocks.map(function(e){return n(e,t)}).join("\n")+"\n"}}},a.forEach(function(e,t){r.semantics.stringifiers[t]=function(t,n,r){return t.args.map(function(e){return r(e,n,t)}).join(" "+e+" ").trim()}})}}),montageDefine("afa97d9","expand",{dependencies:["collections/set","collections/map","./operators"],factory:function(e,t,n){function r(e,t){var n=r.semantics.expand.bind(r.semantics);return n(e,t,n)}var i=e("collections/set"),o=e("collections/map");e("./operators"),n.exports=r,r.semantics={reflexive:new i(["literal","element","rangeContent","mapContent"]),traverseLeft:new i(["with","mapBlock","filterBlock","someBlock","everyBlock","sortedBlock","groupBlock","groupMapBlock"]),expanders:new o([["value",function(e,t){return t.value||{type:"value"}}],["parameters",function(e,t){return t.parameters||{type:"parameters"}}],["record",function(e,t,n){var r={type:"record",args:[]};for(var i in e.args)r.args[i]=n(e.args[i],t,n);return r}],["component",function(e,t,n){return t.components&&e.component?{type:"component",label:t.components.getObjectLabel(e.component)}:e}]]),expand:function(e,t,n){return this.expanders.has(e.type)?this.expanders.get(e.type)(e,t,n):this.traverseLeft.has(e.type)?{type:e.type,args:[n(e.args[0],t,n)].concat(e.args.slice(1))}:this.reflexive.has(e.type)?e:{type:e.type,args:e.args.map(function(e){return n(e,t,n)})}}}}}),montageDefine("afa97d9","grammar",{dependencies:[],factory:function(e,t,n){n.exports=function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,t,n,r,i){function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r,i;switch(e.length){case 0:r="end of input";break;case 1:r=e[0];break;default:r=e.slice(0,-1).join(", ")+" or "+e[e.length-1]}return i=t?'"'+n(t)+'"':"end of input","Expected "+r+" but "+i+" found."}this.expected=e,this.found=t,this.offset=n,this.line=r,this.column=i,this.name="SyntaxError",this.message=o(e,t)}function n(e){function n(t){function n(t,n,r){var i,o;for(i=n;i<r;i++)o=e.charAt(i),"\n"===o?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):"\r"===o||"\u2028"===o||"\u2029"===o?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return Hr!==t&&(Hr>t&&(Hr=0,Xr={line:1,column:1,seenCR:!1}),n(Xr,Hr,t),Hr=t),Xr}function r(e){Vr<Gr||(Vr>Gr&&(Gr=Vr,Yr=[]),Yr.push(e))}function i(e){var t=0;for(e.sort();t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function o(){var e,t;return $r++,e=l(),$r--,null===e&&(t=null,0===$r&&r(Z)),e}function a(){var t,n,i,a,s,l,u;if(t=Vr,n=o(),null!==n){for(i=[],a=Vr,44===e.charCodeAt(Vr)?(s=te,Vr++):(s=null,0===$r&&r(ne)),null!==s?(l=B(),null!==l?(u=o(),null!==u?(s=[s,l,u],a=s):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee);null!==a;)i.push(a),a=Vr,44===e.charCodeAt(Vr)?(s=te,Vr++):(s=null,0===$r&&r(ne)),null!==s?(l=B(),null!==l?(u=o(),null!==u?(s=[s,l,u],a=s):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee);null!==i?(a=B(),null!==a?(Wr=t,n=re(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function s(){var t,n,i,o;return t=Vr,40===e.charCodeAt(Vr)?(n=ie,Vr++):(n=null,0===$r&&r(oe)),null!==n?(i=B(),null!==i?(41===e.charCodeAt(Vr)?(o=ae,Vr++):(o=null,0===$r&&r(se)),null!==o?(Wr=t,n=le(),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,40===e.charCodeAt(Vr)?(n=ie,Vr++):(n=null,0===$r&&r(oe)),null!==n?(i=a(),null!==i?(41===e.charCodeAt(Vr)?(o=ae,Vr++):(o=null,0===$r&&r(se)),null!==o?(Wr=t,n=ue(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)),t}function l(){var t,n,i,a,s,l,c,h,p,d,f;return t=Vr,n=u(),null!==n?(i=B(),null!==i?(a=Vr,63===e.charCodeAt(Vr)?(s=he,Vr++):(s=null,0===$r&&r(pe)),null!==s?(l=B(),null!==l?(c=o(),null!==c?(h=B(),null!==h?(58===e.charCodeAt(Vr)?(p=de,Vr++):(p=null,0===$r&&r(fe)),null!==p?(d=B(),null!==d?(f=o(),null!==f?(s=[s,l,c,h,p,d,f],a=s):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee),null===a&&(a=ce),null!==a?(Wr=t,n=ve(n,a),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),t}function u(){var t,n,i,o,a,s,l,u;if(t=Vr,n=c(),null!==n){for(i=[],o=Vr,a=B(),null!==a?(e.substr(Vr,2)===me?(s=me,Vr+=2):(s=null,0===$r&&r(ge)),null!==s?(l=B(),null!==l?(u=c(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==o;)i.push(o),o=Vr,a=B(),null!==a?(e.substr(Vr,2)===me?(s=me,Vr+=2):(s=null,0===$r&&r(ge)),null!==s?(l=B(),null!==l?(u=c(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==i?(Wr=t,n=_e(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function c(){var t,n,i,o,a,s,l,u;if(t=Vr,n=h(),null!==n){for(i=[],o=Vr,a=B(),null!==a?(e.substr(Vr,2)===be?(s=be,Vr+=2):(s=null,0===$r&&r(ye)),null!==s?(l=B(),null!==l?(u=h(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==o;)i.push(o),o=Vr,a=B(),null!==a?(e.substr(Vr,2)===be?(s=be,Vr+=2):(s=null,0===$r&&r(ye)),null!==s?(l=B(),null!==l?(u=h(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==i?(Wr=t,n=_e(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function h(){var t,n,i,o,a,s,l,u,c;return t=Vr,n=p(),null!==n?(i=Vr,o=B(),null!==o?(a=Vr,e.substr(Vr,3)===we?(s=we,Vr+=3):(s=null,0===$r&&r(Ee)),null===s&&(e.substr(Vr,2)===Ce?(s=Ce,Vr+=2):(s=null,0===$r&&r(Oe)),null===s&&(e.substr(Vr,2)===je?(s=je,Vr+=2):(s=null,0===$r&&r(Pe)),null===s&&(s=Vr,60===e.charCodeAt(Vr)?(l=Te,Vr++):(l=null,0===$r&&r(ke)),null!==l?(u=Vr,$r++,45===e.charCodeAt(Vr)?(c=xe,Vr++):(c=null,0===$r&&r(Ae)),$r--,null===c?u=ce:(Vr=u,u=ee),null!==u?(l=[l,u],s=l):(Vr=s,s=ee)):(Vr=s,s=ee),null===s&&(62===e.charCodeAt(Vr)?(s=De,Vr++):(s=null,0===$r&&r(Se)),null===s&&(e.substr(Vr,2)===Le?(s=Le,Vr+=2):(s=null,0===$r&&r(Me)),null===s&&(e.substr(Vr,2)===Re?(s=Re,Vr+=2):(s=null,0===$r&&r(Fe)))))))),null!==s&&(s=e.substring(a,Vr)),a=s,null!==a?(s=B(),null!==s?(l=p(),null!==l?(o=[o,a,s,l],i=o):(Vr=i,i=ee)):(Vr=i,i=ee)):(Vr=i,i=ee)):(Vr=i,i=ee),null===i&&(i=ce),null!==i?(Wr=t,n=ze(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee),t}function p(){var t,n,i,o,a,s,l,u;if(t=Vr,n=d(),null!==n){for(i=[],o=Vr,a=B(),null!==a?(s=Vr,43===e.charCodeAt(Vr)?(l=Ie,Vr++):(l=null,0===$r&&r(Ne)),null===l&&(45===e.charCodeAt(Vr)?(l=xe,Vr++):(l=null,0===$r&&r(Ae))),null!==l&&(l=e.substring(s,Vr)),s=l,null!==s?(l=B(),null!==l?(u=d(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==o;)i.push(o),o=Vr,a=B(),null!==a?(s=Vr,43===e.charCodeAt(Vr)?(l=Ie,Vr++):(l=null,0===$r&&r(Ne)),null===l&&(45===e.charCodeAt(Vr)?(l=xe,Vr++):(l=null,0===$r&&r(Ae))),null!==l&&(l=e.substring(s,Vr)),s=l,null!==s?(l=B(),null!==l?(u=d(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==i?(Wr=t,n=_e(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function d(){var t,n,i,o,a,s,l,u;if(t=Vr,n=f(),null!==n){for(i=[],o=Vr,a=B(),null!==a?(s=Vr,42===e.charCodeAt(Vr)?(l=Be,Vr++):(l=null,0===$r&&r(Ue)),null===l&&(47===e.charCodeAt(Vr)?(l=qe,Vr++):(l=null,0===$r&&r(Ve)),null===l&&(37===e.charCodeAt(Vr)?(l=We,Vr++):(l=null,0===$r&&r(He)),null===l&&(e.substr(Vr,3)===Xe?(l=Xe,Vr+=3):(l=null,0===$r&&r(Ge))))),null!==l&&(l=e.substring(s,Vr)),s=l,null!==s?(l=B(),null!==l?(u=f(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==o;)i.push(o),o=Vr,a=B(),null!==a?(s=Vr,42===e.charCodeAt(Vr)?(l=Be,Vr++):(l=null,0===$r&&r(Ue)),null===l&&(47===e.charCodeAt(Vr)?(l=qe,Vr++):(l=null,0===$r&&r(Ve)),null===l&&(37===e.charCodeAt(Vr)?(l=We,Vr++):(l=null,0===$r&&r(He)),null===l&&(e.substr(Vr,3)===Xe?(l=Xe,Vr+=3):(l=null,0===$r&&r(Ge))))),null!==l&&(l=e.substring(s,Vr)),s=l,null!==s?(l=B(),null!==l?(u=f(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==i?(Wr=t,n=_e(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function f(){var t,n,i,o,a,s,l,u;if(t=Vr,n=v(),null!==n){for(i=[],o=Vr,a=B(),null!==a?(s=Vr,e.substr(Vr,2)===Ye?(l=Ye,Vr+=2):(l=null,0===$r&&r($e)),null===l&&(e.substr(Vr,2)===Ke?(l=Ke,Vr+=2):(l=null,0===$r&&r(Je)),null===l&&(e.substr(Vr,2)===Qe?(l=Qe,Vr+=2):(l=null,0===$r&&r(Ze)))),null!==l&&(l=e.substring(s,Vr)),s=l,null!==s?(l=B(),null!==l?(u=v(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==o;)i.push(o),o=Vr,a=B(),null!==a?(s=Vr,e.substr(Vr,2)===Ye?(l=Ye,Vr+=2):(l=null,0===$r&&r($e)),null===l&&(e.substr(Vr,2)===Ke?(l=Ke,Vr+=2):(l=null,0===$r&&r(Je)),null===l&&(e.substr(Vr,2)===Qe?(l=Qe,Vr+=2):(l=null,0===$r&&r(Ze)))),null!==l&&(l=e.substring(s,Vr)),s=l,null!==s?(l=B(),null!==l?(u=v(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==i?(Wr=t,n=_e(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function v(){var t,n,i,o,a,s,l,u;if(t=Vr,n=m(),null!==n){for(i=[],o=Vr,a=B(),null!==a?(e.substr(Vr,2)===et?(s=et,Vr+=2):(s=null,0===$r&&r(tt)),null!==s?(l=B(),null!==l?(u=m(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==o;)i.push(o),o=Vr,a=B(),null!==a?(e.substr(Vr,2)===et?(s=et,Vr+=2):(s=null,0===$r&&r(tt)),null!==s?(l=B(),null!==l?(u=m(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==i?(Wr=t,n=_e(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function m(){var t,n,i;return t=Vr,n=Vr,33===e.charCodeAt(Vr)?(i=nt,Vr++):(i=null,0===$r&&r(rt)),null===i&&(43===e.charCodeAt(Vr)?(i=Ie,Vr++):(i=null,0===$r&&r(Ne)),null===i&&(45===e.charCodeAt(Vr)?(i=xe,Vr++):(i=null,0===$r&&r(Ae)))),null!==i&&(i=e.substring(n,Vr)),n=i,null!==n?(i=m(),null!==i?(Wr=t,n=it(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=g()),t}function g(){var e,t,n,r;if(e=Vr,t=y(),null!==t){for(n=[],r=_();null!==r;)n.push(r),r=_();null!==n?(Wr=e,t=ot(t,n),null===t?(Vr=e,e=t):e=t):(Vr=e,e=ee)}else Vr=e,e=ee;return e}function _(){var t,n,i,a;return t=Vr,46===e.charCodeAt(Vr)?(n=at,Vr++):(n=null,0===$r&&r(st)),null!==n?(i=b(),null!==i?(Wr=t,n=lt(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,91===e.charCodeAt(Vr)?(n=ut,Vr++):(n=null,0===$r&&r(ct)),null!==n?(i=o(),null!==i?(93===e.charCodeAt(Vr)?(a=ht,Vr++):(a=null,0===$r&&r(pt)),null!==a?(Wr=t,n=dt(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)),t}function b(){var t,n,i,a,l,u,c;return t=Vr,n=Vr,i=w(),null!==i&&(i=e.substring(n,Vr)),n=i,null!==n?(123===e.charCodeAt(Vr)?(i=ft,Vr++):(i=null,0===$r&&r(vt)),null!==i?(a=B(),null!==a?(l=o(),null!==l?(u=B(),null!==u?(125===e.charCodeAt(Vr)?(c=mt,Vr++):(c=null,0===$r&&r(gt)),null!==c?(Wr=t,n=_t(n,l),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,n=Vr,i=w(),null!==i&&(i=e.substring(n,Vr)),n=i,null!==n?(i=s(),null!==i?(Wr=t,n=bt(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,n=F(),null!==n&&(Wr=t,n=yt(n)),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,n=Vr,i=w(),null!==i&&(i=e.substring(n,Vr)),n=i,null!==n&&(Wr=t,n=wt(n)),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,n=T(),null!==n&&(Wr=t,n=Et(n)),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,n=k(),null!==n&&(Wr=t,n=Et(n)),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,40===e.charCodeAt(Vr)?(n=ie,Vr++):(n=null,0===$r&&r(oe)),null!==n?(i=o(),null!==i?(41===e.charCodeAt(Vr)?(a=ae,Vr++):(a=null,0===$r&&r(se)),null!==a?(Wr=t,n=Et(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee))))))),t}function y(){var t,n,i,a;return t=T(),null===t&&(t=k(),null===t&&(t=E(),null===t&&(t=D(),null===t&&(t=Vr,e.substr(Vr,4)===Ct?(n=Ct,Vr+=4):(n=null,0===$r&&r(Ot)),null!==n&&(Wr=t,n=jt()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,4)===Pt?(n=Pt,Vr+=4):(n=null,0===$r&&r(Tt)),null!==n&&(Wr=t,n=kt()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,5)===xt?(n=xt,Vr+=5):(n=null,0===$r&&r(At)),null!==n&&(Wr=t,n=Dt()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,4)===St?(n=St,Vr+=4):(n=null,0===$r&&r(Lt)),null!==n&&(Wr=t,n=Mt()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,64===e.charCodeAt(Vr)?(n=Rt,Vr++):(n=null,0===$r&&r(Ft)),null!==n?(i=Vr,a=X(),null!==a&&(a=e.substring(i,Vr)),i=a,null!==i?(Wr=t,n=zt(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,36===e.charCodeAt(Vr)?(n=It,Vr++):(n=null,0===$r&&r(Nt)),null!==n?(i=Vr,a=w(),null!==a&&(a=e.substring(i,Vr)),i=a,null!==i?(Wr=t,n=Bt(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,36===e.charCodeAt(Vr)?(n=It,Vr++):(n=null,0===$r&&r(Nt)),null!==n&&(Wr=t,n=Ut()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,35===e.charCodeAt(Vr)?(n=qt,Vr++):(n=null,0===$r&&r(Vt)),null!==n?(i=Vr,a=w(),null!==a&&(a=e.substring(i,Vr)),i=a,null!==i?(Wr=t,n=Wt(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,38===e.charCodeAt(Vr)?(n=Ht,Vr++):(n=null,0===$r&&r(Xt)),null!==n?(i=Vr,a=w(),null!==a&&(a=e.substring(i,Vr)),i=a,null!==i?(a=s(),null!==a?(Wr=t,n=Gt(i,a),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,94===e.charCodeAt(Vr)?(n=Yt,Vr++):(n=null,0===$r&&r($t)),null!==n?(i=y(),null!==i?(Wr=t,n=Kt(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,40===e.charCodeAt(Vr)?(n=ie,Vr++):(n=null,0===$r&&r(oe)),null!==n?(i=o(),null!==i?(41===e.charCodeAt(Vr)?(a=ae,Vr++):(a=null,0===$r&&r(se)),null!==a?(Wr=t,n=Jt(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,n=b(),null!==n&&(Wr=t,n=Qt(n)),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,n=[],null!==n&&(Wr=t,n=Zt()),null===n?(Vr=t,t=n):t=n)))))))))))))))),t}function w(){var t,n;if($r++,t=[],tn.test(e.charAt(Vr))?(n=e.charAt(Vr),Vr++):(n=null,0===$r&&r(nn)),null!==n)for(;null!==n;)t.push(n),tn.test(e.charAt(Vr))?(n=e.charAt(Vr),Vr++):(n=null,0===$r&&r(nn));else t=ee;return $r--,null===t&&(n=null,0===$r&&r(en)),t}function E(){var t,n,i,o;if($r++,t=Vr,39===e.charCodeAt(Vr)?(n=on,Vr++):(n=null,0===$r&&r(an)),null!==n){for(i=[],o=C();null!==o;)i.push(o),o=C();null!==i?(39===e.charCodeAt(Vr)?(o=on,Vr++):(o=null,0===$r&&r(an)),null!==o?(Wr=t,n=sn(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)}else Vr=t,t=ee;if(null===t)if(t=Vr,34===e.charCodeAt(Vr)?(n=ln,Vr++):(n=null,0===$r&&r(un)),null!==n){for(i=[],o=O();null!==o;)i.push(o),o=O();null!==i?(34===e.charCodeAt(Vr)?(o=ln,Vr++):(o=null,0===$r&&r(un)),null!==o?(Wr=t,n=sn(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)}else Vr=t,t=ee;return $r--,null===t&&(n=null,0===$r&&r(rn)),t}function C(){var t,n;return cn.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=null,0===$r&&r(hn)),null===t&&(t=Vr,e.substr(Vr,2)===pn?(n=pn,Vr+=2):(n=null,0===$r&&r(dn)),null!==n&&(Wr=t,n=fn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=j())),t}function O(){var t,n;return vn.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=null,0===$r&&r(mn)),null===t&&(t=Vr,e.substr(Vr,2)===gn?(n=gn,Vr+=2):(n=null,0===$r&&r(_n)),null!==n&&(Wr=t,n=bn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=j())),t}function j(){var t,n,i,o,a,s,l,u;return t=Vr,e.substr(Vr,2)===yn?(n=yn,Vr+=2):(n=null,0===$r&&r(wn)),null!==n&&(Wr=t,n=En()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,2)===Cn?(n=Cn,Vr+=2):(n=null,0===$r&&r(On)),null!==n&&(Wr=t,n=jn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,2)===Pn?(n=Pn,Vr+=2):(n=null,0===$r&&r(Tn)),null!==n&&(Wr=t,n=kn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,2)===xn?(n=xn,Vr+=2):(n=null,0===$r&&r(An)),null!==n&&(Wr=t,n=Dn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,2)===Sn?(n=Sn,Vr+=2):(n=null,0===$r&&r(Ln)),null!==n&&(Wr=t,n=Mn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,2)===Rn?(n=Rn,Vr+=2):(n=null,0===$r&&r(Fn)),null!==n&&(Wr=t,n=zn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,2)===In?(n=In,Vr+=2):(n=null,0===$r&&r(Nn)),null!==n&&(Wr=t,n=Bn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,2)===Un?(n=Un,Vr+=2):(n=null,0===$r&&r(qn)),null!==n&&(Wr=t,n=Vn()),null===n?(Vr=t,t=n):t=n,null===t&&(t=Vr,e.substr(Vr,2)===Wn?(n=Wn,Vr+=2):(n=null,0===$r&&r(Hn)),null!==n?(i=Vr,o=Vr,a=P(),null!==a?(s=P(),null!==s?(l=P(),null!==l?(u=P(),null!==u?(a=[a,s,l,u],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee),null!==o&&(o=e.substring(i,Vr)),i=o,null!==i?(Wr=t,n=Xn(i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee))))))))),t}function P(){var t;return Gn.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=null,0===$r&&r(Yn)),t}function T(){var t,n,i,o,s,l;return t=Vr,91===e.charCodeAt(Vr)?(n=ut,Vr++):(n=null,0===$r&&r(ct)),null!==n?(i=B(),null!==i?(93===e.charCodeAt(Vr)?(o=ht,Vr++):(o=null,0===$r&&r(pt)),null!==o?(Wr=t,n=$n(),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,91===e.charCodeAt(Vr)?(n=ut,Vr++):(n=null,0===$r&&r(ct)),null!==n?(i=B(),null!==i?(o=a(),null!==o?(s=B(),null!==s?(93===e.charCodeAt(Vr)?(l=ht,Vr++):(l=null,0===$r&&r(pt)),null!==l?(Wr=t,n=Kn(o),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)),t}function k(){var t,n,i,o,a,s;return t=Vr,123===e.charCodeAt(Vr)?(n=ft,Vr++):(n=null,0===$r&&r(vt)),null!==n?(i=B(),null!==i?(125===e.charCodeAt(Vr)?(o=mt,Vr++):(o=null,0===$r&&r(gt)),null!==o?(a=B(),null!==a?(Wr=t,n=Jn(),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,123===e.charCodeAt(Vr)?(n=ft,Vr++):(n=null,0===$r&&r(vt)),null!==n?(i=B(),null!==i?(o=x(),null!==o?(125===e.charCodeAt(Vr)?(a=mt,Vr++):(a=null,0===$r&&r(gt)),null!==a?(s=B(),null!==s?(Wr=t,n=Qn(o),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)),t}function x(){var t,n,i,o,a,s,l;if(t=Vr,n=A(),null!==n){for(i=[],o=Vr,44===e.charCodeAt(Vr)?(a=te,Vr++):(a=null,0===$r&&r(ne)),null!==a?(s=B(),null!==s?(l=A(),null!==l?(a=[a,s,l],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==o;)i.push(o),o=Vr,44===e.charCodeAt(Vr)?(a=te,Vr++):(a=null,0===$r&&r(ne)),null!==a?(s=B(),null!==s?(l=A(),null!==l?(a=[a,s,l],o=a):(Vr=o,o=ee)):(Vr=o,o=ee)):(Vr=o,o=ee);null!==i?(Wr=t,n=Zn(n,i),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function A(){var t,n,i,a,s;return t=Vr,n=Vr,i=w(),null!==i&&(i=e.substring(n,Vr)),n=i,null!==n?(58===e.charCodeAt(Vr)?(i=de,Vr++):(i=null,0===$r&&r(fe)),null!==i?(a=B(),null!==a?(s=o(),null!==s?(Wr=t,n=er(n,s),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),t}function D(){var t,n,i;return $r++,t=Vr,n=Vr,i=S(),null!==i&&(i=e.substring(n,Vr)),n=i,null!==n&&(Wr=t,n=nr(n)),null===n?(Vr=t,t=n):t=n,$r--,null===t&&(n=null,0===$r&&r(tr)),t}function S(){var e,t,n,r;return e=Vr,t=L(),null!==t?(n=M(),null!==n?(r=R(),null!==r?(t=[t,n,r],e=t):(Vr=e,e=ee)):(Vr=e,e=ee)):(Vr=e,e=ee),null===e&&(e=Vr,t=L(),null!==t?(n=M(),null!==n?(t=[t,n],e=t):(Vr=e,e=ee)):(Vr=e,e=ee),null===e&&(e=Vr,t=L(),null!==t?(n=R(),null!==n?(t=[t,n],e=t):(Vr=e,e=ee)):(Vr=e,e=ee),null===e&&(e=L()))),e}function L(){var t,n,i,o;return t=Vr,n=N(),null!==n?(i=F(),null!==i?(n=[n,i],t=n):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=I(),null===t&&(t=Vr,45===e.charCodeAt(Vr)?(n=xe,Vr++):(n=null,0===$r&&r(Ae)),null!==n?(i=N(),null!==i?(o=F(),null!==o?(n=[n,i,o],t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,45===e.charCodeAt(Vr)?(n=xe,Vr++):(n=null,0===$r&&r(Ae)),null!==n?(i=I(),null!==i?(n=[n,i],t=n):(Vr=t,t=ee)):(Vr=t,t=ee)))),t}function M(){var t,n,i;return t=Vr,46===e.charCodeAt(Vr)?(n=at,Vr++):(n=null,0===$r&&r(st)),null!==n?(i=F(),null!==i?(n=[n,i],t=n):(Vr=t,t=ee)):(Vr=t,t=ee),t}function R(){var e,t,n;return e=Vr,t=z(),null!==t?(n=F(),null!==n?(t=[t,n],e=t):(Vr=e,e=ee)):(Vr=e,e=ee),e}function F(){var e,t;if(e=[],t=I(),null!==t)for(;null!==t;)e.push(t),t=I();else e=ee;return e}function z(){var t,n,i;return t=Vr,rr.test(e.charAt(Vr))?(n=e.charAt(Vr),Vr++):(n=null,0===$r&&r(ir)),null!==n?(or.test(e.charAt(Vr))?(i=e.charAt(Vr),Vr++):(i=null,0===$r&&r(ar)),null===i&&(i=ce),null!==i?(n=[n,i],t=n):(Vr=t,t=ee)):(Vr=t,t=ee),t}function I(){var t;return sr.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=null,0===$r&&r(lr)),t}function N(){var t;return ur.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=null,0===$r&&r(cr)),t}function B(){var e,t;for(e=[],t=U(),null===t&&(t=q());null!==t;)e.push(t),t=U(),null===t&&(t=q());return e}function U(){var t,n;return $r++,pr.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=null,0===$r&&r(dr)),null===t&&(fr.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=null,0===$r&&r(vr))),$r--,null===t&&(n=null,0===$r&&r(hr)),t}function q(){var t,n;return $r++,gr.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=null,0===$r&&r(_r)),$r--,null===t&&(n=null,0===$r&&r(mr)),t}function V(){var e,t,n,r;if(e=Vr,t=B(),null!==t){for(n=[],r=W();null!==r;)n.push(r),r=W();null!==n?(r=B(),null!==r?(Wr=e,t=br(n),null===t?(Vr=e,e=t):e=t):(Vr=e,e=ee)):(Vr=e,e=ee)}else Vr=e,e=ee;return e}function W(){var t,n,i,o,a,s,l,u,c,h;return t=Vr,64===e.charCodeAt(Vr)?(n=Rt,Vr++):(n=null,0===$r&&r(Ft)),null!==n?(i=Vr,o=X(),null!==o&&(o=e.substring(i,Vr)),i=o,null!==i?(o=B(),null!==o?(a=H(),null===a&&(a=ce),null!==a?(123===e.charCodeAt(Vr)?(s=ft,Vr++):(s=null,0===$r&&r(vt)),null!==s?(l=B(),null!==l?(u=G(),null!==u?(125===e.charCodeAt(Vr)?(c=mt,Vr++):(c=null,0===$r&&r(gt)),null!==c?(h=B(),null!==h?(Wr=t,n=yr(i,a,u),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),t}function H(){var t,n,i,a,s,l,u,c;return t=Vr,60===e.charCodeAt(Vr)?(n=Te,Vr++):(n=null,0===$r&&r(ke)),null===n&&(58===e.charCodeAt(Vr)?(n=de,Vr++):(n=null,0===$r&&r(fe))),null!==n?(i=B(),null!==i?(a=E(),null===a&&(a=ce),null!==a?(s=B(),null!==s?(l=Vr,u=Vr,$r++,123===e.charCodeAt(Vr)?(c=ft,Vr++):(c=null,0===$r&&r(vt)),$r--,null===c?u=ce:(Vr=u,u=ee),null!==u?(c=o(),null!==c?(u=[u,c],l=u):(Vr=l,l=ee)):(Vr=l,l=ee),null===l&&(l=ce),null!==l?(u=B(),null!==u?(Wr=t,n=wr(n,a,l),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,n=B(),null!==n&&(Wr=t,n=Er()),null===n?(Vr=t,t=n):t=n),t}function X(){var t,n,i,o,a,s,l;if(t=Vr,n=[],Cr.test(e.charAt(Vr))?(i=e.charAt(Vr),Vr++):(i=null,0===$r&&r(Or)),null!==i)for(;null!==i;)n.push(i),Cr.test(e.charAt(Vr))?(i=e.charAt(Vr),Vr++):(i=null,0===$r&&r(Or));else n=ee;if(null!==n){if(i=[],o=Vr,58===e.charCodeAt(Vr)?(a=de,Vr++):(a=null,0===$r&&r(fe)),null!==a){if(s=[],Cr.test(e.charAt(Vr))?(l=e.charAt(Vr),Vr++):(l=null,0===$r&&r(Or)),null!==l)for(;null!==l;)s.push(l),Cr.test(e.charAt(Vr))?(l=e.charAt(Vr),Vr++):(l=null,0===$r&&r(Or));else s=ee;null!==s?(a=[a,s],o=a):(Vr=o,o=ee)}else Vr=o,o=ee;for(;null!==o;)if(i.push(o),o=Vr,58===e.charCodeAt(Vr)?(a=de,Vr++):(a=null,0===$r&&r(fe)),null!==a){if(s=[],Cr.test(e.charAt(Vr))?(l=e.charAt(Vr),Vr++):(l=null,0===$r&&r(Or)),null!==l)for(;null!==l;)s.push(l),Cr.test(e.charAt(Vr))?(l=e.charAt(Vr),Vr++):(l=null,0===$r&&r(Or));else s=ee;null!==s?(a=[a,s],o=a):(Vr=o,o=ee)}else Vr=o,o=ee;null!==i?(n=[n,i],t=n):(Vr=t,t=ee)}else Vr=t,t=ee;return t}function G(){var t,n,i,o,a,s,l,u,c;if(t=Vr,n=Y(),null!==n)if(i=B(),null!==i){for(o=[],a=Vr,59===e.charCodeAt(Vr)?(s=jr,Vr++):(s=null,0===$r&&r(Pr)),null!==s?(l=B(),null!==l?(u=Y(),null!==u?(c=B(),null!==c?(s=[s,l,u,c],a=s):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee);null!==a;)o.push(a),a=Vr,59===e.charCodeAt(Vr)?(s=jr,Vr++):(s=null,0===$r&&r(Pr)),null!==s?(l=B(),null!==l?(u=Y(),null!==u?(c=B(),null!==c?(s=[s,l,u,c],a=s):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee)):(Vr=a,a=ee);null!==o?(59===e.charCodeAt(Vr)?(a=jr,Vr++):(a=null,0===$r&&r(Pr)),null===a&&(a=ce),null!==a?(s=B(),null!==s?(Wr=t,n=re(n,o),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)}else Vr=t,t=ee;else Vr=t,t=ee;return null===t&&(t=Vr,n=Y(),null!==n?(i=B(),null!==i?(59===e.charCodeAt(Vr)?(o=jr,Vr++):(o=null,0===$r&&r(Pr)),null===o&&(o=ce),null!==o?(a=B(),null!==a?(Wr=t,n=Tr(n),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t&&(t=Vr,n=B(),null!==n&&(Wr=t,n=le()),null===n?(Vr=t,t=n):t=n)),t}function Y(){var t,n,i,a,s,l,u,c,h,p,d,f,v,m,g,_,b;if(t=Vr,e.substr(Vr,2)===kr?(n=kr,Vr+=2):(n=null,0===$r&&r(xr)),null===n&&(e.substr(Vr,6)===Ar?(n=Ar,Vr+=6):(n=null,0===$r&&r(Dr))),null!==n?(32===e.charCodeAt(Vr)?(i=Sr,Vr++):(i=null,0===$r&&r(Lr)),null!==i?(a=B(),null!==a?(s=Vr,l=w(),null!==l&&(l=e.substring(s,Vr)),s=l,null!==s?(l=B(),null!==l?(e.substr(Vr,2)===Mr?(u=Mr,Vr+=2):(u=null,0===$r&&r(Rr)),null!==u?(c=B(),null!==c?(h=o(),null!==h?(p=B(),null!==p?(Wr=t,n=Fr(n,s,h),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee),null===t){if(t=Vr,n=o(),null!==n)if(i=B(),null!==i)if(58===e.charCodeAt(Vr)?(a=de,Vr++):(a=null,0===$r&&r(fe)),null===a&&(e.substr(Vr,3)===zr?(a=zr,Vr+=3):(a=null,0===$r&&r(Ir)),null===a&&(e.substr(Vr,2)===Nr?(a=Nr,Vr+=2):(a=null,0===$r&&r(Br)))),null!==a)if(s=B(),null!==s)if(l=o(),null!==l)if(u=B(),null!==u){for(c=[],h=Vr,44===e.charCodeAt(Vr)?(p=te,Vr++):(p=null,0===$r&&r(ne)),null!==p?(d=B(),null!==d?(f=Vr,v=w(),null!==v&&(v=e.substring(f,Vr)),f=v,null!==f?(v=B(),null!==v?(58===e.charCodeAt(Vr)?(m=de,Vr++):(m=null,0===$r&&r(fe)),null!==m?(g=B(),null!==g?(_=o(),null!==_?(b=B(),null!==b?(p=[p,d,f,v,m,g,_,b],h=p):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,
h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee);null!==h;)c.push(h),h=Vr,44===e.charCodeAt(Vr)?(p=te,Vr++):(p=null,0===$r&&r(ne)),null!==p?(d=B(),null!==d?(f=Vr,v=w(),null!==v&&(v=e.substring(f,Vr)),f=v,null!==f?(v=B(),null!==v?(58===e.charCodeAt(Vr)?(m=de,Vr++):(m=null,0===$r&&r(fe)),null!==m?(g=B(),null!==g?(_=o(),null!==_?(b=B(),null!==b?(p=[p,d,f,v,m,g,_,b],h=p):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee)):(Vr=h,h=ee);null!==c?(Wr=t,n=Ur(n,a,l,c),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)}else Vr=t,t=ee;else Vr=t,t=ee;else Vr=t,t=ee;else Vr=t,t=ee;else Vr=t,t=ee;else Vr=t,t=ee;null===t&&(t=Vr,n=Vr,i=w(),null!==i&&(i=e.substring(n,Vr)),n=i,null!==n?(i=B(),null!==i?(a=o(),null!==a?(s=B(),null!==s?(Wr=t,n=qr(n,a),null===n?(Vr=t,t=n):t=n):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee)):(Vr=t,t=ee))}return t}var $,K=arguments.length>1?arguments[1]:{},J={expression:o,sheet:V},Q=o,Z="expression",ee=null,te=",",ne='","',re=function(e,t){for(var n=[e],r=0;r<t.length;r++)n.push(t[r][2]);return n},ie="(",oe='"("',ae=")",se='")"',le=function(){return[]},ue=function(e){return e},ce="",he="?",pe='"?"',de=":",fe='":"',ve=function(e,t){if(t){var n=t[2],r=t[6];return{type:"if",args:[e,n,r]}}return e},me="||",ge='"||"',_e=function(e,t){for(var n=0;n<t.length;n++)e={type:Kr[t[n][1]],args:[e,t[n][3]]};return e},be="&&",ye='"&&"',we="<=>",Ee='"<=>"',Ce="<=",Oe='"<="',je=">=",Pe='">="',Te="<",ke='"<"',xe="-",Ae='"-"',De=">",Se='">"',Le="==",Me='"=="',Re="!=",Fe='"!="',ze=function(e,t){if(t){var n=t[1],r=t[3];return"!="===n?{type:"not",args:[{type:"equals",args:[e,r]}]}:{type:Kr[n],args:[e,r]}}return e},Ie="+",Ne='"+"',Be="*",Ue='"*"',qe="/",Ve='"/"',We="%",He='"%"',Xe="rem",Ge='"rem"',Ye="**",$e='"**"',Ke="//",Je='"//"',Qe="%%",Ze='"%%"',et="??",tt='"??"',nt="!",rt='"!"',it=function(e,t){return{type:Jr[e],args:[t]}},ot=function(e,t){for(var n=0;n<t.length;n++)e=t[n](e);return e},at=".",st='"."',lt=function(e){return e},ut="[",ct='"["',ht="]",pt='"]"',dt=function(e){return function(t){return{type:"property",args:[t,e]}}},ft="{",vt='"{"',mt="}",gt='"}"',_t=function(e,t){return Qr[e]?function(n){return{type:Qr[e],args:[n,t]}}:"value"===t.type?function(t){return{type:e,args:[t]}}:function(n){return{type:e,args:[{type:"mapBlock",args:[n,t]}]}}},bt=function(e,t){return function(n){return{type:e,args:[n].concat(t)}}},yt=function(e){return function(t){return{type:"property",args:[t,{type:"literal",value:+e.join("")}]}}},wt=function(e){return function(t){return{type:"property",args:[t,{type:"literal",value:e}]}}},Et=function(e){return function(t){return{type:"with",args:[t,e]}}},Ct="this",Ot='"this"',jt=function(){return{type:"value"}},Pt="true",Tt='"true"',kt=function(){return{type:"literal",value:!0}},xt="false",At='"false"',Dt=function(){return{type:"literal",value:!1}},St="null",Lt='"null"',Mt=function(){return{type:"literal",value:null}},Rt="@",Ft='"@"',zt=function(e){return{type:"component",label:e}},It="$",Nt='"$"',Bt=function(e){return{type:"property",args:[{type:"parameters"},{type:"literal",value:e}]}},Ut=function(){return{type:"parameters"}},qt="#",Vt='"#"',Wt=function(e){return{type:"element",id:e}},Ht="&",Xt='"&"',Gt=function(e,t){return{type:e,args:t,inline:!0}},Yt="^",$t='"^"',Kt=function(e){return{type:"parent",args:[e]}},Jt=function(e){return e},Qt=function(e){return e({type:"value"})},Zt=function(){return{type:"value"}},en="word",tn=/^[a-zA-Z_0-9\-]/,nn="[a-zA-Z_0-9\\-]",rn="string",on="'",an='"\'"',sn=function(e){return{type:"literal",value:e.join("")}},ln='"',un='"\\""',cn=/^[^'\\\0-\x1F]/,hn="[^'\\\\\\0-\\x1F]",pn="\\'",dn='"\\\\\'"',fn=function(){return"'"},vn=/^[^"\\\0-\x1F]/,mn='[^"\\\\\\0-\\x1F]',gn='\\"',_n='"\\\\\\""',bn=function(){return'"'},yn="\\\\",wn='"\\\\\\\\"',En=function(){return"\\"},Cn="\\/",On='"\\\\/"',jn=function(){return"/"},Pn="\\b",Tn='"\\\\b"',kn=function(){return"\b"},xn="\\f",An='"\\\\f"',Dn=function(){return"\f"},Sn="\\n",Ln='"\\\\n"',Mn=function(){return"\n"},Rn="\\r",Fn='"\\\\r"',zn=function(){return"\r"},In="\\t",Nn='"\\\\t"',Bn=function(){return"\t"},Un="\\0",qn='"\\\\0"',Vn=function(){return"\0"},Wn="\\u",Hn='"\\\\u"',Xn=function(e){return String.fromCharCode(parseInt(e,16))},Gn=/^[0-9a-fA-F]/,Yn="[0-9a-fA-F]",$n=function(){return{type:"tuple",args:[]}},Kn=function(e){return{type:"tuple",args:e}},Jn=function(){return{type:"record",args:[]}},Qn=function(e){return{type:"record",args:e}},Zn=function(e,t){var n={};n[e[0]]=e[1];for(var r=0;r<t.length;r++)n[t[r][2][0]]=t[r][2][1];return n},er=function(e,t){return[e,t]},tr="number",nr=function(e){return{type:"literal",value:+e}},rr=/^[eE]/,ir="[eE]",or=/^[+\-]/,ar="[+\\-]",sr=/^[0-9]/,lr="[0-9]",ur=/^[1-9]/,cr="[1-9]",hr="whitespace",pr=/^[\t\x0B\f \xA0\uFEFF]/,dr="[\\t\\x0B\\f \\xA0\\uFEFF]",fr=/^[ \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000]/,vr="[ \\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000]",mr="line terminator",gr=/^[\n\r\u2028\u2029]/,_r="[\\n\\r\\u2028\\u2029]",br=function(e){return{type:"sheet",blocks:e}},yr=function(e,t,n){return{type:"block",connection:t.connection,module:t.module,exports:t.exports,label:e,statements:n}},wr=function(e,t,n){return{connection:{"<":"prototype",":":"object"}[e],module:t&&t.value,exports:""!==n?n[1]:void 0}},Er=function(){return{}},Cr=/^[a-zA-Z_0-9]/,Or="[a-zA-Z_0-9]",jr=";",Pr='";"',Tr=function(e){return[e]},kr="on",xr='"on"',Ar="before",Dr='"before"',Sr=" ",Lr='" "',Mr="->",Rr='"->"',Fr=function(e,t,n){return{type:"event",when:e,event:t,listener:n}},zr="<->",Ir='"<->"',Nr="<-",Br='"<-"',Ur=function(e,t,n,r){var i={type:Zr[t],args:[e,n]};if(r.length){for(var o={},a=0;a<r.length;a++)o[r[a][2]]=r[a][6];i.descriptor=o}return i},qr=function(e,t){return{type:"unit",name:e,value:t}},Vr=0,Wr=0,Hr=0,Xr={line:1,column:1,seenCR:!1},Gr=0,Yr=[],$r=0;if("startRule"in K){if(!(K.startRule in J))throw new Error("Can't start parsing from rule \""+K.startRule+'".');Q=J[K.startRule]}var Kr={"**":"pow","//":"root","%%":"log","*":"mul","/":"div","%":"mod",rem:"rem","+":"add","-":"sub","<":"lt",">":"gt","<=":"le",">=":"ge","==":"equals","<=>":"compare","??":"default","&&":"and","||":"or","<-":"bind","<->":"bind2",":":"assign"},Jr={"+":"toNumber","-":"neg","!":"not","^":"parent"},Qr={map:"mapBlock",filter:"filterBlock",some:"someBlock",every:"everyBlock",sorted:"sortedBlock",sortedSet:"sortedSetBlock",group:"groupBlock",groupMap:"groupMapBlock",min:"minBlock",max:"maxBlock"},Zr={":":"assign","<-":"bind","<->":"bind2"};if($=Q(),null!==$&&Vr===e.length)return $;throw i(Yr),Wr=Math.max(Vr,Gr),new t(Yr,Wr<e.length?e.charAt(Wr):null,Wr,n(Wr).line,n(Wr).column)}return e(t,Error),{SyntaxError:t,parse:n}}()}}),montageDefine("afa97d9","compile-evaluator",{dependencies:["collections/shim-object","collections/map","collections/sorted-set","./operators","./scope","./parse"],factory:function(e,t,n){function r(e){return r.semantics.compile(e)}var i=e("collections/shim-object"),o=e("collections/map"),a=e("collections/sorted-set"),s=e("./operators");e("./scope"),n.exports=r;var l={literal:function(e){return function(){return e.value}},value:function(e){return function(e){return e.value}},parameters:function(e){return function(e){return e.parameters}},element:function(e){return function(t){return t.document.getElementById(e.id)}},component:function(e){return function(t){return t.components.getObjectByLabel(e.label)}},tuple:function(e){var t=e.args.map(this.compile,this);return function(e){return t.map(function(t){return t(e)})}},record:function(e){var t,n,r=e.args,o={},a=i.keys(r);for(n=0;t=a[n];n++)o[t]=this.compile(r[t]);return function(e){var r={},a=i.keys(o);for(n=0;t=a[n];n++)r[t]=o[t](e);return r}}},u={mapBlock:function(e,t){return function(n){return e(n).map(function(e){return t(n.nest(e))})}},filterBlock:function(e,t){return function(n){return e(n).filter(function(e){return t(n.nest(e))})}},someBlock:function(e,t){return function(n){return e(n).some(function(e){return t(n.nest(e))})}},everyBlock:function(e,t){return function(n){return e(n).every(function(e){return t(n.nest(e))})}},sortedBlock:function(e,t){return function(n){return e(n).sorted(Function.by(function(e){return t(n.nest(e))}))}},sortedSetBlock:function(e,t){return function(n){function r(e){return t(n.nest(e))}function o(e,t){return i.compare(r(e),r(t))}function s(e,t){return i.equals(r(e),r(t))}return new a(e(n),s,o)}},groupBlock:function(e,t){return function(n){return e(n).group(function(e){return t(n.nest(e))})}},groupMapBlock:function(e,t){return function(n){return new o(e(n).group(function(e){return t(n.nest(e))}))}},minBlock:function(e,t){return function(n){return e(n).min(Function.by(function(e){return t(n.nest(e))}))}},maxBlock:function(e,t){return function(n){return e(n).max(Function.by(function(e){return t(n.nest(e))}))}},parent:function(e){return function(t){return e(t.parent)}},"with":function(e,t){return function(n){return t(n.nest(e(n)))}},"if":function(e,t,n){return function(r){var i=e(r);if(null!=i)return i?t(r):n(r)}},not:function(e){return function(t){return!e(t)}},and:function(e,t){return function(n){return e(n)&&t(n)}},or:function(e,t){return function(n){return e(n)||t(n)}},"default":function(e,t){return function(n){var r=e(n);return null==r&&(r=t(n)),r}},defined:function(e){return function(t){var n=e(t);return null!=n}},path:function(t,n){return function(i){var o=t(i),a=n(i),s=e("./parse");try{var l=s(a),u=r(l);return u(i.nest(o))}catch(c){}}}},c=i.clone(s,1);i.addEach(c,{property:function(e,t){return e[t]},get:function(e,t){return e.get(t)},mapContent:Function.identity,rangeContent:Function.identity,view:function(e,t,n){return e.slice(t,t+n)}}),r.semantics={compilers:l,argCompilers:u,operators:c,compile:function(e){var t=this.compilers,n=this.argCompilers,r=this.operators;if(t.hasOwnProperty(e.type))return t[e.type].call(this,e);if(n.hasOwnProperty(e.type)){var i=e.args.map(this.compile,this);return 1===i.length?n[e.type].call(null,i[0]):2===i.length?n[e.type].call(null,i[0],i[1]):n[e.type].apply(null,i)}r.hasOwnProperty(e.type)||(r[e.type]=function(t){var n=Array.prototype.slice.call(arguments,1);if(!t[e.type])throw new TypeError("Can't call "+JSON.stringify(e.type)+" of "+t);return 1===n.length?t[e.type].call(t,n[0]):2===n.length?t[e.type].call(t,n[0],n[1]):t[e.type].apply(t,n)});var o=r[e.type],i=e.args.map(this.compile,this);return function(e){var t=i.map(function(t){return t(e)});if(t.every(s.defined))return 1===t.length?o.call(null,t[0]):2===t.length?o.call(null,t[0],t[1]):o.apply(null,t)}}}}}),montageDefine("afa97d9","compile-assigner",{dependencies:["./compile-evaluator","./algebra","./scope"],factory:function(e,t,n){function r(e){return r.semantics.compile(e)}var i=e("./compile-evaluator"),o=e("./algebra"),a=(e("./scope"),{type:"value"}),s={type:"literal",value:!0},l={type:"literal",value:!1};n.exports=r,r.semantics={compile:function(e){var t=this.compilers;if("equals"===e.type){var n=this.compile(e.args[0]),r=this.compileEvaluator(e.args[1]);return t.equals(n,r)}if("if"===e.type){var i=this.compileEvaluator(e.args[0]),s=this.compile(e.args[1]),l=this.compile(e.args[2]);return t["if"](i,s,l)}if("and"===e.type||"or"===e.type){var u=o(e.args[0],a),c=o(e.args[1],a),h=this.compileEvaluator(e.args[0]),r=this.compileEvaluator(e.args[1]),p=this.compileEvaluator(u[1]),d=this.compileEvaluator(c[1]),n=this.compile(u[0]),f=this.compile(c[0]);return t[e.type](n,f,h,r,p,d)}if("everyBlock"===e.type){var v=this.compileEvaluator(e.args[0]),m=o(e.args[1],{type:"literal",value:!0}),g=this.compile(m[0]),_=this.compileEvaluator(m[1]);return t.everyBlock(v,g,_)}if("parent"===e.type){var b=this.compile(e.args[0]);return function(e,t){return b(e,t.parent)}}if(t.hasOwnProperty(e.type)){var y=e.args.map(this.compileEvaluator,this.compileEvaluator.semantics);return 1===y.length?t[e.type].call(null,y[0]):2===y.length?t[e.type].call(null,y[0],y[1]):t[e.type].apply(null,y)}throw new Error("Can't compile assigner for "+JSON.stringify(e.type))},compileEvaluator:i,compilers:{property:function(e,t){return function(n,r){var i=e(r);if(i){var o=t(r);null!=o&&(Array.isArray(i)?i.set(o,n):i[o]=n)}}},get:function(e,t){return function(n,r){var i=e(r);if(i){var o=t(r);null!=o&&i.set(o,n)}}},has:function(e,t){return function(n,r){var i=e(r);if(i){var o=t(r);null!=n&&(n?(i.has||i.contains).call(i,o)||i.add(o):(i.has||i.contains).call(i,o)&&(i.remove||i["delete"]).call(i,o))}}},equals:function(e,t){return function(n,r){if(n)return e(t(r),r)}},"if":function(e,t,n){return function(r,i){var o=e(i);if(null!=o)return o?t(r,i):n(r,i)}},and:function(e,t,n,r,i,o){return function(a,l){null!=a&&(a?(e(i(s),l),t(o(s),l)):e(n(l)&&!r(l),l))}},or:function(e,t,n,r,i,o){return function(a,s){null!=a&&(a?e(n(s)||!r(s),s):(e(i(l),s),t(o(l),s)))}},rangeContent:function(e){return function(t,n){var r=e(n);r&&(t?r.swap(0,r.length,t):r.clear())}},mapContent:function(e){return function(t,n){var r=e(n);r&&(r.clear(),n.value&&r.addEach(t))}},reversed:function(e){return function(t,n){var r=e(n);r&&r.swap(0,r.length,t.reversed())}},everyBlock:function(e,t,n){return function(r,i){if(r){var o=e(i),a=n(i);o.forEach(function(e){t(a,i.nest(e))})}}}}}}}),montageDefine("afa97d9","algebra",{dependencies:[],factory:function(e,t,n){function r(e,t){return r.semantics.solve(e,t)}n.exports=r,r.semantics={solve:function(e,t){for(;;){for(;this.simplifiers.hasOwnProperty(e.type);){var n=this.simplifiers[e.type](e);if(!n)break;e=n}var r=this.rotateTargetToSource.hasOwnProperty(e.type),i=this.rotateSourceToTarget.hasOwnProperty(t.type);if(!r&&!i)break;r?(t=this.rotateTargetToSource[e.type](e,t),e=e.args[0]):i&&(e=this.rotateSourceToTarget[t.type](e,t),t=t.args[0])}return[e,t]},simplifiers:{not:function(e){var t=e.args[0];if("not"===t.type)return t.args[0]},add:function(e){var t=e.args[0];if("literal"===t.type&&""===t.value)return{type:"toString",args:[e.args[1]]}},someBlock:function(e){return{type:"not",args:[{type:"everyBlock",args:[e.args[0],{type:"not",args:[e.args[1]]}]}]}}},rotateTargetToSource:{reflect:function(e,t){return{type:e.type,args:[t]}},invert:function(e,t,n){return{type:n,args:[t,e.args[1]]}},toNumber:function(e,t){return this.reflect(e,t)},toString:function(e,t){return this.reflect(e,t)},not:function(e,t){return this.reflect(e,t)},neg:function(e,t){return this.reflect(e,t)},add:function(e,t){return this.invert(e,t,"sub")},sub:function(e,t){return this.invert(e,t,"add")},mul:function(e,t){return this.invert(e,t,"div")},div:function(e,t){return this.invert(e,t,"mul")},pow:function(e,t){return this.invert(e,t,"root")},root:function(e,t){return this.invert(e,t,"pow")},join:function(e,t){return this.invert(e,t,"split")},split:function(e,t){return this.invert(e,t,"join")}},rotateSourceToTarget:{rangeContent:function(e,t){return"rangeContent"===e.type?e:{type:t.type,args:[e]}}}}}}),montageDefine("afa97d9","compile-binder",{dependencies:["./compile-observer","./observers","./binders","./algebra"],factory:function(e,t,n){function r(e){return r.semantics.compile(e)}var i=e("./compile-observer"),o=(e("./observers"),e("./binders")),a=e("./algebra"),s={type:"value"},l={type:"literal",value:!0};n.exports=r,r.semantics={compilers:{property:o.makePropertyBinder,get:o.makeGetBinder,has:o.makeHasBinder,only:o.makeOnlyBinder,one:o.makeOneBinder,rangeContent:o.makeRangeContentBinder,mapContent:o.makeMapContentBinder,reversed:o.makeReversedBinder,and:o.makeAndBinder,or:o.makeOrBinder},syntaxTypeCompile:{"default":function(e){return this.compile(e.args[0])},literal:function(e){if(null==e.value)return Function.noop;throw new Error("Can't bind to literal: "+e.value)},equals:function(e){return o.makeEqualityBinder(this.compile(e.args[0]),i(e.args[1]))},"if":function(e){return o.makeConditionalBinder(i(e.args[0]),this.compile(e.args[1]),this.compile(e.args[2]))},and_or:function(e){var t=a(e.args[0],s),n=a(e.args[1],s),r=this.compile(t[0]),o=this.compile(n[0]),l=i(t[1]),u=i(n[1]),c=i(e.args[0]),h=i(e.args[1]);return this.compilers[e.type](r,o,c,h,l,u)},everyBlock:function(e){var t=i(e.args[0]),n=a(e.args[1],l),r=this.compile(n[0]),s=i(n[1]);return o.makeEveryBlockBinder(t,r,s)},rangeContent:function(e){var t,n=i(e.args[0]);try{t=this.compile(e.args[0])}catch(r){t=Function.noop}return o.makeRangeContentBinder(n,t)},defined:function(e){var t=this.compile(e.args[0]);return o.makeDefinedBinder(t)},parent:function(e){var t=this.compile(e.args[0]);return o.makeParentBinder(t)},"with":function(e){var t=i(e.args[0]),n=this.compile(e.args[1]);return o.makeWithBinder(t,n)}},compile:function(e){var t,n=this.compilers;if(t=this.syntaxTypeCompile[e.type])return t.call(this,e);if(n.hasOwnProperty(e.type)){for(var r=[],o=i.semantics,a=0,s=e.args.length;a<s;a++)r.push(i.call(o,e.args[a]));return 1===r.length?n[e.type].call(null,r[0]):2===r.length?n[e.type].call(null,r[0],r[1]):n[e.type].apply(null,r)}throw new Error("Can't compile binder for "+JSON.stringify(e.type))}},r.semantics.syntaxTypeCompile.and=r.semantics.syntaxTypeCompile.or=r.semantics.syntaxTypeCompile.and_or}}),montageDefine("afa97d9","binders",{dependencies:["./scope","./observers"],factory:function(e,t,n){function r(){return new Error("").stack.replace(/^.*\n.*\n/,"\n")}function i(e,t,n,i,o,a){return n(j(function(n){if(!o.isActive)try{o.isActive=!0,a&&console.log("SET",a.targetPath,"TO",n,"ON",e,"BECAUSE",a.sourcePath,r()),Array.isArray(e)&&t>>>0===t?e.set(t,n):e[t]=n}finally{o.isActive=!1}}),i)}function o(e,t){return function(n,r,i,o,a){return t(j(function(t){function s(e){return null==e?void 0:e.bindProperty?e.bindProperty(t,n,r,o,a):s.bindProperty(e,t,n,r,o,a)}if(null!=t)return s.bindProperty=M,e(j(s),i)}),i)}}function a(e,t,n,i,o,a){return n(j(function(n){if(!o.isActive)try{o.isActive=!0,a&&console.log("SET FOR KEY",t,"TO",n,"ON",e,"BECAUSE",a.sourcePath,r()),e.set(t,n)}finally{o.isActive=!1}}),i)}function s(e,t){return function(n,r,i,o,a){return e(j(function(e){function s(t){return null==t?void 0:s.bindGet(e,t,n,r,o,a)}if(e)return s.bindGet=R,t(j(s),i)}),i)}}function l(e,t){return function(n,i,o,a,s){return e(j(function(e){if(e)return t(j(function(t){function o(e){if(e)o.set.has(t)||(s&&console.log("ADD",t,"TO",s.targetPath,"BECAUSE",s.sourcePath,r()),o.set.add(t));else for(;o.set.has(t);)s&&console.log("REMOVE",t,"FROM",s.targetPath,"BECAUSE",s.sourcePath,r()),o.set["delete"](t)}if(null!=t)return o.set=e,n(j(o),i)}),o)}),o)}}function u(e,t){return function(n,i,o,a,s){return n(j(function(n){if(n)return s&&console.log("BIND",s.targetPath,"TO",s.sourcePath,r()),e(t,i,i,a,s),function(){s&&console.log("UNBIND",s.targetPath,"FROM",s.sourcePath,r())}}),o)}}function c(e,t,n){return function(r,i,o,a,s){return r(j(function(r){if(r)return e(j(function(e){function r(e,t,l){r.cancelEach(i.slice(l,l+t.length));for(var u,c=[],h=0,p=e.length;h<p;h++)u=o.nest(e[h]),c.push(r.bindCondition(n,u,u,a,s));i.swap(l,t.length,c)}if(e){var i=[];r.cancelEach=T,r.bindCondition=t;var l=P(e,r,o);return function(){T(i),l()}}}),o)}),i)}}function h(e,t,n,r,i,o){var a=k(r),s=A(n,a);return function(n,r,a,l,u){return n(j(function(n){if(null!=n){if(n){var r=e(i,S,a,l,u),c=t(o,S,a,l,u);return function(){r(),c()}}return e(s,a,a,l,u)}}),r)}}function p(e,t,n,r,i,o){var a=k(r),s=x(n,a);return function(n,r,a,l,u){return n(j(function(n){if(null!=n){if(n)return e(s,a,a,l,u);var r=e(i,L,a,l,u),c=t(o,L,a,l,u);return function(){r(),c()}}}),r)}}function d(e,t,n){return function(r,i,o,a,s){return e(j(function(e){if(null!=e)return e?t(r,i,o,a,s):n(r,i,o,a,s)}),i)}}function f(e){return function(t,n,r,i,o){return e(j(function(e){if(e)return t(j(function(t){null!=t&&(e.splice?e.splice(0,e.length,t):e.clear&&e.add&&(e.clear(),e.add(t)))}),n)}),r)}}function v(e){return function(t,n,r,i,o){return e(j(function(e){if(e)return t(j(function(t){null!=t&&t!==e.one()&&(e.splice?e.splice(0,e.length,t):e.clear&&e.add&&(e.clear(),e.add(t)))}),n)}),r)}}function m(e,t){return function(n,i,o,a,s){return e(j(function(e){return e?n(j(function(t){function n(t,n,i){if(!E(e))if(s&&console.log("SWAPPING",n,"FOR",t,"AT",i,"ON",s.targetPath,r()),e.swap)e.swap(i,n.length,t);else if(e.add&&(e.remove||e["delete"])){var o,a,l,u;for(o=0,a=t.length,l;l=t[o];o++)e.add(l);for(u=e.remove||e["delete"],o=0,a=n.length,l;l=n[o];o++)e.deleteMethod(l)}}if(t!==e){if(!t)return void e.clear();if(t.addRangeChangeListener)return t.addRangeChangeListener(n),n(Array.from(t),Array.from(e),0),function(){t.removeRangeChangeListener(n)}}}),i):t(O.makeLiteralObserver([]),i,o,a,s)}),o)}}function g(e){return function(t,n,i,o,a){return e(j(function(e){if(e)return t(j(function(t){function n(t,n){if(!o.isActive)try{o.isActive=!0,void 0===t?(a&&a&&console.log("DELETED",a.targetPath,"FOR KEY",n,"ON",e,"BECAUSE",a.sourcePath,r()),Array.isArray(e)?e.splice(n,1):e["delete"](n)):(a&&a&&console.log("SET",a.targetPath,"FOR KEY",n,"TO",t,"ON",e,"BECAUSE",a.sourcePath,r()),e.set(n,t))}finally{o.isActive=!1}}return t?(e.clear(),t.forEach(n),t.addMapChangeListener(n)):void e.clear()}),n)}),i)}}function _(e){return function(t,n,r,i,o){return e(j(function(e){if(e)return t(j(function(t){function n(t,n,r){if(!E(e)){var i=e.length-r-n.length;e.swap(i,n.length,t.reversed())}}return t?(t.addRangeChangeListener(n),n(t,e,0),function(){t.removeRangeChangeListener(n)}):void e.clear()}),n)}),r)}}function b(e){return function(t,n,r,i,o){return t(j(function(t){return t?Function.noop:e(D,n,r,i,o)}),r)}}function y(e){return function(t,n,r,i,o){if(r.parent)return e(t,n,r.parent,i,o)}}function w(e,t){return function(n,r,i,o,a){return e(j(function(e){if(null!=e)return t(n,r,i.nest(e),o,a)}),i)}}function E(e){return e.getRangeChangeDescriptor&&e.getRangeChangeDescriptor().isActive}var C=e("./scope"),O=e("./observers"),j=O.autoCancelPrevious,P=O.observeRangeChange,T=O.cancelEach,k=O.makeNotObserver,x=O.makeOrObserver,A=O.makeAndObserver,D=(O.observeValue,O.makeLiteralObserver()),S=new C((!0)),L=new C((!1));t.bindProperty=i;var M=i;t.makePropertyBinder=o,t.bindGet=a;var R=a;t.makeGetBinder=s,t.makeHasBinder=l,t.makeEqualityBinder=u,t.makeEveryBlockBinder=c,t.makeAndBinder=h,t.makeOrBinder=p,t.makeConditionalBinder=d,t.makeOnlyBinder=f,t.makeOneBinder=v,t.makeRangeContentBinder=m,t.makeMapContentBinder=g,t.makeReversedBinder=_,t.makeDefinedBinder=b,t.makeParentBinder=y,t.makeWithBinder=w}}),montageDefine("afa97d9","operators",{dependencies:["collections/shim-object","collections/shim-regexp","collections/map","collections/set"],factory:function(e,t,n){e("collections/shim-object"),e("collections/shim-regexp");var r=e("collections/map"),i=e("collections/set");t.toNumber=function(e){return+e},t.toString=function(e){return null==e?e:"string"==typeof e||"number"==typeof e?""+e:null},t.toArray=Array.from,t.toMap=r.from.bind(r),t.toSet=i.from.bind(i),t.not=function(e){return!e},t.neg=function(e){return-e},t.pow=function(e,t){return Math.pow(e,t)},t.root=function(e,t){return Math.pow(e,1/t)},t.log=function(e,t){return Math.log(e)/Math.log(t)},t.mul=function(e,t){return e*t},t.div=function(e,t){return e/t},t.mod=function(e,t){return(e%t+t)%t},t.rem=function(e,t){return e%t},t.add=function(e,t){return e+t},t.sub=function(e,t){return e-t},t.ceil=function(e){return Math.ceil(e)},t.floor=function(e){return Math.floor(e)},t.round=function(e){return Math.round(e)},t.lt=function(e,t){return Object.compare(e,t)<0},t.gt=function(e,t){return Object.compare(e,t)>0},t.le=function(e,t){return Object.compare(e,t)<=0},t.ge=function(e,t){return Object.compare(e,t)>=0},t.equals=Object.equals,t.compare=Object.compare,t.and=function(e,t){return e&&t},t.or=function(e,t){return e||t},t.defined=function(e){return null!=e},t.startsWith=function(e,t){var n=new RegExp("^"+RegExp.escape(t));return n.test(e)},t.endsWith=function(e,t){var n=new RegExp(RegExp.escape(t)+"$");return n.test(e)},t.contains=function(e,t){var n=new RegExp(RegExp.escape(t));return n.test(e)},t.join=function(e,t){return e.join(t||"")},t.split=function(e,t){return e.split(t||"")},t.range=function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t},t.last=function(e){return e.get(e.length-1)}}}),montageDefine("afa97d9","compute",{dependencies:["./parse","./compile-observer","./compile-binder","./observers","./scope"],factory:function(e,t,n){function r(e,t,n){n.target=e,n.targetPath=t;var r=n.source=n.source||e,u=n.args,c=n.compute,h=n.parameters=n.parameters||r,p=n.document,d=n.components,f=n.trace,v=new l(r);v.parameters=h,v.document=p,v.components=d;var m=new l(e);m.parameters=h,m.document=p,m.components=d;for(var g,_,b,y,w=[],E=0;g=u[E];E++)_=i(g),"rangeContent"===_.type?(b=o(_.args[0]),y=s.makeRangeContentObserver(b)):"mapContent"===_.type?(b=o(_.args[0]),y=s.makeMapContentObserver(b)):y=o(_),w.push(y);var C=s.makeRangeContentObserver(s.makeObserversObserver(w)),O=s.makeComputerObserver(C,c,e),j=i(t),P=a(j);return P(O,v,m,n,f?{sourcePath:u.join(", "),targetPath:t}:void 0)}var i=e("./parse"),o=e("./compile-observer"),a=e("./compile-binder"),s=e("./observers"),l=e("./scope");n.exports=r}}),montageDefine("afa97d9","observe",{dependencies:["./parse","./compile-observer","./observers","./scope"],factory:function(e,t,n){function r(e,t,n){var r;r="function"==typeof n?{change:n}:n,r=r||u,r.source=e,r.sourcePath=t;var c=r.parameters=r.parameters||e,h=r.document,p=r.components,d=r.beforeChange,f=r.contentChange,v=new l(e);v.parameters=c,v.document=h,v.components=p,v.beforeChange=d;var m=i(t),g=o(m);return f===!0&&(g=a.makeRangeContentObserver(g)),g(s(function(t){if(t){if("function"!=typeof f)return 1===arguments.length?r.change.call(e,arguments[0]):2===arguments.length?r.change.call(e,arguments[0],arguments[1]):r.change.apply(e,arguments);if("function"==typeof f)return t.addRangeChangeListener(f),function(){t.removeRangeChangeListener(f)}}}),v)}var i=e("./parse"),o=e("./compile-observer"),a=e("./observers"),s=a.autoCancelPrevious,l=e("./scope");n.exports=r;var u={}}}),montageDefine("afa97d9","language",{dependencies:["collections/set","collections/map"],factory:function(e,t,n){for(var r,i,o,a,s=e("collections/set"),l=e("collections/map"),u=t.precedence=new l,c=t.precedenceLevels=[["tuple","record"],["literal","value","parameters","property","element","component","mapBlock","filterBlock","sortedBlock","groupBlock","groupMapBlock","with"],["not","neg","number","parent"],["scope"],["default"],["pow","root","log"],["mul","div","mod","rem"],["add","sub"],["equals","lt","gt","le","ge","compare"],["and"],["or"],["if"]],h=0,p=c.length;h<p;h++)for(i=c[h],r=new s(u.keysArray()),o=0,a=i.length;o<a;o++)u.set(i[o],r);var d=t.operatorTokens=l.from({"**":"pow","//":"root","%%":"log","*":"mul","/":"div","%":"mod",rem:"rem","+":"add","-":"sub","<":"lt",">":"gt","<=":"le",">=":"ge","==":"equals","<=>":"compare","!=":"notEquals","??":"default","&&":"and","||":"or","?":"then",":":"else"});t.operatorTypes=new l(d.map(function(e,t){return[e,t]}))}}),montageDefine("afa97d9","merge",{dependencies:["collections/shim"],factory:function(e,t,n){"use strict";function r(e,t){for(var n,r=(t.length+1)*(e.length+1),i=Array(r),o=Array(t.length+1),a=Array(t.length+1),s=0;s<e.length+1;s++){for(var l=0;l<t.length+1;l++){var u,c;if(0===s&&0===l)u=" ",c=0;else if(0===s)u="insert",c=l;else if(0===l)u="delete",c=s;else if(e[s-1]===t[l-1])u="retain",c=a[l-1];else{var h=o[l-1],p=a[l];p<h?(u="delete",c=p+1):(u="insert",c=h+1)}i[s+l*(e.length+1)]=u,o[l]=c}n=o,o=a,a=n}return{edges:i,cost:a[t.length],source:t,target:e}}function i(e){for(var t,n,r=[],i=e.edges,o=t=e.target.length,a=e.source.length;t||a;){var s=i[t+a*(o+1)];if("delete"===s){if(n&&"delete"===n[0])n[1]++;else{var l=["delete",1];n=l,r.push(l)}t--}else if("insert"===s){if(n&&"insert"===n[0])n[1]++;else{var l=["insert",1];n=l,r.push(l)}a--}else if("retain"===s){var l=["retain",1];n&&"retain"===n[0]?n[1]++:(n=l,r.push(l)),t--,a--}}return r.reverse(),r}function o(e,t){return i(r(e,t))}function a(e,t){for(var n=o(e,t),r=[],i=0,a=0,s=0;s<n.length;){var l=n[s++];if("insert"===l[0])r.push([a,0,t.slice(a,a+l[1])]),a+=l[1];else if("delete"===l[0])if(s<n.length&&"insert"===n[s][0]){var u=n[s++];r.push([a,l[1],t.slice(a,a+u[1])]),i+=l[1],a+=u[1]}else r.push([a,l[1]]),i+=l[1];else"retain"==l[0]&&(i+=l[1],a+=l[1])}return r}function s(e,t){for(var n=0;n<t.length;n++)e.swap.apply(e,t[n])}function l(e,t){s(e,a(e,t))}e("collections/shim"),t.graphOt=r,t.traceOt=i,t.ot=o,t.diff=a,t.apply=s,t.merge=l}}),montageDefine("8919b53","weak-map",{dependencies:[],factory:function(e,t,n){!function(){"use strict";function e(t){t.permitHostObjects___&&t.permitHostObjects___(e)}function t(e){return!(e.substr(0,d.length)==d&&"___"===e.substr(e.length-3))}function r(e){if(e!==Object(e))throw new TypeError("Not an object: "+e);var t=e[f];if(t&&t.key===e)return t;if(p(e)){t={key:e};try{return h(e,f,{value:t,writable:!1,enumerable:!1,configurable:!1}),t}catch(n){return}}}function i(e){return e.prototype=null,Object.freeze(e)}function o(){_||"undefined"==typeof console||(_=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=e);var a=!1;if("function"==typeof WeakMap){var s=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var l=new s,u=Object.freeze({});if(l.set(u,1),1===l.get(u))return void(n.exports=WeakMap);a=!0}}var c=(Object.prototype.hasOwnProperty,Object.getOwnPropertyNames),h=Object.defineProperty,p=Object.isExtensible,d="weakmap:",f=d+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var v=new ArrayBuffer(25),m=new Uint8Array(v);crypto.getRandomValues(m),f=d+"rand:"+Array.prototype.map.call(m,function(e){return(e%36).toString(36)}).join("")+"___"}if(h(Object,"getOwnPropertyNames",{value:function(e){return c(e).filter(t)}}),"getPropertyNames"in Object){var g=Object.getPropertyNames;h(Object,"getPropertyNames",{value:function(e){return g(e).filter(t)}})}!function(){var e=Object.freeze;h(Object,"freeze",{value:function(t){return r(t),e(t)}});var t=Object.seal;h(Object,"seal",{value:function(e){return r(e),t(e)}});var n=Object.preventExtensions;h(Object,"preventExtensions",{value:function(e){return r(e),n(e)}})}();var _=!1,b=0,y=function(){function e(e,t){var n,i=r(e);return i?u in i?i[u]:t:(n=s.indexOf(e),n>=0?l[n]:t)}function t(e){var t=r(e);return t?u in t:s.indexOf(e)>=0}function n(e,t){var n,i=r(e);return i?i[u]=t:(n=s.indexOf(e),n>=0?l[n]=t:(n=s.length,l[n]=t,s[n]=e)),this}function a(e){var t,n,i=r(e);return i?u in i&&delete i[u]:(t=s.indexOf(e),!(t<0||(n=s.length-1,s[t]=void 0,l[t]=l[n],s[t]=s[n],s.length=n,l.length=n,0)))}this instanceof y||o();var s=[],l=[],u=b++;return Object.create(y.prototype,{get___:{value:i(e)},has___:{value:i(t)},set___:{value:i(n)},delete___:{value:i(a)}})};y.prototype=Object.create(Object.prototype,{get:{value:function(e,t){return this.get___(e,t)},writable:!0,configurable:!0},has:{value:function(e){return this.has___(e)},writable:!0,configurable:!0},set:{value:function(e,t){return this.set___(e,t)},writable:!0,configurable:!0},"delete":{value:function(e){return this.delete___(e)},writable:!0,configurable:!0}}),"function"==typeof s?!function(){function t(){function t(e,t){return c?u.has(e)?u.get(e):c.get___(e,t):u.get(e,t)}function n(e){return u.has(e)||!!c&&c.has___(e)}function r(e){var t=!!u["delete"](e);return c?c.delete___(e)||t:t}this instanceof y||o();var l,u=new s,c=void 0,h=!1;return l=a?function(e,t){return u.set(e,t),u.has(e)||(c||(c=new y),c.set(e,t)),this}:function(e,t){if(h)try{u.set(e,t)}catch(n){c||(c=new y),c.set___(e,t)}else u.set(e,t);return this},Object.create(y.prototype,{get___:{value:i(t)},has___:{value:i(n)},set___:{value:i(l)},delete___:{value:i(r)},permitHostObjects___:{value:i(function(t){if(t!==e)throw new Error("bogus call to permitHostObjects___");h=!0})}})}a&&"undefined"!=typeof Proxy&&(Proxy=void 0),
t.prototype=y.prototype,n.exports=t,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),n.exports=y)}}()}}),montageDefine("c3eaa99","ui/number-field.reel/number-field",{dependencies:["montage/ui/base/abstract-number-field"],factory:function(e,t,n){var r=e("montage/ui/base/abstract-number-field").AbstractNumberField;t.NumberField=r.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("c3eaa99","ui/slider.reel/slider",{dependencies:["montage/ui/base/abstract-slider"],factory:function(e,t,n){var r=e("montage/ui/base/abstract-slider").AbstractSlider;t.Slider=r.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("c3eaa99","ui/number-field.reel/number-field.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-NumberField{box-sizing:border-box;position:relative;display:inline-block;width:auto;margin:0 4px;vertical-align:middle;outline:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.digit-NumberField>.digit-NumberField-input{float:left;width:3.75em;border-radius:0;text-align:center}.digit-NumberField>.digit-NumberField-plus,.digit-NumberField>.digit-NumberField-minus{float:left;margin:0;padding:2px;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.digit-NumberField>.digit-NumberField-plus{border-width:1px 1px 1px 0;border-radius:0 2.5em 2.5em 0}.digit-NumberField>.digit-NumberField-minus{border-width:1px 0 1px 1px;border-radius:2.5em 0 0 2.5em}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"numberField"},"_numberFieldTextFieldComponent":{"@":"textField"},"_numberFieldMinusComponent":{"@":"minus"},"_numberFieldPlusComponent":{"@":"plus"}}},"textField":{"prototype":"ui/text-field.reel","properties":{"element":{"#":"textField"}},"bindings":{"value":{"<->":"@owner.value"}}},"plus":{"prototype":"ui/button.reel","properties":{"element":{"#":"buttonPlus"}}},"minus":{"prototype":"ui/button.reel","properties":{"element":{"#":"buttonMinus"}}}}</script></head><body><span data-montage-id=numberField class=digit-NumberField><button data-montage-id=buttonMinus class=digit-NumberField-minus tabindex=-1>−</button> <input data-montage-id=textField class=digit-NumberField-input> <button data-montage-id=buttonPlus class=digit-NumberField-plus tabindex=-1>+</button></span></body></html>'}),montageDefine("c3eaa99","ui/slider.reel/slider.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-Slider{display:inline-block;-moz-box-sizing:border-box;box-sizing:border-box;width:10em;height:.625em;border-radius:.25em;border:1px solid;outline:none;padding-right:-webkit-calc(1.75em - 2px);padding-right:-moz-calc(1.75em - 2px);padding-right:calc(1.75em - 2px)}.digit-Slider.montage-Slider--vertical{width:.625em;height:10em;margin:0 .625em;padding-right:0;padding-bottom:-webkit-calc(1.75em - 2px);padding-bottom:-moz-calc(1.75em - 2px);padding-bottom:calc(1.75em - 2px)}.digit-Slider-thumb{position:relative;font-size:inherit;-moz-box-sizing:border-box;box-sizing:border-box;width:1.75em;height:1.75em;margin:-.625em 0 0 -1px;border-radius:.875em;border:1px solid;background-color:currentColor;cursor:pointer}.montage-Slider--vertical .digit-Slider-thumb{margin:-1px 0 0 -.625em}.digit-Slider-thumb:after{position:absolute;content:"";top:-16px;left:-16px;bottom:-16px;right:-16px}[data-montage-skin="wireframe"] .digit-Slider{border-color:#b3b3b3;background-color:#d9d9d9}[data-montage-skin="wireframe"] .digit-Slider-thumb{border-color:#b3b3b3;background-color:#f2f2f2}[data-montage-skin="wireframe"] .montage-Slider--active .digit-Slider-thumb{background-color:#e5e5e5}[data-montage-skin="light"] .digit-Slider{border-color:hsla(0,0%,70%,1);background-color:hsl(0,0%,86%);box-shadow:inset 0 1px 2px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-Slider-thumb{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:-moz-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:-ms-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),0 1px 2px 0 hsla(0,0%,0%,.1),0 7px 6px -3px hsla(0,0%,0%,.15)}[data-montage-skin="light"] .montage-Slider--active .digit-Slider-thumb{border-color:hsla(0,0%,65%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),0 1px 2px 0 hsla(0,0%,0%,.2),0 6px 6px -3px hsla(0,0%,0%,.1)}[data-montage-skin="dark"] .digit-Slider{border-color:hsl(0,0%,15%);background-color:hsl(0,0%,22%);box-shadow:inset 0 1px 2px hsla(0,0%,0%,.25),0 1px 0 hsla(0,0%,100%,.1);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="dark"] .digit-Slider-thumb{border-color:hsl(0,0%,16%);background-image:-webkit-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:-moz-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:-ms-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),0 1px 2px 0 hsla(0,0%,0%,.15),0 7px 6px -3px hsla(0,0%,0%,.25)}[data-montage-skin="dark"] .montage-Slider--active .digit-Slider-thumb{border-color:hsl(0,0%,12%);background-image:-webkit-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:-moz-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:-ms-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),0 1px 2px 0 hsla(0,0%,0%,.2),0 7px 6px -3px hsla(0,0%,0%,.15)}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"slider"},"_sliderThumbElement":{"#":"sliderThumb"}}}}</script></head><body><div data-montage-id=slider class=digit-Slider><div data-montage-id=sliderThumb class=digit-Slider-thumb></div></div></body></html>'}),montageDefine("c3eaa99","ui/text-field.reel/text-field",{dependencies:["montage/ui/base/abstract-text-field"],factory:function(e,t,n){var r=e("montage/ui/base/abstract-text-field").AbstractTextField;t.TextField=r.specialize({hasTemplate:{value:!0},constructor:{value:function(){this["super"]()}}})}}),montageDefine("c3eaa99","ui/button.reel/button",{dependencies:["montage/ui/base/abstract-button"],factory:function(e,t,n){var r=e("montage/ui/base/abstract-button").AbstractButton;t.Button=r.specialize({hasTemplate:{value:!0},constructor:{value:function(){this["super"](),this.classList.add("digit-Button")}}})}}),montageDefine("c3eaa99","ui/text-field.reel/text-field.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-TextField{outline:none;box-sizing:border-box;font-size:100%;width:10em;height:2.5em;padding:0 .5em;vertical-align:middle;color:inherit;border:1px solid;border-radius:.25em;background-color:transparent;-webkit-tap-highlight-color:transparent;-webkit-appearance:none}.digit-TextField:focus{box-shadow:inset 0 0 0 1px}.digit-TextField.montage--disabled{opacity:.5;border-style:dashed;pointer-events:none}.digit-TextField:invalid{color:#E73525}.digit-TextField[readonly]{background-color:#e5e5e5}.digit-TextField::-webkit-input-placeholder{color:inherit;opacity:.5}.digit-TextField::-moz-placeholder{color:inherit;opacity:.5}.digit-TextField:-ms-input-placeholder{color:inherit;opacity:.5}[data-montage-skin="wireframe"] .digit-TextField{color:#4D4D4D;border-color:#b3b3b3;background-color:#fff}[data-montage-skin="wireframe"] .digit-TextField:focus{border-color:#7f7f7f;box-shadow:none}[data-montage-skin="wireframe"] .digit-TextField:invalid{color:#E73525;border-color:#E73525}[data-montage-skin="light"] .digit-TextField{color:hsla(0,0%,0%,.7);text-shadow:0 1px 0 hsla(0,0%,100%,.5);border-color:hsl(0,0%,80%);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));box-shadow:inset 0 1px 2px hsla(0,0%,0%,.05),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-TextField:focus{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:-moz-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:-ms-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="light"] .digit-TextField:invalid{color:#E73525;border-color:#E73525}[data-montage-skin="dark"] .digit-TextField{color:hsl(0,0%,80%);text-shadow:0 1px 0 hsla(0,0%,0%,.2);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:-moz-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:-ms-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));box-shadow:inset 0 1px 2px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.1);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="dark"] .digit-TextField:focus{color:hsl(0,0%,100%);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:-moz-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:-ms-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-TextField:invalid{color:#FF6052;border-color:#FF6052}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"textField"}}}}</script></head><body><input data-montage-id=textField class=digit-TextField></body></html>'}),montageDefine("c3eaa99","ui/button.reel/button.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-Button{display:inline-block;-moz-box-sizing:border-box;box-sizing:border-box;height:2.5em;min-width:2.5em;margin:0 2px;padding:.625em 1em;border-radius:1.25em;vertical-align:middle;font-size:100%;color:inherit;border:1px solid;background-color:transparent;outline:none;cursor:pointer;text-decoration:none;-webkit-tap-highlight-color:transparent}.digit-Button.montage--active{background-color:hsla(0,0%,0%,.06)}.digit-Button:focus{box-shadow:inset 0 0 0 1px}[data-montage-skin="wireframe"] .digit-Button{color:#4D4D4D;border-color:#b3b3b3;background-color:#f2f2f2}[data-montage-skin="wireframe"] .digit-Button.montage--active{background-color:#e5e5e5}[data-montage-skin="wireframe"] .digit-Button:focus{border-color:#4D4D4D;box-shadow:none}[data-montage-skin="light"] .digit-Button{color:hsla(0,0%,0%,.7);text-shadow:0 1px 0 hsla(0,0%,100%,.5);border-color:hsl(0,0%,80%);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),inset 0 -1px 1px hsla(0,0%,0%,.04),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-Button.montage--active{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-moz-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-ms-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.2),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="light"] .digit-Button:focus{border-color:hsl(0,0%,50%)}[data-montage-skin="dark"] .digit-Button{color:hsl(0,0%,80%);text-shadow:0 1px 0 hsla(0,0%,0%,.2);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-moz-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-ms-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),inset 0 -1px 1px hsla(0,0%,0%,.06),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-Button.montage--active{color:hsl(0,0%,60%);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:-moz-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:-ms-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-Button:focus{border-color:hsl(0,0%,50%)}.digit-Button--glass,.digit-Button--glass.montage--active,[data-montage-skin="wireframe"] .digit-Button--glass,[data-montage-skin="wireframe"] .digit-Button--glass.montage--active,[data-montage-skin="light"] .digit-Button--glass,[data-montage-skin="light"] .digit-Button--glass.montage--active,[data-montage-skin="dark"] .digit-Button--glass,[data-montage-skin="dark"] .digit-Button--glass.montage--active{margin:0;border-radius:0;border:none;background:0 0;box-shadow:none}[data-montage-skin="dark"] .digit-Button--glass.montage--active{color:hsla(0,0%,100%,.5)}.digit-ButtonGroup{display:inline-block;vertical-align:middle;padding-left:1px;border-radius:1.25em}.digit-ButtonGroup>.digit-Button{float:left;margin:0 0 0 -1px;border-radius:0}.digit-ButtonGroup>.digit-Button:first-child{border-top-left-radius:inherit;border-bottom-left-radius:inherit}.digit-ButtonGroup>.digit-Button:last-child{border-top-right-radius:inherit;border-bottom-right-radius:inherit}</style></head><body></body></html>'});