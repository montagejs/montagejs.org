---

layout: api
title: "UndoManager - MontageJS API"

---

<nav class="subnav js-api-subnav">
    <input id="index-search" type="search" placeholder="Search"><details open><summary>Types</summary><ul><li><a href="AbstractButton.html">AbstractButton</a></li><li><a href="AbstractCheckbox.html">AbstractCheckbox</a></li><li><a href="AbstractControl.html">AbstractControl</a></li><li><a href="AbstractImage.html">AbstractImage</a></li><li><a href="AbstractLink.html">AbstractLink</a></li><li><a href="AbstractNumberField.html">AbstractNumberField</a></li><li><a href="AbstractRadioButton.html">AbstractRadioButton</a></li><li><a href="AbstractSelect.html">AbstractSelect</a></li><li><a href="AbstractSlider.html">AbstractSlider</a></li><li><a href="AbstractTextArea.html">AbstractTextArea</a></li><li><a href="AbstractTextField.html">AbstractTextField</a></li><li><a href="AbstractToggleButton.html">AbstractToggleButton</a></li><li><a href="AbstractToggleSwitch.html">AbstractToggleSwitch</a></li><li><a href="AbstractVideo.html">AbstractVideo</a></li><li><a href="ActionEventListener.html">ActionEventListener</a></li><li><a href="Application.html">Application</a></li><li><a href="AssociationBlueprint.html">AssociationBlueprint</a></li><li><a href="Binder.html">Binder</a></li><li><a href="BinderManager.html">BinderManager</a></li><li><a href="BitField.html">BitField</a></li><li><a href="Blueprint.html">Blueprint</a></li><li><a href="BytesConverter.html">BytesConverter</a></li><li><a href="Component.html">Component</a></li><li><a href="Composer.html">Composer</a></li><li><a href="Condition.html">Condition</a></li><li><a href="Converter.html">Converter</a></li><li><a href="CubicBezier.html">CubicBezier</a></li><li><a href="CurrencyConverter.html">CurrencyConverter</a></li><li><a href="DateConverter.html">DateConverter</a></li><li><a href="DateValidator.html">DateValidator</a></li><li><a href="DefaultLocalizer.html">DefaultLocalizer</a></li><li><a href="DerivedPropertyBlueprint.html">DerivedPropertyBlueprint</a></li><li><a href="Enum.html">Enum</a></li><li><a href="EventBlueprint.html">EventBlueprint</a></li><li><a href="EventManager.html">EventManager</a></li><li><a href="Exception.html">Exception</a></li><li><a href="Gate.html">Gate</a></li><li><a href="InvertConverter.html">InvertConverter</a></li><li><a href="KeyComposer.html">KeyComposer</a></li><li><a href="KeyManager.html">KeyManager</a></li><li><a href="Loader.html">Loader</a></li><li><a href="Localizer.html">Localizer</a></li><li><a href="Logger.html">Logger</a></li><li><a href="LowerCaseConverter.html">LowerCaseConverter</a></li><li><a href="MediaController.html">MediaController</a></li><li><a href="MessageFormat.html">MessageFormat</a></li><li><a href="MessageLocalizer.html">MessageLocalizer</a></li><li><a href="module-Overlay.html">module:Overlay</a></li><li><a href="global.html#Montage">Montage</a></li><li><a href="MontageWindow.html">MontageWindow</a></li><li><a href="MutableEvent.html">MutableEvent</a></li><li><a href="NewLineToBrConverter.html">NewLineToBrConverter</a></li><li><a href="NumberConverter.html">NumberConverter</a></li><li><a href="NumberValidator.html">NumberValidator</a></li><li><a href="ObjectController.html">ObjectController</a></li><li><a href="ObjectProperty.html">ObjectProperty</a></li><li><a href="Point_.html">Point</a></li><li><a href="PressComposer.html">PressComposer</a></li><li><a href="PropertyBlueprint.html">PropertyBlueprint</a></li><li><a href="PropertyValidationRule.html">PropertyValidationRule</a></li><li><a href="PropertyValidationSemantics.html">PropertyValidationSemantics</a></li><li><a href="Repetition.html">Repetition</a></li><li><a href="RootComponent.html">RootComponent</a></li><li><a href="Slot.html">Slot</a></li><li><a href="State.html">State</a></li><li><a href="StateChart.html">StateChart</a></li><li><a href="Substitution.html">Substitution</a></li><li><a href="SwipeComposer.html">SwipeComposer</a></li><li><a href="Text.html">Text</a></li><li><a href="TranslateComposer.html">TranslateComposer</a></li><li><a href="TrimConverter.html">TrimConverter</a></li><li><a href="UndoManager.html">UndoManager</a></li><li><a href="UpperCaseConverter.html">UpperCaseConverter</a></li><li><a href="Uuid_.html">Uuid</a></li><li><a href="Validator.html">Validator</a></li></ul></details><details><summary>Externals</summary><ul><li><a href="external-Array.html">Array</a></li><li><a href="external-Function.html">Function</a></li><li><a href="external-Object.html">Object</a></li><li><a href="external-RegExp.html">RegExp</a></li><li><a href="external-String.html">String</a></li></ul></details><details><summary>Events</summary><ul><li><a href="AbstractButton.html#event:action">action</a></li><li><a href="AbstractButton.html#event:longAction">longAction</a></li><li><a href="AbstractCheckbox.html#event:action">action</a></li><li><a href="AbstractLink.html#event:action">action</a></li><li><a href="AbstractRadioButton.html#event:action">action</a></li><li><a href="AbstractSelect.html#event:action">action</a></li><li><a href="AbstractTextField.html#event:action">action</a></li><li><a href="AbstractToggleButton.html#event:action">action</a></li><li><a href="AbstractToggleButton.html#event:longAction">longAction</a></li><li><a href="AbstractToggleSwitch.html#event:action">action</a></li><li><a href="global.html#event:longpress">longpress</a></li><li><a href="Overlay.html#event:dismiss">dismiss</a></li><li><a href="PressComposer.html#event:longPress">longPress</a></li><li><a href="PressComposer.html#event:press">press</a></li><li><a href="PressComposer.html#event:pressCancel">pressCancel</a></li><li><a href="PressComposer.html#event:pressStart">pressStart</a></li><li><a href="UndoManager.html#event:operationRegistered">operationRegistered</a></li><li><a href="UndoManager.html#event:redo">redo</a></li><li><a href="UndoManager.html#event:undo">undo</a></li></ul></details><details><summary>Tutorials</summary><ul><li><a href="tutorial-README.html">README</a></li></ul></details><details><summary>Global</summary><ul><li><a href="global.html#__flowTranslateComposer">__flowTranslateComposer</a></li><li><a href="global.html#_analyzeMovement">_analyzeMovement</a></li><li><a href="global.html#_animationInterval">_animationInterval</a></li><li><a href="global.html#_bezierTubeBoundingSphere">_bezierTubeBoundingSphere</a></li><li><a href="global.html#_bezierValue">_bezierValue</a></li><li><a href="global.html#_boundingBoxSize">_boundingBoxSize</a></li><li><a href="global.html#_cameraElement">_cameraElement</a></li><li><a href="global.html#_closerIndex">_closerIndex</a></li><li><a href="global.html#_computeCssCubicBezierValue">_computeCssCubicBezierValue</a></li><li><a href="global.html#_computeFrustumNormals">_computeFrustumNormals</a></li><li><a href="global.html#_computePointedElement">_computePointedElement</a></li><li><a href="global.html#_computeRotationValuesToXAxis">_computeRotationValuesToXAxis</a></li><li><a href="global.html#_computeVisibleRange">_computeVisibleRange</a></li><li><a href="global.html#_contentOffsetX">_contentOffsetX</a></li><li><a href="global.html#_contentOffsetY">_contentOffsetY</a></li><li><a href="global.html#_controller">_controller</a></li><li><a href="global.html#_createTemplateObjects">_createTemplateObjects</a></li><li><a href="global.html#_currentX">_currentX</a></li><li><a href="global.html#_currentY">_currentY</a></li><li><a href="global.html#_dispatchTranslate">_dispatchTranslate</a></li><li><a href="global.html#_dispatchTranslateEnd">_dispatchTranslateEnd</a></li><li><a href="global.html#_dispatchTranslateStart">_dispatchTranslateStart</a></li><li><a href="global.html#_draggedSlideIndex">_draggedSlideIndex</a></li><li><a href="global.html#_elasticScrollingRange">_elasticScrollingRange</a></li><li><a href="global.html#_elasticScrollingSpeed">_elasticScrollingSpeed</a></li><li><a href="global.html#_elementsBoundingSphereRadius">_elementsBoundingSphereRadius</a></li><li><a href="global.html#_end">_end</a></li><li><a href="global.html#_flow">_flow</a></li><li><a href="global.html#_getSlideOffset">_getSlideOffset</a></li><li><a href="global.html#_handleSelectedIndexesChange">_handleSelectedIndexesChange</a></li><li><a href="global.html#_hasMomentum">_hasMomentum</a></li><li><a href="global.html#_height">_height</a></li><li><a href="global.html#_incrementSlideOffset">_incrementSlideOffset</a></li><li><a href="global.html#_infinite">_infinite</a></li><li><a href="global.html#_isCameraUpdated">_isCameraUpdated</a></li><li><a href="global.html#_isTransitioningScroll">_isTransitioningScroll</a></li><li><a href="global.html#_lineVectorX">_lineVectorX</a></li><li><a href="global.html#_lineVectorY">_lineVectorY</a></li><li><a href="global.html#_maxSlideOffsetIndex">_maxSlideOffsetIndex</a></li><li><a href="global.html#_minSlideOffsetIndex">_minSlideOffsetIndex</a></li><li><a href="global.html#_move">_move</a></li><li><a href="global.html#_numberOfIterations">_numberOfIterations</a></li><li><a href="global.html#_optimizeObjectsInstantiation">_optimizeObjectsInstantiation</a></li><li><a href="global.html#_pageX">_pageX</a></li><li><a href="global.html#_pageY">_pageY</a></li><li><a href="global.html#_pointerIntersectionPosition">_pointerIntersectionPosition</a></li><li><a href="global.html#_pointerStartX">_pointerStartX</a></li><li><a href="global.html#_pointerStartY">_pointerStartY</a></li><li><a href="global.html#_previousScrollDelta">_previousScrollDelta</a></li><li><a href="global.html#_raycastBezierTubes">_raycastBezierTubes</a></li><li><a href="global.html#_rayRectangleIntersection">_rayRectangleIntersection</a></li><li><a href="global.html#_rayRectangleIntersectionPosition">_rayRectangleIntersectionPosition</a></li><li><a href="global.html#_removeObjects">_removeObjects</a></li><li><a href="global.html#_removeSlideOffset">_removeSlideOffset</a></li><li><a href="global.html#_repetition">_repetition</a></li><li><a href="global.html#_resolveElementIdCollisions">_resolveElementIdCollisions</a></li><li><a href="global.html#_rotateXYZ">_rotateXYZ</a></li><li><a href="global.html#_scroll">_scroll</a></li><li><a href="global.html#_scrollEnd">_scrollEnd</a></li><li><a href="global.html#_scrollingTransitionDuration">_scrollingTransitionDuration</a></li><li><a href="global.html#_scrollingTransitionDurationMiliseconds">_scrollingTransitionDurationMiliseconds</a></li><li><a href="global.html#_scrollingTransitionTimingFunction">_scrollingTransitionTimingFunction</a></li><li><a href="global.html#_scrollingTransitionTimingFunctionBezier">_scrollingTransitionTimingFunctionBezier</a></li><li><a href="global.html#_scrollStart">_scrollStart</a></li><li><a href="global.html#_segmentsIntersection">_segmentsIntersection</a></li><li><a href="global.html#_slideOffsets">_slideOffsets</a></li><li><a href="global.html#_slideOffsetsLength">_slideOffsetsLength</a></li><li><a href="global.html#_sphereIntersection">_sphereIntersection</a></li><li><a href="global.html#_start">_start</a></li><li><a href="global.html#_startPageX">_startPageX</a></li><li><a href="global.html#_startPageY">_startPageY</a></li><li><a href="global.html#_startScroll">_startScroll</a></li><li><a href="global.html#_startX">_startX</a></li><li><a href="global.html#_startY">_startY</a></li><li><a href="global.html#_timingFunctions">_timingFunctions</a></li><li><a href="global.html#_translateStride">_translateStride</a></li><li><a href="global.html#_updateDragScroll">_updateDragScroll</a></li><li><a href="global.html#_updateLength">_updateLength</a></li><li><a href="global.html#_updateLinearScroll">_updateLinearScroll</a></li><li><a href="global.html#_updateScroll">_updateScroll</a></li><li><a href="global.html#_updateSlideOffset">_updateSlideOffset</a></li><li><a href="global.html#_updateVisibleIndexes">_updateVisibleIndexes</a></li><li><a href="global.html#_walkObject">_walkObject</a></li><li><a href="global.html#_walksBindingReferences">_walksBindingReferences</a></li><li><a href="global.html#_width">_width</a></li><li><a href="global.html#acceptsActiveTarget">acceptsActiveTarget</a></li><li><a href="global.html#active">active</a></li><li><a href="global.html#activeIndexes">activeIndexes</a></li><li><a href="global.html#add">add</a></li><li><a href="global.html#addContent">addContent</a></li><li><a href="global.html#addEach">addEach</a></li><li><a href="global.html#addEventListener">addEventListener</a></li><li><a href="global.html#allExpanded">allExpanded</a></li><li><a href="global.html#avoidsEmptySelection">avoidsEmptySelection</a></li><li><a href="global.html#boundingBoxSize">boundingBoxSize</a></li><li><a href="global.html#cachedFirstElement">cachedFirstElement</a></li><li><a href="global.html#callDelegateMethod">callDelegateMethod</a></li><li><a href="global.html#cameraFov">cameraFov</a></li><li><a href="global.html#cameraPosition">cameraPosition</a></li><li><a href="global.html#cameraRoll">cameraRoll</a></li><li><a href="global.html#cameraTargetPoint">cameraTargetPoint</a></li><li><a href="global.html#checked">checked</a></li><li><a href="global.html#children">children</a></li><li><a href="global.html#childrenPath">childrenPath</a></li><li><a href="global.html#clear">clear</a></li><li><a href="global.html#clearSelectionOnOrderChange">clearSelectionOnOrderChange</a></li><li><a href="global.html#constructor">constructor</a></li><li><a href="global.html#content">content</a></li><li><a href="global.html#contentConstructor">contentConstructor</a></li><li><a href="global.html#contentController">contentController</a></li><li><a href="global.html#controller">controller</a></li><li><a href="global.html#convertCssPixelsPropertyStringToNumber">convertCssPixelsPropertyStringToNumber</a></li><li><a href="global.html#delete">delete</a></li><li><a href="global.html#deleteEach">deleteEach</a></li><li><a href="global.html#depth">depth</a></li><li><a href="global.html#deselectInvisibleContent">deselectInvisibleContent</a></li><li><a href="global.html#didBecomeActiveTarget">didBecomeActiveTarget</a></li><li><a href="global.html#dispatchEvent">dispatchEvent</a></li><li><a href="global.html#dispatchEventNamed">dispatchEventNamed</a></li><li><a href="global.html#draggedSlideIndex">draggedSlideIndex</a></li><li><a href="global.html#ElementReference">ElementReference</a></li><li><a href="global.html#elementsBoundingSphereRadius">elementsBoundingSphereRadius</a></li><li><a href="global.html#enabled">enabled</a></li><li><a href="global.html#expanded">expanded</a></li><li><a href="global.html#expandParameters">expandParameters</a></li><li><a href="global.html#exportName">exportName</a></li><li><a href="global.html#extractSerialization">extractSerialization</a></li><li><a href="global.html#filterPath">filterPath</a></li><li><a href="global.html#firstElement">firstElement</a></li><li><a href="global.html#flow">flow</a></li><li><a href="global.html#FlowTranslateComposer">FlowTranslateComposer</a></li><li><a href="global.html#frame">frame</a></li><li><a href="global.html#getBlueprintWithModuleId">getBlueprintWithModuleId</a></li><li><a href="global.html#getExternalObjectsString">getExternalObjectsString</a></li><li><a href="global.html#getInlineObjectsString">getInlineObjectsString</a></li><li><a href="global.html#getObjectsString">getObjectsString</a></li><li><a href="global.html#handleMinusAction">handleMinusAction</a></li><li><a href="global.html#handleMousewheel">handleMousewheel</a></li><li><a href="global.html#handlePlusAction">handlePlusAction</a></li><li><a href="global.html#handlePress">handlePress</a></li><li><a href="global.html#hasElasticScrolling">hasElasticScrolling</a></li><li><a href="global.html#hasSelectedIndexScrolling">hasSelectedIndexScrolling</a></li><li><a href="global.html#id">id</a></li><li><a href="global.html#index">index</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initiallyExpanded">initiallyExpanded</a></li><li><a href="global.html#initWithContent">initWithContent</a></li><li><a href="global.html#initWithDocument">initWithDocument</a></li><li><a href="global.html#initWithHtml">initWithHtml</a></li><li><a href="global.html#initWithModuleAndExportName">initWithModuleAndExportName</a></li><li><a href="global.html#initWithModuleId">initWithModuleId</a></li><li><a href="global.html#initWithObjectsAndDocumentFragment">initWithObjectsAndDocumentFragment</a></li><li><a href="global.html#initWithRepetition">initWithRepetition</a></li><li><a href="global.html#initWithRequire">initWithRequire</a></li><li><a href="global.html#injectIntoDocument">injectIntoDocument</a></li><li><a href="global.html#instantiateWithInstances">instantiateWithInstances</a></li><li><a href="global.html#isActiveTarget">isActiveTarget</a></li><li><a href="global.html#isEven">isEven</a></li><li><a href="global.html#isFinal">isFinal</a></li><li><a href="global.html#isFirst">isFirst</a></li><li><a href="global.html#isInputEnabled">isInputEnabled</a></li><li><a href="global.html#isLast">isLast</a></li><li><a href="global.html#isOdd">isOdd</a></li><li><a href="global.html#isSelectionEnabled">isSelectionEnabled</a></li><li><a href="global.html#Iteration">Iteration</a></li><li><a href="global.html#iterations">iterations</a></li><li><a href="global.html#junctions">junctions</a></li><li><a href="global.html#lastDrawTime">lastDrawTime</a></li><li><a href="global.html#length">length</a></li><li><a href="global.html#linearScrollingVector">linearScrollingVector</a></li><li><a href="global.html#max">max</a></li><li><a href="global.html#maxScroll">maxScroll</a></li><li><a href="global.html#mergeSerializations">mergeSerializations</a></li><li><a href="global.html#min">min</a></li><li><a href="global.html#minScroll">minScroll</a></li><li><a href="global.html#module">module</a></li><li><a href="global.html#ModuleReference">ModuleReference</a></li><li><a href="global.html#momentumDuration">momentumDuration</a></li><li><a href="global.html#MontageBuilder">MontageBuilder</a></li><li><a href="global.html#multiSelect">multiSelect</a></li><li><a href="global.html#nextTarget">nextTarget</a></li><li><a href="global.html#Node">Node</a></li><li><a href="global.html#noneExpanded">noneExpanded</a></li><li><a href="global.html#object">object</a></li><li><a href="global.html#offset">offset</a></li><li><a href="global.html#organizedContent">organizedContent</a></li><li><a href="global.html#parent">parent</a></li><li><a href="global.html#paths">paths</a></li><li><a href="global.html#pop">pop</a></li><li><a href="global.html#push">push</a></li><li><a href="global.html#RangeController">RangeController</a></li><li><a href="global.html#recycle">recycle</a></li><li><a href="global.html#relative">relative</a></li><li><a href="global.html#removeEventListener">removeEventListener</a></li><li><a href="global.html#repetition">repetition</a></li><li><a href="global.html#require">require</a></li><li><a href="global.html#resolve">resolve</a></li><li><a href="global.html#retractFromDocument">retractFromDocument</a></li><li><a href="global.html#reversed">reversed</a></li><li><a href="global.html#root">root</a></li><li><a href="global.html#scroll">scroll</a></li><li><a href="global.html#scrollingMode">scrollingMode</a></li><li><a href="global.html#scrollingTransitionDuration">scrollingTransitionDuration</a></li><li><a href="global.html#scrollingTransitionTimingFunction">scrollingTransitionTimingFunction</a></li><li><a href="global.html#select">select</a></li><li><a href="global.html#selectAddedContent">selectAddedContent</a></li><li><a href="global.html#selected">selected</a></li><li><a href="global.html#selectedIndexes">selectedIndexes</a></li><li><a href="global.html#selectedIndexScrollingOffset">selectedIndexScrollingOffset</a></li><li><a href="global.html#selection">selection</a></li><li><a href="global.html#setDocument">setDocument</a></li><li><a href="global.html#setInstances">setInstances</a></li><li><a href="global.html#setObjectMetadata">setObjectMetadata</a></li><li><a href="global.html#shift">shift</a></li><li><a href="global.html#slotContent">slotContent</a></li><li><a href="global.html#sortPath">sortPath</a></li><li><a href="global.html#splice">splice</a></li><li><a href="global.html#start">start</a></li><li><a href="global.html#startScrollingIndexToOffset">startScrollingIndexToOffset</a></li><li><a href="global.html#startStrideTime">startStrideTime</a></li><li><a href="global.html#step">step</a></li><li><a href="global.html#stopScrolling">stopScrolling</a></li><li><a href="global.html#stride">stride</a></li><li><a href="global.html#surrendersActiveTarget">surrendersActiveTarget</a></li><li><a href="global.html#swap">swap</a></li><li><a href="global.html#Target">Target</a></li><li><a href="global.html#translateStride">translateStride</a></li><li><a href="global.html#">undefined</a></li><li><a href="global.html#unshift">unshift</a></li><li><a href="global.html#value">value</a></li><li><a href="global.html#visibleIndexes">visibleIndexes</a></li><li><a href="global.html#willBecomeActiveTarget">willBecomeActiveTarget</a></li></ul></details>
</nav>

<div class="main">
    <article class="content">
    	



<header>
    <h2>
    UndoManager
    </h2>
    
</header>

<article>
    
        <dl>
            <dt>Extends</dt>
            <dd><a href="global.html#Target">Target</a> </dd>
        </dl>
    
    <div class="container-overview">
    

    
        
<dt>
    <h4 class="name" id="UndoManager"></h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Applications that allow end-user operations can use an UndoManager to record
   information on how to undo those operations.</p>
<h2>Undoable Operations</h2>
<p>   To make an operation undoable an application simply adds the inverse of that
   operation to an UndoManager instance using the <code>add</code> method:</p>
<p>   <code>undoManager.register(label, operationPromise)</code></p>
<p>   This means that every undo-able user operation has to have an inverse
   operation available. For example a calculator might provide a <code>subtract</code>
   method as the inverse of the <code>add</code> method.</p>
<p>   An simple example would look something like this:</p>
<pre><code class="lang-javascript">add: {
      value: function (number) {
          this.undoManager.register(&quot;Add&quot;, Promise.resolve([this.subtract, this, number]));
          var result = this.total += number;
          return result;
      }
  },

subtract: {
      value: function (number) {
          this.undoManager.register(&quot;Subtract&quot;, Promise.resolve([this.add, this, number]));
          var result = this.total -= number;
          return result;
      }
  }</code></pre>
<p>   Of immediate interest is the actual promise added to the undoManager.
   <code>Promise.resolve([&quot;Add&quot;, this.subtract, this, number])</code></p>
<p>   The promise provides the final label (optionally), a reference to the function to call,
   the context for the function to be executed in, and any number of arguments
   to be passed along when calling the function.</p>
<p>   In simple cases such as this the promise for the inverse operation
   can be resolved immediately; this is not necessarily always possible in cases
   where the operation itself is asynchronous.</p>
<h2>Basic Undoing and Redoing</h2>
<p>   After performing <code>calculator.add(42)</code> the undoManager will have an entry
   on how to undo that addition operation. Each operation added to the
   undoManager is added on top of a stack. Calling the undoManager's <code>undo</code>
   method will perform the operation on the top of that stack if
   original operationPromise has been resolved.</p>
<p>   While performing an undo operation any additions to the undoManager will
   instead be placed on the redo stack. Conversely, any additions made while
   performing a redo operation will be placed on the undo stack.</p>
<p>   When not actively undoing or redoing, the redo stack is cleared whenever a
   new operation is added; the only way operations end up on the redo stack is
   through undoing an operation.</p>
<h2>Asynchronous Considerations</h2>
<p>   It is possible for a user invoked operation to take some time to complete or
   details of how to undo the operation may not be known until the operation
   has completed.</p>
<p>   In these cases it is important to remember that the undo stack captures user
   intent, which is considered synchronous. This is why the undoManager accepts
   promises for the operations but places them on the stack synchronously.</p>
<p>   Consider the following example:</p>
<pre><code class="lang-javascript">addRandomNumber: {
      var deferredUndo,
          self = this;

      this.undoManager.register(&quot;Add Random&quot;, deferredUndo.promise);

      return this.randomNumberGeneratorService.next().then(function(rand) {
          deferredUndo.resolve([&quot;Add &quot; + rand, self.subtract, self, rand];
          var result = self.total = self.total + number;
          return result
      });
  }</code></pre>
<p>   Here we see that the undo operation for addRandomNumber is added to the
   UndoManager before we even know how to undo the operation, indeed it's added
   before the operation has even happened.</p>
<p>   It is worth noting that the undoManager does not block anything. Users are
   still free to call <code>add</code>, <code>subtract</code>, <code>addRandomNumber</code> or any
   other APIs exposed by the calculator, whether the <code>addRandomNumber</code> has
   resolved or not. It's the responsibility of an API provider to handle this
   scenario as necessary.</p>
<p>   At this point two things can happen:
   1) A user could invoke <code>undo</code> after the operation promise's resolution.
   2) A user could invoke <code>undo</code> prior to the operation promise's resolution.</p>
<p>   In the first scenario, things move along much like they did in the first case
   we described above.</p>
<p>   In the second scenario, the undoManager puts the unresolved promise into a
   queue of operations to be performed when possible. Subsequent undo and redo
   requests are added to this queue.</p>
<p>   Whenever a promise is resolved the undoManager runs through this queue in
   order, oldest to newest, and attempts to perform the operation specified,
   stopping when it encounters an unfulfilled operation promise.</p>
<p>   This guarantees that promised operations are added in the order as they were
   performed by the user and are executed, not in the order they are fulfilled,
   but in the order they are undone or redone.</p>
    </div>
    

    

    

    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L46">core/undo-manager.js</a>, line 46
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    

    

    

    
</dd>

    
    </div>

    

    

    

    

    
        <h3 class="subsection-title">Properties</h3>

        <dl>
            

        
            
<dt>
    <h4 class="name" id="canRedo"><span class="type-signature"></span>canRedo<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Returns true if the redo stack contains any items, otherwise returns false.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L700">core/undo-manager.js</a>, line 700
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="canUndo"><span class="type-signature"></span>canUndo<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Returns true if the undo stack contains any items, otherwise returns false.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L692">core/undo-manager.js</a>, line 692
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="closeBatch"><span class="type-signature"></span>closeBatch<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Closes the current batch operation; subsequent calls to <code>register</code> will
add operations to the parent batch or the top level if the closed batch
was the top-most batch.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L330">core/undo-manager.js</a>, line 330
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="currentBatch"><span class="type-signature"></span>currentBatch<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>The batch to which newly registered undo and redo operations will be added</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L308">core/undo-manager.js</a>, line 308
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="isRedoing"><span class="type-signature"></span>isRedoing<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Returns <code>true</code> if the UndoManager is in the middle of an redo operation, otherwise returns <code>false</code>.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L617">core/undo-manager.js</a>, line 617
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="isUndoing"><span class="type-signature"></span>isUndoing<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Returns <code>true</code> if the UndoManager is in the middle of an undo operation, otherwise returns <code>false</code>.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L609">core/undo-manager.js</a>, line 609
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="maxUndoCount"><span class="type-signature"></span>maxUndoCount<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Maximum number of operations allowed in each undo and redo stack
        Setting this lower than the current count of undo/redo operations will remove
        the oldest undos/redos as necessary to meet the new limit.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L230">core/undo-manager.js</a>, line 230
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="openBatch"><span class="type-signature"></span>openBatch<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Opens a batch operation; subsequent calls to <code>register</code> will add those
operations to this batch.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L316">core/undo-manager.js</a>, line 316
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="redoCount"><span class="type-signature"></span>redoCount<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>The current number of stored redoable operations</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L266">core/undo-manager.js</a>, line 266
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="redoLabel"><span class="type-signature"></span>redoLabel<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Contains the label describing the operation on top of the redo stack.
     End-users are strongly advised to prefix this with a localized &quot;Redo&quot; when
     presenting the label within an interface.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L720">core/undo-manager.js</a>, line 720
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="registrationEnabled"><span class="type-signature"></span>registrationEnabled<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Whether or not to accept registration of undo/redo operations</p>
<p>This is typically used to disable registration of operations
temporarily while undoable actions should be performed without
being undoable.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L294">core/undo-manager.js</a>, line 294
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="undoCount"><span class="type-signature"></span>undoCount<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>The current number of stored undoable operations</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L255">core/undo-manager.js</a>, line 255
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        
            
<dt>
    <h4 class="name" id="undoLabel"><span class="type-signature"></span>undoLabel<span class="type-signature"></span></h4>

    
</dt>
<dd>
    
    <div class="description">
        <p>Contains the label describing the operation on top of the undo stack.
        End-users are strongly advised to prefix this with a localized &quot;Undo&quot; when
        presenting the label within an interface.</p>
    </div>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L710">core/undo-manager.js</a>, line 710
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>


        </dl>
    

    
        <h3 class="subsection-title">Methods</h3>

        <dl>
            
<dt>
    <h4 class="name" id="clearRedo"><span class="type-signature"></span>clearRedo<span class="signature">()</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Removes all items from the redo stack.</p>
    </div>
    

    

    

    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L600">core/undo-manager.js</a>, line 600
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    

    

    

    
</dd>

        
            
<dt>
    <h4 class="name" id="clearUndo"><span class="type-signature"></span>clearUndo<span class="signature">()</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Removes all items from the undo stack.</p>
    </div>
    

    

    

    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L590">core/undo-manager.js</a>, line 590
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    

    

    

    
</dd>

        
            
<dt>
    <h4 class="name" id="redo"><span class="type-signature"></span>redo<span class="signature">()</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Schedules the next redo operation for invocation as soon as possible</p>
    </div>
    

    

    

    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L659">core/undo-manager.js</a>, line 659
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>A promise resolving to true when this redo request has been performed</p>
</div>



<dl>
	<dt class="return-type-label">
		Type
	</dt>
	<dd class="return-type">
		
<span class="param-type">Promise</span>


	</dd>
</dl>


        

    
</dd>

        
            
<dt>
    <h4 class="name" id="register"><span class="type-signature"></span>register<span class="signature">(label, operationPromise)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Adds a new operation to the either the undo or redo stack as appropriate.</p>
<p>   The operationPromise should be resolved with an array containing:
       - A label string for the operation (optional)
       - The function to execute when performing this operation
       - The object to use as the context when performing the function
       - Any number of arguments to apply when performing the function</p>
<h3>Examples</h3>
<p>   Registering an undo operation with no arguments</p>
<pre><code class="lang-javascript">undoManager.register(&quot;Square&quot;, Promise.resolve([calculator.sqrt, calculator]));</code></pre>
<p>  Registering an undo operation with arguments</p>
<pre><code class="lang-javascript">undoManager.register(&quot;Add&quot;, Promise.resolve([calculator.subtract, calculator, number]));</code></pre>
<p>   Registering an undo operation with a label and arguments</p>
<pre><code class="lang-javascript">   undoManager.register(&quot;Add&quot;, Promise.resolve([&quot;Add 5&quot;, calculator.subtract, calculator, 5]));</code></pre>
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
	<tr>
		
		<th>Name</th>
		
		
		<th>Type</th>
		
		
		
		
		
		<th class="last">Description</th>
	</tr>
	</thead>
	
	<tbody>
	
	
        <tr>
            
                <td class="name"><code>label</code></td>
            
            
            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>
            
            
            
            
            
            <td class="description last"><p>A label to associate with this undo entry.</p></td>
        </tr>
	
	
	
        <tr>
            
                <td class="name"><code>operationPromise</code></td>
            
            
            <td class="type">
            
                
<span class="param-type">promise</span>


            
            </td>
            
            
            
            
            
            <td class="description last"><p>A promise for an undoable operation</p></td>
        </tr>
	
	
	</tbody>
</table>
    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L410">core/undo-manager.js</a>, line 410
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>a promise for the resolution of the operationPromise</p>
</div>




        

    
</dd>

        
            
<dt>
    <h4 class="name" id="undo"><span class="type-signature"></span>undo<span class="signature">()</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Schedules the next undo operation for invocation as soon as possible</p>
    </div>
    

    

    

    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L638">core/undo-manager.js</a>, line 638
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    <p>A promise resolving to true when this undo request has been performed</p>
</div>



<dl>
	<dt class="return-type-label">
		Type
	</dt>
	<dd class="return-type">
		
<span class="param-type">Promise</span>


	</dd>
</dl>


        

    
</dd>

        </dl>
    

    

    
        <h3 class="subsection-title">Events</h3>

        <dl>
            
<dt>
    <h4 class="name" id="event:operationRegistered">operationRegistered</h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Dispatched when a new change is registered (i.e. not while undoing or
        redoing).</p>
    </div>
    

    

    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L168">core/undo-manager.js</a>, line 168
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>

        
            
<dt>
    <h4 class="name" id="event:redo">redo</h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Dispatched when a redo has been completed.</p>
    </div>
    

    

    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L172">core/undo-manager.js</a>, line 172
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>

        
            
<dt>
    <h4 class="name" id="event:undo">undo</h4>

    
</dt>
<dd>

    
    <div class="description markdown-body">
        <p>Dispatched when an undo has been completed.</p>
    </div>
    

    

    

    



<table class="details">
    
    
    

    
    
    
    
    
    
    
    
    
    
    
    
    
	<tr>
	    <th class="details-header tag-source">Source:</th>
	    <td class="details-content tag-source"><ul class="dummy"><li>
	        <a href="https://github.com/montagejs/montage/blob/master/core/undo-manager.js#L170">core/undo-manager.js</a>, line 170
	    </li></ul></td>
	</tr>
    
    
    
    
    
    
    
</table>


    
</dd>

        </dl>
    
</article>





    </article>
    {% include comments.html %}
</div>